/*	-INFORMATION-
	Subject:	Classes, Subclasses, Companion Template Option, Creature, Feats, Species(Races), Spells, Weapons
	Effect:		This script adds all of the content from the 2022-2023 series of Unearthed Arcana articles.
				This file has been made by MasterJedi2014, borrowing a lot of code from MPMB and those who have contributed to the sheet's existing material.
	Code by:	MasterJedi2014, using MorePurpleMoreBetter's code as reference; Joost/MPMB; TrackAtNite; Nod
	Date:		2024-05-23 (sheet v13.1.0)
	Notes:		This file will start by adding the Weapon Mastery functions made by Joost/MPMB & and the Weapon updates from UA23PT8.
				It will thereafter list content in the order it was released, ending with the code that adds all official WotC subclasses to the UA classes.
*/

var iFileName = "5.1E UA Content [by MasterJedi2014] V11.js";
RequiredSheetVersion("13.1.0");

/*	-SCRIPT AUTHOR NOTE-
	Artificer will not be added in this script because it is not a part of the playtesting for the upcoming
	revision to 5th Edition.
*/

// >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> //
// >>> Define Sources for everything first >>> //
// >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> //

SourceList["UA22CO"] = {
	name : "Unearthed Arcana 2022: Character Origins",
	abbreviation : "UA22CO",
	date : "2022/08/18",
	group : "UA:5.1E/One D&D",
	url : "https://media.dndbeyond.com/compendium-images/one-dnd/character-origins/CSWCVV0M4B6vX6E1/UA2022-CharacterOrigins.pdf",
};

SourceList["UA22XC"] = {
	name : "Unearthed Arcana 2022: Expert Classes",
	abbreviation : "UA22XC",
	date : "2022/10/28",
	group : "UA:5.1E/One D&D",
	url : "https://media.dndbeyond.com/compendium-images/one-dnd/expert-classes/kpx0MvyfBGHe0XKk/UA2022-Expert-Classes.pdf",
};

SourceList["UA22CS"] = {
	name : "Unearthed Arcana 2022: The Cleric and Revised Species",
	abbreviation : "UA22CS",
	date : "2022/12/01",
	group : "UA:5.1E/One D&D",
	url : "https://media.dndbeyond.com/compendium-images/one-dnd/cleric-and-revised-species/tr8jAj5cc33uQixi/UA-2022-ClericandSpecies.pdf",
};

SourceList["UA23DP"] = {
	name : "Unearthed Arcana 2023: Druid & Paladin",
	abbreviation : "UA23DP",
	date : "2023/02/23",
	group : "UA:5.1E/One D&D",
	url : "https://media.dndbeyond.com/compendium-images/one-dnd/druid-paladin/PXoa3UgywnZbwc9U/UA-2023-DruidandPaladin.pdf",
};

SourceList["UA23PT5"] = {
	name : "Unearthed Arcana 2023: Player's Handbook Playtest 5",
	abbreviation : "UA23PT5",
	date : "2023/04/26",
	group : "UA:5.1E/One D&D",
	url : "https://media.dndbeyond.com/compendium-images/ua/ph-playtest5/owThVp1CESZ1c91y/UA-2023-PH-Playtest5.pdf",
};

SourceList["UA23PT6"] = {
	name : "Unearthed Arcana 2023: Player's Handbook Playtest 6",
	abbreviation : "UA23PT6",
	date : "2023/06/29",
	group : "UA:5.1E/One D&D",
	url : "https://media.dndbeyond.com/compendium-images/ua/ph-playtest6/OJVW7QLuHjEFCCVs/UA-2023-PH-Playtest6.pdf",
};

SourceList["UA23PT7"] = {
	name : "Unearthed Arcana 2023: Player's Handbook Playtest 7",
	abbreviation : "UA23PT7",
	date : "2023/09/07",
	group : "UA:5.1E/One D&D",
	url : "https://media.dndbeyond.com/compendium-images/ua/ph-playtest7/tsgOb3llF22AL0nU/UA2023-PH-Playtest7.pdf",
};

SourceList["UA23BC"] = {
	name : "Unearthed Arcana 2023: Bastions and Cantrips",
	abbreviation : "UA23BC",
	date : "2023/10/05",
	group : "UA:5.1E/One D&D",
	url : "https://media.dndbeyond.com/compendium-images/ua/bastions-cantrips/BRF3GSu0nTfNu8p4/UA2023-BastionsCantrips.pdf",
};

SourceList["UA23PT8"] = {
	name : "Unearthed Arcana 2023: Player's Handbook Playtest 8",
	abbreviation : "UA23PT8",
	date : "2023/11/23",
	group : "UA:5.1E/One D&D",
	url : "https://media.dndbeyond.com/compendium-images/ua/ph-playtest8/gHvtmY50loGLgQUb/UA2023-PH-Playtest8.pdf",
};

SourceList["UAM"] = {
	name : "UA Monk",
	abbreviation : "UAM",
	group : "Treasure Coast Tabletop Club",
	date : "2023/11/27"
};

SourceList["MJ:HB"] = {
	name : "MasterJedi2014's Homebrew",
	abbreviation : "MJ:HB",
	date : "2024/05/23",
};

//// >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA23PT8 Weapon Mastery Functions & Weapon Updates >>> ////
//// >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ////

// Add "weaponMasteryAtkAdd" & "masterOfArmamentsAtkAdd" functions for Weapon Masteries, made by user @Joost/MorePurpleMoreBetter
masteryFunctions = {
  weaponMasteryAtkAdd : [
    function (fields, v, addIfPactWeapon) {
      if ( /mastery/i.test(v.WeaponText) || (addIfPactWeapon && v.pactWeapon) ) return; // less indentation is easier to read
      // Sum all the WeaponsList object names that get a certain mastery
      var oMasteries = {
        'Slow' : ['club', 'javelin', 'light crossbow', 'sling', 'whip', 'longbow', 'musket', 'rifle hunting', 'rifle automatic', 'shotgun', 'antimatter rifle', 'laser rifle'],
        'Nick' : ['dagger', 'light hammer', 'sickle', 'scimitar', ''],
        'Push' : ['greatclub', 'pike', 'warhammer', 'heavy crossbow'],
        'Vex' : ['handaxe', 'dart', 'shortbow', 'rapier', 'shortsword', 'blowgun', 'hand crossbow', 'pistol', 'pistol automatic', 'revolver', 'laser pistol'],
        'Sap' : ['mace', 'spear', 'flail', 'lonsword', 'morningstar', 'war pick', ''],
        'Topple' : ['quarterstaff', 'battleaxe', 'lance', 'maul', 'trident'],
        'Graze' : ['glaive', 'greatsword'],
        'Cleave' : ['greataxe', 'halberd']
      }
      // Loop over these and add the mastery only if either v.WeaponName or v.baseWeaponName match exactly
      loopMasteries:
      for (var sMastery in oMasteries) {
        // Loop over all the weapons in the mastery's array to see if any match
        var aWeapons = oMasteries[sMastery];
        loopWeapons:
        for (var i = 0; i < aWeapons.length; i++) {
          if ( aWeapons[i] === v.WeaponName || aWeapons[i] === v.baseWeaponName ) {
            fields.Description += (fields.Description ? ', ' : '') + 'Mstry: ' + sMastery;
            v.mastery = sMastery; // save to later reference
            break loopMasteries;
          }
        }
      }
    },
    'If I include the word "Mastery" in the name of a weapon, the Mastery property for that weapon will be appended to the description, if any.',
    1 // make this be process first, as it is a base change to the item's description that we want all other descriptions to come after (hence the use of a comma instead of a semicolon when adding the description above)
  ],
  masterOfArmamentsAtkAdd : [
    function (fields, v) {
      if ( !/mastery/i.test(v.WeaponTextName) || v.masterOfArmaments ) return; // less indentation is easier to read
      // Make an array of all the optional masteries the weapon is eligible for (thus, always include Slow)
      var aOptionalMasteries = ['Slow'];
      if ( v.isMeleeWeapon && /heavy/i.test(fields.Description) ) {
        aOptionalMasteries.push('Cleave', 'Graze');
      }
      if ( /light/i.test(fields.Description) ) {
        aOptionalMasteries.push('Nick');
      }
      if ( /heavy|two-handed|versatile/i.test(fields.Description) ) {
        aOptionalMasteries.push('Push');
      }
      if ( /versatile/i.test(fields.Description) || !v.theWea.description ) {
        aOptionalMasteries.push('Sap');
      }
      if ( /heavy|reach|versatile/i.test(fields.Description) ) {
        aOptionalMasteries.push('Topple');
      }
      if ( /ammunition|finesse|light/i.test(fields.Description) ) {
        aOptionalMasteries.push('Vex');
      }
      // Add the default mastery of the weapon, if not already eligible
      if ( v.mastery && aOptionalMasteries.indexOf(v.mastery) === -1 ) {
        aOptionalMasteries.push(v.mastery);
      }
      // Sort this new array
      aOptionalMasteries.sort();
      var sMasteries = 'Mstry: ' + aOptionalMasteries.join('/');
      // Add to the description (replace current "Mstry: X" if it exists)
      var rxMstry = /Mstry: (Slow|Nick|Push|Vex|Sap|Topple|Graze|Cleave)/i;
      if ( rxMstry.test(fields.Description) ) {
        fields.Description = fields.Description.replace(rxMstry, sMasteries);
      } else {
        // no "Mstry: X" string so just add it to the end
        fields.Description += (fields.Description ? '; ' : '') + sMasteries;
      }
      // Save that this function was run on this weapon so it isn't accidentally done twice
      v.masterOfArmaments = true;
    },
    'Weapons with the word "Mastery" will have any extra Mastery properties that they qualify for appended to their descriptions.'
  ]
};

// Alter Trident
WeaponsList["trident"] = {
	regExpSearch : /trident|\bchas?\b|magariyari/i,
	name : "Trident",
	source : [["SRD", 66], ["P", 149], ["UA23PT8", 22]],
	list : "melee",
	ability : 1,
	type : "Martial",
	damage : [1, 8, "piercing"],
	range : "Melee, 20/60 ft",
	weight : 4,
	description : "Thrown, versatile (1d10)",
	abilitytodamage : true
};

// Alter Ranged Martial Firearms
WeaponsList["pistol"] = {
	regExpSearch : /^(?=.*pistol)(?!.*automatic).*$/i,
	name : "Pistol",
	source : [["D", 268], ["UA23PT8", 22]],
	list : "firearm",
	ability : 2,
	type : "Martial",
	damage : [1, 10, "piercing"],
	range : "30/90 ft",
	weight : 3,
	description : "Ammunition, loading",
	abilitytodamage : true,
	ammo : "renaissance bullet",
};
WeaponsList["musket"] = {
	regExpSearch : /musket/i,
	name : "Musket",
	source : [["D", 268], ["UA23PT8", 22]],
	list : "firearm",
	ability : 2,
	type : "Martial",
	damage : [1, 12, "piercing"],
	range : "40/120 ft",
	weight : 10,
	description : "Ammunition, loading",
	abilitytodamage : true,
	ammo : "renaissance bullet",
};

// Alter Adventuring Gear: Net
WeaponsList["net"] = {
	regExpSearch : /\bnet(ting)?s?\b/i,
	name : "Net",
	source : [["SRD", 66], ["P", 149], ["UA23PT8", 24]],
	list : "ranged",
	ability : 2,
	type : "Martial",
	damage : ["\u2015", "", "Restrained"],
	range : "15 ft",
	weight : 3,
	description : "Thrown, only 1 attack, up to Large creature hit is Restrained",
	tooltip : "Special: When I take the Attack action on your turn, I can replace one of my attacks with a throw of the net at a creature within 15 feet of myself. The target must make a Dexterity saving throw against a DC equal to 8 + my Proficiency Bonus + my Dexterity modifier. The target succeeds automatically if it’s Huge or larger. On a failed save, the target has the Restrained condition until it escapes the net. To escape, the target must use its action to make a DC 10 Strength (Athletics) check, escaping on a success. A creature within 5 feet of the target can use its action to attempt the same thing. Destroying the net (AC 10; 5 HP; immunity to Bludgeoning, Poison, and Psychic damage) also frees the target, ending the effect.",
	special : true,
	abilitytodamage : false
};

//// >>>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA22CO Species >>> ////
//// >>>>>>>>>>>>>>>>>>>>>> ////

// Human
RaceList["human ua22co"] = {
	regExpSearch : /^(?=.*human).*$/i,
	name : "Human (UA22CO)",
	plural : "Humans",
	source : [["UA22CO", 3], ["MJ:HB", 0]],
	size : 3,
	speed : {
		walk : { spd : 30, enc : 20 },
	},
	languageProfs : ["Common"],
	skillstxt : "Proficiency with one skill of my choice.",
	age : " reach adulthood in their late teens and live less than a century, about 80 years on average.",
	height : " range from 3' to over 6 feet tall (2'11\" + 5d8\")",
	weight : " typically weigh 155 lb (75 + 5d8 \xD7 1d4 lb)",
	heightMetric : " range from .91 to over 1.8 metres tall (89 + 9d10 cm)",
	weightMetric : " typically weigh around 74 kg (34 + 6d8 \xD7 4d4 / 10 kg)",
	trait : "Human:\n   Resourceful: I gain Heroic Advantage whenever I finish a Long Rest.\n\n   Skillful: I gain proficiency in one skill of my choice.\n\n   Versatile: I gain the Skilled Feat or another 1st Lvl Feat of my choice.",
	eval : function() { AddFeat("Skilled"); },
	removeeval : function() { RemoveFeat("Skilled"); }
};

// Dwarf
RaceList["dwarf ua22co"] = {
	regExpSearch : /^(?=.*dwarf).*$/i,
	name : "Dwarf (UA22CO)",
	source : [["UA22CO", 5], ["MJ:HB", 0]],
	plural : "Dwarves",
	size : 3,
	speed : {
		walk : { spd : 30, enc : 20 },
	},
	languageProfs : ["Common"],
	vision : [
		["Darkvision", 60],
		["Blindsight for 10 min as Bonus Action", 60],
	],
	dmgres : ["Poison"],
	toolProfs : [["Artisan's tools", 2]],
	age : " are considered young until they reach the age of 50. On average, they live about 350 years.",
	height : " range from 4' to 5' tall (3'8\" + 2d4\")",
	weight : " typically weigh 150 lb (115 + 2d4 \xD7 2d6 lb)",
	heightMetric : " range from 1.2 to 1.5 metres tall (110 + 5d4 cm)",
	weightMetric : " typically weigh around 70 kg (55 + 5d4 \xD7 4d6 / 10 kg)",
	trait : "Dwarf:\n   Dwarven Resilience: I have Resistance to Poison Damage and gain Advantage on saving throws I make to avoid or end the Poisoned Condition on myself.\n\n   Dwarven Toughness: Hit Point Maximum increases by 1 per character level.\n\n   Forge Wise: I gain Tool Proficiency with two of the following options of my choice: Jeweler’s Tools, Mason’s Tools, Smith’s Tools, or Tinker’s Tools.\n\n   Stonecunning: As a Bonus Action, I can gain Tremorsense out to 60 ft for 10 minutes. I can do so Proficiency Bonus number of times per Long Rest.",
	calcChanges : {
		hp : function (totalHD) {
			return [totalHD * 1, '\n + ' + totalHD + ' 1 from Dwarven Toughness (' + (totalHD * 1) + ')', true];
		},
	},
};

// Elves
RaceList["elf ua22co"] = {
	regExpSearch : /^(?=.*elf).*$/i,
	name : "Elf (UA22CO)",
	source : [["UA22CO", 6], ["MJ:HB", 0]],
	plural : "Elves",
	size : 3,
	speed : {
		walk : { spd : 30, enc : 20 },
	},
	languageProfs : ["Common"],
	vision : [
		["Darkvision", 60],
	],
	skills : ["Perception"],
	skillstxt : "Proficiency with Perception.",
	savetxt : {
		text : "Magic can't put me to sleep; Adv. on saves vs. Charmed",
	},
	age : " typically claim adulthood around the age of 100 and can live to be 750 years old.",
	height : " range from under 5' to over 6' tall (4'6\" + 2d10\")",
	weight : " typically weigh 115 lb (90 + 2d10 \xD7 1d4 lb)",
	heightMetric : " range from 1.5 to over 1.8 metres tall (140 + 5d10 cm)",
	weightMetric : " typically weigh around 55 kg (40 + 5d10 \xD7 2d4 / 10 kg)",
	trait : "Elf:\n   Elven Lineage: Choose a type of Elf using the \"Racial Options\" button. I am part of an elven lineage that grants me supernatural abilities at 1st level, 3rd level, and 5th level.\n   Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).\n\n   Fey Ancestry: I have Advantage on saving throws I make to avoid or end the Charmed Condition on myself.\n\n   Keen Senses: I have Proficiency in the Perception Skill.\n\n   Trance: Elves don't need to sleep, and cannot be magically put to sleep, but meditate semiconsciously for 4 hours a day. After resting in this way, I gain the benefits of a Long Rest after 4 hours of meditation.",
};
AddRacialVariant("elf ua22co", "high", {
	regExpSearch : /^(?=.*high).*$/i,
	name : "High Elf (UA22CO)",
	sortname : "Elf, High (UA22CO)",
	plural : "Elves",
	source : [["UA22CO", 6], ["MJ:HB", 0]],
	trait : "High Elf:\n   Elven Lineage: I am part of an elven lineage that grants me supernatural abilities:\nAt 1st level, I know the Prestidigitation cantrip, and can swap it out with another Wizard cantrip after a Long Rest.\nAt 3rd level, I become able to cast Detect Magic.\nAt 5th level, I become able to cast Misty Step.\n   I can cast these spells once without a spell slot. Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).\n\n   Fey Ancestry: I have Advantage on saving throws I make to avoid or end the Charmed Condition on myself.\n\n   Keen Senses: I have Proficiency in the Perception Skill.\n\n   Trance: Elves don't need to sleep, and cannot be magically put to sleep, but meditate semiconsciously for 4 hours a day. After resting in this way, I gain the benefits of a Long Rest after 4 hours of meditation.",
	spellcastingAbility : [4, 5, 6],
	features : {
		"prestidigitation" : {
			name : "Prestidigitation",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["prestidigitation"],
				selection : ["prestidigitation"],
				firstCol : 'atwill',
			},
		},
		"detect magic" : {
			name : "Detect Magic",
			minlevel : 3,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["detect magic"],
				selection : ["detect magic"],
				firstCol : 'oncelr',
			},
		},
		"misty step" : {
			name : "Misty Step",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["misty step"],
				selection : ["misty step"],
				firstCol : 'oncelr',
			},
		},
	},
});
AddRacialVariant("elf ua22co", "drow", {
	regExpSearch : /^(?=.*drow).*$/i,
	name : "Drow (UA22CO)",
	sortname : "Elf, Dark (Drow) (UA22CO)",
	plural : "Drow",
	source : [["UA22CO", 6], ["MJ:HB", 0]],
	vision : [
		["Darkvision", 120],
	],
	trait : "Drow:\n   Elven Lineage: I am part of an elven lineage that grants me supernatural abilities:\nAt 1st level, I know the Dancing Lights cantrip.\nAt 3rd level, I become able to cast Faerie Fire.\nAt 5th level, I become able to cast Darkness.\n   I can cast these spells once without a spell slot. Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).\n\n   Fey Ancestry: I have Advantage on saving throws I make to avoid or end the Charmed Condition on myself.\n\n   Keen Senses: I have Proficiency in the Perception Skill.\n\n   Trance: Elves don't need to sleep, and cannot be magically put to sleep, but meditate semiconsciously for 4 hours a day. After resting in this way, I gain the benefits of a Long Rest after 4 hours of meditation.",
	spellcastingAbility : [4, 5, 6],
	features : {
		"dancing lights" : {
			name : "Dancing Lights",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["dancing lights"],
				selection : ["dancing lights"],
				firstCol : 'atwill',
			},
		},
		"faerie fire" : {
			name : "Faerie Fire",
			minlevel : 3,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["faerie fire"],
				selection : ["faerie fire"],
				firstCol : 'oncelr',
			},
		},
		"darkness" : {
			name : "Darkness",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["darkness"],
				selection : ["darkness"],
				firstCol : 'oncelr',
			},
		},
	},
});
AddRacialVariant("elf ua22co", "wood", {
	regExpSearch : /^(?=.*wood).*$/i,
	name : "Wood Elf (UA22CO)",
	sortname : "Elf, Wood (UA22CO)",
	plural : "Elves",
	source : [["UA22CO", 6], ["MJ:HB", 0]],
	speed : {
		walk : { spd : 35, enc : 25 },
	},
	trait : "Wood Elf:\n   Elven Lineage: I am part of an elven lineage that grants me supernatural abilities:\nAt 1st level, I know the Druidcraft cantrip, and my Speed increases to 35 ft.\nAt 3rd level, I become able to cast Longstrider.\nAt 5th level, I become able to cast Pass without Trace.\n   I can cast these spells once without a spell slot. Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).\n\n   Fey Ancestry: I have Advantage on saving throws I make to avoid or end the Charmed Condition on myself.\n\n   Keen Senses: I have Proficiency in the Perception Skill.\n\n   Trance: Elves don't need to sleep, and cannot be magically put to sleep, but meditate semiconsciously for 4 hours a day. After resting in this way, I gain the benefits of a Long Rest after 4 hours of meditation.",
	spellcastingAbility : [4, 5, 6],
	features : {
		"druidcraft" : {
			name : "Druidcraft",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["druidcraft"],
				selection : ["druidcraft"],
				firstCol : 'atwill',
			},
		},
		"longstrider" : {
			name : "Longstrider",
			minlevel : 3,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["longstrider"],
				selection : ["longstrider"],
				firstCol : 'oncelr',
			},
		},
		"pass without trace" : {
			name : "Pass without Trace",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["pass without trace"],
				selection : ["pass without trace"],
				firstCol : 'oncelr',
			},
		},
	},
});

// Gnomes
RaceList["gnome ua22co"] = {
	regExpSearch : /^(?=.*gnome).*$/i,
	name : "Gnome (UA22CO)",
	plural : "Gnomes",
	source : [["UA22CO", 7], ["MJ:HB", 0]],
	size : 4,
	speed : {
		walk : { spd : 30, enc : 20 },
	},
	languageProfs : ["Common"],
	vision : [["Darkvision", 60]],
	savetxt : {
		text : "Adv. on Int, Wis, \u0026 Cha saves",
	},
	age : " start adult life around age 40, and can live about 425 years on average.",
	height : " range from about 3' to 4' tall (2'11\" + 2d4\")",
	weight : " typically weigh 40 lb (35 + 2d4 lb)",
	heightMetric : " range from .90 to 1.20 metres tall (90 + 5d4 cm)",
	weightMetric : " typically weigh around 18 kg (16 + 5d4 / 10 kg)",
	trait : "Gnome:\n   Gnomish Cunning: I have Advantage on Intelligence, Wisdom, and Charisma saving throws.\n\n   Gnomish Lineage: Choose a type of Gnome using the \"Racial Options\" button. I am part of a gnomish lineage that grants me supernatural abilities.\n   Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).",
};
AddRacialVariant("gnome ua22co", "forest", {
	regExpSearch : /^(?=.*forest).*$/i,
	name : "Forest Gnome (UA22CO)",
	sortname : "Gnome, Forest (UA22CO)",
	plural : "Gnomes",
	source : [["UA22CO", 7], ["MJ:HB", 0]],
	trait : "Forest Gnome:\n   Gnomish Cunning: I have Advantage on Intelligence, Wisdom, and Charisma saving throws.\n\n   Gnomish Lineage: I am part of a gnomish lineage that grants me supernatural abilities.\nI know the Minor Illusion cantrip & I can cast Speak with Animals.\n   I can cast these spells a Proficiency Bonus number of times per Long Rest without a spell slot. Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).",
	spellcastingAbility : [4, 5, 6],
	features : {
		"minor illusion" : {
			name : "Minor Illusion",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["minor illusion"],
				selection : ["minor illusion"],
				firstCol : 'atwill',
			},
		},
		"speak with animals" : {
			name : "Speak with Animals",
			limfeaname : "Speak with Animals",
			minlevel : 1,
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["speak with animals"],
				selection : ["speak with animals"],
				firstCol : 'oncelr',
			},
		},
	},
});
AddRacialVariant("gnome ua22co", "rock", {
	regExpSearch : /^(?=.*rock).*$/i,
	name : "Rock Gnome (UA22CO)",
	sortname : "Gnome, Rock (UA22CO)",
	plural : "Gnomes",
	source : [["UA22CO", 7], ["MJ:HB", 0]],
	trait : "Rock Gnome:\n   Gnomish Cunning: I have Advantage on Intelligence, Wisdom, and Charisma saving throws.\n\n   Gnomish Lineage: I am part of a gnomish lineage that grants me supernatural abilities.\nI know the Mending & Prestidigitation cantrips. See the Notes page for more info on this Species Feature.\n   I can cast these spells a Proficiency Bonus number of times per Long Rest without a spell slot. Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).",
	toNotesPage : [{
		name : "Rock Gnome Traits Continued:",
		note : "\n   Gnomish Lineage (Continued): I can can spend 10 minutes casting Prestidigitation to create a Tiny clockwork device (AC 5, 1 HP), such as a toy, a fire starter, or a music box. Casting the Spell in this way consumes 10 GP worth of raw material (string, gears, and the like), which I provide during the casting.\n   When I create the device, I determine its function by choosing one effect from Prestidigitation; the device produces that effect whenever I or another creature takes a Bonus Action to touch the device and activate it. If the chosen effect has options within it, I choose one of those options for the device when I create it. For example, if I choose the spell’s ignite-extinguish effect, I determine whether the device ignites or extinguishes fire; the device doesn’t do both.\n   I can have three such devices in existence at a time, and each one dismantles itself 8 hours after its creation. I can also touch one of my devices and dismantle it as an Action. After a device is dismantled, the 10 GP of materials used to create it can be reclaimed.",
		page3notes : true,
		popupName : "Species Traits Continued",
		source : [["MJ:HB", 0], ["UA22CO", 7]],
	}],
	spellcastingAbility : [4, 5, 6],
	features : {
		"mending" : {
			name : "Mending",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["mending"],
				selection : ["mending"],
				firstCol : 'atwill',
			},
		},
		"prestidigitation" : {
			name : "Prestidigitation",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["prestidigitation"],
				selection : ["prestidigitation"],
				firstCol : 'atwill',
			},
		},
		"clockwork devices" : {
			name : "Clockwork Devices",
			minlevel : 1,
			usages : 3,
			recovery : "8hr",
		},
	},
});

// Halfling
RaceList["halfling ua22co"] = {
	regExpSearch : /^(?=.*halfling).*$/i,
	name : "Halfling (UA22CO)",
	source : [["UA22CO", 8], ["MJ:HB", 0]],
	plural : "Halflings",
	size : 4,
	speed : {
		walk : { spd : 30, enc : 20 },
	},
	languageProfs : ["Common"],
	skills : ["Stealth"],
	skillstxt : "Proficiency with Stealth.",
	savetxt : {
		text : "Adv. on saves vs. Frightened",
	},
	age : " reach adulthood at age 20, and can live about 150 years on average.",
	height : " are about 3' tall (2'7\" + 2d4\")",
	weight : " typically weigh 40 lb (35 + 2d4 lb)",
	heightMetric : " are about .90 metres tall (80 + 5d4 cm)",
	weightMetric : " typically weigh around 18 kg (16 + 5d4 / 10 kg)",
	trait : "Halfling:\n   Brave: I have Advantage on saving throws I make to avoid or end the Frightened Condition on myself.\n\n   Halfling Nimbleness: I can move through the space of any creature that is of a size larger than me, but I can’t stop there.\n\n   Luck: When I roll a 1 on any d20 Test, I can reroll the die and must use the new roll.\n\n   Naturally Stealthy: I have Proficiency in the Stealth Skill.",
};

// Orc
RaceList["orc ua22co"] = {
	regExpSearch : /^(?=.*orc).*$/i,
	name : "Orc (UA22CO)",
	source : [["UA22CO", 9], ["MJ:HB", 0]],
	plural : "Orcs",
	size : 3,
	speed : {
		walk : { spd : 30, enc : 20 },
	},
	languageProfs : ["Common"],
	vision : [
		["Darkvision", 60],
	],
	age : " reach adulthood at age 12 and live less than a century, about 80 years on average.",
	height : " are usually over 6' tall (5'4\" + 2d8\")",
	weight : " typically weigh between 230 and 280 lb (175 + 2d8 \xD7 2d6 lb)",
	heightMetric : " are usually over 1.80 metres tall (160 + 5d8 cm)",
	weightMetric : " typically weigh between 100 and 125 kg (80 + 5d8 \xD7 4d6 / 10 kg)",
	trait : "Orc:\n   Adrenaline Rush: Proficiency Bonus per Long Rest, I can take the Dash action as a Bonus Action and gain my Proficiency Bonus in Temporary Hit Points.\n\n   Powerful Build: I count as one Size larger when determining my carrying capacity and the weight I can push, drag, or lift.\n\n   Relentless Endurance: Once per long rest, when I am reduced to 0 hit points but not killed outright, I can drop to 1 hit point instead.",
	features : {
		"adrenaline rush" : {
			name : "Adrenaline Rush",
			minlevel : 1,
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
			action : [
				["bonus action", "Adrenaline Rush"],
			],
		},
		"relentless endurance" : {
			name : "Relentless Endurance",
			minlevel : 1,
			usages : 1,
			recovery : "long rest",
		},
	},
	carryingCapacity : 2,
};

// Tieflings
RaceList["tiefling ua22co"] = {
	regExpSearch : /^(?=.*tiefling).*$/i,
	name : "Tiefling (UA22CO)",
	plural : "Teiflings",
	source : [["UA22CO", 9], ["MJ:HB", 0]],
	size : 3,
	speed : {
		walk : { spd : 30, enc : 20 },
	},
	languageProfs : ["Common"],
	vision : [["Darkvision", 60]],
	age : " mature at the same rate as humans but live a few years longer, about 100 years on average.",
	height : " range from 3' to over 6 feet tall (2'11\" + 5d8\")",
	weight : " typically weigh 155 lb (75 + 5d8 \xD7 1d4 lb)",
	heightMetric : " range from .91 to over 1.8 metres tall (89 + 9d10 cm)",
	weightMetric : " typically weigh around 74 kg (34 + 6d8 \xD7 4d4 / 10 kg)",
	trait : "Tiefling:\n   Fiendish Legacy: Choose a type of Tiefling using the \"Racial Options\" button. I am the recipient of a fiendish legacy that grants me supernatural abilities at 1st level, 3rd level, \u0026 5th level.\n   Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).\n\n   Otherworldly Presence: I know the Thaumaturgy cantrip. When I cast it with this trait, the Spell uses the same spellcasting ability I use for my Fiendish Legacy trait.",
};
AddRacialVariant("tiefling ua22co", "abyssal", {
	regExpSearch : /^(?=.*abyssal).*$/i,
	name : "Abyssal Tiefling (UA22CO)",
	sortname : "Tiefling, Abyssal (UA22CO)",
	plural : "Tieflings",
	source : [["UA22CO", 9], ["MJ:HB", 0]],
	dmgres : ["Poison"],
	trait : "Abyssal Tiefling:\n   Fiendish Legacy: I am the recipient of an Abyssal fiendish legacy that grants me supernatural abilities:\nAt 1st level, I am resistant to Poison Damage & know the Poison Spray cantrip.\nAt 3rd level, I become able to cast Ray of Sickness.\nAt 5th level, I become able to cast Hold Person.\n   I can cast these spells once without a spell slot. Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).\n\n   Otherworldly Presence: I know the Thaumaturgy cantrip. When I cast it with this trait, the Spell uses the same spellcasting ability I use for my Fiendish Legacy trait.",
	spellcastingAbility : [4, 5, 6],
	features : {
		"otherworldly presence" : {
			name : "Otherworldy Presence",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["thaumaturgy"],
				selection : ["thaumaturgy"],
				firstCol : 'atwill',
			},
		},
		"poison spray" : {
			name : "Poison Spray",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["poison spray", "poison spray ua23bc"],
				selection : ["poison spray", "poison spray ua23bc"],
				firstCol : 'atwill',
			},
		},
		"ray of sickness" : {
			name : "Ray of Sickness",
			minlevel : 3,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["ray of sickness"],
				selection : ["ray of sickness"],
				firstCol : 'oncelr',
			},
		},
		"hold person" : {
			name : "Hold Person",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["hold person"],
				selection : ["hold person"],
				firstCol : 'oncelr',
			},
		},
	},
});
AddRacialVariant("tiefling ua22co", "cthonic", {
	regExpSearch : /^(?=.*cthonic).*$/i,
	name : "Cthonic Tiefling (UA22CO)",
	sortname : "Tiefling, Cthonic (UA22CO)",
	plural : "Tieflings",
	source : [["UA22CO", 9], ["MJ:HB", 0]],
	dmgres : ["Necrotic"],
	trait : "Cthonic Tiefling:\n   Fiendish Legacy: I am the recipient of a Cthonic fiendish legacy that grants me supernatural abilities:\nAt 1st level, I am resistant to Necrotic Damage & know the Chill Touch cantrip.\nAt 3rd level, I become able to cast False Life.\nAt 5th level, I become able to cast Ray of Enfeeblement.\n   I can cast these spells once without a spell slot. Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).\n\n   Otherworldly Presence: I know the Thaumaturgy cantrip. When I cast it with this trait, the Spell uses the same spellcasting ability I use for my Fiendish Legacy trait.",
	spellcastingAbility : [4, 5, 6],
	features : {
		"otherworldly presence" : {
			name : "Otherworldy Presence",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["thaumaturgy"],
				selection : ["thaumaturgy"],
				firstCol : 'atwill',
			},
		},
		"chill touch" : {
			name : "Chill Touch",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["chill touch", "chill touch ua23bc"],
				selection : ["chill touch", "chill touch ua23bc"],
				firstCol : 'atwill',
			},
		},
		"false life" : {
			name : "False Life",
			minlevel : 3,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["false life"],
				selection : ["false life"],
				firstCol : 'oncelr',
			},
		},
		"ray of enfeeblement" : {
			name : "Ray of Enfeeblement",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["ray of enfeeblement"],
				selection : ["ray of enfeeblement"],
				firstCol : 'oncelr',
			},
		},
	},
});
AddRacialVariant("tiefling ua22co", "infernal", {
	regExpSearch : /^(?=.*infernal).*$/i,
	name : "Infernal Tiefling (UA22CO)",
	sortname : "Tiefling, Infernal (UA22CO)",
	plural : "Tieflings",
	source : [["UA22CO", 9], ["MJ:HB", 0]],
	dmgres : ["Fire"],
	trait : "Infernal Tiefling:\n   Fiendish Legacy: I am the recipient of an Infernal fiendish legacy that grants me supernatural abilities:\nAt 1st level, I am resistant to Fire Damage & know the Fire Bolt cantrip.\nAt 3rd level, I become able to cast Hellish Rebuke.\nAt 5th level, I become able to cast Darkness.\n   I can cast these spells once without a spell slot. Intelligence, Wisdom, or Charisma is my spellcasting ability for the Spells I cast with this trait (choose the ability when I select the lineage).\n\n   Otherworldly Presence: I know the Thaumaturgy cantrip. When I cast it with this trait, the Spell uses the same spellcasting ability I use for my Fiendish Legacy trait.",
	spellcastingAbility : [4, 5, 6],
	features : {
		"otherworldly presence" : {
			name : "Otherworldy Presence",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["thaumaturgy"],
				selection : ["thaumaturgy"],
				firstCol : 'atwill',
			},
		},
		"fire bolt" : {
			name : "Fire Bolt",
			minlevel : 1,
			spellcastingBonus : {
				spells : ["fire bolt"],
				selection : ["fire bolt"],
				firstCol : 'atwill',
			},
		},
		"hellish rebuke" : {
			name : "Hellish Rebuke",
			minlevel : 3,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["hellish rebuke"],
				selection : ["hellish rebuke"],
				firstCol : 'oncelr',
			},
		},
		"darkness" : {
			name : "Darkness",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				spells : ["darkness"],
				selection : ["darkness"],
				firstCol : 'oncelr',
			},
		},
	},
});

//// >>>>>>>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA22CO Backgrounds >>> ////
//// >>>>>>>>>>>>>>>>>>>>>>>>>> ////

// Add the backgrounds presented in this UA article
BackgroundList["acolyte ua22co"] = {
	regExpSearch : /^(?=.*acolyte).*$/i,
	name : "Acolyte (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 11]],
	skills : ["Insight", "Religion"],
	gold : 3,
	toolProfs : ["Calligrapher's supplies"],
	languageProfs : ["Celestial"],
	lifestyle : "poor",
	scores : [0, 0, 0, 1, 2, 0],
	equipleft : [
		["Calligrapher's supplies", "", 5],
		["Holy symbol", "", 0.03125],
		["Book (Prayers)", "", 5],
		["Parchment sheet", 10, 0.00625],
	],
	equipright : [
		["Robe", "", 4],
	],
	feature : "Shelter of the Faithful UA22CO",
	trait : [
		"I idolize a particular hero of my faith, and constantly refer to that person's deeds and example.",
		"I can find common ground between the fiercest enemies, empathizing with them and always working toward peace.",
		"I see omens in every event and action. The gods try to speak to us, we just need to listen.",
		"Nothing can shake my optimistic attitude.",
		"I quote (or misquote) sacred texts and proverbs in almost every situation.",
		"I am tolerant (or intolerant) of other faiths and respect (or condemn) the worship of other gods.",
		"I've enjoyed fine food, drink, and high society among my temple's elite. Rough living grates on me.",
		"I've spent so long in the temple that I have little practical experience dealing with people in the outside world.",
	],
	ideal : [
		["Tradition",
			"Tradition: The ancient traditions of worship and sacrifice must be preserved and upheld. (Lawful)"
		],
		["Charity",
			"Charity: I always try to help those in need, no matter what the personal cost. (Good)"
		],
		["Change",
			"Change: We must help bring about the changes the gods are constantly working in the world. (Chaotic)"
		],
		["Power",
			"Power: I hope to one day rise to the top of my faith's religious hierarchy. (Lawful)"
		],
		["Faith",
			"Faith: I trust that my deity will guide my actions. I have faith that if I work hard, things will go well. (Lawful)"
		],
		["Aspiration",
			"Aspiration: I seek to prove myself worthy of my god's favor by matching my actions against his or her teachings. (Any)"
		],
	],
	bond : [
		"I would die to recover an ancient relic of my faith that was lost long ago.",
		"I will someday get revenge on the corrupt temple hierarchy who branded me a heretic.",
		"I owe my life to the priest who took me in when my parents died.",
		"Everything I do is for the common people.",
		"I will do anything to protect the temple where I served.",
		"I seek to preserve a sacred text that my enemies consider heretical and seek to destroy.",
	],
	flaw : [
		"I judge others harshly, and myself even more severely.",
		"I put too much trust in those who wield power within my temple's hierarchy.",
		"My piety sometimes leads me to blindly trust those that profess faith in my god.",
		"I am inflexible in my thinking.",
		"I am suspicious of strangers and expect the worst of them.",
		"Once I pick a goal, I become obsessed with it to the detriment of everything else in my life.",
	],
};
BackgroundList["artisan ua22co"] = {
	regExpSearch : /^(?=.*artisan).*$/i,
	name : "Artisan (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 12]],
	skills : ["Investigation", "Persuasion"],
	gold : 25,
	toolProfs : [["Artisan's tools", 1]],
	languageProfs : [1, "Gnomish"],
	lifestyle : "comfortable",
	scores : [0, 0, 0, 2, 0, 1],
	scorestxt : "+2 Intelligence, +1 Charisma",
	equipleft : [
		["Artisan's tools (of chosen type)", "", ""],
		["Abacus", "", 2],
		["Merchant's scale", "", 3],
		["Belt, with:", "----", 0.0625],
		["- Pouch", 2, 1],
	],
	equipright : [
		["Traveler's clothes", "", 4],
	],
	feature : "Respect of the Stout Folk UA22CO",
	trait : [
		"I believe that anything worth doing is worth doing right. I can't help it—I'm a perfectionist.",
		"I'm a snob who looks down on those who can't appreciate fine art.",
		"I always want to know how things work and what makes people tick.",
		"I'm full of witty aphorisms and have a proverb for every occasion.",
		"I'm rude to people who lack my commitment to hard work and fair play.",
		"I like to talk at length about my profession.",
		"I don't part with my money easily and will haggle tirelessly to get the best deal possible.",
		"I'm well known for my work, and I want to make sure everyone appreciates it. I'm always taken aback when people haven't heard of me.",
	],
	ideal : [
		["Community",
			"Community: It is the duty of all civilized people to strengthen the bonds of community and the security of civilization. (Lawful)"
		],
		["Generosity",
			"Generosity: My talents were given to me so that I could use them to benefit the world. (Good)"
		],
		["Freedom",
			"Freedom: Everyone should be free to pursue his or her own livelihood. (Chaotic)"
		],
		["Greed",
			"Greed: I'm only in it for the money. (Evil)"
		],
		["People",
			"People: I'm committed to the people I care about, not to ideals. (Neutral)"
		],
		["Aspiration",
			"Aspiration: I work hard to be the best there is at my craft. (Any)"
		],
	],
	bond : [
		"The workshop where I learned my trade is the most important place in the world to me.",
		"I created a great work for someone, and then found them unworthy to receive it. I'm still looking for someone worthy.",
		"I owe my guild a great debt for forging me into the person I am today.",
		"I pursue wealth to secure someone's love.",
		"One day I will return to my guild and prove that I am the greatest artisan of them all.",
		"I will get revenge on the evil forces that destroyed my place of business and ruined my livelihood.",
	],
	flaw : [
		"I'll do anything to get my hands on something rare or priceless.",
		"I'm quick to assume that someone is trying to cheat me.",
		"No one must ever learn that I once stole money from guild coffers.",
		"I'm never satisfied with what I have—I always want more.",
		"I would kill to acquire a noble title.",
		"I'm horribly jealous of anyone who can outshine my handiwork. Everywhere I go, I'm surrounded by rivals.",
	],
	extra : [
		"Select an Artisan Specialty",
		"Alchemists & apothecaries",
		"Armorers, locksmiths, & finesmiths",
		"Brewers, distillers, & vintners",
		"Calligraphers, scribes, & scriveners",
		"Carpenters, roofers, & plasterers",
		"Cartographers, surveyors, & chart-makers",
		"Cobblers & shoemakers",
		"Cooks & bakers",
		"Glassblowers & glaziers",
		"Jewelers & gemcutters",
		"Leatherworkers, skinners, & tanners",
		"Masons & stonecutters",
		"Painters, limners, & sign-makers",
		"Potters & tile-makers",
		"Shipwrights & sail-makers",
		"Smiths & metal-forgers",
		"Tinkers, pewterers, & casters",
		"Wagon-makers & wheelwrights",
		"Weavers & dyers",
		"Woodcarvers, coopers, & bowyers",
	],
};
BackgroundList["charlatan ua22co"] = {
	regExpSearch : /^(?=.*charlatan).*$/i,
	name : "Charlatan (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 12]],
	skills : ["Deception", "Sleight of Hand"],
	gold : 15,
	toolProfs : ["Forgery kit"],
	languageProfs : [1, "Infernal"],
	lifestyle : "comfortable",
	scores : [0, 1, 0, 0, 0, 2],
	scorestxt : "+2 Charisma, +1 Dexterity",
	equipleft : [
		["Forgery kit", "", 5],
		["Costume clothes", "", 4],
	],
	equipright : [
		["Fine clothes", "", 6],
	],
	feature : "False Identity UA22CO",
	trait : [
		"I fall in and out of love easily, and am always pursuing someone.",
		"I have a joke for every occasion, especially occasions where humor is inappropriate.",
		"Flattery is my preferred trick for getting what I want.",
		"I'm a born gambler who can't resist taking a risk for a potential payoff.",
		"I lie about almost everything, even when there's no reason to.",
		"Sarcasm and insults are my weapons of choice.",
		"I keep multiple holy symbols on me and invoke whatever deity might come in useful at any given moment.",
		"I pocket anything I see that might have some value.",
	],
	ideal : [
		["Independence",
			"Independence: I am a free spirit—no one tells me what to do. (Chaotic)"
		],
		["Fairness",
			"Fairness: I never target people who can't afford to lose a few coins. (Lawful)"
		],
		["Charity",
			"Charity: I distribute the money I acquire to the people who really need it. (Good)"
		],
		["Creativity",
			"Creativity: I never run the same con twice. (Chaotic)"
		],
		["Friendship",
			"Friendship: Material goods come and go. Bonds of friendship last forever. (Good)"
		],
		["Aspiration",
			"Aspiration: I'm determined to make something of myself. (Any)"
		],
	],
	bond : [
		"I fleeced the wrong person and must work to ensure that this individual never crosses paths with me or those I care about.",
		"I owe everything to my mentor—a horrible person who's probably rotting in jail somewhere.",
		"Somewhere out there, I have a child who doesn't know me. I'm making the world better for him or her.",
		"I come from a noble family, and one day I'll reclaim my lands and title from those who stole them from me.",
		"A powerful person killed someone I love. Some day soon, I'll have my revenge.",
		"I swindled and ruined a person who didn't deserve it. I seek to atone for my misdeeds but might never be able to forgive myself.",
	],
	flaw : [
		"I can't resist a pretty face.",
		"I'm always in debt. I spend my ill-gotten gains on decadent luxuries faster than I bring them in.",
		"I'm convinced that no one could ever fool me the way I fool others.",
		"I'm too greedy for my own good. I can't resist taking a risk if there's money involved.",
		"I can't resist swindling people who are more powerful than me.",
		"I hate to admit it and will hate myself for it, but I'll run and preserve my own hide if the going gets tough.",
	],
	extra : [
		"Select a Charlatan Scheme",
		"Cheat at games of chance",
		"Shave coins, forge documents",
		"User/manipulator",
		"Change identity",
		"Sleight-of-hand cons",
		"Sell junk as expensive necessities",
	],
};
BackgroundList["criminal ua22co"] = {
	regExpSearch : /^(?=.*criminal).*$/i,
	name : "Criminal (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 12]],
	skills : ["Sleight of Hand", "Stealth"],
	gold : 16,
	toolProfs : ["Thieves' tools"],
	languageProfs : [1, "Thieves' Cant"],
	lifestyle : "poor",
	scores : [0, 2, 0, 1, 0, 0],
	scorestxt : "+2 Dexterity, +1 Intelligence",
	equipleft : [
		["Crowbar", "", 5],
		["Dagger", "", 1],
		["Belt, with:", "----", 0.0625],
		["- Thieves' tools", "", 1],
		["- Pouch", "2", 1],
	],
	equipright : [
		["Traveler's clothes", "", 4],
		["Dagger", "", 1],
	],
	feature : "Criminal Contact UA22CO",
	trait : [
		"I always have a plan for when things go wrong.",
		"I am always calm, no matter what the situation. I never raise my voice or let my emotions control me.",
		"The first thing I do in a new place is note the locations of everything valuable—or where such things could be hidden.",
		"I would rather make a new friend than a new enemy.",
		"I am incredibly slow to trust. Those who seem the fairest often have the most to hide.",
		"I don't pay attention to the risks in a situation. Never tell me the odds.",
		"The best way to get me to do something is to tell me I can't do it.",
		"I blow up at the slightest insult.",
	],
	ideal : [
		["Honor",
			"Honor: I don't steal from others in the trade. (Lawful)"
		],
		["Freedom",
			"Freedom: Chains are meant to be broken, as are those who would forge them. (Chaotic)"
		],
		["Charity",
			"Charity: I steal from the wealthy so that I can help people in need. (Good)"
		],
		["Greed",
			"Greed: I will do whatever it takes to become wealthy. (Evil)"
		],
		["People",
			"People: I'm loyal to my friends, not to any ideals, and everyone else can take a trip down the Styx for all I care. (Neutral)"
		],
		["Redemption",
			"Redemption: There's a spark of good in everyone. (Good)"
		],
	],
	bond : [
		"I'm trying to pay off an old debt I owe to a generous benefactor.",
		"My ill-gotten gains go to support my family.",
		"Something important was taken from me, and I aim to steal it back.",
		"I will become the greatest thief that ever lived.",
		"I'm guilty of a terrible crime. I hope I can redeem myself for it.",
		"Someone I loved died because of a mistake I made. That will never happen again.",
	],
	flaw : [
		"When I see something valuable, I can't think about anything but how to steal it.",
		"When faced with a choice between money and my friends, I usually choose the money.",
		"If there's a plan, I'll forget it. If I don't forget it, I'll ignore it.",
		"I have a 'tell' that reveals when I'm lying.",
		"I turn tail and run when things look bad.",
		"An innocent person is in prison for a crime that I committed. I'm okay with that.",
	],
	extra : [
		"Select a Criminal Specialty",
		"Blackmailer",
		"Burglar",
		"Enforcer",
		"Fence",
		"Highway robber",
		"Hired killer",
		"Pickpocket",
		"Smuggler",
	],
};
BackgroundList["cultist ua22co"] = {
	regExpSearch : /^(?=.*cultist).*$/i,
	name : "Cultist (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 12]],
	skills : ["Arcana", "Religion"],
	gold : 19,
	toolProfs : ["Disguise kit"],
	languageProfs : [1, "Abyssal"],
	lifestyle : "poor",
	scores : [0, 0, 0, 2, 0, 1],
	scorestxt : "+2 Intelligence, +1 Charisma",
	equipleft : [
		["Disguise kit", "", 3],
		["Bell", "", 0.03125],
		["Lamp", "", 1],
		["Robe", "", 4],
	],
	equipright : [
		["Common clothes", "", 3],
		["Dagger", "", 1],
	],
	feature : "Cult Teachings UA22CO",
	trait : [
		"I need a dagger close at hand at all times. Just in case they find me.",
		"I can't believe I'm out here fighting monsters. After everything I've been through, why can't I find a normal life?",
		"I need a stiff drink before I do anything stressful these days. I know it's a problem. Just...let me have this.",
		"Murder is okay when it's for a good cause! I didn't tear my past out by the roots so I could let evil people cause more harm.",
		"My past is filled with stories like you wouldn't believe. Ones that'll really make your skin crawl. Do you want to hear...?",
		"I know you've told me your name twice already, but that's not good enough. How can I be sure you are who you say you are?",
	],
	ideal : [
		["Guild",
			"Guild: My guild is all that really matters. (Any)"
		],
		["Hedonism",
			"Hedonism: Death comes for everyone, so take as much pleasure as you can from every moment of life. (Neutral)"
		],
		["Creativity",
			"Creativity: I strive to find more ways to express my art through pain—my own as well as others'. (Chaotic)"
		],
		["Spectacle",
			"Spectacle: People are inspired by the greatness they see in art. (Any)"
		],
		["Solidarity",
			"Solidarity: The worthy must respect the worthy. In the afterlife, all will be united in goal and action. (Lawful)"
		],
		["Knowledge",
			"Knowledge: The worthy shall cultivate a nimble mind, so as to perceive the wonders beyond imagination that wait in the afterlife. (Neutral)"
		],
		["Strength",
			"Strength: The worthy shall hone a strong body that can withstand the boundless energies of the afterlife. (Neutral)"
		],
		["Ambition",
			"Ambition: The worthy shall strive for greatness, for supremacy in life leads to supremacy in the afterlife. (Evil)"
		],
		["Zeal",
			"Zeal: The worthy shall rush to the Great One's side with relentless passion, rising to overcome every obstacle in their way. (Any)"
		],
	],
	bond : [
		"I have belonged to the same cultist cell for years, and these people mean everything to me.",
		"A blood witch told me I have a special destiny to fulfill, and I'm trying to figure out what it is.",
		"I'm secretly hoping that I can change the cult from the inside, using my influence to help rein in the wanton violence.",
		"I own something that the Great One once touched (it's seared black at the spot), and I cherish it.",
		"I want to be better at my devotion than any other member of my cultist cell.",
		"I am devoted to the Great One and live to impress them.",
	],
	flaw : [
		"I can't help but feel a rush whenever I see a life snuffed out before me. Just one more kill... just one more.",
		"Oh, I always tell the truth. Always. I've never had to keep a secret from anyone, so of course I'll be open with you.",
		"I throw caution to the wind.",
		"I resent the rich and powerful.",
		"When I'm angry, I lash out in violence.",
		"There's no such thing as too much pleasure.",
	],
};
BackgroundList["entertainer ua22co"] = {
	regExpSearch : /^(?=.*entertainer|actor|dancer|fire.?eater|jester|juggler|instrumentalist|poet|singer|storyteller|tumbler).*$/i,
	name : "Entertainer (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 12]],
	skills : ["Acrobatics", "Performance"],
	gold : 8,
	toolProfs : [["Musical instrument", 1]],
	languageProfs : [1, "Elvish"],
	lifestyle : "modest",
	scores : [0, 1, 0, 0, 0, 2],
	scorestxt : "+2 Charisma, +1 Dexterity",
	equipleft : [
		["Musical instrument (of chosen type)", "", ""],
		["Costume clothes", 2, 4],
		["Perfume (vial)", "", 0.125],
		["Steel mirror", , 0.5],
	],
	equipright : [
		["Traveler's clothes", "", 4],
	],
	feature : "By Popular Demand UA22CO",
	trait : [
		"I know a story relevant to almost every situation.",
		"Whenever I come to a new place, I collect local rumors and spread gossip.",
		"I'm a hopeless romantic, always searching for that 'special someone'.",
		"Nobody stays angry at me or around me for long, since I can defuse any amount of tension.",
		"I love a good insult, even one directed at me.",
		"I get bitter if I'm not the center of attention.",
		"I'll settle for nothing less than perfection.",
		"I change my mood or my mind as quickly as I change key in a song.",
	],
	ideal : [
		["Beauty",
			"Beauty: When I perform, I make the world better than it was. (Good)"
		],
		["Tradition",
			"Tradition: The stories, legends, and songs of the past must never be forgotten, for they teach us who we are. (Lawful)"
		],
		["Creativity",
			"Creativity: The world is in need of new ideas and bold action. (Chaotic)"
		],
		["Greed",
			"Greed: I'm only in it for the money and fame. (Evil)"
		],
		["People",
			"People: I like seeing the smiles on people's faces when I perform. That's all that matters. (Neutral)"
		],
		["Honesty",
			"Honesty: Art should reflect the soul; it should come from within and reveal who we really are. (Any)"
		],
	],
	bond : [
		"My instrument is my most treasured possession, and it reminds me of someone I love.",
		"Someone stole my precious instrument, and someday I'll get it back.",
		"I want to be famous, whatever it takes.",
		"I idolize a hero of the old tales and measure my deeds against that person's.",
		"I will do anything to prove myself superior to my hated rival.",
		"I would do anything for the other members of my old troupe.",
	],
	flaw : [
		"I'll do anything to win fame and renown.",
		"I'm a sucker for a pretty face.",
		"A scandal prevents me from ever going home again. That kind of trouble seems to follow me around.",
		"I once satirized a noble who still wants my head. It was a mistake that I will likely repeat.",
		"I have trouble keeping my true feelings hidden. My sharp tongue lands me in trouble.",
		"Despite my best efforts, I am unreliable to my friends.",
	],
	extra : [
		"Select an Entertainer Specialty",
		"Actor",
		"Dancer",
		"Fire-eater",
		"Jester",
		"Juggler",
		"Instrumentalist",
		"Poet",
		"Singer",
		"Storyteller",
		"Tumbler",
	],
};
BackgroundList["farmer ua22co"] = {
	regExpSearch : /^(?=.*farmer).*$/i,
	name : "Farmer (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 13]],
	skills : ["Animal Handling", "Nature"],
	gold : 23,
	toolProfs : ["Carpenter's tools"],
	languageProfs : [1, "Halfling"],
	lifestyle : "poor",
	scores : [0, 0, 2, 0, 1, 0],
	scorestxt : "+2 Constitution, +1 Wisdom",
	equipleft : [
		["Carpenter's tools", "", 6],
		["Healer's kit (10 uses left)", "", 3],
		["Iron pot", "", 10],
		["Shovel", "", 5],
		["Sickle", "", 2],
	],
	equipright : [
		["Traveler's clothes", "", 4],
	],
	feature : "Harvest the Land UA22CO",
	trait : [
		"I am unmoved by the wrath of nature.",
		"My friends are my crew; we sink or float together.",
		"I need long stretches of quiet to clear my head.",
		"Rich folk don't know the satisfaction of hard work.",
		"I laugh heartily, feel deeply, and fear nothing.",
		"I work hard; nature offers no handouts.",
		"I dislike bargaining; state your price and mean it.",
		"Luck favors me, and I take risks others might not.",
	],
	ideal : [
		["Camaraderie",
			"Camaraderie: Good people make even the longest journey bearable. (Good)"
		],
		["Luck",
			"Luck: Our luck depends on respecting its rules—now throw this salt over your shoulder. (Lawful)"
		],
		["Daring",
			"Daring: The richest bounty goes to those who risk everything. (Chaotic)"
		],
		["Plunder",
			"Plunder: Take all that you can and leave nothing for the scavengers. (Evil)"
		],
		["Balance",
			"Balance: Do not sow the same spot twice in a row; suppress your greed, and nature will reward you. (Neutral)"
		],
		["Hard Work",
			"Hard Work: No wind can move a soul hard at work. (Any)"
		],
	],
	bond : [
		"I lost something important in the deep sea, and I intend to find it.",
		"Someone else's greed destroyed my livelihood, and I will be compensated.",
		"I will fish the many famous waters of this land.",
		"The gods saved me during a terrible storm, and I will honor their gift.",
		"My destiny awaits me at the bottom of a particular pond in the Feywild.",
		"I must repay my village's debt.",
	],
	flaw : [
		"I am judgmental, especially of those I deem homebodies or otherwise lazy.",
		"I become depressed and anxious if I'm away from the sea too long.",
		"I have lived a hard life and find it difficult to empathize with others.",
		"I am inclined to tell long-winded stories at inopportune times.",
		"I work hard, but I play harder.",
		"I am obsessed with catching an elusive aquatic beast, often to the detriment of other pursuits.",
	],
};
BackgroundList["gladiator ua22co"] = {
	regExpSearch : /^(?=.*gladiator).*$/i,
	name : "Gladiator (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 13]],
	skills : ["Athletics", "Performance"],
	gold : 15,
	toolProfs : ["Smith's tools"],
	languageProfs : [1, "Orc"],
	lifestyle : "modest",
	scores : [2, 0, 0, 0, 0, 1],
	scorestxt : "+2 Strength, +1 Charisma",
	equipleft : [
		["Smith's tools", "", 8],
		["Healer's kit (10 uses left)", "", 3],
		["Chain, feet of", 10, 1],
		["Costume clothes", "", 4],
	],
	equipright : [
		["Traveler's clothes", "", 4],
		["Javelin", 6, 2],
	],
	feature : "Are You Entertained? UA22CO",
	trait : [
		"I know a story relevant to almost every situation.",
		"Whenever I come to a new place, I collect local rumors and spread gossip.",
		"I'm a hopeless romantic, always searching for that 'special someone'.",
		"Nobody stays angry at me or around me for long, since I can defuse any amount of tension.",
		"I love a good insult, even one directed at me.",
		"I get bitter if I'm not the center of attention.",
		"I'll settle for nothing less than perfection.",
		"I change my mood or my mind as quickly as I change key in a song.",
	],
	ideal : [
		["Beauty",
			"Beauty: When I perform, I make the world better than it was. (Good)"
		],
		["Tradition",
			"Tradition: The stories, legends, and songs of the past must never be forgotten, for they teach us who we are. (Lawful)"
		],
		["Creativity",
			"Creativity: The world is in need of new ideas and bold action. (Chaotic)"
		],
		["Greed",
			"Greed: I'm only in it for the money and fame. (Evil)"
		],
		["People",
			"People: I like seeing the smiles on people's faces when I perform. That's all that matters. (Neutral)"
		],
		["Honesty",
			"Honesty: Art should reflect the soul; it should come from within and reveal who we really are. (Any)"
		],
	],
	bond : [
		"My instrument is my most treasured possession, and it reminds me of someone I love.",
		"Someone stole my precious instrument, and someday I'll get it back.",
		"I want to be famous, whatever it takes.",
		"I idolize a hero of the old tales and measure my deeds against that person's.",
		"I will do anything to prove myself superior to my hated rival.",
		"I would do anything for the other members of my old troupe.",
	],
	flaw : [
		"I'll do anything to win fame and renown.",
		"I'm a sucker for a pretty face.",
		"A scandal prevents me from ever going home again. That kind of trouble seems to follow me around.",
		"I once satirized a noble who still wants my head. It was a mistake that I will likely repeat.",
		"I have trouble keeping my true feelings hidden. My sharp tongue lands me in trouble.",
		"Despite my best efforts, I am unreliable to my friends.",
	],
};
BackgroundList["guard ua22co"] = {
	regExpSearch : /^(?=.*guard).*$/i,
	name : "Guard (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 13]],
	skills : ["Athletics", "Perception"],
	gold : 12,
	toolProfs : [["Gaming set", 1]],
	languageProfs : [1, "Dwarvish"],
	lifestyle : "poor",
	scores : [2, 0, 0, 0, 1, 0],
	scorestxt : "+2 Strength, +1 Wisdom",
	equipleft : [
		["Gaming set (of chosen type)", "", ""],
		["Hooded lantern", "", 2],
		["Manacles", "", 6],
		["Quiver, with:", "----", 1],
		["- Crossbow bolt", 20, 0.075],
	],
	equipright : [
		["Traveler's clothes", "", 4],
		["Light crossbow", "", 5],
		["Spear", "", 3],
	],
	feature : "Watcher's Eye UA22CO",
	trait : [
		"I'm always polite and respectful.",
		"I'm haunted by memories of war. I can't get the images of violence out of my mind.",
		"I've lost too many friends, and I'm slow to make new ones.",
		"I'm full of inspiring and cautionary tales from my military experience relevant to almost every combat situation.",
		"I can stare down a hell hound without flinching.",
		"I enjoy being strong and like breaking things.",
		"I have a crude sense of humor.",
		"I face problems head-on. A simple, direct solution is the best path to success.",
	],
	ideal : [
		["Greater Good",
			"Greater Good: Our lot is to lay down our lives in defense of others. (Good)"
		],
		["Responsibility",
			"Responsibility: I do what I must and obey just authority. (Lawful)"
		],
		["Independence",
			"Independence: When people follow orders blindly, they embrace a kind of tyranny. (Chaotic)"
		],
		["Might",
			"Might: In life as in war, the stronger force wins. (Evil)"
		],
		["Live and Let Live",
			"Live and Let Live: Ideals aren't worth killing over or going to war for. (Neutral)"
		],
		["Nation",
			"Nation: My city, nation, or people are all that matter. (Any)"
		],
	],
	bond : [
		"I would still lay down my life for the people I served with.",
		"Someone saved my life on the battlefield. To this day, I will never leave a friend behind.",
		"My honor is my life.",
		"I'll never forget the crushing defeat my company suffered or the enemies who dealt it.",
		"Those who fight beside me are those worth dying for.",
		"I fight for those who cannot fight for themselves.",
	],
	flaw : [
		"The monstrous enemy we faced in battle still leaves me quivering with fear.",
		"I have little respect for anyone who is not a proven warrior.",
		"I made a terrible mistake in battle that cost many lives—and I would do anything to keep that mistake secret.",
		"My hatred of my enemies is blinding and unreasoning.",
		"I obey the law, even if the law causes misery.",
		"I'd rather eat my armor than admit when I'm wrong.",
	],
};
BackgroundList["guide ua22co"] = {
	regExpSearch : /^(?=.*guide).*$/i,
	name : "Guide (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 13]],
	skills : ["Stealth", "Survival"],
	gold : 2,
	toolProfs : ["Cartographer's tools"],
	languageProfs : [1, "GIant"],
	lifestyle : "poor",
	scores : [0, 1, 0, 0, 2, 0],
	scorestxt : "+2 Wisdom, +1 Dexterity",
	equipleft : [
		["Cartographer's tools", "", 6],
		["Fishing tackle", "", 4],
		["Two-person tent", "", 20],
		["Bedroll", "", 7],
		["Quiver, with:", "----", 1],
		["- Arrow", 20, 0.05],
	],
	equipright : [
		["Traveler's clothes", "", 4],
		["Shortbow", "", 2],
	],
	feature : "Makeshift Meals UA22CO",
	trait : [
		"I always have an exit strategy in mind if things go poorly.",
		"You can't survive in this grim city without a good sense of humor, but I have a taste for gallows humor.",
		"I try to work in the thin grey area between the squabbling factions, squeezing under their radar when possible. The less I am seen, the better.",
		"If you spot danger, it is best to avoid it, that's how you survive.",
		"The outdoors are a dangerous place. But I can navigate it with my eyes closed. No one else I've ever met is as good as I am.",
		"In order to survive the monsters of nature, one must be a monster of the outdoors.",
		"Take everything you can from the dead, take it from the living if you can. If you are to survive, you must take any opportunity to scavenge.",
		"I will never give up until I reclaim what I lost in these ruins.",
	],
	ideal : [
		["Self-Reliance",
			"Self-Reliance: I won't risk my life for others. Everyone must fend for themselves—better you than me. (Evil)"
		],
		["Bravery",
			"Bravery: I find the thrill of surviving the monsters and magics of the outdoors exhilarating and thrive on the chaos. (Chaotic)"
		],
		["Safety",
			"Safety: Whatever I can do to keep myself fed and keep a safe place to rest is good in my books. (Any)"
		],
		["Helpful",
			"Helpful: People need all the help they can get in the city, and I know I can provide it. (Good)"
		],
		["Hope",
			"Hope: I believe there is something worth saving here, we must hold on to the idea of a better future. (Good)"
		],
		["Responsibility",
			"Responsibility: I lived here before the meteor, I'll live here long after. I must protect my home and do what I can to make it livable again. (Lawful)"
		],
	],
	bond : [
		"I had family in these ruins. I know not what became of them, but I must find out.",
		"Nature is my home, and I will fight for what's left of it until the very end.",
		"I'll do any dirty work in the city if it means a hot meal, a warm bed, or some good company.",
		"I've spent so long in these ruins, its the outside world that terrifies me now.",
		"Why haven't I left the outdoors? Have you seen how much gold there is to be made here?",
		"I am bound to the throne of a collapsed civilization, and fight to see it one day reclaimed.",
	],
	flaw : [
		"Any meal could be my last. I'll eat just about anything. I do what I must to survive.",
		"I don't like being outside the Haze of the city for too long, I've gotten used to it.",
		"I am convinced my family is alive in the city somewhere. I hear their voices call to me at night.",
		"I don't trust anyone easily. I'll sleep with one eye open even around my companions, for nature makes monsters of us all.",
		"The years spent here have turned me to a vice, I very much rely on that vice to get me through my days.",
		"I hear voices constantly. Sometimes I get distracted with conversations with people who are not there.",
	],
	extra : [
		"Select a Guide's Mark of Survival",
		"Talk to self",
		"Eat almost anything",
		"Scarred",
		"Missing finger",
		"Treasured locket",
		"Monster trophies",
		"Can sleep anywhere",
		"Recite names of the lost",
	],
};
BackgroundList["hermit ua22co"] = {
	regExpSearch : /^(?=.*hermit).*$/i,
	name : "Hermit (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 14]],
	skills : ["Medicine", "Religion"],
	gold : 15,
	toolProfs : ["Herbalism kit"],
	languageProfs : [1, "Sylvan"],
	lifestyle : "poor",
	scores : [0, 0, 1, 0, 2, 0],
	scorestxt : "+2 Wisdom, +1 Constitution",
	equipleft : [
		["Herbalism kit", "", 3],
		["Bedroll", "", 7],
		["Book (Philosophy)", "", 5],
		["Fishing tackle", "", 4],
		["Lamp", "", 1],
		["Oil (flasks of)", 3, 1],
	],
	equipright : [
		["Traveler's clothes", "", 4],
		["Quarterstaff", "", 4],
	],
	feature : "Discovery UA22CO",
	trait : [
		"I've been isolated for so long that I rarely speak, preferring gestures and the occasional grunt.",
		"I am utterly serene, even in the face of disaster.",
		"The leader of my community had something wise to say on every topic, and I am eager to share that wisdom.",
		"I feel tremendous empathy for all who suffer.",
		"I'm oblivious to etiquette and social expectations.",
		"I connect everything that happens to me to a grand, cosmic plan.",
		"I often get lost in my own thoughts and contemplation, becoming oblivious to my surroundings.",
		"I am working on a grand philosophical theory and love sharing my ideas.",
	],
	ideal : [
		["Greater Good",
			"Greater Good: My gifts are meant to be shared with all, not used for my own benefit. (Good)"
		],
		["Logic",
			"Logic: Emotions must not cloud our sense of what is right and true, or our logical thinking. (Lawful)"
		],
		["Free Thinking",
			"Free Thinking: Inquiry and curiosity are the pillars of progress. (Chaotic)"
		],
		["Power",
			"Power: Solitude and contemplation are paths toward mystical or magical power. (Evil)"
		],
		["Live and Let Live",
			"Live and Let Live: Meddling in the affairs of others only causes trouble. (Neutral)"
		],
		["Self-Knowledge",
			"Self-Knowledge: If you know yourself, there's nothing left to know. (Any)"
		],
	],
	bond : [
		"Nothing is more important than the other members of my hermitage, order, or association.",
		"I entered seclusion to hide from the ones who might still be hunting me. I must someday confront them.",
		"I'm still seeking the enlightenment I pursued in my seclusion, and it still eludes me.",
		"I entered seclusion because I loved someone I could not have.",
		"Should my discovery come to light, it could bring ruin to the world.",
		"My isolation gave me great insight into a great evil that only I can destroy.",
	],
	flaw : [
		"Now that I've returned to the world, I enjoy its delights a little too much.",
		"I harbor dark, bloodthirsty thoughts that my isolation and meditation failed to quell.",
		"I am dogmatic in my thoughts and philosophy.",
		"I let my need to win arguments overshadow friendships and harmony.",
		"I'd risk too much to uncover a lost bit of knowledge.",
		"I like keeping secrets and won't share them with anyone.",
	],
	extra : [
		"Select a Hermit Specialty",
		"Searching for spiritual enlightenment",
		"Living in accordance with a religious order",
		"Exiled for a crime I didn't commit",
		"Retreated from society after a life-altering event",
		"Worked on my art, literature, music, or manifesto",
		"Commune with nature, far from civilization",
		"Caretaker of an ancient ruin or relic",
		"Pilgrim in search of a thing of spiritual significance",
	],
};
BackgroundList["laborer ua22co"] = {
	regExpSearch : /^(?=.*laborer|mason).*$/i,
	name : "Laborer (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 14]],
	skills : ["Athletics", "Survival"],
	gold : 15,
	toolProfs : ["Mason's tools"],
	languageProfs : [1, "Dwarvish"],
	lifestyle : "modest",
	scores : [1, 0, 2, 0, 0, 0],
	scorestxt : "+2 Constitution, +1 Strength",
	equipleft : [
		["Mason's tools", "", 8],
		["Bullseye lantern", "", 2],
		["Mess kit", "", 1],
		["Oil (flasks of)", 1, 1],
		["Belt, with:", "----", 0.0625],
		["- Light hammer", "", 2],
	],
	equipright : [
		["Common clothes", "", 3],
		["Handaxe", "", 2],
	],
	feature : "Stone Infrastructure UA22CO",
	trait : [
		"I believe that anything worth doing is worth doing right. I can't help it—I'm a perfectionist.",
		"I'm a snob who looks down on those who can't appreciate fine art.",
		"I always want to know how things work and what makes people tick.",
		"I'm full of witty aphorisms and have a proverb for every occasion.",
		"I'm rude to people who lack my commitment to hard work and fair play.",
		"I like to talk at length about my profession.",
		"I don't part with my money easily and will haggle tirelessly to get the best deal possible.",
		"I'm well known for my work, and I want to make sure everyone appreciates it. I'm always taken aback when people haven't heard of me.",
	],
	ideal : [
		["Community",
			"Community: It is the duty of all civilized people to strengthen the bonds of community and the security of civilization. (Lawful)"
		],
		["Generosity",
			"Generosity: My talents were given to me so that I could use them to benefit the world. (Good)"
		],
		["Freedom",
			"Freedom: Everyone should be free to pursue his or her own livelihood. (Chaotic)"
		],
		["Greed",
			"Greed: I'm only in it for the money. (Evil)"
		],
		["People",
			"People: I'm committed to the people I care about, not to ideals. (Neutral)"
		],
		["Aspiration",
			"Aspiration: I work hard to be the best there is at my craft. (Any)"
		],
	],
	bond : [
		"The workshop where I learned my trade is the most important place in the world to me.",
		"I created a great work for someone, and then found them unworthy to receive it. I'm still looking for someone worthy.",
		"I owe my guild a great debt for forging me into the person I am today.",
		"I pursue wealth to secure someone's love.",
		"One day I will return to my guild and prove that I am the greatest artisan of them all.",
		"I will get revenge on the evil forces that destroyed my place of business and ruined my livelihood.",
	],
	flaw : [
		"I'll do anything to get my hands on something rare or priceless.",
		"I'm quick to assume that someone is trying to cheat me.",
		"No one must ever learn that I once stole money from guild coffers.",
		"I'm never satisfied with what I have—I always want more.",
		"I would kill to acquire a noble title.",
		"I'm horribly jealous of anyone who can outshine my handiwork. Everywhere I go, I'm surrounded by rivals.",
	],
};
BackgroundList["noble ua22co"] = {
	regExpSearch : /^(?!.*(waterdhavian|waterdeep|knight))(?=.*noble).*$/i,
	name : "Noble (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 14]],
	skills : ["History", "Persuasion"],
	gold : 24,
	toolProfs : [["Gaming set", 1]],
	languageProfs : [1, "Draconic"],
	lifestyle : "wealthy",
	scores : [0, 0, 0, 1, 0, 2],
	scorestxt : "+2 Charisma, +1 Intelligence",
	equipleft : [
		["Gaming set (of chosen type)", "", ""],
		["Perfume (vial)", "", 0.125],
		["Signet ring", "", 0.0625],
	],
	equipright : [
		["Fine clothes", "", 6],
	],
	feature : "Position of Privilege UA22CO",
	trait : [
		"My eloquent flattery makes everyone I talk to feel like the most wonderful and important person in the world.",
		"The common folk love me for my kindness and generosity.",
		"No one could doubt by looking at my regal bearing that I am a cut above the unwashed masses.",
		"I take great pains to always look my best and follow the latest fashions.",
		"I don't like to get my hands dirty, and I won't be caught dead in unsuitable accommodations.",
		"Despite my noble birth, I do not place myself above other folk. We all have the same blood.",
		"My favor, once lost, is lost forever.",
		"If you do me an injury, I will crush you, ruin your name, and salt your fields.",
	],
	ideal : [
		["Respect",
			"Respect: Respect is due to me because of my position, but all people regardless of station deserve to be treated with dignity. (Good)"
		],
		["Responsibility",
			"Responsibility: It is my duty to respect the authority of those above me, just as those below me must respect mine. (Lawful)"
		],
		["Independence",
			"Independence: I must prove that I can handle myself without coddling from my family. (Chaotic)"
		],
		["Power",
			"Power: If I can attain more power, no one will tell me what to do. (Evil)"
		],
		["Family",
			"Family: Blood runs thicker than water. (Any)"
		],
		["Noble Obligation",
			"Noble Obligation: It is my duty to protect and care for the people beneath me. (Good)"
		],
	],
	bond : [
		"I will face any challenge to win the approval of my family.",
		"My house's alliance with another noble family must be sustained at all costs.",
		"Nothing is more important than the other members of my family.",
		"I am in love with the heir of a family that my family despises.",
		"My loyalty to my sovereign is unwavering.",
		"The common folk must see me as a hero of the people.",
	],
	flaw : [
		"I secretly believe that everyone is beneath me.",
		"I hide a truly scandalous secret that could ruin my family forever.",
		"I too often hear veiled insults and threats in every word addressed to me, and I'm quick to anger.",
		"I have an insatiable desire for carnal pleasures.",
		"In fact, the world does revolve around me.",
		"By my words and actions, I often bring shame to my family.",
	],
};
BackgroundList["pilgrim ua22co"] = {
	regExpSearch : /^(?=.*pilgrim).*$/i,
	name : "Pilgrim (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 14]],
	skills : ["Religion", "Survival"],
	gold : 16,
	toolProfs : [["Musical instrument", 1]],
	languageProfs : [1, "Halfling"],
	lifestyle : "poor",
	scores : [0, 0, 1, 0, 2, 0],
	scorestxt : "+2 Wisdom, +1 Constitution",
	equipleft : [
		["Musical intrument (of chosen type)", "", ""],
		["Bedroll", "", 7],
		["Healer's kit (10 uses left)", "", 3],
		["Holy symbol", "", 0.03125],
		["Rations (days of)", 2, 2],
	],
	equipright : [
		["Traveler's clothes", "", 4],
	],
	feature : "Wanderer UA22CO",
	trait : [
		"I'm driven by a wanderlust that led me away from home.",
		"I watch over my friends as if they were a litter of newborn pups.",
		"I once ran twenty-five miles without stopping to warn to my clan of an approaching orc horde. I'd do it again if I had to.",
		"I have a lesson for every situation, drawn from observing nature.",
		"I place no stock in wealthy or well-mannered folk. Money and manners won't save you from a hungry owlbear.",
		"I'm always picking things up, absently fiddling with them, and sometimes accidentally breaking them.",
		"I feel far more comfortable around animals than people.",
		"I was, in fact, raised by wolves.",
	],
	ideal : [
		["Change",
			"Change: Life is like the seasons, in constant change, and we must change with it. (Chaotic)"
		],
		["Greater Good",
			"Greater Good: It is each person's responsibility to make the most happiness for the whole tribe. (Good)"
		],
		["Honor",
			"Honor: If I dishonor myself, I dishonor my whole clan. (Lawful)"
		],
		["Might",
			"Might: The strongest are meant to rule. (Evil)"
		],
		["Nature",
			"Nature: The natural world is more important than all the constructs of civilization. (Neutral)"
		],
		["Glory",
			"Glory: I must earn glory in battle, for myself and my clan. (Any)"
		],
	],
	bond : [
		"My family, clan, or tribe is the most important thing in my life, even when they are far from me.",
		"An injury to the unspoiled wilderness of my home is an injury to me.",
		"I will bring terrible wrath down on the evildoers who destroyed my homeland.",
		"I am the last of my tribe, and it is up to me to ensure their names enter legend.",
		"I suffer awful visions of a coming disaster and will do anything to prevent it.",
		"It is my duty to provide children to sustain my tribe.",
	],
	flaw : [
		"I am too enamored of ale, wine, and other intoxicants.",
		"There's no room for caution in a life lived to the fullest.",
		"I remember every insult I've received and nurse a silent resentment toward anyone who's ever wronged me.",
		"I am slow to trust members of other races, tribes, and societies.",
		"Violence is my answer to almost any challenge.",
		"Don't expect me to save those who can't save themselves. It is nature's way that the strong thrive and the weak perish.",
	],
};
BackgroundList["sage ua22co"] = {
	regExpSearch : /^(?=.*sage).*$/i,
	name : "Sage (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 15]],
	skills : ["Arcana", "History"],
	gold : 8,
	toolProfs : ["Calligrapher's supplies"],
	languageProfs : [1, "Elvish"],
	lifestyle : "modest",
	scores : [0, 0, 0, 2, 1, 0],
	scorestxt : "+2 Intelligence, +1 Wisdom",
	equipleft : [
		["Calligrapher's supplies", "", 5],
		["Book (History)", "", 5],
		["Parchment sheet", 8, 0.00625],
	],
	equipright : [
		["Robe", "", 4],
		["Quarterstaff", "", 4],
	],
	feature : "Researcher UA22CO",
	trait : [
		"I use polysyllabic words that convey the impression of great erudition.",
		"I've read every book in the world's greatest libraries—or I like to boast that I have.",
		"I'm used to helping out those who aren't as smart as I am, and I patiently explain anything and everything to others.",
		"There's nothing I like more than a good mystery.",
		"I'm willing to listen to every side of an argument before I make my own judgment.",
		"I... speak... slowly... when talking... to idiots,... which... almost... everyone... is... compared... to me.",
		"I am horribly, horribly awkward in social situations.",
		"I'm convinced that people are always trying to steal my secrets.",
	],
	ideal : [
		["Knowledge",
			"Knowledge: The path to power and self-improvement is through knowledge. (Neutral)"
		],
		["Beauty",
			"Beauty: What is beautiful points us beyond itself toward what is true. (Good)"
		],
		["Logic",
			"Logic: Emotions must not cloud our logical thinking. (Lawful)"
		],
		["No Limits",
			"No Limits: Nothing should fetter the infinite possibility inherent in all existence. (Chaotic)"
		],
		["Power",
			"Power: Knowledge is the path to power and domination. (Evil)"
		],
		["Self-Improvement",
			"Self-Improvement: The goal of a life of study is the betterment of oneself. (Any)"
		],
	],
	bond : [
		"It is my duty to protect my students.",
		"I have an ancient text that holds terrible secrets that must not fall into the wrong hands.",
		"I work to preserve a library, university, scriptorium, or monastery.",
		"My life's work is a series of tomes related to a specific field of lore.",
		"I've been searching my whole life for the answer to a certain question.",
		"I sold my soul for knowledge. I hope to do great deeds and win it back.",
	],
	flaw : [
		"I am easily distracted by the promise of information.",
		"Most people scream and run when they see a demon. I stop and take notes on its anatomy.",
		"Unlocking an ancient mystery is worth the price of a civilization.",
		"I overlook obvious solutions in favor of complicated ones.",
		"I speak without really thinking through my words, invariably insulting others.",
		"I can't keep a secret to save my life, or anyone else's.",
	],
	extra : [
		"Select a Sage Specialty",
		"Alchemist",
		"Astronomer",
		"Discredited academic",
		"Librarian",
		"Professor",
		"Researcher",
		"Wizard's apprentice",
		"Scribe",
	],
};
BackgroundList["sailor ua22co"] = {
	regExpSearch : /^(?=.*sailor).*$/i,
	name : "Sailor (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 15]],
	skills : ["Acrobatics", "Perception"],
	gold : 10,
	toolProfs : ["Navigator's tools"],
	languageProfs : [1, "Primordial"],
	lifestyle : "modest",
	scores : [0, 2, 0, 0, 1, 0],
	scorestxt : "+2 Dexterity, +1 Wisdom",
	equipleft : [
		["Navigator's tools", "", 2],
		["Fishing tackle", "", 1],
		["Silk rope (feet of)", 50, 0.5],
	],
	equipright : [
		["Traveler's clothes", "", 4],
		["Dagger", "", 1],
	],
	feature : "Ship's Passage UA22CO",
	trait : [
		"My friends know they can rely on me, no matter what.",
		"I work hard so that I can play hard when the work is done.",
		"I enjoy sailing into new ports and making new friends over a flagon of ale.",
		"I stretch the truth for the sake of a good story.",
		"To me, a tavern brawl is a nice way to get to know a new city.",
		"I never pass up a friendly wager.",
		"My language is as foul as an otyugh nest.",
		"I like a job well done, especially if I can convince someone else to do it.",
	],
	ideal : [
		["Respect",
			"Respect: The thing that keeps a ship together is mutual respect between captain and crew. (Good)"
		],
		["Fairness",
			"Fairness: We all do the work, so we all share in the rewards. (Lawful)"
		],
		["Freedom",
			"Freedom: The sea is freedom—the freedom to go anywhere and do anything. (Chaotic)"
		],
		["Mastery",
			"Mastery: I'm a predator, and the other ships on the sea are my prey. (Evil)"
		],
		["People",
			"People: I'm committed to my crewmates, not to ideals. (Neutral)"
		],
		["Aspiration",
			"Aspiration: Someday, I'll own my own ship and chart my own destiny. (Any)"
		],
	],
	bond : [
		"I'm loyal to my captain first, everything else second.",
		"The ship is most important—crewmates and captains come and go.",
		"I'll always remember my first ship.",
		"In a harbor town, I have a paramour whose eyes nearly stole me from the sea.",
		"I was cheated out of my fair share of the profits, and I want to get my due.",
		"Ruthless pirates murdered my captain and crewmates, plundered our ship, and left me to die. Vengeance will be mine.",
	],
	flaw : [
		"I follow orders, even if I think they're wrong.",
		"I'll say anything to avoid having to do extra work.",
		"Once someone questions my courage, I never back down no matter how dangerous the situation.",
		"Once I start drinking, it's hard for me to stop.",
		"I can't help but pocket loose coins and other trinkets I come across.",
		"My pride will probably lead to my destruction.",
	],
};
BackgroundList["soldier ua22co"] = {
	regExpSearch : /^(?!.*mercenary)(?=.*soldier).*$/i,
	name : "Soldier (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 15]],
	skills : ["Athletics", "Intimidation"],
	gold : 14,
	toolProfs : ["Calligrapher's supplies"],
	languageProfs : [1, "Goblin"],
	lifestyle : "modest",
	scores : [2, 0, 1, 0, 0, 0],
	scorestxt : "+2 Strength, +1 Constitution",
	equipleft : [
		["Gaming set (of chosen type)", "", ""],
		["Healer's kit (10 uses left)", "", 3],
		["Quiver, with:", "----", 1],
		["- Arrow", 20, 0.05],
	],
	equipright : [
		["Traveler's clothes", "", 4],
		["Shortbow", "", 2],
		["Spear", "", 4],
	],
	feature : "Military Rank UA22CO",
	trait : [
		"I'm always polite and respectful.",
		"I'm haunted by memories of war. I can't get the images of violence out of my mind.",
		"I've lost too many friends, and I'm slow to make new ones.",
		"I'm full of inspiring and cautionary tales from my military experience relevant to almost every combat situation.",
		"I can stare down a hell hound without flinching.",
		"I enjoy being strong and like breaking things.",
		"I have a crude sense of humor.",
		"I face problems head-on. A simple, direct solution is the best path to success.",
	],
	ideal : [
		["Greater Good",
			"Greater Good: Our lot is to lay down our lives in defense of others. (Good)"
		],
		["Responsibility",
			"Responsibility: I do what I must and obey just authority. (Lawful)"
		],
		["Independence",
			"Independence: When people follow orders blindly, they embrace a kind of tyranny. (Chaotic)"
		],
		["Might",
			"Might: In life as in war, the stronger force wins. (Evil)"
		],
		["Live and Let Live",
			"Live and Let Live: Ideals aren't worth killing over or going to war for. (Neutral)"
		],
		["Nation",
			"Nation: My city, nation, or people are all that matter. (Any)"
		],
	],
	bond : [
		"I would still lay down my life for the people I served with.",
		"Someone saved my life on the battlefield. To this day, I will never leave a friend behind.",
		"My honor is my life.",
		"I'll never forget the crushing defeat my company suffered or the enemies who dealt it.",
		"Those who fight beside me are those worth dying for.",
		"I fight for those who cannot fight for themselves.",
	],
	flaw : [
		"The monstrous enemy we faced in battle still leaves me quivering with fear.",
		"I have little respect for anyone who is not a proven warrior.",
		"I made a terrible mistake in battle that cost many lives—and I would do anything to keep that mistake secret.",
		"My hatred of my enemies is blinding and unreasoning.",
		"I obey the law, even if the law causes misery.",
		"I'd rather eat my armor than admit when I'm wrong.",
	],
};
BackgroundList["urchin ua22co"] = {
	regExpSearch : /^(?=.*urchin).*$/i,
	name : "Urchin (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 15]],
	skills : ["Insight", "Stealth"],
	gold : 18,
	toolProfs : ["Thieves' tools"],
	languageProfs : [1, "Common Sign Language"],
	lifestyle : "modest",
	scores : [0, 2, 0, 0, 1, 0],
	scorestxt : "+2 Dexterity, +1 Wisdom",
	equipleft : [
		["Bedroll", "", 7],
		["Dagger", "", 1],
		["Gaming set (of my choice)", "", ""],
		["Belt, with:", "----", 0.0625],
		["- Thieves' tools", "", 1],
		["- Pouch", "", 1],
	],
	equipright : [
		["Common clothes", "", 3],
		["Dagger", "", 1],
	],
	feature : "City Secrets UA22CO",
	trait : [
		"I hide scraps of food and trinkets away in my pockets.",
		"I ask a lot of questions.",
		"I like to squeeze into small places where no one else can get to me.",
		"I sleep with my back to a wall or tree, with everything I own wrapped in a bundle in my arms.",
		"I eat like a pig and have bad manners.",
		"I think anyone who's nice to me is hiding evil intent.",
		"I don't like to bathe.",
		"I bluntly say what others are hinting at or hiding.",
	],
	ideal : [
		["Respect",
			"Respect: All people, rich or poor, deserve respect. (Good)"
		],
		["Community",
			"Community: We have to take care of each other, because no one else is going to do it. (Lawful)"
		],
		["Change",
			"Change: The low are lifted up, and the high and mighty are brought down. Change is the nature of things. (Chaotic)"
		],
		["Retribution",
			"Retribution: The rich need to be shown what life and death are like in the gutters. (Evil)"
		],
		["People",
			"People: I help the people who help me—that's what keeps us alive. (Neutral)"
		],
		["Aspiration",
			"Aspiration: I'm going to prove that I'm worthy of a better life. (Any)"
		],
	],
	bond : [
		"My town or city is my home, and I'll fight to defend it.",
		"I sponsor an orphanage to keep others from enduring what I was forced to endure.",
		"I owe my survival to another urchin who taught me to live on the streets.",
		"I owe a debt I can never repay to the person who took pity on me.",
		"I escaped my life of poverty by robbing an important person, and I'm wanted for it.",
		"No one else should have to endure the hardships I've been through.",
	],
	flaw : [
		"If I'm outnumbered, I will run away from a fight.",
		"Gold seems like a lot of money to me, and I'll do just about anything for more of it.",
		"I will never fully trust anyone other than myself.",
		"I'd rather kill someone in their sleep than fight fair.",
		"It's not stealing if I need it more than someone else.",
		"People who can't take care of themselves get what they deserve.",
	],
};

// Add the background features for the backgrounds in this UA article
BackgroundFeatureList["shelter of the faithful ua22co"] = {
	// Acolyte BG Feature
	description : "I command the respect of those who share my faith. I can perform the religious ceremonies of my faith. My companions and I can expect free healing and care at an establishment of my faith, though I must provide any material components needed for spells. Those who share my religion will support me at a modest lifestyle. \n As an Acolyte, I gain the Magic Initiate (UA22CO) feat at 1st level, with my choice of either the Cleric or Paladin variant.",
	source : [["MJ:HB", 0], ["UA22CO", 11]],
	eval : function() { AddFeat("Magic Initiate"); },
	removeeval : function() { RemoveFeat("Magic Initiate"); }
};
BackgroundFeatureList["respect of the stout folk ua22co"] = {
	// Artisan BG Feature
	description : "No one esteems clan crafters quite so highly as dwarves do. I always have free room and board in any place where shield dwarves or gold dwarves dwell, and the individuals in such a settlement might vie among themselves to determine who can offer me (and possibly my compatriots) the finest accommodations and assistance. \n As an Artisan, I gain the Crafter (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 12]],
	eval : function() { AddFeat("Crafter (UA22CO)"); },
	removeeval : function() { RemoveFeat("Crafter (UA22CO)"); }
};
BackgroundFeatureList["false identity ua22co"] = {
	// Charlatan BG Feature
	description : "I have created a second identity that includes documentation, established acquaintances, and disguises that allow me to assume that persona. Additionally, I can forge documents, including official papers and personal letters, as long as I have seen an example of the kind of document or the handwriting I am trying to copy. \n As a Charlatan, I gain the Skilled (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 12]],
	eval : function() { AddFeat("Skilled"); },
	removeeval : function() { RemoveFeat("Skilled"); }
};
BackgroundFeatureList["criminal contact ua22co"] = {
	// Criminal BG Feature
	description : "I have a reliable and trustworthy contact who acts as my liaison to a network of other criminals. I know how to get messages to and from my contact, even over great distances; specifically, I know the local messengers, corrupt caravan masters, and seedy sailors who can deliver my messages. \n As a Criminal, I gain the Alert (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 12]],
	eval : function() { AddFeat("Alert (UA22CO)"); },
	removeeval : function() { RemoveFeat("Alert (UA22CO)"); }
};
BackgroundFeatureList["cult teachings ua22co"] = {
	// Cultist BG Feature
	description : "I was inundated with knowledge about one of the Great One, and know by heart everything from the cult's basic commandments to some of its most esoteric secrets. I have advantage on Intelligence (Religion) checks to know information about the Great One, including obscure secrets unknown to most worshipers. \n As a Cultist, I gain the Magic Initiate (UA22CO) feat at 1st level, with my choice of either the Sorcerer, Warlock, or Wizard variant.",
	source : [["MJ:HB", 0], ["UA22CO", 12]],
	eval : function() { AddFeat("Magic Initiate"); },
	removeeval : function() { RemoveFeat("Magic Initiate"); }
};
BackgroundFeatureList["by popular demand ua22co"] = {
	// Entertainer BG Feature
	description : "I can always find a place to perform (inn/tavern/circus/etc.), where I receive free lodging and food of a modest or comfortable standard, as long as I perform each night. In addition, my performance makes me something of a local figure. When strangers recognize me in a town where I have performed, they typically take a liking to me. \n As an Entertainer, I gain the Musician (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 12]],
	eval : function() { AddFeat("Musician (UA22CO)"); },
	removeeval : function() { RemoveFeat("Musician (UA22CO)"); }
};
BackgroundFeatureList["harvest the land ua22co"] = {
	// Farmer BG Feature
	description : "I gain advantage on ability checks made using carpenter's tools, a shovel, or a sickle. I also gain advantage on Persuasion checks with other farmers to secure lodging or sustenance. \n As a Farmer, I gain the Tough (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 13]],
	eval : function() { AddFeat("Tough"); },
	removeeval : function() { RemoveFeat("Tough"); }
};
BackgroundFeatureList["are you entertained? ua22co"] = {
	// Gladiator BG Feature
	description : "I can always find a place to perform (arena/pit fight), where I receive free lodging and food of a modest or comfortable standard, as long as I perform each night. In addition, my performance makes me something of a local figure. When strangers recognize me in a town where I have performed, they typically take a liking to me. \n As a Gladiator, I gain the Savage Attacker (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 13]],
	eval : function() { AddFeat("Savage Attacker"); },
	removeeval : function() { RemoveFeat("Savage Attacker"); }
};
BackgroundFeatureList["watcher's eye ua22co"] = {
	// Guard BG Feature
	description : "My experience in enforcing the law, and dealing with lawbreakers, gives me a feel for local laws and criminals. I can easily find the local outpost of the watch, guards or a similar organization, and just as easily pick out the dens of criminal activity in a community. I am far more likely to be welcome in the former locations rather than the latter, however. \n As a Guard, I gain the Alert (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 13]],
	eval : function() { AddFeat("Alert (UA22CO)"); },
	removeeval : function() { RemoveFeat("Alert (UA22CO)"); }
};
BackgroundFeatureList["makeshift meals ua22co"] = {
	// Guide BG Feature
	description : "I know how to purify food found in nature. When I take a short rest, I prepare a meal for a number of creatures equal to my proficiency bonus. Creatures who consume the food regain hit points equal to my level. Once they do, they can't regain hit points from another one of my meals until they finish a long rest. \n As a Guide, I gain the Magic Initiate (UA22CO) feat at 1st level, with my choice of either the Druid or Ranger variant.",
	source : [["MJ:HB", 0], ["UA22CO", 13]],
	eval : function() { AddFeat("Magic Initiate"); },
	removeeval : function() { RemoveFeat("Magic Initiate"); }
};
BackgroundFeatureList["discovery ua22co"] = {
	// Hermit BG Feature
	description : "The quiet seclusion of my extended hermitage gave me access to a unique and powerful discovery. The exact nature of this revelation depends on the nature of my seclusion. It might be a great truth, a hidden site, a long forgotten fact, or unearthed some relic of the past that could rewrite history. \n As a Hermit, I gain the Magic Initiate (UA22CO) feat at 1st level, with my choice of either the Druid or Ranger variant.",
	source : [["MJ:HB", 0], ["UA22CO", 14]],
	eval : function() { AddFeat("Magic Initiate"); },
	removeeval : function() { RemoveFeat("Magic Initiate"); }
};
BackgroundFeatureList["stone infrastructure ua22co"] = {
	// Laborer BG Feature
	description : "I have an advanced knowledge of the properties of stone structures, including where they are strongest and weakest. \n As a Laborer, I gain the Tough (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 14]],
	eval : function() { AddFeat("Tough"); },
	removeeval : function() { RemoveFeat("Tough"); }
};
BackgroundFeatureList["position of privilege ua22co"] = {
	// Noble BG Feature
	description : "I am welcome in high society, and people assume I have the right to be wherever I am. The common folk make every effort to accommodate me and avoid my displeasure, and other people of high birth treat me as a member of the same social sphere. I can secure an audience with a local noble if I need to. \n As a Noble, I gain the Skilled (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 14]],
	eval : function() { AddFeat("Skilled"); },
	removeeval : function() { RemoveFeat("Skilled"); }
};
BackgroundFeatureList["wanderer ua22co"] = {
	// Pilgrim BG Feature
	description : "I have an excellent memory for maps and geography, and I can always recall the general layout of terrain, settlements, and other features around me. In addition, I can find food and fresh water for myself and up to five other people each day, provided that the land offers berries, small game, water, and so forth. \n As a Pilgrim, I gain the Healer (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 14]],
	eval : function() { AddFeat("Healer (UA22CO)"); },
	removeeval : function() { RemoveFeat("Healer (UA22CO)"); }
};
BackgroundFeatureList["researcher ua22co"] = {
	// Sage BG Feature
	description : "When I attempt to learn or recall a piece of lore, if I do not know that information, I often know where and from whom I can obtain it. Usually, this information comes from a library, scriptorium, university, or a sage or other learned person or creature. Unearthing the deepest secrets of the multiverse can require an adventure or even a whole campaign. \n As a Sage, I gain the Magic Initiate (UA22CO) feat at 1st level, with my choice of either the Artificer, Sorcerer, Warlock, or Wizard variant.",
	source : [["MJ:HB", 0], ["UA22CO", 15]],
	eval : function() { AddFeat("Magic Initiate"); },
	removeeval : function() { RemoveFeat("Magic Initiate"); }
};
BackgroundFeatureList["ship's passage ua22co"] = {
	// Sailor BG Feature
	description : "When I need to, I can secure free passage on a sailing ship for myself and my companions. I might sail on the ship I served on, or another ship I have good relations with. Because I'm calling in a favor, I can't be certain of a schedule or route that will meet my every need. My companions and I are expected to assist the crew during the voyage. \n As a Sailor, I gain the Tavern Brawler (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 15]],
	eval : function() { AddFeat("Tavern Brawler"); },
	removeeval : function() { RemoveFeat("Tavern Brawler"); }
};
BackgroundFeatureList["military rank ua22co"] = {
	// Soldier BG Feature
	description : "I have a military rank from my career as a soldier. Soldiers loyal to my former military organization still recognize my authority and influence. I can invoke my rank to influence soldiers and temporarily requisition simple equipment or horses. I can usually gain access to friendly military encampments and fortresses where my rank is recognized. \n As a Soldier, I gain the Savage Attacker (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 15]],
	eval : function() { AddFeat("Savage Attacker"); },
	removeeval : function() { RemoveFeat("Savage Attacker"); }
};
BackgroundFeatureList["city secrets ua22co"] = {
	// Urchin BG Feature
	description : "I know the secret patterns and flow to cities and can find passages through the urban sprawl that others would miss. When I am not in combat, I (and companions I lead) can travel between any two locations in the city twice as fast as my speed would normally allow. \n As an Urchin, I gain the Lucky (UA22CO) feat at 1st level.",
	source : [["MJ:HB", 0], ["UA22CO", 15]],
	eval : function() { AddFeat("Lucky"); },
	removeeval : function() { RemoveFeat("Lucky"); }
};

// Add the new feats for the backgrounds in this UA article.
FeatsList["alert ua22co"] = {
	name : "Alert (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 16]],
	allowDuplicates : false,
	addMod : [
		{ type : "skill", field : "Init", mod : "Prof", text : "I can add my Proficiency Bonus to initiative rolls." },
	],
	descriptionFull : " \u2022 Initiative Proficiency. When I roll Initiative, I can add my Proficiency Bonus to the roll.\n \u2022 Initiative Swap. Immediately after I roll Initiative, I can swap my Initiative with the Initiative of one willing ally in the same combat. I can’t make this swap if myself or the ally is Incapacitated.",
	description : " \u2022 Initiative Proficiency. When I roll Initiative, I can add my Proficiency Bonus to the roll.\n \u2022 Initiative Swap. I can swap my Initiative with one willing ally, unless myself or the ally is Incapacitated.",
};
FeatsList["crafter ua22co"] = {
	name : "Crafter (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 16]],
	allowDuplicates : false,
	toolProfs : [["Artisan's tools", 3]],
	descriptionFull : " \u2022 Tool Proficiency. I gain Tool Proficiency with three different Artisan’s Tools of my choice.\n \u2022 Discount. Whenever I buy a nonmagical item, I receive a 20 percent discount on it.\n \u2022 Faster Crafting. When I craft an item using a tool with which I have Tool Proficiency, the required crafting time is reduced by 20 percent.",
	description : " \u2022 Tool Proficiency. I gain Tool Proficiency with three different Artisan’s Tools of my choice.\n \u2022 Discount. I get a 20% discount on nonmagical items.\n \u2022 Faster Crafting. I craft items 20% faster when using a tool I am proficient with.",
};
FeatsList["healer ua22co"] = {
	name : "Healer (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 17]],
	allowDuplicates : false,
	descriptionFull : "I have the training and intuition to administer first aid and other care effectively, granting me the following benefits:\n \u2022 Battle Medic. If I have a Healer’s Kit, I can expend one use of it and tend to a creature within 5 feet of me as an Action. That creature can expend one of its Hit Dice, and I then roll that die. The creature regains a number of Hit Points equal to the roll plus my Proficiency Bonus.\n \u2022 Healing Re-Rolls. Whenever I roll a die to determine the number of Hit Points I restore with a spell or with this feat’s Battle Medic benefit, I can re-roll the die if it rolls a 1, and I must use the new roll.",
	description : " \u2022 Battle Medic. If I a Healer's Kit, I can expend one of its uses & roll one of the target's hit die plus my Proficiency Bonus and heal target the resulting value.\n \u2022 Healing Rerolls. I can reroll any dice used for healing that rolls a 1; must use new roll.",
};
FeatsList["musician ua22co"] = {
	name : "Musician (UA22CO)",
	source : [["MJ:HB", 0], ["UA22CO", 17]],
	allowDuplicates : false,
	toolProfs : [["Musical instrument", 3]],
	descriptionFull : " \u2022 Instrument Training. I gain Tool Proficiency with three Musical Instruments of my choice.\n \u2022 Inspiring Song. As I finish a Short Rest or a Long Rest, I can play a song on a Musical Instrument with which I have Tool Proficiency and give Heroic Advantage to allies who hear the song. The number of allies I can affect in this way equals my Proficiency Bonus.",
	description : " \u2022 Instrument Training. I gain Tool Proficiency with three Musical Instruments of my choice.\n \u2022 Inspiring Song. After a Short Rest or Long Rest, I can give Proficiency Bonus # of allies Heroic Advantage.",
};

//// >>>>>>>>>>>>>>>>>>>> ////
//// >>> UA22XC Feats >>> ////
//// >>>>>>>>>>>>>>>>>>>> ////

// 4th Lvl Feats
FeatsList["actor ua22xc"] = {
	name : "Actor (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 16]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Charisma 13+",
	prereqeval : function(v) {
		return v.characterLevel >=4 && What('Cha') >= 13;
	},
	scores : [0, 0, 0, 0, 0, 1],
	scorestxt : "+1 Charisma",
	descriptionFull : "Skilled at mimicry and dramatics, you gain the following benefits: \n \u2022 Ability Score Increase. Increase your Charisma score by 1, to a maximum of 20. \n \u2022 Impersonation. While you’re disguised as a fictional person or a real person other than yourself, you have Advantage on Charisma Checks (Performance) to convince others that you are that person. \n \u2022 Mimicry. You can mimic the sounds of other creatures, including speech. To mimic a sound or a way of speaking, you must listen to it for at least 1 minute. Any time thereafter, you can make a DC 15 Charisma Check (Performance) to perform the mimicry; on a success, you perform it convincingly for up to 1 hour.",
	description : " \u2022 Ability Score Increase. My Charisma increases by 1, to a max of 20. \n \u2022 Impersonation. While disguised as someone else, I have Advantage on Charisma Checks (Performance) to convince others that I are that person. \n \u2022 Mimicry. After listening for at a minute, I can make a DC 15 Charisma Check (Performance) to mimic the sounds of other creatures, including speech, for an hour.",
};
FeatsList["athlete ua22xc"] = {
	name : "Athlete (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 16]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Strength, Dexterity, or Constitution 13+",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (What('Str') >= 13||What('Dex') >= 13||What('Con') >= 13);
	},
	speed : {
		climb : { spd : "30", enc : 20 },
	},
	descriptionFull : "You have undergone extensive physical training to gain the following benefits: \n \u2022 Ability Score Increase. Increase your Strength, Dexterity, or Constitution score by 1, to a maximum of 20. \n \u2022 Climb Speed. You gain a Climb Speed equal to my Speed. \n \u2022 Hop Up. When you are Prone, you can right yourself with only 5 feet of movement. \n \u2022 Jumping. You have Advantage on any Ability Check you make for the Jump Action.",
	description : " \u2022 Ability Score Increase. My Strength, Dexterity, or Constitution increases by 1, to a max of 20. \n \u2022 Climb Speed. I gain a Climb Speed equal to my Speed. \n \u2022 Hop Up. When I am Prone, I can right myself with only 5 feet of movement. \n \u2022 Jumping. I have Advantage on any Ability Check I make for the Jump Action.",
	choices : ['Strength +1', 'Dexterity +1', 'Constitution +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
	"constitution +1" : {
		scores : [0, 0, 1, 0, 0, 0],
		scorestxt : "+1 Constitution",
	},
};
FeatsList["charger ua22xc"] = {
	name : "Charger (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 16]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (v.martialWeaponsProf||v.otherWeaponsProf.some(function (n) {
			return WeaponsList[n] && (/Martial/i).test(WeaponsList[n].type);
		}));
	},
	descriptionFull : "You have trained to charge headlong into battle, gaining the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Dexterity score by 1, to a maximum of 20. \n \u2022 Improved Dash. When you take the Dash Action, your Speed increases by 10 feet for that Action. \n \u2022 Charge Attack. If you move at least 10 feet in a straight line immediately before hitting with an attack as part of the Attack Action on your turn, choose one of the following effects: gain a +1d8 bonus to the attack’s damage roll, or push the target up to 10 feet, provided the target you want to push is no more than one Size larger than you. You can use this benefit only once on each of your turns.",
	description : " \u2022 Ability Score Increase. My Strength or Dexterity increases by 1, to a max of 20. \n \u2022 Improved Dash. When I take the Dash Action, my Speed increases by 10 feet for that Action. \n \u2022 Charge Attack. If I move at least 10 ft in a line immediately before hitting with an Attack as part of the Attack action on my turn, I can either gain +1d8 bonus damage or push a target no more than one Size larger than me back 10 ft.",
	choices : ['Strength +1', 'Dexterity +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
};
FeatsList["crossbow expert ua22xc"] = {
	name : "Crossbow Expert (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 17]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (v.martialWeaponsProf||v.otherWeaponsProf.some(function (n) {
			return WeaponsList[n] && (/Martial/i).test(WeaponsList[n].type);
		}));
	},
	scores : [0, 1, 0, 0, 0, 0],
	scorestxt : "+1 Dexterity",
	calcChanges : {
		atkAdd : [
			function (fields, v) {
				if ((/crossbow/i).test(v.theWea.type) || (/crossbow/i).test(v.theWea.list)) {
					fields.Description = fields.Description.replace(/([;,]? ?loading|loading[;,]? ?)/i, '');
				};
			},
			"I ignore the loading quality of crossbows.",
		],
	},
	descriptionFull : "Thanks to extensive practice with crossbows, you gain the following benefits: \n \u2022 Ability Score Increase. Increase your Dexterity score by 1, to a maximum of 20. \n \u2022 Ignore Loading. You ignore the Loading property of crossbows. \n \u2022 Firing in Melee. Being within 5 feet of an enemy doesn’t impose Disadvantage on your Attack Rolls with crossbows. \n \u2022 Dual Wielding. When you make the extra attack of the Light weapon property, you can add your Ability Modifier to the damage of the extra attack if that attack is with a crossbow that has the Light property.",
	description : " \u2022 Ability Score Increase. My Dexterity increases by 1, to a max of 20. \n \u2022 Ignore Loading. I ignore the Loading property of crossbows. \n \u2022 Firing in Melee. Being within 5 feet of an enemy doesn’t impose Disadvantage on my Attack Rolls with crossbows. \n \u2022 Dual Wielding. When using the extra attack of the Light weapon property, add my Ability Modifier to the damage if extra attack is made with a crossbow with the Light property.",
};
FeatsList["defensive duelist ua22xc"] = {
	name : "Defensive Duelist (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 17]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Dexterity 13+",
	prereqeval : function(v) {
		return v.characterLevel >=4 && What('Dex') >= 13;
	},
	scores : [0, 1, 0, 0, 0, 0],
	scorestxt : "+1 Dexterity",
	descriptionFull : "You've learned to deftly parry attacks, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Dexterity score by 1, to a maximum of 20. \n \u2022 Parry. If you are holding a Finesse Weapon and another creature hits you with a Melee Attack, you can use your Reaction to add your Proficiency Bonus to your Armor Class for that attack, potentially causing the attack to miss you.",
	description : " \u2022 Ability Score Increase. My Dexterity increases by 1, to a max of 20. \n \u2022 Parry. If holding a Finesse Weapon when hit by a Melee Attack, I can add my Proficiency Bonus to my AC.",
};
FeatsList["dual wielder ua22xc"] = {
	name : "Dual Wielder (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 17]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (v.martialWeaponsProf||v.otherWeaponsProf.some(function (n) {
			return WeaponsList[n] && (/Martial/i).test(WeaponsList[n].type);
		}));
	},
	descriptionFull : "You master fighting with two weapons, gaining the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Dexterity score by 1, to a maximum of 20. \n \u2022 Enhanced Dual Wielding. When you are holding a Weapon with the Light property in one hand, you can treat a non-Light Weapon in your other hand as if it had the Light property, provided that Weapon lacks the Two-Handed property. \n \u2022 Quick Draw. You can draw or stow two Weapons that lack the Two-Handed property when you would normally be able to draw or stow only one.",
	description : " \u2022 Ability Score Increase. My Strength or Dexterity increases by 1, to a max of 20. \n \u2022 Enhanced Dual Wielding. When holding a Light Weapon in one hand, I can treat a non-Light Weapon as if it were a Light Weapon so long as it isn't a Two-Handed Weapon. \n \u2022 Quick Draw. I can draw or stow two Weapons at once that lack the Two-Handed property.",
	choices : ['Strength +1', 'Dexterity +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
};
FeatsList["durable ua22xc"] = {
	name : "Durable (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 17]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Constitution 13+",
	prereqeval : function(v) {
		return v.characterLevel >=4 && What('Con') >= 13;
	},
	scores : [0, 0, 1, 0, 0, 0],
	scorestxt : "+1 Constitution",
	descriptionFull : "Hardy and resilient, you gain the following benefits: \n \u2022 Ability Score Increase. Increase your Constitution score by 1, to a maximum of 20. \n \u2022 Defy Death. You have Advantage on Death Saving Throws. \n \u2022 Speedy Recovery. As a Bonus Action, you can expend one of your Hit Dice, roll the die, and regain a number of Hit Points equal to the roll.",
	description : " \u2022 Ability Score Increase. My Constitution increases by 1, to a max of 20. \n \u2022 Defy Death. I have Advantage on Death Saving Throws. \n \u2022 Speedy Recovery. I can use a Bonus Action to expend one of my Hit Dice to heal myself.",
};
FeatsList["elemental adept ua22xc"] = {
	name : "Elemental Adept (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 17]],
	allowDuplicates : true,
	prerequisite : "Character Level 4+; Spellcasting or Pact Magic Feature",
	prereqeval : function(v) {
		return v.characterLevel >= 4 && v.isSpellcastingClass;
	},
	descriptionFull : "Repeatable: Yes, but you must choose a different Damage Type each time for Energy Mastery. \n In your spellcasting, you can harness a particular form of energy with deadly mastery, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma score by 1, to a maximum of 20. \n \u2022 Energy Mastery. Choose one of the following Damage Types: Acid, Cold, Fire, Lightning, or Thunder. Spells you cast ignore Resistance to damage of the chosen type. In addition, when you roll damage for a Spell you cast that deals damage of that type, you can treat any 1 on a damage die as a 2.",
	description : "Repeatable: Yes, but I must choose a different Damage Type each time for Energy Mastery. \n \u2022 Ability Score Increase. My Intelligence, Wisdom, or Charisma increases by 1, to a max of 20. \n \u2022 Energy Mastery. Chose from Acid, Cold, Fire, Lightning, or Thunder. Spells cast that deal the chosen damage type ignore Resistance to that damage. Treat dice rolls of 1 as a 2 for damage rolls.",
	choices : ['Intelligence +1', 'Wisdom +1', 'Charisma +1'],
	"intelligence +1" : {
		scores : [0, 0, 0, 1, 0, 0],
		scorestxt : "+1 Intelligence",
	},
	"wisdom +1" : {
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
	},
	"charisma +1" : {
		scores : [0, 0, 0, 0, 0, 1],
		scorestxt : "+1 Charisma",
	},
};
FeatsList["grappler ua22xc"] = {
	name : "Grappler (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 19]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (What('Str') >= 13||What('Dex') >= 13);
	},
	descriptionFull : "You’re an accomplished wrestler, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Dexterity score by 1, to a maximum of 20. \n \u2022 Attack Advantage. You have Advantage on Attack Rolls against a creature Grappled by you. \n \u2022 Fast Wrestler. You aren’t Slowed when you move a creature Grappled by you, provided the creature is your Size or smaller. \n \u2022 Punch and Grab. When you hit a creature with an Unarmed Strike as part of the Attack Action on your turn, you can deal damage to the target and also grapple it. You can use this benefit only once per turn.",
	description : " \u2022 Ability Score Increase. My Strength or Dexterity increases by 1, to a max of 20. \n \u2022 Attack Advantage. I have Advantage on Attack Rolls against a creature Grappled by me. \n \u2022 Fast Wrestler. If it is my Size or smaller, I'm not slowed when moving a creature Grappled by me. \n \u2022 Punch and Grab. Once per turn during my Attack Action, I can both Grapple a creature and deal damage to it in the same Unarmed Strike.",
	choices : ['Strength +1', 'Dexterity +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
};
FeatsList["great weapon master ua22xc"] = {
	name : "Great Weapon Master (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 20]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (v.martialWeaponsProf||v.otherWeaponsProf.some(function (n) {
			return WeaponsList[n] && (/Martial/i).test(WeaponsList[n].type);
		}));
	},
	scores : [1, 0, 0, 0, 0, 0],
	scorestxt : "+1 Strength",
	action : [
		["bonus action", "Great Weapon Master (after crit or take-down)"]
	],
	descriptionFull : "You’ve learned to use the weight of a weapon to your advantage, letting its momentum empower your strikes. You gain the following benefits: \n \u2022 Ability Score Increase. Increase your Strength score by 1, to a maximum of 20. \n \u2022 Cleave. Immediately after you score a Critical Hit with a Melee Weapon or reduce a creature to 0 Hit Points with one, you can make one attack with the same weapon as a Bonus Action. \n \u2022 Heavy Weapon Mastery. When you hit a creature with a Heavy Weapon as part of the Attack Action on your turn, you can cause the weapon to deal extra damage to the target. The extra damage equals your Proficiency Bonus, and you can deal it only once per turn.",
	description : " \u2022 Ability Score Increase. My Strength increases by 1, to a max of 20. \n \u2022 Cleave. Critical Hitting or reducing a creature to 0 HP with a Melee Weapon, I can make one extra attack with the same weapon as a Bonus Action. \n \u2022 Heavy Weapon Mastery. Once per turn during my Attack Action, I can add my Proficiency Bonus as damage when I hit a creature with a Heavy Weapon.",
};
FeatsList["heavily armored ua22xc"] = {
	name : "Heavily Armored (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 20]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Medium Armor Training",
	prereqeval : function(v) {
		return v.characterLevel >= 4 && v.mediumArmorProf;
	},
	armorProfs : [false, false, true, false],
	descriptionFull : "You have trained to use Heavy Armor effectively, gaining the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Constitution score by 1, to a maximum of 20. \n \u2022 Armor Training. You gain Heavy Armor Training.",
	description : " \u2022 Ability Score Increase. My Strength or Constitution increases by 1, to a max of 20. \n \u2022 Armor Training. I gain Heavy Armor Training.",
	choices : ['Strength +1', 'Constitution +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"constitution +1" : {
		scores : [0, 0, 1, 0, 0, 0],
		scorestxt : "+1 Constitution",
	},
};
FeatsList["heavy armor master ua22xc"] = {
	name : "Heavy Armor Master (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 20]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Heavy Armor Training",
	prereqeval : function(v) {
		return v.characterLevel >= 4 && v.heavyArmorProf;
	},
	armorProfs : [false, false, true, false],
	descriptionFull : "You can use your Heavy Armor to deflect strikes, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Constitution score by 1, to a maximum of 20. \n \u2022 Damage Reduction. When you’re hit by an attack while you’re wearing Heavy Armor, any Bludgeoning, Piercing, or Slashing Damage dealt to you by that attack is reduced by an amount equal to your Proficiency Bonus.",
	description : " \u2022 Ability Score Increase. My Strength or Constitution increases by 1, to a max of 20. \n \u2022 Damage Reduction. While wearing Heavy Armor, I reduce all Bludgeoning, Piercing, or Slashing Damage taken by my Proficiency Bonus.",
	choices : ['Strength +1', 'Constitution +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"constitution +1" : {
		scores : [0, 0, 1, 0, 0, 0],
		scorestxt : "+1 Constitution",
	},
};
FeatsList["inspiring leader ua22xc"] = {
	name : "Inspiring Leader (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 20]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Wisdom or Charisma 13+",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (What('Wis') >= 13||What('Cha') >= 13);
	},
	descriptionFull : "You are adept at encouraging others, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Wisdom or Charisma score by 1, to a maximum of 20. \n \u2022 Encouraging Performance. At the end of a Short Rest or a Long Rest, you can give an inspiring performance: a speech, a song, or a dance. When you do so, choose up to six friendly creatures (which can include yourself) within 30 feet of you who witness the performance. The chosen creatures each gain Temporary Hit Points equal to 2d4 + your Proficiency Bonus.",
	description : " \u2022 Ability Score Increase. My Wisdom or Charisma increases by 1, to a max of 20. \n \u2022 Encouraging Performance. After a Short Rest or a Long Rest, I can give up to six friendly creatures that I can see (including myself) 2d4 + my Proficiency Bonus in Temp HP.",
	choices : ['Wisdom +1', 'Charisma +1'],
	"wisdom +1" : {
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
	},
	"charisma +1" : {
		scores : [0, 0, 0, 0, 0, 1],
		scorestxt : "+1 Charisma",
	},
};
FeatsList["keen mind ua22xc"] = {
	name : "Keen Mind (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 20]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Intelligence 13+",
	prereqeval : function(v) {
		return v.characterLevel >=4 && What('Int') >= 13;
	},
	scores : [0, 0, 0, 1, 0, 0],
	scorestxt : "+1 Intelligence",
	skillstxt : "Proficiency with one of the following skills: Arcana, History, Investigation, Nature, or Religion; or\n   Expertise with one of the skills above that I'm already Proficient with",
	descriptionFull : "You have trained to rapidly recall or discover vital details, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Intelligence score by 1, to a maximum of 20. \n \u2022 Lore Knowledge. Choose one of the following Skills: Arcana, History, Investigation, Nature, or Religion. If you lack Proficiency in the chosen Skill, you gain Proficiency in it, and if you have Proficiency in it, you gain Expertise in it. \n \u2022 Quick Study. You can take the Study Action as a Bonus Action.",
	description : " \u2022 Ability Score Increase. My Intelligence increases by 1, to a max of 20. \n \u2022 Lore Knowledge. I gain Proficiency (or Expertise if already Proficient) in one of the following skills: Arcana, History, Investigation, Nature, or Religion. \n \u2022 Quick Study. I can take the Study Action as a Bonus Action.",
};
FeatsList["lightly armored ua22xc"] = {
	name : "Lightly Armored (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 21]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+",
	prereqeval : function(v) {
		return v.characterLevel >= 4;
	},
	armorProfs : [true, true, false, true],
	descriptionFull : "You gain the following Armor Training: Light Armor, Medium Armor, and Shield.",
	description : "I gain the following Armor Training: Light Armor, Medium Armor, and Shield.",
};
FeatsList["mage slayer ua22xc"] = {
	name : "Mage Slayer (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 21]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (v.martialWeaponsProf||v.otherWeaponsProf.some(function (n) {
			return WeaponsList[n] && (/Martial/i).test(WeaponsList[n].type);
		}));
	},
	descriptionFull : "You have practiced techniques useful in battling magic-users, gaining the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Dexterity score by 1, to a maximum of 20. \n \u2022 Concentration Breaker. When you damage a creature that is concentrating, it has Disadvantage on the Saving Throw it makes to maintain Concentration. \n \u2022 Guarded Mind. If you fail an Intelligence, a Wisdom, or a Charisma Saving Throw, you can cause yourself to succeed instead. Once you use this benefit, you can’t use it again until you finish a Long Rest.",
	description : " \u2022 Ability Score Increase. My Strength or Dexterity increases by 1, to a max of 20. \n \u2022 Concentration Breaker. Concentrating creatures damaged by me have Disadvantage on Saving Throws to maintain Concentration. \n \u2022 Guarded Mind. Once per Long Rest, I can choose to succeed an Intelligence, a Wisdom, or a Charisma Saving Throw I would have otherwise failed.",
	choices : ['Strength +1', 'Dexterity +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
};
FeatsList["medium armor master ua22xc"] = {
	name : "Medium Armor Master (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 21]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Medium Armor Training",
	prereqeval : function(v) {
		return v.characterLevel >= 4 && v.mediumArmorProf;
	},
	eval : function () {
		Value('Medium Armor Max Mod', 3);
		ApplyArmor(What("AC Armor Description"));
	},
	removeeval : function () {
		tDoc.resetForm(['Medium Armor Max Mod']);
		ApplyArmor(What("AC Armor Description"));
	},
	descriptionFull : "You have practiced moving in medium armor to gain the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Dexterity score by 1, to a maximum of 20. \n \u2022 Dexterous Wearer. While you are wearing Medium Armor, you can add 3, rather than 2, to your AC if you have a Dexterity score of 16 or higher.",
	description : " \u2022 Ability Score Increase. My Strength or Dexterity increases by 1, to a max of 20. \n \u2022 Dexterous Wearer. While wearing Medium Armor, I can add +3 instead of +2 to my AC.",
	choices : ['Strength +1', 'Dexterity +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
};
FeatsList["mounted combatant ua22xc"] = {
	name : "Mounted Combatant (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 21]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (v.martialWeaponsProf||v.otherWeaponsProf.some(function (n) {
			return WeaponsList[n] && (/Martial/i).test(WeaponsList[n].type);
		}));
	},
	descriptionFull : "You have developed a bond with your mounts, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Strength, Dexterity, or Wisdom score by 1, to a maximum of 20. \n \u2022 Mount Handler. You have Advantage on Wisdom Checks (Animal Handling) made to handle or train horses and other Beasts employed as mounts. \n \u2022 Mounted Strike. While mounted, you have Advantage on Attack Rolls against any creature that is within 5 feet of your mount and at least one Size smaller than it. \n \u2022 Leap Aside. If your mount is subjected to an effect that allows it to make a Dexterity Saving Throw to take only half damage, it instead takes no damage if it succeeds on the Saving Throw, and only half damage if it fails. For your mount to gain this benefit, you must be riding it, and neither of you can be Incapacitated. \n \u2022 Veer. While mounted, you can use your Reaction to force an attack that hits your mount to hit you instead.",
	description : " \u2022 Ability Score Increase. My Strength, Dexterity, or Wisdom increases by 1, to a max of 20. \n \u2022 Mount Handler. Advantage on Wisdom Checks (Animal Handling) made to handle/train horses & other Beasts used as mounts. \n \u2022 Mounted Strike. Advantage against any creature within 5ft of & at least one Size smaller than my mount. \n \u2022 Leap Aside. When I am riding it and when neither of us are Incapacitated, my mount takes reduced damage from effects calling for a Dexterity Saving Throw; It takes no damage if it succeeds, and half damage if it fails. \n \u2022 Veer. While mounted, I can use my Reaction to force an attack that hits my mount to hit me instead.",
	choices : ['Strength +1', 'Dexterity +1', 'Wisdom +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
	"wisdom +1" : {
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
	},
};
FeatsList["observant ua22xc"] = {
	name : "Observant (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 21]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Intelligence or Wisdom 13+",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (What('Int') >= 13||What('Wis') >= 13);
	},
	skillstxt : "Proficiency with one of the following skills: Insight, Investigation, or Perception; or\n   Expertise with one of the skills above that I'm already Proficient with",
	descriptionFull : "Quick to notice details around you, you gain the following benefits: \n \u2022 Ability Score Increase. Increase your Intelligence or Wisdom score by 1, to a maximum of 20. \n \u2022 Keen Observer. Choose one of the following Skills: Insight, Investigation, or Perception. If you lack Proficiency with the chosen Skill, you gain Proficiency in it, and if you have Proficiency in it, you gain Expertise in it. \n \u2022 Quick Search. You can take the Search Action as a Bonus Action.",
	description : " \u2022 Ability Score Increase. My Intelligence or Wisdom increases by 1, to a max of 20. \n \u2022 Keen Observer. I gain Proficiency (or Expertise if already Proficient) in one of the following skills: Insight, Investigation, or Perception.  \n \u2022 Quick Search. I can take the Search Action as a Bonus Action.",
	choices : ['Intelligence +1', 'Wisdom +1'],
	"intelligence +1" : {
		scores : [0, 0, 0, 1, 0, 0],
		scorestxt : "+1 Intelligence",
	},
	"wisdom +1" : {
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
	},
};
FeatsList["polearm master ua22xc"] = {
	name : "Polearm Master (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 21]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (v.martialWeaponsProf||v.otherWeaponsProf.some(function (n) {
			return WeaponsList[n] && (/Martial/i).test(WeaponsList[n].type);
		}));
	},
	scores : [1, 0, 0, 0, 0, 0],
	scorestxt : "+1 Strength",
	action : [
		["bonus action", "Butt End Attack (after attack with polearm)"]
	],
	descriptionFull : "You have trained extensively with pole weapons that have Reach, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Strength score by 1, to a maximum of 20. \n \u2022 Pole Strike. Immediately after you take the Attack Action and attack with a Weapon that has the Heavy and Reach properties, you can use a Bonus Action to make a Melee Attack with the opposite end of the Weapon. The weapon’s damage die for this attack is a d4, and it deals Bludgeoning Damage. \n \u2022 Reactive Strike. While you are holding a Weapon that has the Heavy and Reach properties, you can use your Reaction to make one Melee Attack against a creature that enters the Reach you have with that Weapon.",
	description : " \u2022 Ability Score Increase. My Strength increases by 1, to a max of 20. \n \u2022 Pole Strike. If I attack with a Weapon with the Heavy & Reach properties during my Attack Action, I can immediately use my Bonus Action to attack with the other end of the weapon, dealing 1d4 Bludgeoning damage on a hit. \n \u2022 Reactive Strike. While holding a Weapon with the Heavy & Reach properties, I can make an opportunity attack when a creature enters my reach.",
};
FeatsList["resilient ua22xc"] = {
	name : "Resilient (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 22]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+",
	prereqeval : function(v) {
		return v.characterLevel >=4;
	},
	descriptionFull : "You have developed the resilience to better withstand certain dangers, granting you the following benefits: \n \u2022 Ability Score Increase. Choose one ability in which you lack Saving Throw Proficiency. Increase the chosen Ability Score by 1, to a maximum of 20. \n \u2022 Saving Throw Proficiency. You gain Saving Throw Proficiency with the chosen ability.",
	description : " \u2022 Ability Score Increase. Choose one ability in which I lack Saving Throw Proficiency. Increase the chosen Ability Score by 1, to a maximum of 20. \n \u2022 Saving Throw Proficiency. I gain Saving Throw Proficiency with the chosen ability.",
	choices : ['Strength', 'Dexterity', 'Constitution', 'Intelligence', 'Wisdom', 'Charisma'],
	"strength" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
		saves : ["Str"],
	},
	"dexterity" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
		saves : ["Dex"],
	},
	"constitution" : {
		scores : [0, 0, 1, 0, 0, 0],
		scorestxt : "+1 Constitution",
		saves : ["Con"],
	},
	"intelligence" : {
		scores : [0, 0, 0, 1, 0, 0],
		scorestxt : "+1 Intelligence",
		saves : ["Int"],
	},
	"wisdom" : {
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
		saves : ["Wis"],
	},
	"charisma" : {
		scores : [0, 0, 0, 0, 0, 1],
		scorestxt : "+1 Charisma",
		saves : ["Cha"],
	},
};
FeatsList["ritual caster ua22xc"] = {
	name : "Ritual Caster (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 22]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Intelligence, Wisdom, or Charisma 13+",
	prereqeval : function(v) {
		return v.characterLevel >= 4 && (What('Int') >= 13||What('Wis') >= 13||What('Cha') >= 13);
	},
	descriptionFull : "You have studied ritual magic, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma score by 1, to a maximum of 20. \n \u2022 Ritual Spells. Choose two 1st-level Spells that have the Ritual tag from the Bard, Cleric, Druid, Sorcerer, Warlock, and Wizard Spell Lists. You always have those two Spells prepared, and you can cast them with any Spell Slots you have. The Spells’ Spellcasting Ability is the ability increased by this Feat. \n \u2022 Quick Ritual. With this benefit, you can cast a Ritual Spell that you have prepared using its regular casting time, rather than the extended time for a Ritual. Doing so doesn’t require a Spell Slot. Once you cast the Spell in this way, you can’t use this benefit again until you finish a Long Rest.",
	description : " \u2022 Ability Score Increase. My Intelligence, Wisdom, or Charisma increases by 1, to a max of 20. \n \u2022 Ritual Spells. I can cast spells in my ritual book as rituals only. I gain two 1st-level ritual spells. I can copy ritual spells that I find into my book if they are not more than half my level (2 hours and 50 gp per spell level). \n \u2022 Quick Ritual. Once per Long Rest, I can cast a prepared Ritual Spell using its regular casting time, rather than the extended time for a Ritual, and without requiring a Spell Slot.",
	choices : ['Intelligence +1', 'Wisdom +1', 'Charisma +1'],
	"intelligence +1" : {
		scores : [0, 0, 0, 1, 0, 0],
		scorestxt : "+1 Intelligence",
		spellcastingBonus : [{
			name : "1st-level Wizard ritual spell",
			times : 2,
			selection : ["alarm", "comprehend languages", "detect magic", "find familiar", "identify", "illusory script", "tenser's floating disk", "unseen servant"],
			firstCol : "oncelr",
		}],
		spellcastingAbility : 4,
	},
	"wisdom +1" : {
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
		spellcastingBonus : [{
			name : "1st-level Cleric or Druid ritual spell",
			times : 2,
			selection : ["ceremnoy", "detect magic", "detect poison and disease", "purify food and drink", "speak with animals"],
			firstCol : "oncelr",
		}],
		spellcastingAbility : 5,
	},
	"charisma +1" : {
		scores : [0, 0, 0, 0, 0, 1],
		scorestxt : "+1 Charisma",
		spellcastingBonus : [{
			name : "1st-level Bard, Sorcerer, or Warlock ritual spell",
			times : 2,
			selection : ["comprehend languages", "detect magic", "identify", "illusory script", "speak with animals", "unseen servant"],
			firstCol : "oncelr",
		}],
		spellcastingAbility : 6,
	},
	// I am not sure if I did the above spell code right.
};
FeatsList["sentinel ua22xc"] = {
	name : "Sentinel (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 22]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (v.martialWeaponsProf||v.otherWeaponsProf.some(function (n) {
			return WeaponsList[n] && (/Martial/i).test(WeaponsList[n].type);
		}));
	},
	action : [
		["reaction", "Sentinel (after attack on ally)"]
	],
	descriptionFull : "You have mastered techniques to take advantage of every drop in any enemy’s guard, gaining the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Dexterity score by 1, to a maximum of 20. \n \u2022 Guardian. Immediately after a creature within 5 feet of you takes the Disengage Action or hits a target other than you with an attack, you can make an Opportunity Attack against that creature. \n \u2022 Halt. When you hit a creature with an Opportunity Attack, the creature’s Speed becomes 0 for the rest of the turn.",
	description : " \u2022 Ability Score Increase. My Strength or Dexterity increases by 1, to a max of 20. \n \u2022 Guardian. The Disengage action doesn't work on me. When a creature within 5 ft makes an attack against a target other than me, I can use my reaction to make a melee weapon attack against the attacker. \n \u2022 Halt. Creatures I hit with opportunity attacks have 0 speed for this turn.",
	choices : ['Strength +1', 'Dexterity +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
};
FeatsList["sharpshooter ua22xc"] = {
	name : "Sharpshooter (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 22]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (v.martialWeaponsProf||v.otherWeaponsProf.some(function (n) {
			return WeaponsList[n] && (/Martial/i).test(WeaponsList[n].type);
		}));
	},
	scores : [0, 1, 0, 0, 0, 0],
	scorestxt : "+1 Dexterity",
	descriptionFull : "You can make shots that others find impossible, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Dexterity score by 1, to a maximum of 20. \n \u2022 Bypass Cover. Your Ranged Attacks with Weapons ignore Half Cover and Three- Quarters Cover. \n \u2022 Firing in Melee. Being within 5 feet of an enemy doesn’t impose Disadvantage on your ranged Attack Rolls with Weapons. \n \u2022 Long Shots. Attacking at Long Range doesn’t impose Disadvantage on your ranged Attack Rolls with Weapons.",
	description : " \u2022 Ability Score Increase. My Dexterity increases by 1, to a max of 20. \n \u2022 Bypass Cover. I ignore all forms of Cover except Full Cover. \n \u2022 Firing in Melee. Being within 5 feet of an enemy doesn’t impose Disadvantage on my ranged Attack Rolls with Weapons. \n \u2022 Long Shots. Long Range shots with Weapons are no longer at Disadvantage.",
};
FeatsList["shield master ua22xc"] = {
	name : "Shield Master (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 23]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Shield Training",
	prereqeval : function(v) {
		return v.characterLevel >=4 && v.shieldProf;
	},
	scores : [1, 0, 0, 0, 0, 0],
	scorestxt : "+1 Strength",
	action : [
		["bonus action", "Shove with shield (with Attack action)"]
		["reaction", "Interpose shield (if Dex save half dmg)"]
	],
	descriptionFull : "You’ve trained to use shields not just for protection, but also for offense, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Strength score by 1, to a maximum of 20. \n \u2022 Shield Bash. If you attack a creature within 5 feet of you as part of the Attack Action and hit with a Melee Weapon, you can immediately bash the target with your Shield if it’s equipped, forcing the target to make a Strength Saving Throw against a DC equal to 8 + your Strength modifier + your Proficiency Bonus. \n On a failed save, you knock the target Prone or push it 5 feet away. You can use this benefit only once on each of your turns. \n \u2022 Interpose Shield. If you are subjected to an effect that allows you to make a Dexterity Saving Throw to take only half damage, you can use your Reaction to take no damage if you succeed on the Saving Throw and are wielding a Shield, interposing your shield between yourself and the source of the effect.",
	description : " \u2022 Ability Score Increase. My Strength increases by 1, to a max of 20. \n \u2022 Shield Bash. As a bonus action, when I use the Attack action, I can shove someone within 5 ft with my shield. They must fail a Strength Save against a DC equal to 8 + my Str Mod + my Prof Bonus to be shoved. \n \u2022 Interpose Shield. As a reaction, if I succeed on a Dex save for half damage, I can interpose my shield to avoid the damage.",
};
FeatsList["skulker ua22xc"] = {
	name : "Skulker (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 23]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Dexterity 13+",
	prereqeval : function(v) {
		return v.characterLevel >=4 && What('Dex') >= 13;
	},
	scores : [0, 1, 0, 0, 0, 0],
	scorestxt : "+1 Dexterity",
	vision : [
		["Blindsight", 10],
	],
	descriptionFull : "You are an expert at slinking through shadows, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Dexterity score by 1, to a maximum of 20. \n \u2022 Blindsight. You have Blindsight with a range of 10 feet. \n \u2022 Fog of War. Exploiting the distractions of battle, you have Advantage on any Dexterity Check (Stealth) you make as part of the Hide Action during combat. \n \u2022 Sniper. If you make an Attack Roll while Hidden and the roll misses, making the Attack Roll doesn’t end the Hidden Condition on you.",
	description : " \u2022 Ability Score Increase. My Dexterity increases by 1, to a max of 20. \n \u2022 Blindsight. I have Blindsight with a range of 10 feet. \n \u2022 Fog of War. I have Advantage of Dexterity Checks (Stealth) I make as part of the Hide Action during combat. \n \u2022 Sniper. Missing an Attack Roll while Hidden doesn't end the Hidden Condition on me.",
};
FeatsList["speedster ua22xc"] = {
	name : "Speedster (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 23]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Dexterity 13+",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (What('Dex') >= 13||What('Con') >= 13);
	},
	descriptionFull : "You possess exceptional speed and stamina, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Dexterity or Constitution score by 1, to a maximum of 20. \n \u2022 Speed Increase. Your Speed increases by 10 feet while you aren’t wearing Heavy Armor. \n \u2022 Dash Over Difficult Terrain. When you take the Dash Action on your turn, Difficult Terrain doesn’t cost you extra movement for the rest of that turn.",
	description : " \u2022 Ability Score Increase. My Dexterity or Constitution increases by 1, to a max of 20. \n \u2022 Speed Increase. My Speed increases by 10 feet when not wearing Heavy Armor. \n \u2022 Dash Over Difficult Terrain. I ignore Difficult Terrain while Dashing.",
	choices : ['Dexterity +1', 'Dexterity +1 (Wearing Heavy Armor)', 'Constitution +1', 'Constitution +1 (Wearing Heavy Armor)'],
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
		speed : {
			allModes : "+10",
		},
	},
	"dexterity +1 (wearing heavy armor)" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
	"constitution +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Constitution",
		speed : {
			allModes : "+10",
		},
	},
	"constitution +1 (wearing heavy armor)" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Constitution",
	},
};
FeatsList["spell sniper ua22xc"] = {
	name : "Spell Sniper (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 23]],
	allowDuplicates : true,
	prerequisite : "Character Level 4+; Spellcasting or Pact Magic Feature",
	prereqeval : function(v) {
		return v.characterLevel >= 4 && v.isSpellcastingClass;
	},
	descriptionFull : "You have learned techniques to enhance your attacks with certain kinds of spells, gaining the following benefits: \n \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma score by 1, to a maximum of 20. \n \u2022 Bypass Cover. Your Attack Rolls for Spells ignore Half Cover and Three-Quarters Cover. \n \u2022 Casting in Melee. Being within 5 feet of an enemy doesn’t impose Disadvantage on your Attack Rolls with Spells. \n \u2022 Increased Range. When you cast a Spell that has a range of at least 10 feet and that requires you to make an Attack Roll, you can increase the Spell’s range by 60 feet.",
	description : " \u2022 Ability Score Increase. My Intelligence, Wisdom, or Charisma increases by 1, to a max of 20. \n \u2022 Bypass Cover. I ignore all forms of Cover except Full Cover. \n \u2022 Casting in Melee. Being within 5 feet of an enemy doesn’t impose Disadvantage on my Attack Rolls with spells. \n \u2022 Increased Range. Spells with a range of at least 10 ft that require an Attack Roll have an additional 60 ft of range.",
	choices : ['Intelligence +1', 'Wisdom +1', 'Charisma +1'],
	"intelligence +1" : {
		scores : [0, 0, 0, 1, 0, 0],
		scorestxt : "+1 Intelligence",
	},
	"wisdom +1" : {
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
	},
	"charisma +1" : {
		scores : [0, 0, 0, 0, 0, 1],
		scorestxt : "+1 Charisma",
	},
};
FeatsList["war caster ua22xc"] = {
	name : "War Caster (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 23]],
	allowDuplicates : true,
	prerequisite : "Character Level 4+; Spellcasting or Pact Magic Feature",
	prereqeval : function(v) {
		return v.characterLevel >= 4 && v.isSpellcastingClass;
	},
	savetxt : {
		text : "Adv. on Con (Concentration) saves when damaged",
	},
	action : [
		["reaction", " - Opportunity Spell"],
	],
	descriptionFull : "You have practiced casting spells in the midst of combat, granting you the following benefits: \n \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma score by 1, to a maximum of 20. \n \u2022 Concentration. You have Advantage on Constitution Saving Throws that you make to maintain your Concentration. \n \u2022 Reactive Spell. When a creature provokes an Opportunity Attack from you by moving out of your Reach, you can use your Reaction to cast a Spell at the creature, rather than making an Opportunity Attack. The Spell must have a casting time of one Action and must target only that creature. \n \u2022 Somatic Components. You can perform the Somatic Components of Spells even when you have Weapons or a Shield in one or both hands.",
	description : " \u2022 Ability Score Increase. My Intelligence, Wisdom, or Charisma increases by 1, to a max of 20. \n \u2022 Concentration. Advantage on Constitution Saving Throws to maintain Concentration. \n \u2022 Reactive Spell. Cast spell of 1 action casting time that targets only one creature instead of an opportunity attack. \n \u2022 Somatic Components. Perform somatic components even when holding weapons or shield in one or both hands.",
	choices : ['Intelligence +1', 'Wisdom +1', 'Charisma +1'],
	"intelligence +1" : {
		scores : [0, 0, 0, 1, 0, 0],
		scorestxt : "+1 Intelligence",
	},
	"wisdom +1" : {
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
	},
	"charisma +1" : {
		scores : [0, 0, 0, 0, 0, 1],
		scorestxt : "+1 Charisma",
	},
};
FeatsList["weapon training ua22xc"] = {
	name : "Weapon Training (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 24]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+",
	prereqeval : function(v) {
		return v.characterLevel >=4;
	},
	weaponProfs : [false, true],
	descriptionFull : "You have practiced extensively with a variety of weapons, gaining the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Dexterity score by 1, to a maximum of 20. \n \u2022 Weapon Proficiency. You gain Martial Weapon Proficiency.",
	description : " \u2022 Ability Score Increase. My Strength or Dexterity increases by 1, to a max of 20. \n \u2022 Weapon Proficiency. I gain Martial Weapon Proficiency.",
	choices : ['Strength +1', 'Dexterity +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
};

// Modified version of the "Gunner" Feat that is effectively a firearm version of the "Crossbow Expert" Feat, minus the "Dual Wielding" feature, since the original "Gunner" has no such feature.
FeatsList["gunner ua22xc"] = {
	name : "Gunner (UA22XC)",
	source : [["MJ:HB", 0], ["T", 80], ["UA22XC", 17]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+; Proficiency with Any Martial Weapon",
	prereqeval : function(v) {
		return v.characterLevel >=4 && (v.martialWeaponsProf||v.otherWeaponsProf.some(function (n) {
			return WeaponsList[n] && (/Martial/i).test(WeaponsList[n].type);
		}));
	},
	scores : [0, 1, 0, 0, 0, 0],
	scorestxt : "+1 Dexterity",
	weaponProfs : [false, false, ["Firearms"]],
	calcChanges : {
		atkAdd : [
			function (fields, v) {
				if ((/firearm/i).test(v.theWea.type) || (/firearm/i).test(v.theWea.list)) {
					fields.Description = fields.Description.replace(/([;,]? ?loading|loading[;,]? ?)/i, '');
				};
			},
			"I ignore the loading quality of firearms.",
		],
	},
	descriptionFull : "Thanks to extensive practice with firearms, you gain the following benefits: \n \u2022 Ability Score Increase. Increase your Dexterity score by 1, to a maximum of 20. \n \u2022 Ignore Loading. You ignore the Loading property of firearms. \n \u2022 Firing in Melee. Being within 5 feet of an enemy doesn’t impose Disadvantage on your Attack Rolls with firearms.",
	description : " \u2022 Ability Score Increase. My Dexterity increases by 1, to a max of 20. \n \u2022 Ignore Loading. I ignore the Loading property of firearms. \n \u2022 Firing in Melee. Being within 5 feet of an enemy doesn’t impose Disadvantage on my Attack Rolls with firearms.",
};

// 20th Lvl (Epic Boon) Feats
FeatsList["epic boon of combat prowess ua22xc"] = {
	name : "Epic Boon of Combat Prowess (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 18]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert or Warrior Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.barbarian || classes.known.barbarian_ua23pt8 || classes.known.fighter || classes.known.fighter_ua23pt7 || classes.known.monk || classes.known.monk_ua23pt8 || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6);
	},
	description : "When I miss with a Melee Attack, I can hit instead. Once I use this benefit, I can’t use it again until I roll Initiative.",
};
FeatsList["epic boon of fortitude ua22xc"] = {
	name : "Epic Boon of Fortitude (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 18]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+",
	prereqeval : function(v) {
		return v.characterLevel >=20;
	},
	calcChanges : {
		hp : function (totalHD) {
			return [totalHD + 40, '\n + ' + totalHD + ' + 40 from Epic Boon of Fortitude (' + (totalHD + 40) + ')', true];
		},
	},
	description : "My Hit Point Maximum increases by 40. In addition, whenever I regain Hit Points, I regain additional Hit Points equal to my Constitution Modifier. I can regain these additional Hit Points no more than once per round.",
};
FeatsList["epic boon of luck ua22xc"] = {
	name : "Epic Boon of Luck (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 18]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6);
	},
	description : "Immediately after I roll a d20 for a d20 Test, I can roll a d10 and add the number rolled to the test. Once I use this benefit, I can’t use it again until I roll Initiative or finish a Short Rest or a Long Rest.",
};
FeatsList["epic boon of peerless aim ua22xc"] = {
	name : "Epic Boon of Peerless Aim (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 18]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert or Warrior Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.barbarian || classes.known.barbarian_ua23pt8 || classes.known.fighter || classes.known.fighter_ua23pt7 || classes.known.monk || classes.known.monk_ua23pt8 || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6);
	},
	description : "If I make a Ranged Attack against a target in range and miss, I can cause the attack to hit instead. Once I use this benefit, I can’t use it again until I roll Initiative.",
};
FeatsList["epic boon of skill proficiency ua22xc"] = {
	name : "Epic Boon of Skill Proficiency (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 19]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+",
	prereqeval : function(v) {
		return v.characterLevel >=20;
	},
	skills : [
		"Acrobatics",
		"Animal Handling",
		"Arcana",
		"Athletics",
		"Deception",
		"History",
		"Insight",
		"Intimidation",
		"Investigation",
		"Medicine",
		"Nature",
		"Perception",
		"Performance",
		"Persuasion",
		"Religion",
		"Sleight of Hand",
		"Stealth",
		"Survival",
	],
	skillstxt : "Proficiency with all skills",
	description : "I gain Proficiency in all Skills.",
};
FeatsList["epic boon of undetectability ua22xc"] = {
	name : "Epic Boon of Undetectability (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 19]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6);
	},
	description : "I can’t be seen or heard by any means — magical or nonmagical — while I are Hidden.",
};
FeatsList["epic boon of the unfettered ua22xc"] = {
	name : "Epic Boon of the Unfettered (UA22XC)",
	source : [["MJ:HB", 0], ["UA22XC", 19]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert or Warrior Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.barbarian || classes.known.barbarian_ua23pt8 || classes.known.fighter || classes.known.fighter_ua23pt7 || classes.known.monk || classes.known.monk_ua23pt8 || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6);
	},
	action : [
		["bonus action", "Disengage"],
	],
	description : "As a Bonus Action, I can take the Disengage Action, which also ends the Grappled and the Restrained Conditions on me.",
};

//// >>>>>>>>>>>>>>>>>>> ////
//// >>> UA22XC Bard >>> ////
//// >>>>>>>>>>>>>>>>>>> ////

/*	-SCRIPT AUTHOR NOTE-
	This Bard is the version that appeared in the UA22XC article. Due to the removal of the Arcane, Divine, &
	Primal Spell Lists from playtesting, this Bard has been altered to adhere to the spellcasting rules of later
	articles.
	Some of the code references spells that appear in later UA articles.
*/

// Add UA22XC Bard class
ClassList.bard_ua22xc = {
	name : "Bard (UA:XC)",
	regExpSearch : /(bard|minstrel|troubadour)/i,
	source : [["UA22XC", 3], ["MJ:HB", 0]],
	primaryAbility : "Charisma",
	prerequisite : "Charisma 13+",
	prereqeval : function(v) {
		return What('Cha') >= 13;
	},
	die : 8,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
	saves : ["Dex", "Cha"],
	skills : ["\n\n" + toUni("Bard") + ": Choose any three skills of my choice.", "Choose any one skill of my choice."],
	toolProfs : {
		primary : [["Musical instrument", 3]],
		secondary : [["Musical instrument", 1]],
	},
	armor : [
		[true, false, false, false],
		[true, false, false, false],
	],
	weapons : [
		[true, false, [""]],
		[true, false, [""]],
	],
	equipment : "Cleric starting equipment:" +
		"\n \u2022 Leather Armor," +
		"\n \u2022 Dagger," +
		"\n \u2022 Entertainer's Pack," +
		"\n \u2022 Musical Instrument of my choice," +
		"\n \u2022 Shortsword," +
		"\n \u2022 and 18 gp;" +
		"\n\nAlternatively, choose 100 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Bard College", []],
	attacks : [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,],
	abilitySave : 6,
	spellcastingFactor : 1,
	spellcastingKnown : {
		cantrips : [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
		spells : "list",
		prepared : true,
	},
	spellcastingList : {
		class : ["bard"],
	},
	features : {
		"bardic inspiration ua22xc" : { //Ripped directly from "ListClasses.js" and then heavily altered
			name : "Bardic Inspiration",
			source : [["UA22XC", 4], ["SRD", 12], ["P", 53], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				" \u2022 Boost a d20 Test. As a Reaction, when another creature within 60 ft that I can see/hear",
				"  fails a d20 Test, I can give that creature an Inspiration die. The creature adds the result of",
				"  that die to their d20 Test result, potentially turning a failure into a success.",
				" \u2022 Heal. Immediately after another creature within 60 ft that I can see/hear takes damage,",
				"  I can use my Reaction to roll my Inspiration die \u0026 restore the resulting number of HP to the creature.",
			]),
			additional : ["d6", "d6", "d6", "d6", "d8", "d8", "d8", "d8", "d8", "d10", "d10", "d10", "d10", "d10", "d12", "d12", "d12", "d12", "d12", "d12"],
			limfeaname : "Bard Insp.",
			usages : "Prof. Bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : levels.map(function (n) {
				return n < 7 ? "long rest" : "short rest";
			}),
			action : [
				["reaction", " (d20 Boost)"],
				["reaction", " (Heal)"],
			],
		},
		"spellcasting ua22xc" : { //Ripped directly from the Cleric class in "UA2023PT6 Content [by MasterJedi2014] V4.js" and then altered
			name : "Spellcasting",
			source : [["UA22XC", 5], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can cast prepared bard cantrips/spells, using Charisma as my spellcasting ability.",
				"I can use a musical instrument as a spellcasting focus for my bard spells.",
				"I can cast my prepared bard spells as rituals if they have the ritual tag.",
			]),
			additional : levels.map(function (n, idx) {
				return [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5][idx] + " cantrips known";
			}),
			calcChanges : {
				spellList : [
					function(spList, spName, spType) {
						// Stop this is not the class' spell list or if this is for a bonus spell entry
						if (spName !== "bard" && spType.indexOf("bonus") !== -1) return;
						spList.extraspells = spList.extraspells.concat(["mass healing word"]);
					},
					"Adds the \"Mass Healing Word\" spell to the bard class' spell list.",
					101,
				]
			},
		},
		"expertise ua22xc" : function() { //Ripped directly from "ListClasses.js" and then altered
			var a = {
				name : "Expertise",
				source : [["UA22XC", 5], ["SRD", 13], ["P", 54], ["MJ:HB", 0]],
				minlevel : 2,
				description : desc("I gain expertise with two skills I am proficient with; two more at 9th level"),
				skillstxt : "Expertise with any two skill proficiencies, and two more at 9th level",
				additional : levels.map(function (n) {
					return n < 2 ? "" : "with " + (n < 9 ? 2 : 4) + " skills";
				}),
				extraname : "Bard Expertise",
				extrachoices : ["Acrobatics", "Animal Handling", "Arcana", "Athletics", "Deception", "History", "Insight", "Intimidation", "Investigation", "Medicine", "Nature", "Perception", "Performance", "Persuasion", "Religion", "Sleight of Hand", "Stealth", "Survival"],
				extraTimes : levels.map(function (n) { return n < 2 ? 0 : n < 9 ? 2 : 4; })
			};
			for (var i = 0; i < a.extrachoices.length; i++) {
				var attr = a.extrachoices[i].toLowerCase();
				a[attr] = {
					name : a.extrachoices[i] + " Expertise",
					description : "",
					source : a.source,
					skills : [[a.extrachoices[i], "only"]],
					prereqeval : function(v) {
						return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
					}
				};
			}
			return a;
		}(),
		"songs of restoration 1 ua22xc" : {
			name : "Songs of Restoration 1",
			source : [["UA22XC", 5], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"I have learned how to use music, poetry, \u0026 dance to heal wounds and maladies.",
				"I know the spell Healing Word, \u0026 it doesn't count against the number of spells I can prepare.",
				"I'll learn additional spells at Bard Levels 4, 6, 8, \u0026 10.",
			]),
			spellChanges : {
				"healing word" : {
					firstCol : "markedbox",
					changes : "I know the spell Healing Word, \u0026 it doesn't count against the number of spells I can prepare.",
				},
				"healing word ua23pt8" : {
					firstCol : "markedbox",
					changes : "I know the spell Healing Word (UA23PT8), \u0026 it doesn't count against the number of spells I can prepare.",
				},
			},
		},
		"subclassfeature3" : { //Ripped directly from "ListClasses.js"
			name : "Bard College",
			source : [["UA22XC", 5], ["SRD", 12], ["P", 54]],
			minlevel : 3,
			description : desc('Choose a College that reflects your personality and put it in the "Class" field ')
		},
		"songs of restoration 2 ua22xc" : {
			name : "Songs of Restoration 2",
			source : [["UA22XC", 5], ["MJ:HB", 0]],
			minlevel : 4,
			description : desc([
				"I know the spell Lesser Restoration, \u0026 it doesn't count against the number of spells I can prepare.",
			]),
			spellChanges : {
				"lesser restoration" : {
					firstCol : "markedbox",
					changes : "I know the spell Lesser Restoration, \u0026 it doesn't count against the number of spells I can prepare.",
				},
			},
		},
		"jack of all trades ua22xc" : { //Ripped directly from "ListClasses.js"
			name : "Jack of All Trades",
			source : [["UA22XC", 5], ["SRD", 12], ["P", 54]],
			minlevel : 5,
			description : desc("I can add half my Proficiency Bonus to any ability check that doesn't already include it"),
			eval : function() { Checkbox('Jack of All Trades', true); },
			removeeval : function() { Checkbox('Jack of All Trades', false); }
		},
		"songs of restoration 3 ua22xc" : {
			name : "Songs of Restoration 3",
			source : [["UA22XC", 5], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"I know the spell Mass Healing Word, \u0026 it doesn't count against the number of spells I can prepare.",
			]),
			spellChanges : {
				"mass healing word" : {
					firstCol : "markedbox",
					changes : "I know the spell Mass Healing Word, \u0026 it doesn't count against the number of spells I can prepare.",
				},
				"mass healing word ua23pt8" : {
					firstCol : "markedbox",
					changes : "I know the spell Mass Healing Word (UA23PT8), \u0026 it doesn't count against the number of spells I can prepare.",
				},
			},
		},
		"font of bardic inspiration ua22xc" : { //Ripped directly from "ListClasses.js"
			name : "Font of Bardic Inspiration",
			source : [["UA22XC", 5], ["SRD", 13], ["P", 54]],
			minlevel : 7,
			description : desc("I can now also recover my expended Bardic Inspiration uses after a short rest")
		},
		"songs of restoration 4 ua22xc" : {
			name : "Songs of Restoration 4",
			source : [["UA22XC", 5], ["MJ:HB", 0]],
			minlevel : 8,
			description : desc([
				"I know the spell Freedom of Movement, \u0026 it doesn't count against the number of spells I can prepare.",
			]),
			spellChanges : {
				"freedom of movement" : {
					firstCol : "markedbox",
					changes : "I know the spell Freedom of Movement, \u0026 it doesn't count against the number of spells I can prepare.",
				},
			},
		},
		"songs of restoration 5 ua22xc" : {
			name : "Songs of Restoration 5",
			source : [["UA22XC", 5], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"I know the spell Greater Restoration, \u0026 it doesn't count against the number of spells I can prepare.",
			]),
			spellChanges : {
				"greater restoration" : {
					firstCol : "markedbox",
					changes : "I know the spell Greater Restoration, \u0026 it doesn't count against the number of spells I can prepare.",
				},
			},
		},
		"magical secrets ua22xc" : { //Ripped directly from "ListClasses.js" and then altered
			name : "Magical Secrets",
			source : [["UA22XC", 6], ["SRD", 13], ["P", 54], ["MJ:HB", 0]],
			minlevel : 11,
			description : desc("I can add two spells/cantrips from any class to my spells prepared/known; +2 more at level 15"),
			additional : levels.map(function (n) {
				return n < 11 ? "" : (n < 15 ? 2 : 4) + " spells/cantrips";
			}),
			spellcastingBonus : {
				name : "Magical Secret",
				"class" : "any",
				times : levels.map(function (n) {
					return n < 11 ? 0 : n < 15 ? 2 : 4;
				}),
			},
		},
		"superior bardic inspiration ua22xc" : { //Ripped directly from "ListClasses.js" and then altered
			name : "Superior Bardic Inspiration",
			source : [["UA22XC", 6], ["SRD", 13], ["P", 54], ["MJ:HB", 0]],
			minlevel : 18,
			description : desc("I regain two uses of Bardic Inspiration when I roll initiative"),
		},
		"epic boon ua22xc" : {
			name : "Epic Boon",
			source : [["UA22XC", 6], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"I gain the Epic Boon of Luck Feat or another Epic Boon Feat of my choice.",
			]),
			eval : function() { AddFeat("Epic Boon of Luck (UA22XC)"); },
		},
	},
};

//// Add Bard optional choices; Ripped directly from "all_WotC_pub+UA.js" and then altered
AddFeatureChoice(ClassList.bard_ua22xc.features["spellcasting ua22xc"], true, "Access to Dunamancy Spells", {
	name : "Dunamancy Spells",
	extraname : "Optional Bard 1",
	source : [["W", 186]],
	description : desc([
		"All dunamancy spells are added to the bard spell list, each still pending DM's approval"
	]),
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "bard" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["sapping sting", "gift of alacrity", "magnify gravity", "fortune's favor", "immovable object", "wristpocket", "pulse wave", "gravity sinkhole", "temporal shunt", "gravity fissure", "tether essence", "dark star", "reality break", "ravenous void", "time ravage"]);
			},
			"This optional class feature expands the spell list of the bard class with all dunamancy spells (spell level in brackets): Sapping Sting (cantrip), Gift of Alacrity (1), Magnify Gravity (1), Fortune's Favor (2), Immovable Object (2), Wristpocket (2), Pulse Wave (3), Gravity Sinkhole (4), Temporal Shunt (5), Gravity Fissure (6), Tether Essence (7), Dark Star (8), Reality Break (8),Ravenous Void (9), and Time Ravage (9)."
		]
	}
}, "Optional 1st-level bard features");
AddFeatureChoice(ClassList.bard_ua22xc.features["spellcasting ua22xc"], true, "Additional Bard Spells", {
	name : "Additional Bard Spells",
	source : [["T", 27]],
	extraname : "Optional Bard 1",
	description : "",
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "bard" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["color spray", "command", "aid", "aid ua22cs", "enlarge/reduce", "mirror image", "slow", "phantasmal killer", "rary's telepathic bond", "heroes' feast", "prismatic spray", "antipathy/sympathy", "prismatic wall"]);
			},
			"This optional class feature expands the spell list of the bard class with the following spells (spell level in brackets): Color Spray (1), Command (1), Aid (2), Enlarge/Reduce (2), Mirror Image (2), Slow (3), Phantasmal Killer (4), Rary's Telepathic Bond (5), Heroes' Feast (6), Prismatic Spray (7), Antipathy/Sympathy (8), and Prismatic Wall (9)."
		]
	}
}, "Optional 1st-level bard features");
AddFeatureChoice(ClassList.bard_ua22xc.features["songs of restoration 2 ua22xc"], true, "Bardic Versatility", {
	name : "Bardic Versatility",
	extraname : "Optional Bard 4",
	source : [["T", 28]],
	description : " [ASI = Ability Score Improvement]" + desc([
		"Whenever I gain an ASI from the bard class, I can change one cantrip or expertise choice",
		"I can select another cantrip from the bard spell list or another skill I'm proficient with"
	]),
	prereqeval : function (v) { return classes.known.bard_ua22xc.level >= 4 ? true : "skip"; }
}, "Optional 4th-level bard features");

//// Add "UA 2019: Class Feature Variants" Bard optional choices; Ripped directly from "all_WotC_pub+UA.js" and then altered
AddFeatureChoice(ClassList.bard_ua22xc.features["spellcasting ua22xc"], true, "Spell Versatility (ua)", {
	name : "Spell Versatility",
	extraname : "Optional Bard 1",
	source : [["UA:CFV", 3]],
	description : "\n   After a long rest, I can swap a bard cantrip or spell I know for another of the same level"
}, "Optional 1st-level bard features");
AddFeatureChoice(ClassList.bard_ua22xc.features["spellcasting ua22xc"], true, "Expanded Spell List (ua)", {
	name : "Expanded Bard Spell List",
	extraname : "Optional Bard 1",
	source : [["UA:CFV", 3]],
	description : "",
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "bard" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["cause fear", "color spray", "command", "aid", "enlarge/reduce", "mind spike", "mirror image", "phantasmal force", "mass healing word", "slow", "tiny servant", "phantasmal killer", "contact other plane", "rary's telepathic bond", "heroes' feast", "mental prison", "scatter", "tenser's transformation", "power word pain", "prismatic spray", "antipathy/sympathy", "maze", "prismatic wall"]);
			},
			"This alternative class feature enhancement expands the spell list of the bard class with the following spells (spell level in brackets): Cause Fear (1), Color Spray (1), Command (1), Aid (2), Enlarge/Reduce (2), Mind Spike (2), Mirror Image (2), Phantasmal Force (2), Mass Healing Word (3), Slow (3), Tiny Servant (3), Phantasmal Killer (4), Contact Other Plane (5), Rary's Telepathic Bond (5), Heroes' Feast (6), Mental Prison (6), Scatter (6), Tenser's Transformation (6), Power Word Pain (7), Prismatic Spray (7), Antipathy/Sympathy (8), Maze (8), and Prismatic Wall (9)."
		]
	}
}, "Optional 1st-level bard features");

////// Add UA22XC College of Lore Bard subclass
AddSubClass("bard_ua22xc", "college of lore_ua22xc", {
	regExpSearch : /^(college|bard|minstrel|troubadour)(?=.*lore).*$/i,
	subname : "College of Lore",
	source : [["UA22XC", 7], ["SRD", 13], ["P", 54], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : { //Ripped directly from "ListClasses.js" and then heavily altered
			name : "Bonus Proficiencies",
			source : [["UA22XC", 7], ["SRD", 13], ["P", 54], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I gain Proficiency with Arcana, History, \u0026 Nature. If I am already Proficient in one of those,",
				"  I gain Proficiency with another Skill of my choice.",
			]),
			skills : [
				"Arcana",
				"History",
				"Nature",
			],
			skillstxt : "Proficiency with Arcana, History, \u0026 Nature. Choose another if already Proficient in one.",
		},
		"subclassfeature3.1" : { //Ripped directly from "ListClasses.js" and then altered
			name : "Cutting Words",
			source : [["UA22XC", 7], ["SRD", 13], ["P", 54], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a reaction, when a foe within earshot & 60 ft rolls ability check, attack or damage,",
				"  I can subtract a Bardic Inspiration die from the result."
			]),
			action : ["reaction", ""]
		},
		"subclassfeature6" : {
			name : "Cunning Inspiration",
			source : [["UA22XC", 7], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"My Bardic Inspiration die are rolled with Advantage.",
			]),
		},
		"subclassfeature10" : {
			name : "Improved Cutting Words",
			source : [["UA22XC", 7], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"When I use my Cunning WOrds feature, I can deal Psychic Damage equal to the number rolled on",
				"  the Bardic Inspiration die + my Charisma modifier.",
			]),
		},
		"subclassfeature14" : { //Ripped directly from "ListClasses.js" and then altered
			name : "Peerless Skill",
			source : [["UA22XC", 7], ["SRD", 14], ["P", 55], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"When making an ability check, I can expend a use of Bardic Inspiration to add the die.",
				"If the check still fails, the Bardic Inspiration isn't expended.",
			]),
		},
	},
});

//// >>>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA22CS Species >>> ////
//// >>>>>>>>>>>>>>>>>>>>>> ////

// Ardlings
RaceList["ardling ua22cs"] = {
	regExpSearch : /^(?=.*ardling).*$/i,
	name : "Ardling (UA22CS)",
	plural : "Ardlings",
	source : [["UA22CS", 8], ["MJ:HB", 0]],
	size : 3,
	speed : {
		walk : { spd : 30, enc : 20 },
	},
	languageProfs : ["Common"],
	skills : ["Perception"],
	skillstxt : "Proficiency with Perception.",
	age : " reach adulthood in their late teens and live about 200 years on average.",
	height : " range from 3' to 7 ft tall (2'11\" + 6d8\")",
	weight : " typically weigh 174 lb (75 + 6d8 \xD7 1d4 lb)",
	heightMetric : " range from .91 to about 2.11 metres tall (89 + 12d10 cm)",
	weightMetric : " typically weigh around 79 kg (34 + 6d8 \xD7 5d4 / 10 kg)",
	trait : "Ardling:\n   Animal Ancestry: Choose a type of ardling using the \"Racial Options\" button.\n\n   Divine Magic: I know one Cantrip from the Cleric or Druid Spell List (Thaumaturgy by default), and can swap it with another after a Long Rest.\n   Intelligence, Wisdom, or Charisma is my spellcasting ability for any Spell I cast with this trait (choose the ability when I select the Species).\n\n   Keen Senses: I have Proficiency in the Perception Skill.",
	spellcastingAbility : [4, 5, 6],
	spellcastingBonus : {
		name : "Divine Magic",
		"class" : ["cleric", "cleric ua23pt6", "druid", "druid ua23pt8"],
		selection : ["thaumaturgy"],
		level : [0, 0],
		firstCol : 'atwill',
	},
};
AddRacialVariant("ardling ua22cs", "climber", {
	regExpSearch : /^(?=.*climber).*$/i,
	name : "Climber Ardling (UA22CS)",
	sortname : "Ardling, Climber (UA22CS)",
	plural : "Ardlings",
	source : [["UA22CS", 8], ["MJ:HB", 0]],
	speed : {
		climb : { spd : 30, enc : 20 },
	},
	trait : "Climber Ardling:\n   Animal Ancestry: I am descended from a Celestial animal, and my head resembles the head of either a Bear, Cat, Lizard, or Squirrel.\nI have hooked claws, sharp nails, or a serpentine tail, giving me a Climb Speed equal to my Speed. Once per turn, I can deal my Proficiency Bonus in damage when I hit with a Unarmed Strike.\n\n   Divine Magic: I know one Cantrip from the Cleric or Druid Spell List (Thaumaturgy by default), and can swap it with another after a Long Rest.\n   Intelligence, Wisdom, or Charisma is my spellcasting ability for any Spell I cast with this trait (choose the ability when I select the Species).\n\n   Keen Senses: I have Proficiency in the Perception Skill.",
});
AddRacialVariant("ardling ua22cs", "flyer", {
	regExpSearch : /^(?=.*flyer).*$/i,
	name : "Flyer Ardling (UA22CS)",
	sortname : "Ardling, Flyer (UA22CS)",
	plural : "Ardlings",
	source : [["UA22CS", 8], ["MJ:HB", 0]],
	action : [
		["reaction", "Negate fall dmg (fall ≥ 3m(10'))"],
	],
	savetxt : {
		text : "Adv. on Ability Checks made during the Jump Action",
	},
	trait : "Flyer Ardling:\n   Animal Ancestry: I am descended from a Celestial animal, and my head resembles the head of either a Bat, Eagle, Owl, or Raven.\nI have vestigial wings, allowing me to use my Reaction to negate fall damage for falls higher than 3m (10 ft). I can also use my wings to gain Advantage on Ability Checks made during the Jump Action.\n\n   Divine Magic: I know one Cantrip from the Cleric or Druid Spell List (Thaumaturgy by default), and can swap it with another after a Long Rest.\n   Intelligence, Wisdom, or Charisma is my spellcasting ability for any Spell I cast with this trait (choose the ability when I select the Species).\n\n   Keen Senses: I have Proficiency in the Perception Skill.",
});
AddRacialVariant("ardling ua22cs", "racer", {
	regExpSearch : /^(?=.*racer).*$/i,
	name : "Racer Ardling (UA22CS)",
	sortname : "Ardling, Racer (UA22CS)",
	plural : "Ardlings",
	source : [["UA22CS", 8], ["MJ:HB", 0]],
	trait : "Racer Ardling:\n   Animal Ancestry: I am descended from a Celestial animal, and my head resembles the head of either a Deer, Dog, Horse, or Triceratops.\nWhen I take the Dash Action, my Speed increases by an amount equal to 10 times my Proficiency Bonus.\n\n   Divine Magic: I know one Cantrip from the Cleric or Druid Spell List (Thaumaturgy by default), and can swap it with another after a Long Rest.\n   Intelligence, Wisdom, or Charisma is my spellcasting ability for any Spell I cast with this trait (choose the ability when I select the Species).\n\n   Keen Senses: I have Proficiency in the Perception Skill.",
});
AddRacialVariant("ardling ua22cs", "swimmer", {
	regExpSearch : /^(?=.*swimmer).*$/i,
	name : "Swimmer Ardling (UA22CS)",
	sortname : "Ardling, Swimmer (UA22CS)",
	plural : "Ardlings",
	source : [["UA22CS", 8], ["MJ:HB", 0]],
	speed : {
		swim : { spd : 30, enc : 20 },
	},
	dmgres : ["Cold"],
	trait : "Swimmer Ardling:\n   Animal Ancestry: I am descended from a Celestial animal, and my head resembles the head of either a Crocodile, Dolphin, Frog, or Shark.\nI can hold my breath for up to an hour at a time, I have a Swim Speed equal to my Speed. I'm also Resistant to Cold Damage.\n\n   Divine Magic: I know one Cantrip from the Cleric or Druid Spell List (Thaumaturgy by default), and can swap it with another after a Long Rest.\n   Intelligence, Wisdom, or Charisma is my spellcasting ability for any Spell I cast with this trait (choose the ability when I select the Species).\n\n   Keen Senses: I have Proficiency in the Perception Skill.",
});

// Dragonborn; Credit to the author of the FToD Dragonborn entry in "all_WotC_pub+UA.js" as the foundation from which this UA version is built on. Spliced into this RaceList object are aspects from the Dragonborn entry in "ListsRaces.js" & descriptions from UA22CS.
var UA22CS_dragonborns_add = function () {
	var objDragonborns = {
		"Chromatic UA" : {
			regExpSearch : /^(?=.*chromatic)(?=.*dragonborn).*$/i,
			source : [["UA22CO", 9], ["MJ:HB", 0]],
			variants : [["Black", "Acid"], ["Blue", "Lightning"], ["Green", "Poison"], ["Red", "Fire"], ["White", "Cold"]],
			breathWeaponShape : "See description",
			trait : desc([
				">>TYPE<< Breath Weapon: When I take the Attack action on my turn, I can replace one attack with a breath weapon that deals 1d10 >>type<< damage to all in either a 5-ft by 30-ft line or a 15-ft cone, Dex save halves (DC 8 + Con mod + Proficiency Bonus). I can do this my Proficiency Bonus per long rest. The damage increases with +1d10 at 5th, 11th, and 17th level.",
				"Draconic Flight: From 5th level, I can manifest spectral wings. As a Bonus Action once per Long Rest, I can gain, for 10 minutes, a Fly Speed equal to my Speed."
			], "\n \u2022 "),
			features : {
				"draconic flight" : {
					name : "Draconic Flight",
					source : [["UA22CO", 9], ["MJ:HB", 0]],
					minlevel : 5,
					usages : 1,
					recovery : "long rest",
					action : [["bonus action", ""]]
				}
			}
		},
		"Gem UA" : { // Included for the following reasons. 1: The FToD code that this is based on has Gem dragonborn & I don't want to accidentally break the code by removing this. 2: The UA Metallic & Chromatic dragonborn are functionally identical, so the Gem dragonborn probably are as well.
			regExpSearch : /^(?=.*gem)(?=.*dragonborn).*$/i,
			source : [["UA22CO", 9], ["MJ:HB", 0]],
			variants : [["Amethyst", "Force"], ["Crystal", "Radiant"], ["Emerald", "Psychic"], ["Sapphire", "Thunder"], ["Topaz", "Necrotic"]],
			breathWeaponShape : "See description",
			trait : desc([
				">>TYPE<< Breath Weapon: When I take the Attack action on my turn, I can replace one attack with a breath weapon that deals 1d10 >>type<< damage to all in either a 5-ft by 30-ft line or a 15-ft cone, Dex save halves (DC 8 + Con mod + Proficiency Bonus). I can do this my Proficiency Bonus per long rest. The damage increases with +1d10 at 5th, 11th, and 17th level.",
				"Draconic Flight: From 5th level, I can manifest spectral wings. As a Bonus Action once per Long Rest, I can gain, for 10 minutes, a Fly Speed equal to my Speed."
			], "\n \u2022 "),
			features : {
				"draconic flight" : {
					name : "Draconic Flight",
					source : [["UA22CO", 9], ["MJ:HB", 0]],
					minlevel : 5,
					usages : 1,
					recovery : "long rest",
					action : [["bonus action", ""]]
				}
			}
		},
		"Metallic UA" : {
			regExpSearch : /^(?=.*metallic)(?=.*dragonborn).*$/i,
			source : [["UA22CO", 9], ["MJ:HB", 0]],
			variants : [["Brass", "Fire"], ["Bronze", "Lightning"], ["Copper", "Acid"], ["Gold", "Fire"], ["Silver", "Cold"]],
			breathWeaponShape : "See description",
			trait : desc([
				">>TYPE<< Breath Weapon: When I take the Attack action on my turn, I can replace one attack with a breath weapon that deals 1d10 >>type<< damage to all in either a 5-ft by 30-ft line or a 15-ft cone, Dex save halves (DC 8 + Con mod + Proficiency Bonus). I can do this my Proficiency Bonus per long rest. The damage increases with +1d10 at 5th, 11th, and 17th level.",
				"Draconic Flight: From 5th level, I can manifest spectral wings. As a Bonus Action once per Long Rest, I can gain, for 10 minutes, a Fly Speed equal to my Speed."
			], "\n \u2022 "),
			features : {
				"draconic flight" : {
					name : "Draconic Flight",
					source : [["UA22CO", 9], ["MJ:HB", 0]],
					minlevel : 5,
					usages : 1,
					recovery : "long rest",
					action : [["bonus action", ""]]
				}
			}
		}
	}
	for (var sDrBrn in objDragonborns) {
		var sDrBrnLC = sDrBrn.toLowerCase();
		var oDrBrn = objDragonborns[sDrBrn];
		RaceList[sDrBrnLC + " dragonborn ua22cs"] = {
			regExpSearch : oDrBrn.regExpSearch,
			name : sDrBrn + " Dragonborn (UA22CS)",
			sortname : "Dragonborn (UA22CS), " + sDrBrn,
			source : oDrBrn.source,
			plural : sDrBrn + " Dragonborn",
			size : 3,
			speed : {
				walk : { spd : 30, enc : 20 }
			},
			languageProfs : ["Common"],
			vision : [
				["Darkvision", 60],
			],
			weaponsAdd : ["Breath Weapon"],
			weaponOptions : [{
				regExpSearch : /^(?=.*breath)(?=.*weapon).*$/i,
				name : "Breath weapon",
				source : oDrBrn.source,
				ability : 3,
				type : 'Natural',
				damage : ['C', 10, 'fire'],
				range : oDrBrn.breathWeaponShape.replace('by', '\xD7'),
				description : "5-ft by 30-ft line OR 15-ft cone; Hits all in area; Dex save, success - half damage",
				abilitytodamage : false,
				dc : true,
				dbBreathWeapon : true
			}],
			age : " reach adulthood in their late teens and live less than a century, about 80 years on average.",
			height : " range from 5' to 7' tall (5'6\" + 2d8\")",
			weight : " typically weigh between 230 and 280 lb (175 + 2d8 \xD7 2d6 lb)",
			heightMetric : " range from 1.5 to 2.1 metres tall (160 + 5d8 cm)",
			weightMetric : " typically weigh between 100 and 125 kg (80 + 5d8 \xD7 4d6 / 10 kg)",
			trait : sDrBrn + " Dragonborn (UA22CS)"+
				"\n \u2022 " + sDrBrn + ' Ancestry: Choose a type of dragon using the "Racial Options" button. The damage type of my resistance and my breath weapon are determined by the dragon type chosen.'+
				+ oDrBrn.trait.replace(/>>type<< /ig, ""),
			features : {
				"breath weapon" : {
					name : "Breath Weapon",
					minlevel : 1,
					usages : "Proficiency bonus per ",
					usagescalc : "event.value = How('Proficiency Bonus');",
					recovery : "long rest",
					additional : levels.map(function (n) {
						return (n < 5 ? 1 : n < 11 ? 2 : n < 17 ? 3 : 4) + 'd10';
					}),
					calcChanges : {
						atkAdd : [
							function (fields, v) {
								if (v.theWea.dbBreathWeapon && (/dragonborn/i).test(CurrentRace.known) && CurrentRace.variant) {
									fields.Damage_Type = CurrentRace.dmgres[0];
								}
							},
							'',
							1
						]
					}
				}
			},
			variants : []
		};
		if (oDrBrn.features) {
			for (var sFea in oDrBrn.features) {
				RaceList[sDrBrnLC + " dragonborn ua22cs"].features[sFea] = oDrBrn.features[sFea];
			}
		}
		for (var i = 0; i < oDrBrn.variants.length; i++) {
			var sDrBrnVar = oDrBrn.variants[i][0];
			var sDrBrnDmg = oDrBrn.variants[i][1];
			AddRacialVariant(sDrBrnLC + " dragonborn ua22cs", sDrBrnVar.toLowerCase(), {
				regExpSearch : RegExp(sDrBrnVar, "i"),
				name : sDrBrnVar + " " + sDrBrnLC + " dragonborn ua22cs",
				trait : sDrBrnVar + " " + sDrBrnLC + " dragonborn ua22cs"+
					oDrBrn.trait.replace(/>>TYPE<</g, sDrBrnDmg).replace(/>>type<</g, sDrBrnDmg.toLowerCase()),
				dmgres : [sDrBrnDmg]
			});
		}
	}
}();

// Goliaths
RaceList["goliath ua22cs"] = {
	regExpSearch : /^(?=.*goliath).*$/i,
	name : "Goliath (UA22CS)",
	source : [["UA22CO", 9], ["MJ:HB", 0]],
	plural : "Goliaths",
	size : 3,
	speed : {
		walk : { spd : 35, enc : 25 },
	},
	languageProfs : ["Common"],
	savetxt : {
		text : "Adv. to end Grappled condition on myself",
	},
	age : " reach adulthood in their late teens and live about 80 years on average",
	height : " are between 6 and a half and 8 feet tall (6'2\" + 2d10\")",
	weight : " weigh between 280 and 340 lb (200 + 2d10 \xD7 2d6 lb)",
	heightMetric : " are between 2 and 2.4 metres tall (190 + 5d10 cm)",
	weightMetric : " weigh between 100 and 155 kg (90 + 5d10 \xD7 4d6 / 10 kg)",
	trait : "Goliath:\n   Giant Ancestry: I am descended from Giants, granting me a supernatural boon that I can use a Proficiency Bonus number of times per Long Rest.\n\n   Large Form: At 5th Lvl, I gain the ability change my Size to Large for 10 minutes as a Bonus Action. While I'm Large, I gain Adv. on Str Checks \u0026 my Speed increases by 10 ft.\n\n   Powerful Build: I have Adv. on Saving Throws to end the Grappled condition on myself. Additionally, I count as one Size larger when determining my carrying capacity and the weight I can push, drag, or lift.",
	carryingCapacity : 2,
};
AddRacialVariant("goliath ua22cs", "cloud", {
	regExpSearch : /^(?=.*cloud).*$/i,
	name : "Cloud Goliath (UA22CS)",
	sortname : "Goliath, Cloud (UA22CS)",
	plural : "Goliaths",
	source : [["UA22CS", 9], ["MJ:HB", 0]],
	trait : "Cloud Goliath:\n   Giant Ancestry: I am descended from Cloud Giants, granting me the supernatural ability to Teleport up to 30 ft to an unoccupied space I can see as Bonus Action. I can use this ability a Proficiency Bonus number of times per Long Rest.\n\n   Large Form: At 5th Lvl, I gain the ability change my Size to Large for 10 minutes as a Bonus Action. While I'm Large, I gain Adv. on Str Checks \u0026 my Speed increases by 10 ft.\n\n   Powerful Build: I have Adv. on Saving Throws to end the Grappled condition on myself. Additionally, I count as one Size larger when determining my carrying capacity and the weight I can push, drag, or lift.",
	features : {
		"cloud's jaunt" : {
			name : "Cloud's Jaunt",
			minlevel : 1,
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
			action : [
				["bonus action", "Cloud's Jaunt"],
			],
		},
		"large form" : {
			name : "Large Form",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			action : [
				["bonus action", "Large Form"],
			],
		},
	},
});
AddRacialVariant("goliath ua22cs", "fire", {
	regExpSearch : /^(?=.*fire).*$/i,
	name : "Fire Goliath (UA22CS)",
	sortname : "Goliath, Fire (UA22CS)",
	plural : "Goliaths",
	source : [["UA22CS", 9], ["MJ:HB", 0]],
	trait : "Fire Goliath:\n   Giant Ancestry: I am descended from Fire Giants, granting me the supernatural ability to deal an extra 1d10 Fire damage with my attacks. I can use this ability a Proficiency Bonus number of times per Long Rest.\n\n   Large Form: At 5th Lvl, I gain the ability change my Size to Large for 10 minutes as a Bonus Action. While I'm Large, I gain Adv. on Str Checks \u0026 my Speed increases by 10 ft.\n\n   Powerful Build: I have Adv. on Saving Throws to end the Grappled condition on myself. Additionally, I count as one Size larger when determining my carrying capacity and the weight I can push, drag, or lift.",
	features : {
		"fire's burn" : {
			name : "Fire's Burn (+1d10 Fire Dmg)",
			minlevel : 1,
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
		},
		"large form" : {
			name : "Large Form",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			action : [
				["bonus action", "Large Form"],
			],
		},
	},
});
AddRacialVariant("goliath ua22cs", "frost", {
	regExpSearch : /^(?=.*frost).*$/i,
	name : "Frost Goliath (UA22CS)",
	sortname : "Goliath, Frost (UA22CS)",
	plural : "Goliaths",
	source : [["UA22CS", 9], ["MJ:HB", 0]],
	trait : "Frost Goliath:\n   Giant Ancestry: I am descended from Frost Giants, granting me the supernatural ability to deal an extra 1d6 Cold damage with my attacks \u0026 reduce the target's Speed by 10 ft until the start of my next turn. I can use this ability a Proficiency Bonus number of times per Long Rest.\n\n   Large Form: At 5th Lvl, I gain the ability change my Size to Large for 10 minutes as a Bonus Action. While I'm Large, I gain Adv. on Str Checks \u0026 my Speed increases by 10 ft.\n\n   Powerful Build: I have Adv. on Saving Throws to end the Grappled condition on myself. Additionally, I count as one Size larger when determining my carrying capacity and the weight I can push, drag, or lift.",
	features : {
		"frost's chill" : {
			name : "Frost's Chill (+1d6 Cold Dmg)",
			minlevel : 1,
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
		},
		"large form" : {
			name : "Large Form",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			action : [
				["bonus action", "Large Form"],
			],
		},
	},
});
AddRacialVariant("goliath ua22cs", "hill", {
	regExpSearch : /^(?=.*hill).*$/i,
	name : "Hill Goliath (UA22CS)",
	sortname : "Goliath, Hill (UA22CS)",
	plural : "Goliaths",
	source : [["UA22CS", 9], ["MJ:HB", 0]],
	trait : "Hill Goliath:\n   Giant Ancestry: I am descended from Hill Giants, granting me the supernatural ability to knock the targets of my attacks Prone. I can use this ability a Proficiency Bonus number of times per Long Rest.\n\n   Large Form: At 5th Lvl, I gain the ability change my Size to Large for 10 minutes as a Bonus Action. While I'm Large, I gain Adv. on Str Checks \u0026 my Speed increases by 10 ft.\n\n   Powerful Build: I have Adv. on Saving Throws to end the Grappled condition on myself. Additionally, I count as one Size larger when determining my carrying capacity and the weight I can push, drag, or lift.",
	features : {
		"hill's tumble" : {
			name : "Hill's Tumble",
			minlevel : 1,
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
		},
		"large form" : {
			name : "Large Form",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			action : [
				["bonus action", "Large Form"],
			],
		},
	},
});
AddRacialVariant("goliath ua22cs", "stone", {
	regExpSearch : /^(?=.*stone).*$/i,
	name : "Stone Goliath (UA22CS)",
	sortname : "Goliath, Stone (UA22CS)",
	plural : "Goliaths",
	source : [["UA22CS", 9], ["MJ:HB", 0]],
	trait : "Stone Goliath:\n   Giant Ancestry: I am descended from Stone Giants, granting me the supernatural ability to use my Reaction to reduce damage taken by 1d12 + Con Mod. I can use this ability a Proficiency Bonus number of times per Long Rest.\n\n   Large Form: At 5th Lvl, I gain the ability change my Size to Large for 10 minutes as a Bonus Action. While I'm Large, I gain Adv. on Str Checks \u0026 my Speed increases by 10 ft.\n\n   Powerful Build: I have Adv. on Saving Throws to end the Grappled condition on myself. Additionally, I count as one Size larger when determining my carrying capacity and the weight I can push, drag, or lift.",
	features : {
		"stone's endurance" : {
			name : "Stone's Endurance",
			minlevel : 1,
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
			action : [
				["reaction", "Stone's Endurance [-1d12+Con Dmg]"],
			],
		},
		"large form" : {
			name : "Large Form",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			action : [
				["bonus action", "Large Form"],
			],
		},
	},
});
AddRacialVariant("goliath ua22cs", "storm", {
	regExpSearch : /^(?=.*storm).*$/i,
	name : "Storm Goliath (UA22CS)",
	sortname : "Goliath, Storm (UA22CS)",
	plural : "Goliaths",
	source : [["UA22CS", 9], ["MJ:HB", 0]],
	trait : "Storm Goliath:\n   Giant Ancestry: I am descended from Storm Giants, granting me the supernatural ability to use my Reaction to deal 1d8 Thunder damage to a target within 60 ft that just damaged me. I can use this ability a Proficiency Bonus number of times per Long Rest.\n\n   Large Form: At 5th Lvl, I gain the ability change my Size to Large for 10 minutes as a Bonus Action. While I'm Large, I gain Adv. on Str Checks \u0026 my Speed increases by 10 ft.\n\n   Powerful Build: I have Adv. on Saving Throws to end the Grappled condition on myself. Additionally, I count as one Size larger when determining my carrying capacity and the weight I can push, drag, or lift.",
	features : {
		"storm's thunder" : {
			name : "Storm's Thunder",
			minlevel : 1,
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
			action : [
				["reaction", "Storm's Thunder [1d8 Thunder Dmg]"],
			],
		},
		"large form" : {
			name : "Large Form",
			minlevel : 5,
			usages : 1,
			recovery : "long rest",
			action : [
				["bonus action", "Large Form"],
			],
		},
	},
});

//// >>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA22CS Spells >>> ////
//// >>>>>>>>>>>>>>>>>>>>> ////

/*	-SCRIPT AUTHOR NOTE-
	Due to the ambiguous state these spells are in regarding whether they are still in playtesting or not, all of the below spells are set to be excluded by default.
	The user will need to enable the spells that they want to use/playtest.
*/

// Add spells
SpellsList["aid ua22cs"] = {
	name : "Aid (UA22CS)",
	source : [["UA22CS", 12], ["SRD", 114], ["P", 211], ["MJ:HB", 0]],
	classes : ["artificer", "bard", "bard_ua22xc", "cleric", "cleric_ua23pt6", "paladin", "paladin_ua23pt6", "ranger", "ranger_ua23pt6"],
	defaultExcluded : true,
	level : 2,
	school : "Abjur",
	time : "1 a",
	range : "30 ft",
	rangeMetric : "9 m",
	components : "V,S,M",
	compMaterial : "A tiny strip of white cloth",
	duration : "Instantaneous",
	description : "6 creatures gain 5+5/SL temp HP", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "Your spell bolsters creatures, filling them with resolve. Choose up to six creatures within range. Each target gains 5 Temporary Hit Points." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, the number of Temporary Hit Points increases by 5 for each slot level above 2nd.",
};
SpellsList["banishment ua22cs"] = {
	name : "Banishment (UA22CS)",
	source : [["UA22CS", 16], ["SRD", 120], ["P", 217], ["MJ:HB", 0]],
	classes : ["cleric", "cleric_ua23pt6", "paladin", "paladin_ua23pt6", "sorcerer", "sorcerer_ua23pt7", "warlock", "warlock_ua23pt7", "wizard", "wizard_ua23pt7"],
	defaultExcluded : true,
	level : 4,
	school : "Abjur",
	time : "1 a",
	range : "30 ft",
	rangeMetric : "9 m",
	components : "V,S,M",
	compMaterial : "An item distastful to the target",
	duration : "Conc, 1 min",
	save : "Cha",
	description : "1+1/SL crea save or banished; crea return if spell lasts < 1 min; end of turn save to return early", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "You attempt to send one creature that you can see within range to another plane of existence. The target must succeed on a Charisma Saving Throw or be transported to a harmless demiplane for the duration. The target can willingly fail the save." + "\n   " + "While in the demiplane, the target is Incapacitated. At the end of each of its turns, the target can repeat the save, ending the Spell on itself on a success. When the Spell ends on the target, it reappears in the space it left or in the nearest unoccupied space if that space is occupied." + "\n   " + "If the Spell lasts on the target for 1 minute and the target is an Aberration, a Celestial, an Elemental, a Fey, or a Fiend, the target doesn’t return. It is instead transported to a random location on a plane associated with its Creature Type." + AtHigherLevels + "When you cast this Spell using a Spell Slot of 5th level or higher, you can target one additional creature for each slot level above 4th.",
};
SpellsList["guidance ua22cs"] = {
	name : "Guidance (UA22CS)",
	source : [["UA22CS", 19], ["SRD", 151], ["P", 248], ["MJ:HB", 0]],
	classes : ["artificer", "cleric", "cleric_ua23pt6", "druid", "druid_ua23pt8"],
	defaultExcluded : true,
	level : 0,
	school : "Div",
	time : "1 rea",
	timeFull : "1 reaction, which you take in response to you or an ally within 10 feet of you failing an Ability Check",
	range : "10 ft",
	rangeMetric : "3 m",
	components : "V,S",
	duration : "Instantaneous",
	description : "1 creature (myself included) adds 1d4 to a failed Ability Check", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "You channel magical insight to the creature who failed the Ability Check. That creature can roll a d4 and add the number rolled to the check, potentially turning it into a success.",
};
SpellsList["prayer of healing ua22cs"] = {
	name : "Prayer of Healing (UACS)",
	source : [["UA22CS", 23], ["SRD", 170], ["P", 267], ["MJ:HB", 0]],
	classes : ["cleric", "cleric_ua23pt6", "paladin", "paladin_ua23pt6"],
	defaultExcluded : true,
	level : 2,
	school : "Abjur",
	time : "10 min",
	range : "30 ft",
	rangeMetric : "9 m",
	components : "V",
	duration : "Instantaneous",
	description : "Spell mod willing creatures heal 2d8+1d8/SL HP \u0026 gain Short Rest benefits", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "You utter an extended prayer of restoration. Choose a number of willing creatures equal to your Spellcasting Ability Modifier (minimum of 1). Each of those creatures who remains within range for the Spell’s entire casting gains the benefits of a Short Rest and also regains 2d8 Hit Points, and a creature can’t be affected by this Spell again until that creature finishes a Long Rest." + AtHigherLevels + "When you cast this Spell using a Spell Slot of 3rd level or higher, the healing increases by 1d8 for each slot above 2nd.",
};
SpellsList["resistance ua22cs"] = {
	name : "Resistance (UA22CS)",
	source : [["UA22CS", 25], ["SRD", 175], ["P", 272], ["MJ:HB", 0]],
	classes : ["artificer", "cleric", "cleric_ua23pt6", "druid", "druid_ua23pt8"],
	defaultExcluded : true,
	level : 0,
	school : "Abjur",
	time : "1 rea",
	timeFull : "1 reaction, which you take in response to you or an ally within 10 feet of you failing an Saving Throw",
	range : "10 ft",
	rangeMetric : "3 m",
	components : "V,S",
	duration : "Instantaneous",
	description : "1 creature (myself included) adds 1d4 to a failed Saving Throw", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "You channel magical protection to the creature who failed the Saving Throw. That creature can roll a d4 and add the number rolled to the save, potentially turning it into a success.",
};
SpellsList["spiritual weapon ua22cs"] = {
	name : "Spiritual Weapon (UA22CS)",
	source : [["UA22CS", 25], ["SRD", 182], ["P", 278], ["MJ:HB", 0]],
	classes : ["cleric", "cleric_ua23pt6"],
	defaultExcluded : true,
	level : 2,
	school : "Evoc",
	time : "1 bns",
	range : "60 ft",
	rangeMetric : "18 m",
	components : "V,S",
	duration : "Conc, 1 min",
	description : "Create weapon; spell atk 1d8+1d8/SL+ability modifier Force dmg; bns a to move 20 ft and/or attack", //Ripped directly from "ListsSpells.js" and then altered
	descriptionShorter : "Create wea; spell atk 1d8+1d8/SL+spell modifier Force dmg; bns a move 20 ft and/or atk", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "You create a floating, spectral force that resembles a weapon of your choice and that lasts for the duration. The force appears within range in a space of your choice, and you can immediately make one melee spell attack against a creature within 5 feet of the force. On a hit, the target takes Force Damage equal to 1d8 + your spellcasting ability modifier." + "\n   " + "As a Bonus Action on your later turns, you can move the force up to 20 feet and repeat the attack against a creature within 5 feet of it." + AtHigherLevels + "When you cast this Spell using a Spell Slot of 3rd level or higher, the damage increases by 1d8 for every slot level above 2nd.",
};

// Add version of "Prayer of Healing" spell that is compliant with the updates to healing spells in UA23PT8
SpellsList["prayer of healing ua22cs ua23pt8"] = {
	name : "Prayer of Healing(UACS/PT8)",
	source : [["UA22CS", 23], ["SRD", 170], ["P", 267], ["MJ:HB", 0]],
	classes : ["cleric", "cleric_ua23pt6", "paladin", "paladin_ua23pt6"],
	defaultExcluded : true,
	level : 2,
	school : "Abjur",
	time : "10 min",
	range : "30 ft",
	rangeMetric : "9 m",
	components : "V",
	duration : "Instantaneous",
	description : "Spell mod willing creatures heal 4d8+2d8/SL HP \u0026 gain Short Rest benefits", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "SCRIPT AUTHOR NOTE: Modified to be in alignment with the updates to healing spells in UA23PT8; Changes made amount only to doubling the healing of the spell, with no other changes made." + "\n   " + "You utter an extended prayer of restoration. Choose a number of willing creatures equal to your Spellcasting Ability Modifier (minimum of 1). Each of those creatures who remains within range for the Spell’s entire casting gains the benefits of a Short Rest and also regains 4d8 Hit Points, and a creature can’t be affected by this Spell again until that creature finishes a Long Rest." + AtHigherLevels + "When you cast this Spell using a Spell Slot of 3rd level or higher, the healing increases by 2d8 for each slot above 2nd.",
};

//// >>>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA23DP Content >>> ////
//// >>>>>>>>>>>>>>>>>>>>>> ////

// Add "Find Familiar (UA23DP)" spell
SpellsList["find familiar ua23dp"] = {
	name : "Find Familiar (UA23DP)",
	source : [["UA23DP", 18], ["MJ:HB", 0]],
	classes : ["wizard", "wizard_ua23pt7"],
	level : 1,
	school : "Conj",
	time : "1 h",
	range : "10 ft",
	rangeMetric : "3 m",
	components : "V,S,M\u2020",
	compMaterial : "10 GP worth of charcoal, incense, and herbs that must be consumed by fire in a brass brazier",
	duration : "Instantaneous",
	description : "Gain a familiar; can see through its eyes; it can deliver touch spells; can be upcast; see B (10gp cons.)",
	descriptionFull : "You gain the service of an otherworldly spirit, which manifests as a little animal in an unoccupied space of your choice within range. This creature uses the Otherworldly Familiar stat block. If you already have a familiar from this spell, that familiar transforms into the new one but retains its memories; you don’t get a second familiar." + "\n   " + "Whenever you cast the spell, choose the familiar’s creature type: Celestial, Fey, or Fiend. Also choose an environment: Air, Land, or Water. The familiar resembles a Tiny animal of your choice—such as an owl, a cat, or a frog—that is native to the chosen environment. Both choices—creature type and environment—determine certain traits in the stat block." + "\n   " + "Combat. The familiar is an ally to you and your companions. In combat, it shares your initiative count, but it takes its turn immediately after yours. It obeys your commands (no action required by you), but the familiar can’t attack unless you use your Reaction on its turn to command it do so. If you don’t issue any commands, the familiar takes the Dodge action and uses its Move to avoid danger." + "\n   " + "Disappearance of the Familiar. The familiar disappears if it drops to 0 Hit Points, if you dismiss it as a Bonus Action, or if you die. When it disappears, it leaves behind anything it was wearing or carrying. If you cast this spell again, you decide whether you summon the familiar that disappeared or a different one." + "\n   " + "Remote Viewing. As a Magic action, you can see what your familiar sees and hear what it hears until the end of your next turn." + "\n   " + "At Higher Levels. When you cast this spell using a Spell Slot of 2nd level or higher, use the higher level wherever the spell’s level appears in the stat block.",
	ritual : true,
};

// Add UA23DP Familiar companion template
CompanionList.familiar_ua23dp = {
	name : "Find Familiar (UA23DP)",
	nameMenu : "Familiar (Find Familiar UA23DP spell)",
	nameTooltop : "from the Find Familiar (UA23DP) Spell",
	nameOrigin : "1st-Level conjuration [ritual] spell",
	source : [["UA23DP", 18], ["MJ:HB", 0]],
	action : [["reaction", " (Attack command)"]],
	includeCheck : function(sCrea, objCrea, iCreaCR) {
		return /^(otherworldly)$/i.test(sCrea);
	},
	notes : [{
		name : "Spell Description",
		description : "You gain the service of an otherworldly spirit, which manifests as a little animal in an unoccupied space of your choice within range. This creature uses the Otherworldly Familiar stat block. If you already have a familiar from this spell, that familiar transforms into the new one but retains its memories; you don’t get a second familiar." + "\n   " + "Whenever you cast the spell, choose the familiar’s creature type: Celestial, Fey, or Fiend. Also choose an environment: Air, Land, or Water. The familiar resembles a Tiny animal of your choice—such as an owl, a cat, or a frog—that is native to the chosen environment. Both choices—creature type and environment—determine certain traits in the stat block.",
		joinString : "\n   "
	}, {
		name : "Variable Speed",
		description : "The Otherworldly Familiar's Speed changes based on whether it is a Land, Air, or Water Familiar:\n      Land Familiars gain a 30 ft (9m) Climb Speed; Air Familiars gain a 30 ft (9m) Fly Speed; Water Familiars gain a 30 ft (9m) Swim Speed.",
		joinString : "\n   "
	}, {
		name : "Combat",
		description : "The familiar is an ally to you and your companions. In combat, it shares your initiative count, but it takes its turn immediately after yours. It obeys your commands (no action required by you), but the familiar can’t attack unless you use your Reaction on its turn to command it do so. If you don’t issue any commands, the familiar takes the Dodge action and uses its Move to avoid danger.",
		joinString : "\n   "
	}, {
		name : "Disappearance of the Familiar",
		description : "The familiar disappears if it drops to 0 Hit Points, if you dismiss it as a Bonus Action, or if you die. When it disappears, it leaves behind anything it was wearing or carrying. If you cast this spell again, you decide whether you summon the familiar that disappeared or a different one.",
		joinString : "\n   "
	}, {
		name : "Remote Viewing",
		description : "As a Magic action, you can see what your familiar sees and hear what it hears until the end of your next turn.",
		joinString : "\n   "
	}, {
		name : "At Higher Levels",
		description : "When you cast this spell using a Spell Slot of 2nd level or higher, use the higher level wherever the spell’s level appears in the stat block." + "\n   " + "The familiar's HP, AC, & Damage change depending on the level the Find Familiar (UA23DP) spell was cast at:" + "\n      " + "- HP total equals 2 + 2 per spell level; the Otherworldly Familiar has a number of Hit DIce equal to the spell's level;" + "\n      " + "- AC total equals 10 + 2 (Land only) + 1 per spell level (natural armor);" + "\n   " + "   - Damage equals 1 + the spellls level of Radiant (Celestial), Psychic (Fey), or Necrotic (Fiend) damage.",
		joinString : "\n   "
	}],
};

// Add UA23DP Otherworlder Familiar creatures, one for each spell level
CreatureList["otherworldly familiar ua23dp lvl 1"] = {
	name : "1st-Lvl Otherworldly Familiar (UA23DP)",
	source : [["UA23DP", 19], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*familiar).*$/i,
	size : 5,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["familiar", "familiar_not_al", "familiar_ua23dp"],
	companionApply : "familiar",
	alignment : "Neutral",
	ac : 11,
	hp : 4,
	hd : [1, 4],
	speed : "30 ft (9m)",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [3, 14, 10, 10, 14, 8],
	senses : "Darkvision 60 ft (18m)",
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Scratch (UA23DP)",
		ability : 4,
		damage : [2, "", "Rad/Psy/Nec"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Scratch as an Attack action; Damage depends on Creature Type; Uses your Reaction",
		abilitytodamage : false,
		useSpellMod : "wizard",
	}],
	languages : "Telepathy 120 ft (36m) (only between you and the familiar)",
	features : [{
		name : "Extradimensional Escape (Once per Long Rest)",
		description : "When the familiar would drop to 0 Hit Points, it instead drops to 1 Hit Point and vanishes into an extradimensional space, leaving behind anything it was wearing or carrying. It remains there for 1 hour or until you summon it as a Magic action, and then it reappears in your space.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Deliver Spell",
		description : "As a reaction, the familiar delivers a spell cast by you that has a range of touch. The familiar must be within 120 ft (36m) of you to do so.",
		joinString : "\n   ",
	}],
	traits : [{
		name : "Amphibious (Water Only)",
		description : "The familiar can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Familiar",
};
CreatureList["otherworldly familiar ua23dp lvl 2"] = {
	name : "2nd-Lvl Otherworldly Familiar (UA23DP)",
	source : [["UA23DP", 19], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*familiar).*$/i,
	size : 5,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["familiar", "familiar_not_al", "familiar_ua23dp"],
	companionApply : "familiar",
	alignment : "Neutral",
	ac : 12,
	hp : 6,
	hd : [2, 4],
	speed : "30 ft (9m)",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [3, 14, 10, 10, 14, 8],
	senses : "Darkvision 60 ft (18m)",
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Scratch (UA23DP)",
		ability : 4,
		damage : [3, "", "Rad/Psy/Nec"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Scratch as an Attack action; Damage depends on Creature Type; Uses your Reaction",
		abilitytodamage : false,
		useSpellMod : "wizard",
	}],
	languages : "Telepathy 120 ft (36m) (only between you and the familiar)",
	features : [{
		name : "Extradimensional Escape (Once per Long Rest)",
		description : "When the familiar would drop to 0 Hit Points, it instead drops to 1 Hit Point and vanishes into an extradimensional space, leaving behind anything it was wearing or carrying. It remains there for 1 hour or until you summon it as a Magic action, and then it reappears in your space.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Deliver Spell",
		description : "As a reaction, the familiar delivers a spell cast by you that has a range of touch. The familiar must be within 120 ft (36m) of you to do so.",
		joinString : "\n   ",
	}],
	traits : [{
		name : "Amphibious (Water Only)",
		description : "The familiar can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Familiar",
};
CreatureList["otherworldly familiar ua23dp lvl 3"] = {
	name : "3rd-Lvl Otherworldly Familiar (UA23DP)",
	source : [["UA23DP", 19], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*familiar).*$/i,
	size : 5,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["familiar", "familiar_not_al", "familiar_ua23dp"],
	companionApply : "familiar",
	alignment : "Neutral",
	ac : 13,
	hp : 8,
	hd : [3, 4],
	speed : "30 ft (9m)",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [3, 14, 10, 10, 14, 8],
	senses : "Darkvision 60 ft (18m)",
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Scratch (UA23DP)",
		ability : 4,
		damage : [4, "", "Rad/Psy/Nec"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Scratch as an Attack action; Damage depends on Creature Type; Uses your Reaction",
		abilitytodamage : false,
		useSpellMod : "wizard",
	}],
	languages : "Telepathy 120 ft (36m) (only between you and the familiar)",
	features : [{
		name : "Extradimensional Escape (Once per Long Rest)",
		description : "When the familiar would drop to 0 Hit Points, it instead drops to 1 Hit Point and vanishes into an extradimensional space, leaving behind anything it was wearing or carrying. It remains there for 1 hour or until you summon it as a Magic action, and then it reappears in your space.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Deliver Spell",
		description : "As a reaction, the familiar delivers a spell cast by you that has a range of touch. The familiar must be within 120 ft (36m) of you to do so.",
		joinString : "\n   ",
	}],
	traits : [{
		name : "Amphibious (Water Only)",
		description : "The familiar can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Familiar",
};
CreatureList["otherworldly familiar ua23dp lvl 4"] = {
	name : "4th-Lvl Otherworldly Familiar (UA23DP)",
	source : [["UA23DP", 19], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*familiar).*$/i,
	size : 5,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["familiar", "familiar_not_al", "familiar_ua23dp"],
	companionApply : "familiar",
	alignment : "Neutral",
	ac : 14,
	hp : 10,
	hd : [4, 4],
	speed : "30 ft (9m)",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [3, 14, 10, 10, 14, 8],
	senses : "Darkvision 60 ft (18m)",
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Scratch (UA23DP)",
		ability : 4,
		damage : [5, "", "Rad/Psy/Nec"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Scratch as an Attack action; Damage depends on Creature Type; Uses your Reaction",
		abilitytodamage : false,
		useSpellMod : "wizard",
	}],
	languages : "Telepathy 120 ft (36m) (only between you and the familiar)",
	features : [{
		name : "Extradimensional Escape (Once per Long Rest)",
		description : "When the familiar would drop to 0 Hit Points, it instead drops to 1 Hit Point and vanishes into an extradimensional space, leaving behind anything it was wearing or carrying. It remains there for 1 hour or until you summon it as a Magic action, and then it reappears in your space.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Deliver Spell",
		description : "As a reaction, the familiar delivers a spell cast by you that has a range of touch. The familiar must be within 120 ft (36m) of you to do so.",
		joinString : "\n   ",
	}],
	traits : [{
		name : "Amphibious (Water Only)",
		description : "The familiar can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Familiar",
};
CreatureList["otherworldly familiar ua23dp lvl 5"] = {
	name : "5th-Lvl Otherworldly Familiar (UA23DP)",
	source : [["UA23DP", 19], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*familiar).*$/i,
	size : 5,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["familiar", "familiar_not_al", "familiar_ua23dp"],
	companionApply : "familiar",
	alignment : "Neutral",
	ac : 15,
	hp : 12,
	hd : [5, 4],
	speed : "30 ft (9m)",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [3, 14, 10, 10, 14, 8],
	senses : "Darkvision 60 ft (18m)",
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Scratch (UA23DP)",
		ability : 4,
		damage : [6, "", "Rad/Psy/Nec"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Scratch as an Attack action; Damage depends on Creature Type; Uses your Reaction",
		abilitytodamage : false,
		useSpellMod : "wizard",
	}],
	languages : "Telepathy 120 ft (36m) (only between you and the familiar)",
	features : [{
		name : "Extradimensional Escape (Once per Long Rest)",
		description : "When the familiar would drop to 0 Hit Points, it instead drops to 1 Hit Point and vanishes into an extradimensional space, leaving behind anything it was wearing or carrying. It remains there for 1 hour or until you summon it as a Magic action, and then it reappears in your space.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Deliver Spell",
		description : "As a reaction, the familiar delivers a spell cast by you that has a range of touch. The familiar must be within 120 ft (36m) of you to do so.",
		joinString : "\n   ",
	}],
	traits : [{
		name : "Amphibious (Water Only)",
		description : "The familiar can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Familiar",
};
CreatureList["otherworldly familiar ua23dp lvl 6"] = {
	name : "6th-Lvl Otherworldly Familiar (UA23DP)",
	source : [["UA23DP", 19], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*familiar).*$/i,
	size : 5,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["familiar", "familiar_not_al", "familiar_ua23dp"],
	companionApply : "familiar",
	alignment : "Neutral",
	ac : 16,
	hp : 14,
	hd : [6, 4],
	speed : "30 ft (9m)",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [3, 14, 10, 10, 14, 8],
	senses : "Darkvision 60 ft (18m)",
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Scratch (UA23DP)",
		ability : 4,
		damage : [7, "", "Rad/Psy/Nec"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Scratch as an Attack action; Damage depends on Creature Type; Uses your Reaction",
		abilitytodamage : false,
		useSpellMod : "wizard",
	}],
	languages : "Telepathy 120 ft (36m) (only between you and the familiar)",
	features : [{
		name : "Extradimensional Escape (Once per Long Rest)",
		description : "When the familiar would drop to 0 Hit Points, it instead drops to 1 Hit Point and vanishes into an extradimensional space, leaving behind anything it was wearing or carrying. It remains there for 1 hour or until you summon it as a Magic action, and then it reappears in your space.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Deliver Spell",
		description : "As a reaction, the familiar delivers a spell cast by you that has a range of touch. The familiar must be within 120 ft (36m) of you to do so.",
		joinString : "\n   ",
	}],
	traits : [{
		name : "Amphibious (Water Only)",
		description : "The familiar can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Familiar",
};
CreatureList["otherworldly familiar ua23dp lvl 7"] = {
	name : "7th-Lvl Otherworldly Familiar (UA23DP)",
	source : [["UA23DP", 19], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*familiar).*$/i,
	size : 5,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["familiar", "familiar_not_al", "familiar_ua23dp"],
	companionApply : "familiar",
	alignment : "Neutral",
	ac : 17,
	hp : 16,
	hd : [7, 4],
	speed : "30 ft (9m)",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [3, 14, 10, 10, 14, 8],
	senses : "Darkvision 60 ft (18m)",
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Scratch (UA23DP)",
		ability : 4,
		damage : [8, "", "Rad/Psy/Nec"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Scratch as an Attack action; Damage depends on Creature Type; Uses your Reaction",
		abilitytodamage : false,
		useSpellMod : "wizard",
	}],
	languages : "Telepathy 120 ft (36m) (only between you and the familiar)",
	features : [{
		name : "Extradimensional Escape (Once per Long Rest)",
		description : "When the familiar would drop to 0 Hit Points, it instead drops to 1 Hit Point and vanishes into an extradimensional space, leaving behind anything it was wearing or carrying. It remains there for 1 hour or until you summon it as a Magic action, and then it reappears in your space.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Deliver Spell",
		description : "As a reaction, the familiar delivers a spell cast by you that has a range of touch. The familiar must be within 120 ft (36m) of you to do so.",
		joinString : "\n   ",
	}],
	traits : [{
		name : "Amphibious (Water Only)",
		description : "The familiar can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Familiar",
};
CreatureList["otherworldly familiar ua23dp lvl 8"] = {
	name : "8th-Lvl Otherworldly Familiar (UA23DP)",
	source : [["UA23DP", 19], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*familiar).*$/i,
	size : 5,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["familiar", "familiar_not_al", "familiar_ua23dp"],
	companionApply : "familiar",
	alignment : "Neutral",
	ac : 18,
	hp : 18,
	hd : [8, 4],
	speed : "30 ft (9m)",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [3, 14, 10, 10, 14, 8],
	senses : "Darkvision 60 ft (18m)",
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Scratch (UA23DP)",
		ability : 4,
		damage : [9, "", "Rad/Psy/Nec"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Scratch as an Attack action; Damage depends on Creature Type; Uses your Reaction",
		abilitytodamage : false,
		useSpellMod : "wizard",
	}],
	languages : "Telepathy 120 ft (36m) (only between you and the familiar)",
	features : [{
		name : "Extradimensional Escape (Once per Long Rest)",
		description : "When the familiar would drop to 0 Hit Points, it instead drops to 1 Hit Point and vanishes into an extradimensional space, leaving behind anything it was wearing or carrying. It remains there for 1 hour or until you summon it as a Magic action, and then it reappears in your space.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Deliver Spell",
		description : "As a reaction, the familiar delivers a spell cast by you that has a range of touch. The familiar must be within 120 ft (36m) of you to do so.",
		joinString : "\n   ",
	}],
	traits : [{
		name : "Amphibious (Water Only)",
		description : "The familiar can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Familiar",
};
CreatureList["otherworldly familiar ua23dp lvl 9"] = {
	name : "9th-Lvl Otherworldly Familiar (UA23DP)",
	source : [["UA23DP", 19], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*familiar).*$/i,
	size : 5,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["familiar", "familiar_not_al", "familiar_ua23dp"],
	companionApply : "familiar",
	alignment : "Neutral",
	ac : 19,
	hp : 20,
	hd : [9, 4],
	speed : "30 ft (9m)",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [3, 14, 10, 10, 14, 8],
	senses : "Darkvision 60 ft (18m)",
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Scratch (UA23DP)",
		ability : 4,
		damage : [10, "", "Rad/Psy/Nec"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Scratch as an Attack action; Damage depends on Creature Type; Uses your Reaction",
		abilitytodamage : false,
		useSpellMod : "wizard",
	}],
	languages : "Telepathy 120 ft (36m) (only between you and the familiar)",
	features : [{
		name : "Extradimensional Escape (Once per Long Rest)",
		description : "When the familiar would drop to 0 Hit Points, it instead drops to 1 Hit Point and vanishes into an extradimensional space, leaving behind anything it was wearing or carrying. It remains there for 1 hour or until you summon it as a Magic action, and then it reappears in your space.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Deliver Spell",
		description : "As a reaction, the familiar delivers a spell cast by you that has a range of touch. The familiar must be within 120 ft (36m) of you to do so.",
		joinString : "\n   ",
	}],
	traits : [{
		name : "Amphibious (Water Only)",
		description : "The familiar can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Familiar",
};

// Add UA23DP Otherworldly Scratch weapon
WeaponsList["otherworldly scratch (ua23dp)"] = {
	name : "Otherworldly Scratch (UA23DP)",
	source : [["UA23DP", 19], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*scratch).*$/i,
	type : "Natural",
	ability : 4,
	abilitytodamage : false,
	damage : [2, "", "Rad/Psy/Nec"],
	range : "Melee (5 ft)",
	description : "One Otherworldly Scratch as an Attack action; Damage depends on Creature Type; Uses your Reaction",
	list : "melee",
	useSpellMod : "wizard",
};

// Add "Druid & Paladin" Epic Boons
FeatsList["epic boon of fate ua23dp"] = {
	name : "Epic Boon of Fate (UA23DP)",
	source : [["UA23DP", 14], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Mage or Priest Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.cleric || classes.known.cleric_ua23pt6 || classes.known.druid || classes.known.druid_ua23pt8 || classes.known.paladin || classes.known.paladin_ua23pt6 || classes.known.sorcerer || classes.known.sorcerer_ua23pt7 || classes.known.warlock || classes.known.warlock_ua23pt7 || classes.known.wizard || classes.known.wizard_ua23pt7);
	},
	descriptionFull : " \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma score by 1, to a max of 30.\n \u2022 Improve Fate. When another creature within 60 feet of you fails a d20 Test, you can roll 2d4 and apply the total rolled as a bonus or penalty to the d20 roll. You can use this benefit no more than once per turn. You have 8 uses of this benefit, and whenever you finish a Long Rest, you regain 2d4 expended uses.",
	description : "My Intelligence, Wisdom, or Charisma increases by 1, to a max of 30. When another creature within 60 feet of me fails a d20 Test, I can roll 2d4 and apply the total rolled as a bonus or penalty to the d20 roll. I can use this benefit no more than once per turn. I have 8 uses of this benefit, and whenever I finish a Long Rest, I regain 2d4 expended uses.",
	choices : ['Intelligence +1', 'Wisdom +1', 'Charisma +1'],
	"intelligence +1" : {
		scoresMaximum : [0, 0, 0, 30, 30, 30],
		scores : [0, 0, 0, 1, 0, 0],
		scorestxt : "+1 Intelligence",
	},
	"wisdom +1" : {
		scoresMaximum : [0, 0, 0, 30, 30, 30],
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
	},
	"charisma +1" : {
		scoresMaximum : [0, 0, 0, 30, 30, 30],
		scores : [0, 0, 0, 0, 0, 1],
		scorestxt : "+1 Charisma",
	},
};
FeatsList["epic boon of spell recall ua23dp"] = {
	name : "Epic Boon of Spell Recall (UA23DP)",
	source : [["UA23DP", 14], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Mage or Priest Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.cleric || classes.known.cleric_ua23pt6 || classes.known.druid || classes.known.druid_ua23pt8 || classes.known.paladin || classes.known.paladin_ua23pt6 || classes.known.sorcerer || classes.known.sorcerer_ua23pt7 || classes.known.warlock || classes.known.warlock_ua23pt7 || classes.known.wizard || classes.known.wizard_ua23pt7);
	},
	descriptionFull : " \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma score by 1, to a max of 30.\n \u2022 Free Casting. Whenever you cast a spell with a Spell Slot of 1st, 2nd, 3rd, or 4th level, roll a d4. If the number you roll equals the slot’s level, the slot isn’t expended.",
	description : "My Intelligence, Wisdom, or Charisma increases by 1, to a max of 30. Whenever I cast a spell with a Spell Slot of 1st, 2nd, 3rd, or 4th level, roll a d4. If the number I roll equals the slot’s level, the slot isn’t expended.",
	choices : ['Intelligence +1', 'Wisdom +1', 'Charisma +1'],
	"intelligence +1" : {
		scoresMaximum : [0, 0, 0, 30, 30, 30],
		scores : [0, 0, 0, 1, 0, 0],
		scorestxt : "+1 Intelligence",
	},
	"wisdom +1" : {
		scoresMaximum : [0, 0, 0, 30, 30, 30],
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
	},
	"charisma +1" : {
		scoresMaximum : [0, 0, 0, 30, 30, 30],
		scores : [0, 0, 0, 0, 0, 1],
		scorestxt : "+1 Charisma",
	},
};
FeatsList["epic boon of truesight ua23dp"] = {
	name : "Epic Boon of Truesight (UA23DP)",
	source : [["UA23DP", 15], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Priest Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.cleric || classes.known.cleric_ua23pt6 || classes.known.druid || classes.known.druid_ua23pt8 || classes.known.paladin || classes.known.paladin_ua23pt6);
	},
	vision : [
		["Truesight", 60],
	],
	descriptionFull : " \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma score by 1, to a max of 30.\n \u2022 Truesight. You have Truesight within a range of 60 ft (18m).",
	description : "My Intelligence, Wisdom, or Charisma increases by 1, to a max of 30. I gain Truesight within a range of 60 ft (18m).",
	choices : ['Intelligence +1', 'Wisdom +1', 'Charisma +1'],
	"intelligence +1" : {
		scoresMaximum : [0, 0, 0, 30, 30, 30],
		scores : [0, 0, 0, 1, 0, 0],
		scorestxt : "+1 Intelligence",
	},
	"wisdom +1" : {
		scoresMaximum : [0, 0, 0, 30, 30, 30],
		scores : [0, 0, 0, 0, 1, 0],
		scorestxt : "+1 Wisdom",
	},
	"charisma +1" : {
		scoresMaximum : [0, 0, 0, 30, 30, 30],
		scores : [0, 0, 0, 0, 0, 1],
		scorestxt : "+1 Charisma",
	},
};

//// >>>>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA23PT5 Content >>> ////
//// >>>>>>>>>>>>>>>>>>>>>>> ////

// 4th Lvl Feats
FeatsList["weapon master ua23pt5"] = {
	name : "Weapon Master (UA23PT5)",
	source : [["UA23PT5", 14], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Character Level 4+",
	prereqeval : function(v) {
		return v.characterLevel >=4;
	},
	descriptionFull : "You gain the following benefits: \n \u2022 Ability Score Increase. Increase your Strength, or Dexterity score by 1, to a maximum of 20. \n \u2022 Mastery Property. Your training with weapons allows you to use the Mastery property of one kind of Simple or Martial weapon of your choice, provided you are proficient with it.\n   Whenever you finish a Long Rest, you can change the kind of weapon you chose to another eligible kind.",
	description : "My Strength or Dexterity increases by 1, to a max of 20. I can also use the Mastery property of one kind of Simple or Martial weapon of my choice that I am Proficient with. I can change the kind of Weapon I can the Mastery property of upon finishing a Long Rest.",
	choices : ['Strength +1', 'Dexterity +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scorestxt : "+1 Strength",
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scorestxt : "+1 Dexterity",
	},
};

// 20th Lvl (Epic Boon) Feats
FeatsList["epic boon of dimensional travel ua23pt5"] = {
	name : "Epic Boon of Dimensional Travel (UA23PT5)",
	source : [["UA23PT5", 13], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert or Mage Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6 || classes.known.sorcerer || classes.known.sorcerer_ua23pt7 || classes.known.warlock || classes.known.warlock_ua23pt7 || classes.known.wizard || classes.known.wizard_ua23pt7);
	},
	descriptionFull : "You gain the following benefits: \n \u2022 Ability Score Increase. Increase your Dexterity, Intelligence, or Wisdom score by 1, to a maximum of 30. \n \u2022 Blink Steps. Immediately after you take the Attack action or the Magic action, you can teleport up to 30 feet to an unoccupied space you can see.",
	description : "My Dexterity, Intelligence, or Wisdom increases by 1, to a max of 30. Additionally, immediately after I take the Attack or Magic action, I can teleport up to 30 ft to an unoccupied space I can see.",
	choices : ['Dexterity +1', 'Intelligence +1', 'Wisdom +1'],
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Dexterity",
	},
	"intelligence +1" : {
		scores : [0, 0, 0, 1, 0, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Intelligence",
	},
	"wisdom +1" : {
		scores : [0, 0, 0, 0, 1, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Wisdom",
	},
};
FeatsList["epic boon of energy resistance ua23pt5"] = {
	name : "Epic Boon of Energy Resistance (UA23PT5)",
	source : [["UA23PT5", 13], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert or Mage Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6 || classes.known.sorcerer || classes.known.sorcerer_ua23pt7 || classes.known.warlock || classes.known.warlock_ua23pt7 || classes.known.wizard || classes.known.wizard_ua23pt7);
	},
	descriptionFull : "You gain the following benefits: \n \u2022 Ability Score Increase. Increase your Constitution, Intelligence, Wisdom, or Charisma score by 1, to a maximum of 30.\n \u2022 Energy Resistances. You gain Resistance to two of the following damage types of your choice: Acid, Cold, Fire, Lightning, Necrotic, Poison, Psychic, Radiant, or Thunder. Whenever you finish a Long Rest, you can meditate and change those choices.\n \u2022 Energy Redirection. When you take damage of a type to which you have Resistance, you can use your Reaction to direct damage of the same type toward another creature you can see within 60 feet of yourself that isn’t behind Total Cover. If you do so, that creature must succeed on a Dexterity saving throw (DC equals 8 + your Proficiency Bonus + the ability modifier of the score increased by this feat) or take damage equal to 2d12 + your Constitution modifier.",
	description : "My Constitution, Intelligence, Wisdom, or Charisma increases by 1, to a max of 30. I also gain resistance to 2 damage types per Long Rest; see \"Saving Throws\" section on pg 1 for more info. Additionally, when I take damage of a type to which I have Resistance, I can use my Reaction to direct damage of the same type at another creature I can see within 60 ft. If I do so, that creature must succeed a Dex save (DC = 8 + Prof Bonus + Ability Modifier increased by this Feat) or take damage equal to 2d12 + Con mod.",
	savetxt : {
		text : ["Resistance to 2 of the following per Long Rest: Acid, Cold, Fire, Lightning, Necrotic, Poison, Psychic, Radiant, or Thunder"],
	},
	action : [
		["reaction", "Energy Redirection [2d12 + Con mod dmg]"],
	],
	choices : ['Constitution +1', 'Intelligence +1', 'Wisdom +1', 'Charisma +1'],
	"constitution +1" : {
		scores : [0, 0, 1, 0, 0, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Constitution",
	},
	"intelligence +1" : {
		scores : [0, 0, 0, 1, 0, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Intelligence",
	},
	"wisdom +1" : {
		scores : [0, 0, 0, 0, 1, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Wisdom",
	},
	"charisma +1" : {
		scores : [0, 0, 0, 0, 0, 1],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Charisma",
	},
};
FeatsList["epic boon of irresistible offense ua23pt5"] = {
	name : "Epic Boon of Irresistible Offense (UA23PT5)",
	source : [["UA23PT5", 13], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert or Warrior Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.barbarian || classes.known.barbarian_ua23pt8 || classes.known.fighter || classes.known.fighter_ua23pt7 || classes.known.monk || classes.known.monk_ua23pt8 || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6);
	},
	descriptionFull : "You gain the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Dexterity score by 1, to a maximum of 30.\n \u2022 Overcome Defenses. The Bludgeoning, Piercing, and Slashing damage you deal always ignores Resistance.\n \u2022 Overwhelming Strike. When you roll a 20 on the d20 for an attack roll, you can deal extra damage to the target equal to the ability score increased by this feat. The extra damage’s type is the same as the attack’s type. You can use this benefit only once per turn.",
	description : "My Strength or Dexterity increases by 1, to a max of 30. Additionally, the Bludgeoning, Piercing, and Slashing damage I deal always ignores Resistance. Furthermore, once per turn, rolling a 20 on the d20 for a weapon attack roll increases the damage of that attack equal to the Ability Score that was increased by this Feat.",
	choices : ['Strength +1', 'Dexterity +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Strength",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if (v.isWeapon) {
						fields.Description += (fields.Description ? '; ' : '') + 'Once per turn on Nat 20, +' + Number(What("Str")) + ' damage';
					}
				},
				"Once per turn, when I roll a Nat 20 on a weapon attack roll, I can do extra damage equal to my Str Score.",
			],
		},
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Dexterity",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if (v.isWeapon) {
						fields.Description += (fields.Description ? '; ' : '') + 'Once per turn on Nat 20 +' + Number(What("Dex")) + ' damage';
					}
				},
				"Once per turn, when I roll a Nat 20 on a weapon attack roll, I can do extra damage equal to my Dex Score.",
			],
		},
	},
};
FeatsList["epic boon of recovery ua23pt5"] = {
	name : "Epic Boon of Recovery (UA23PT5)",
	source : [["UA23PT5", 14], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+",
	prereqeval : function(v) {
		return v.characterLevel >=20;
	},
	descriptionFull : "You gain the following benefits: \n \u2022 Ability Score Increase. Increase your Constitution score by 1, to a maximum of 30.\n \u2022 Last Stand. When you would be reduced to 0 Hit Points, you can drop to 1 Hit Point instead and regain a number of Hit Points equal to half your Hit Point Maximum. Once you use this benefit, you can’t use it again until you finish a Long Rest.\n \u2022 Death Defiant. When you take damage while you have 0 Hit Points, you can make a death saving throw instead of suffering a death saving throw failure.",
	description : "My Constitution increases by 1, to a max of 30. Additionally, once per Long Rest, when I would drop to 0 HP, I can instead drop to 1 HP and regain half of my max HP on top of that. Furthermore, when I take damage while at 0 HP, I can make a Death Save instead of automatically suffering a Death Save failure.",
	scores : [0, 0, 1, 0, 0, 0],
	scoresMaximum : [30, 30, 30, 30, 30, 30],
	scorestxt : "+1 Constitution",
	savetxt : {
		text : ["When hit at 0 HP, I roll a Death Save instead of auto failing a Death Save"],
	},
	limfeaname : "Last Stand [+.5*MaxHP]",
	usages : 1,
	recovery : "long rest",
};
FeatsList["epic boon of speed ua23pt5"] = {
	name : "Epic Boon of Speed (UA23PT5)",
	source : [["UA23PT5", 14], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert or Warrior Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.barbarian || classes.known.barbarian_ua23pt8 || classes.known.fighter || classes.known.fighter_ua23pt7 || classes.known.monk || classes.known.monk_ua23pt8 || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6);
	},
	speed : {
		allModes : "+30",
	},
	action : [
		["bonus action", "Disengage [ends Grappled \u0026 Restrained]"],
	],
	descriptionFull : "You gain the following benefits: \n \u2022 Ability Score Increase. Increase your Dexterity score by 1, to a maximum of 30.\n \u2022 Escape Artist. As a Bonus Action, you can take the Disengage Action, which also ends the Grappled and Restrained conditions on you.\n \u2022 Quickness. Your Speed increases by 30 feet.",
	description : "My Dexterity increases by 1, to a max of 30. Additionally, I can use a Bonus Action to Disengage, ending the Grappled \u0026 Restrained conditions on myself in the process. Furthermore, my Speed increases by 30 ft.",
	scores : [0, 1, 0, 0, 0, 0],
	scoresMaximum : [30, 30, 30, 30, 30, 30],
	scorestxt : "+1 Dexterity",
};
FeatsList["epic boon of the night spirit ua23pt5"] = {
	name : "Epic Boon of the Night Spirit (UA23PT5)",
	source : [["UA23PT5", 14], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert or Mage Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6 || classes.known.sorcerer || classes.known.sorcerer_ua23pt7 || classes.known.warlock || classes.known.warlock_ua23pt7 || classes.known.wizard || classes.known.wizard_ua23pt7);
	},
	savetxt : {
		text : ["While in Dim Light or Darkness, Resist all damage except Force, Psychic, \u0026 Radiant"],
	},
	action : [
		["action", "In Dim Light/Darkness: Invisible condition"],
	],
	descriptionFull : "You gain the following benefits: \n \u2022 Ability Score Increase. Increase your Dexterity, Intelligence, Wisdom, or Charisma score by 1, to a maximum of 30.\n \u2022 Merge with Shadows. While entirely within Dim Light or Darkness, you can give yourself the Invisible condition as a Magic action. The condition ends on you immediately after you take an action, a Bonus Action, or a Reaction.\n \u2022 Shadowy Form. While entirely within Dim Light or Darkness, you have Resistance to all damage except Force, Psychic, and Radiant.",
	description : "My Dexterity, Intelligence, or Wisdom increases by 1, to a max of 30. Additionally, when entirely in Dim Light or Darkness, I can gain the Invisible condition as a Magic action. The condition ends immediately after taking an action, a Bonus Action, or a Reaction. Furthermore, while I am entirely in Dim Light or Darkness, I have Resistance to all damage except Force, Psychic, and Radiant.",
	choices : ['Dexterity +1', 'Intelligence +1', 'Wisdom +1'],
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Dexterity",
	},
	"intelligence +1" : {
		scores : [0, 0, 0, 1, 0, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Intelligence",
	},
	"wisdom +1" : {
		scores : [0, 0, 0, 0, 1, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Wisdom",
	},
	"charisma +1" : {
		scores : [0, 0, 0, 0, 0, 1],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Charisma",
	},
};
/*	-SCRIPT AUTHOR NOTE-
	Below is the "Epic Boon of Irresistible Offense" Feat as it is actually written in the UA article.
	This version is exluded by default because it is written in the original article in such a way that the bonus damage on a Nat 20 could be added to both weapon AND spell attacks, which seem unintended for a Feat that only increases Str or Dex.
	The version above has been coded such that it only adds the bonus damage to weapons.
*/
FeatsList["epic boon of irresistible offense raw ua23pt5"] = {
	name : "Epic Boon of Irresistible Offense (RAW) (UA23PT5)",
	source : [["UA23PT5", 13], ["MJ:HB", 0]],
	defaultExcluded : true,
	allowDuplicates : false,
	prerequisite : "Character Level 20+; Expert or Warrior Group",
	prereqeval : function(v) {
		return v.characterLevel >=20 && (classes.known.artificer || classes.known.bard || classes.known.bard_ua22xc || classes.known.barbarian || classes.known.barbarian_ua23pt8 || classes.known.fighter || classes.known.fighter_ua23pt7 || classes.known.monk || classes.known.monk_ua23pt8 || classes.known.ranger || classes.known.ranger_ua23pt6 || classes.known.rogue || classes.known.rogue_ua23pt6);
	},
	descriptionFull : "You gain the following benefits: \n \u2022 Ability Score Increase. Increase your Strength or Dexterity score by 1, to a maximum of 30.\n \u2022 Overcome Defenses. The Bludgeoning, Piercing, and Slashing damage you deal always ignores Resistance.\n \u2022 Overwhelming Strike. When you roll a 20 on the d20 for an attack roll, you can deal extra damage to the target equal to the ability score increased by this feat. The extra damage’s type is the same as the attack’s type. You can use this benefit only once per turn.",
	description : "My Strength or Dexterity increases by 1, to a max of 30. Additionally, the Bludgeoning, Piercing, and Slashing damage I deal always ignores Resistance. Furthermore, once per turn, rolling a 20 on the d20 for an attack roll increases the damage of that attack equal to the Ability Score that was increased by this Feat.",
	choices : ['Strength +1', 'Dexterity +1'],
	"strength +1" : {
		scores : [1, 0, 0, 0, 0, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Strength",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if (v.isWeapon || v.isSpell) {
						fields.Description += (fields.Description ? '; ' : '') + 'Once per turn on Nat 20, +' + Number(What("Str")) + ' damage';
					}
				},
				"Once per turn, when I roll a Nat 20 on an attack roll, I can do extra damage equal to my Str Score.",
			],
		},
	},
	"dexterity +1" : {
		scores : [0, 1, 0, 0, 0, 0],
		scoresMaximum : [30, 30, 30, 30, 30, 30],
		scorestxt : "+1 Dexterity",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if (v.isWeapon || v.isSpell) {
						fields.Description += (fields.Description ? '; ' : '') + 'Once per turn on Nat 20 +' + Number(What("Dex")) + ' damage';
					}
				},
				"Once per turn, when I roll a Nat 20 on an attack roll, I can do extra damage equal to my Dex Score.",
			],
		},
	},
};

//// >>>>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA23PT6 Content >>> ////
//// >>>>>>>>>>>>>>>>>>>>>>> ////

/*	-SCRIPT AUTHOR NOTE-
	Bard will not be added in this script because the Arcane, Divine, and Primal Spell Lists have been removed
	from playtesting & the Bard in this UA article depends on those Spell Lists to function correctly.
	Some of the code references spells that appear in later UA articles.
*/

// Add UA23PT6 Cleric class
ClassList.cleric_ua23pt6 = {
	name : "Cleric (UA:PT-vi)",
	regExpSearch : /(cleric|priest|clergy)/i,
	source : [["UA23PT6", 9], ["MJ:HB", 0]],
	primaryAbility : "Wisdom",
	prerequisite : "Wisdom 13+",
	prereqeval : function(v) {
		return What('Wis') >= 13;
	},
	die : 8,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
	saves : ["Wis", "Cha"],
	skills : ["\n\n" + toUni("Cleric") + ": Choose two from History, Insight, Medicine, Persuasion, Religion", ""],
	armor : [
		[true, true, false, true],
		[true, true, false, true],
	],
	weapons : [
		[true, false, [""]],
		[true, false, [""]],
	],
	equipment : "Cleric starting equipment:" +
		"\n \u2022 Chain shirt," +
		"\n \u2022 Holy Symbol," +
		"\n \u2022 Mace," +
		"\n \u2022 Priest's Pack," +
		"\n \u2022 Shield," +
		"\n \u2022 and 7 gp;" +
		"\n\nAlternatively, choose 110 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Divine Domain", []],
	attacks : [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,],
	abilitySave : 5,
	spellcastingFactor : 1,
	spellcastingKnown : {
		cantrips : [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
		spells : "list",
		prepared : true,
	},
	spellcastingList : {
		class : ["cleric", "cleric_ua23pt6"],
	},
	features : {
		"divine order ua23pt6" : {
			name : "Divine Order",
			source : [["UA23PT6", 11], ["MJ:HB", 0]],
			minlevel : 1,
			description : "\n   " + "Choose a Divine Order using the \"Choose Feature\" button above. The chosen option will appear in pg 3's Notes section.",
		},
		"spellcasting ua23pt6" : {
			name : "Spellcasting",
			source : [["UA23PT6", 11], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can cast prepared cleric cantrips/spells, using Wisdom as my spellcasting ability.",
				"I can use a holy symbol as a spellcasting focus for my cleric spells.",
				"I can cast my prepared cleric spells as rituals if they have the ritual tag.",
			]),
			additional : levels.map(function (n, idx) {
				return [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5][idx] + " cantrips known";
			}),
		},
		"channel divinity ua23pt6" : {
			name : "Channel Divinity",
			source : [["UA23PT6", 11], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"I can channel divine energy to cause an effect; the save for this is my cleric spell DC.",
				"Available effects are Divine Spark & Turn Undead; I gain additional effect options at higher levels in this class.",
				"I can use Channel Divinity 2 times at 2nd Level, 3 times at 6th Level, and 4 times at 18th Level.",
			]),
			additional : "; regain 1 per Short Rest",
			usages : [0, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4],
			recovery : "long rest",
		},
		"divine spark ua23pt6" : {
			name : "Channel Divinity: Divine Spark",
			source : [["UA23PT6", 11], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"As a Magic action, I roll 1d8 + Wis modifier, targeting one creature I can see within 30 ft.",
				"I either restore Hit Points to the creature equal to that total or force the creature to make a Constitution saving throw.",
				"Creature takes radiant or necrotic damage, saves for half. Add an additional d8 at Cleric levels 7 (2d8), 13 (3d8), and 18 (4d8).",
			]),
			action : [
				["action", "Channel Divinity: Divine Spark"],
			],
		},
		"turn undead ua23pt6" : {
			name : "Channel Divinity: Turn Undead",
			source : [["UA23PT6", 11], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"As a Magic action, all undead within 30 ft that can see/hear me must make a Wisdom save",
				"If an undead fails this save, it is Turned for 1 minute or until it takes any damage, I become Incapacitated, or I die",
				"Turned creatures gain the Frightened & Incapacitated conditions",
			]),
			action : [
				["action", "Channel Divinity: Turn Undead"],
			],
		},
		"subclassfeature3" : { //Ripped directly from ListClasses.js and then altered
			name : "Divine Domain",
			source : [["SRD", 16], ["P", 58]],
			minlevel : 3,
			description : desc('Choose a Domain related to your deity and put it in the "Class" field ')
		},
		"smite undead ua23pt6" : {
			name : "Smite Undead",
			source : [["UA23PT6", 12], ["MJ:HB", 0]],
			minlevel : 5,
			description : desc([
				"I can can cause my Turn Undead feature to smite undead, doing Wis modifier # of d8s.",
				"in Radiant damage to Undead that dail their saving throw against that use of Turn Undead;",
				"This Radiant damage doesn't end the turn effect.",
			]),
		},
		"blessed strikes ua23pt6" : {
			name : "Blessed Strikes",
			source : [["UA23PT6", 12], ["MJ:HB", 0]],
			minlevel : 7,
			description : "\n   " + "Choose a Blessed Strikes option using the \"Choose Feature\" button above. The chosen option will appear in pg 3's Notes section.",
		},
		"commune ua23pt6" : {
			name : "Commune",
			source : [["UA23PT6", 12], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"I now always have the Commune spell prepared.",
			]),
			spellcastingBonus : {
				name : "Commune",
				spells : ["commune"],
				selection : ["commune"],
				times : 1,
			},
		},
		"divine intervention ua23pt6" : {
			name : "Divine Intervention",
			source : [["UA23PT6", 12], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"Once per Long Rest, I can use a Magic action to cast a Cleric spell of 5th Level or lower",
				"with a non-Reaction casting time with expending a spell slot or needing material components.",
			]),
			usages : 1,
			recovery : "long rest",
		},
		"improved blessed strikes ua23pt6" : {
			name : "Improved Blessed Strikes",
			source : [["UA23PT6", 12], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"The option I chose for Blessed Strikes at 7th Lvl grows more powerful",
			]),
		},
		"greater divine intervention ua23pt6" : {
			name : "Greater Divine Intervention",
			source : [["UA23PT6", 13], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"I can cast the Wish spell when I use my Divine Intervention feature; doing so means I can not",
				"use my Divine Intervention feature until I finish 2d4 Long Rests. When casting Wish with this",
				"feature, I\'m immune to the stress caused by using Wish to do something other than casting a spell.",
			]),
			limfeaname : "Divine Inter. Wish; recharge 1 per 2d4",
			usages : 1,
			recovery : "long rest",
		},
	},
};

//// Add Cleric "Divine Order" choices
AddFeatureChoice(ClassList.cleric_ua23pt6.features["divine order ua23pt6"], true, "Divine Order: Protector", {
	name : "Divine Order: Protector",
	extraname : "Cleric 1",
	source : [["UA23PT6", 11], ["MJ:HB", 0]],
	description : "\n   " + "I gain Martial Weapons Proficiency & Heavy Armor training.",
	weaponProfs : [false, true],
	armorProfs : [
		[false, false, true, false],
	],
	prereqeval : function (v) { return classes.known.cleric_ua23pt6.level >= 1 ? true : "skip"; }
}, "1st-level cleric Divine Order choice");
AddFeatureChoice(ClassList.cleric_ua23pt6.features["divine order ua23pt6"], true, "Divine Order: Thaumaturge", {
	name : "Divine Order: Thaumaturge",
	extraname : "Cleric 1",
	source : [["UA23PT6", 11], ["MJ:HB", 0]],
	description : "\n   " + "I know 1 extra cantrip from the Cleric spell list & I add my Wis modifier to Intelligence (Religion) checks.",
	spellcastingBonus : [{
		name : "Cleric cantrip",
		spellcastingAbility : 5,
		"class" : ["cleric", "cleric_ua23pt6"],
		level : [0, 0],
		firstCol : "atwill",
		times : 1
	}],
	addMod : [
		{ type : "skill", field : "Religion", mod : "Wis", text : "I can add my Wisdom modifier to Intelligence (Religion) checks." },
	],
	prereqeval : function (v) { return classes.known.cleric_ua23pt6.level >= 1 ? true : "skip"; }
}, "1st-level cleric Divine Order choice");

//// Add Cleric "Blessed Strikes" choices
AddFeatureChoice(ClassList.cleric_ua23pt6.features["blessed strikes ua23pt6"], true, "Blessed Strikes: Divine Strike", {
	name : "Blessed Strikes: Divine Strike",
	extraname : "Cleric 7",
	source : [["UA23PT6", 12], ["MJ:HB", 0]],
	description : "\n   " + "Once per turn, when I hit a creature with a weapon attack, I can do extra Radiant/Necrotic damage; damage increases at 14th Lvl",
	additional : levels.map(function (n) {
		return n < 7 ? "" : "+" + (n < 14 ? 1 : 2) + "d8 Radiant/Necrotic damage (choice)";
	}),
	calcChanges : {
		atkAdd : [
			function (fields, v) {
				if (classes.known.cleric_ua23pt6 && classes.known.cleric_ua23pt6.level >= 7 && !v.isSpell) {
					fields.Description += (fields.Description ? '; ' : '') + 'Once per turn +' + (classes.known.cleric_ua23pt6.level < 14 ? 1 : 2) + 'd8 Radiant/Necrotic damage';
				}
			},
			"Once per turn, when I hit a creature with a weapon attack, I can do extra Radiant/Necrotic damage.",
		],
	},
	prereqeval : function (v) { return classes.known.cleric_ua23pt6.level >= 7 ? true : "skip"; }
}, "7th-level cleric Blessed Strike choice");
AddFeatureChoice(ClassList.cleric_ua23pt6.features["blessed strikes ua23pt6"], true, "Blessed Strikes: Potent Spellcasting", {
	name : "Blessed Strikes: Potent Spellcasting",
	extraname : "Cleric 7",
	source : [["UA23PT6", 12], ["MJ:HB", 0]],
	description : "\n   " + "I add my Wisdom modifier to the damage I deal with my cleric cantrips; At 14th Lvl, I can add 2x Wis Mod in Temp HP to myself or another creature",
	additional : levels.map(function (n) {
		return n < 14 ? "" : "+" + " 2x Wis Mod in Temp HP to myself or other creature within 60 ft";
	}),
	calcChanges : {
		atkCalc : [
			function (fields, v, output) {
				if (classes.known.cleric_ua23pt6 && classes.known.cleric_ua23pt6.level > 7 && v.thisWeapon[3] && v.thisWeapon[4].indexOf('cleric_ua23pt6') !== -1 && SpellsList[v.thisWeapon[3]].level === 0) {
					output.extraDmg += What('Wis Mod');
				};
			},
			"My cleric cantrips get my Wisdom modifier added to their damage.",
		],
		spellAdd : [
			function (spellKey, spellObj, spName) {
				if (spName.indexOf("cleric_ua23pt6") == -1 || !What("Wis Mod") || Number(What("Wis Mod")) <= 0 || spellObj.psionic || spellObj.level !== 0) return;
				return genericSpellDmgEdit(spellKey, spellObj, "\\w+\\.?", "Wis");
			},
			"My cleric cantrips get my Wisdom modifier added to their damage.",
		],
	},
	prereqeval : function (v) { return classes.known.cleric_ua23pt6.level >= 7 ? true : "skip"; }
}, "7th-level cleric Blessed Strike choice");

//// Add Cleric optional choices; Ripped directly from all_WotC_pub+UA.js and then altered
AddFeatureChoice(ClassList.cleric_ua23pt6.features["spellcasting ua23pt6"], true, "Access to Dunamancy Spells", {
	name : "Dunamancy Spells",
	extraname : "Optional Cleric 1",
	source : [["W", 186]],
	description : desc([
		"All dunamancy spells are added to the cleric spell list, each still pending DM's approval"
	]),
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "cleric_ua23pt6" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["sapping sting", "gift of alacrity", "magnify gravity", "fortune's favor", "immovable object", "wristpocket", "pulse wave", "gravity sinkhole", "temporal shunt", "gravity fissure", "tether essence", "dark star", "reality break", "ravenous void", "time ravage"]);
			},
			"This optional class feature expands the spell list of the cleric class with all dunamancy spells (spell level in brackets): Sapping Sting (cantrip), Gift of Alacrity (1), Magnify Gravity (1), Fortune's Favor (2), Immovable Object (2), Wristpocket (2), Pulse Wave (3), Gravity Sinkhole (4), Temporal Shunt (5), Gravity Fissure (6), Tether Essence (7), Dark Star (8), Reality Break (8),Ravenous Void (9), and Time Ravage (9)."
		]
	}
}, "Optional 1st-level cleric features");
AddFeatureChoice(ClassList.cleric_ua23pt6.features["spellcasting ua23pt6"], true, "Additional Cleric Spells", {
	name : "Additional Cleric Spells",
	extraname : "Optional Cleric 1",
	source : [["T", 30]],
	description : "",
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "cleric_ua23pt6" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["aura of vitality", "aura of life", "aura of purity", "sunbeam", "sunburst", "power word heal"]);
			},
			"This optional class feature expands the spell list of the cleric class with the following spells (spell level in brackets): Aura of Vitality (3), Aura of Life (4), Aura of Purity (4), Sunbeam (6), Sunburst (8), and Power Word Heal (9)."
		]
	}
}, "Optional 1st-level cleric features");
AddFeatureChoice(ClassList.cleric_ua23pt6.features["channel divinity ua23pt6"], true, "Harness Divine Power", {
	name : "Channel Divinity: Harness Divine Power",
	extraname : "Optional Cleric 2",
	source : [["T", 30]],
	description : desc([
		"As a bonus action, I can expend a use of my channel divinity to regain one used spell slot",
		"The level of this spell slot can be no more than half my Proficiency Bonus (rounded up)",
		"I can only do this so many times per long rest, even if I have uses of channel divinity left"
	]),
	action : [["bonus action", ""]],
	usages : levels.map(function(n) {
		return n < 3 ? "" : n < 6 ? 1 : n < 18 ? 2 : 3;
	}),
	recovery : "long rest"
}, "Optional 2nd-level cleric features");
AddFeatureChoice(ClassList.cleric_ua23pt6.features["turn undead ua23pt6"], true, "Cantrip Versatility", {
	name : "Cantrip Versatility",
	extraname : "Optional Cleric 4",
	source : [["T", 31]],
	description : " [ASI = Ability Score Improvement]\n   Whenever I gain an ASI from the cleric class, I can change one cleric cantrip for another",
	prereqeval : function (v) { return classes.known.cleric_ua23pt6.level >= 4 ? true : "skip"; }
}, "Optional 4th-level cleric features");

//// Add "UA 2019: Class Feature Variants" Cleric optional choices; Ripped directly from all_WotC_pub+UA.js and then altered
AddFeatureChoice(ClassList.cleric_ua23pt6.features["spellcasting ua23pt6"], true, "Cantrip Versatility (ua:cfv)", {
	name : "Cantrip Versatility",
	extraname : "Optional Cleric 1",
	source : [["UA:CFV", 3]],
	description : "\n   Whenever I gain a cleric level, I can replace a cleric cantrip I know with another"
}, "Optional 1st-level cleric features");
AddFeatureChoice(ClassList.cleric_ua23pt6.features["spellcasting ua23pt6"], true, "Expanded Spell List (ua:cfv)", {
	name : "Expanded Cleric Spell List",
	extraname : "Optional Cleric 1",
	source : [["UA:CFV", 3]],
	description : "",
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "cleric_ua23pt6" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["cause fear", "wrathful smite", "branding smite", "aura of vitality", "aura of life", "aura of purity", "skill empowerment", "wall of light", "power word heal"]);
			},
			"This alternative class feature enhancement expands the spell list of the cleric class with the following spells (spell level in brackets): Cause Fear (1), Wrathful Smite (1), Branding Smite (2), Aura of Vitality (3), Aura of Life (4), Aura of Purity (4), Skill Empowerment (5), Wall of Light (5), and Power Word Heal (9)."
		]
	}
}, "Optional 1st-level cleric features");
AddFeatureChoice(ClassList.cleric_ua23pt6.features["channel divinity ua23pt6"], true, "Harness Divine Power (ua:cfv)", {
	name : "Channel Divinity:\xA0Harness Divine Power",
	source : [["UA:CFV", 4]],
	description : "\n   As a bonus action, I can use my holy symbol and a prayer to regain 1 used level 1 spell slot",
	action : [["bonus action", ""]]
}, "Optional 2nd-level cleric features");

////// Add UA23PT6 Life Domain Cleric subclass
AddSubClass("cleric_ua23pt6", "life domain_ua23pt6", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*\b(life|living)\b).*$/i,
	subname : "Life Domain",
	source : [["UA23PT6", 13], ["MJ:HB", 0], ["SRD", 17], ["P", 60]],
	spellcastingExtra : ["aid", "aid ua22cs", "aura of life", "bless", "cure wounds", "cure wounds ua23pt8", "death ward", "greater restoration", "lesser restoration", "mass healing word", "mass healing word ua23pt8", "revivify", "mass cure wounds", "mass cure wounds ua23pt8"],
	features : {
		"subclassfeature3" : { //Ripped directly from ListClasses.js and then altered
			name : "Disciple of Life",
			source : [["UA23PT6", 13], ["MJ:HB", 0], ["SRD", 17], ["P", 60]],
			minlevel : 3,
			description : desc([
				"Whenever a 1st-level or higher spell I cast restores HP to a creature, it heals more",
				"The creature regains an additional 2 + spell level (SL) worth of hit points",
				'Note that "X/SL" on the spell page means per spell slot level above the spell\'s normal level',
			]),
			calcChanges : {
				spellAdd : [
					// Includes Revivify and Raise Dead as they restore HP from 0 to 1, but omits Aid and Heroes' Feast as they increase max HP, not restore
					function (spellKey, spellObj, spName) {
						if (spellObj.psionic || !spellObj.level) return;
						switch (spellKey) {
							case "enervation" :
							case "life transference" :
							case "vampiric touch" :
								var useSpellDescr = getSpellShortDescription(spellKey, spellObj);
								var strAdd = " +" + (spellObj.level + 2) + "+1/SL";
								spellObj.description = useSpellDescr.replace(/(heals? (half|twice)( the damage dealt| that)?)( in HP)?/, "$1" + strAdd);
								return true;
							case "mass heal" :
								spellObj.description = spellObj.descriptionShorter.replace(/crea(tures)? in range.*cure[sd]/i, "crea in range, each then +11 HP, cured");
								return true;
							default :
								if (!genericSpellDmgEdit(spellKey, spellObj, "heal", (2 + spellObj.level))) return;
								if (spellObj.level < 9) genericSpellDmgEdit(spellKey, spellObj, "heal", "1/SL");
								spellObj.discipleOfLife = true; // for Blessed Healer and Supreme Healing,
								return true;
						}
					},
					"When I use a spell that restores hit points, it restores an additional 2 + the level of the spell slot (or spell slot equivalent) used to cast the spell.",
				],
			},
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Preserve Life",
			source : [["UA23PT6", 13], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can expend a number of Channel Divinity uses to cast an Abjuration spell",
				"without expending a spell slot. The number of Channel Divinity uses required",
				"equals the level of the spell being cast.",
			]),
			action : ["action", ""],
		},
		"subclassfeature6" : { //Ripped directly from ListClasses.js and then altered
			name : "Blessed Healer",
			source : [["UA23PT6", 13], ["MJ:HB", 0], ["SRD", 17], ["P", 60]],
			minlevel : 6,
			description : desc("When I restore HP to another with a spell, I regain 2 + the spell (slot) level in HP"),
			calcChanges : {
				spellAdd : [
					// note that several healing spells are skipped because they don't restore hp at casting (only later)
					function (spellKey, spellObj, spName) {
						var otherHealSpells = ["mass heal", "life transference", "power word heal", "power word heal ua23pt8", "resurrection", "true resurrection"];
						var noHealAtCast = ["aura of life", "aura of vitality", "goodberry", "healing elixir-uass", "healing spirit"];
						if (noHealAtCast.indexOf(spellKey) !== -1) return;
						if (spellObj.discipleOfLife || otherHealSpells.indexOf(spellKey) !== -1) {
							var useSpellDescr = getSpellShortDescription(spellKey, spellObj).replace(/spell(casting)? (ability )?mod(ifier)?/i, "spell mod");
							switch (spellKey) {
								case "heal" :
								case "life transference" :
								case "mass heal" :
									useSpellDescr = useSpellDescr.replace(" in range", "").replace(" I can see", "").replace("blindness, deafness", "blind, deaf");
									break;
								case "regenerate" :
									useSpellDescr = useSpellDescr.replace(" for the duration; restores lost body", "; regrow");
									break;
								case "resurrection" :
								case "true resurrection" :
									useSpellDescr = useSpellDescr.replace(" with", ", ").replace("century", "100y").replace("1000gp", "1k gp");
									break;
								case "raise dead" :
								case "revivify" :
									useSpellDescr = useSpellDescr.replace(/(Resurrects?|Restores?) (a )?crea(ture)?('s)? (body )?that (has )?died in( the)?/i, "Restore crea that died in");
									break;
							};
							var alwaysOthers = ["life transference", "raise dead", "revivify", "resurrection", "true resurrection"];
							var strPart = alwaysOthers.indexOf(spellKey) === -1 ? "; if other, I heal " : "; I heal ";
							var strAdd = spellObj.level < 9 ? strPart + (spellObj.level + 2) + (spellObj.noSpellUpcasting ? "" : "+1/SL") + " HP" : strPart + "11 HP";
							spellObj.description = useSpellDescr + strAdd;
							return true;
						}
					},
					"When I cast a spell that restores hit points to another creature than myself at the moment of casting, I also heal 2 + the level of the spell slot (or spell slot equivalent) hit points.",
				],
			},
		},
		"subclassfeature17" : { //Ripped directly from ListClasses.js
			name : "Supreme Healing",
			source : [["UA23PT6", 14], ["MJ:HB", 0], ["SRD", 17], ["P", 60]],
			minlevel : 17,
			description : desc("When I restore HP with a spell, I heal the maximum amount instead of rolling the dice"),
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (!spellObj.discipleOfLife) return;
						return genericSpellDmgEdit(spellKey, spellObj, "heal", false, false, true, true);
					},
					"When I use a spell that restores hit points by rolling one or more dice to restore hit points with a spell, I instead use the highest number possible for each die.",
				],
			},
		},
	},
});

////// Add UA23PT6 Light Domain Cleric subclass
AddSubClass("cleric_ua23pt6", "light domain_ua23pt6", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*\b(light|sun)\b).*$/i,
	subname : "Light Domain",
	source : [["UA23PT6", 14], ["MJ:HB", 0], ["P", 61]],
	spellcastingExtra : ["arcane eye", "burning hands", "daylight", "faerie fire", "fireball", "flame strike", "moonbeam", "scrying", "see invisibility", "wall of fire"],
	features : {
		"subclassfeature3" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Warding Flare",
			source : [["UA23PT6", 14], ["MJ:HB", 0], ["P", 61]],
			minlevel : 3,
			description : desc([
				"When a creature within 30 ft attacks a creature and I can see it, I can interpose divine light",
				"As a Reaction, I impose disadv. on the attacker's attack roll (unless it can't be blinded)",
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			action : ["reaction", ""],
		},
		"subclassfeature3.1" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Channel Divinity: Radiance of the Dawn",
			source : [["UA23PT6", 14], ["MJ:HB", 0], ["P", 61]],
			minlevel : 3,
			description : "\n   " + "As a Magic action, in 30 ft, magical darkness is dispelled and hostiles must make a Con save" + "\n   " + "Each takes radiant damage, saves for half, and negates with total cover",
			additional : ["", "", "2d10 + 3 damage", "2d10 + 4 damage", "2d10 + 5 damage", "2d10 + 6 damage", "2d10 + 7 damage", "2d10 + 8 damage", "2d10 + 9 damage", "2d10 + 10 dmg", "2d10 + 11 dmg", "2d10 + 12 dmg", "2d10 + 13 dmg", "2d10 + 14 dmg", "2d10 + 15 dmg", "2d10 + 16 dmg", "2d10 + 17 dmg", "2d10 + 18 dmg", "2d10 + 19 dmg", "2d10 + 20 dmg"],
			action : ["action", ""],
		},
		"subclassfeature6" : {
			name : "Revealing Light",
			source : [["UA23PT6", 14], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"Once per Long Rest, I can use a Bonus Action to cast \"See Invisibility\" without expending a spell slot.",
				"Allies within 10 ft of me also gain the benefit of the spell. I can end spell with a Bonus Action.",
				"While spell is active, I emite Bright Light in a 10 ft rad & Dim Light for another 10 ft.",
			]),
			action : ["bonus action", " (start/stop)"],
			usages : 1,
			recovery : "long rest",
		},
		"subclassfeature17" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Corona of Light",
			source : [["UA23PT6", 14], ["MJ:HB", 0], ["P", 61]],
			minlevel : 17,
			description : "\n   " + "As a Magic action, I have an aura of 60 ft sunlight and 30 ft dim light for 1 min" + "\n   " + "Enemies in the sunlight have disadv. on saves vs. spells (inc. Radiance of the Dawn) that deal fire or radiant damage",
			action : ["action", " (start/stop)"],
		},
	},
});

////// Add UA23PT6 Trickery Domain Cleric subclass
AddSubClass("cleric_ua23pt6", "trickery domain_ua23pt6", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*(trickery|trickster)).*$/i,
	subname : "Trickery Domain",
	source : [["UA23PT6", 15], ["MJ:HB", 0], ["P", 63]],
	spellcastingExtra : ["charm person", "disguise self", "pass without trace", "invisibility", "hypnotic pattern", "nondetection", "confusion", "dimension door", "hold monster", "mislead"],
	features : {
		"subclassfeature3" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Blessing of the Trickster",
			source : [["UA23PT6", 15], ["MJ:HB", 0], ["P", 63]],
			minlevel : 3,
			description : "\n   " + "As an action, a willing creature I touch (including me) has adv. on Dex (Stealth) checks" + "\n   " + "This lasts for 1 hour or until I use it again",
			action : ["action", ""],
		},
		"subclassfeature3.1" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Channel Divinity: Invoke Duplicity",
			source : [["UA23PT6", 15], ["MJ:HB", 0], ["P", 63]],
			minlevel : 3,
			description : desc([
				"As a free action, I create an illusory duplicate of myself within 30 ft of me for 1 min",
				"As a Bonus Action, I can move them 30 ft to a space I can see within 120 ft & can swap places with it",
				"I can cast spells as though I was in the duplicate's space, using my own senses",
				"I have advantage on attacks if the target is within 5 ft of a duplicate and me",
			]),
			action : ["bonus action", "Move Duplicate"],
		},
		"subclassfeature6" : {
			name : "Trickster's Magic",
			source : [["UA23PT6", 15], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"I can cast an Illusion spell with an Action casting time using a Bonus Action instead.",
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
		},
		"subclassfeature17" : {
			name : "Improved Duplicity",
			source : [["UA23PT6", 15], ["MJ:HB", 0], ["P", 63]],
			minlevel : 17,
			description : desc([
				"I can initially teleport up to a range of 120 ft instead of 30 ft.",
				"The duplicate can now move 60 ft per Bonus Action.",
				"Both myself and my allies have advantage on attacks if the target is within 5 ft of the duplicate.",
				"When illusion ends, myself or a creature of my choice regains HP equal to my Cleric lvl.",
			]),
		},
	},
});

////// Add UA23PT6 War Domain Cleric subclass
AddSubClass("cleric_ua23pt6", "war domain_ua23pt6", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*\b(war|fighting)\b).*$/i,
	subname : "War Domain",
	source : [["UA23PT6", 16], ["MJ:HB", 0], ["P", 63]],
	spellcastingExtra : ["crusader's mantle", "destructive wave", "divine favor", "freedom of movement", "hold monster", "magic weapon", "shield of faith", "spirit guardians", "spiritual weapon", "spiritual weapon ua22cs", "stoneskin"],
	features : {
		"subclassfeature3" : {
			name : "War Priest",
			source : [["UA23PT6", 16], ["MJ:HB", 0], ["P", 63]],
			minlevel : 3,
			description : desc([
				"When I use the Attack action, I can make a weapon attack as a bonus action",
				"I can use the Mastery property of one kind of Simple or Martial weapon I have Proficiency in.",
				"I can swap out the chosen weapon I can use the Mastery property of after a Long Rest",
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			action : ["bonus action", " (with Attack action)"],
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Guided Strike",
			source : [["UA23PT6", 16], ["MJ:HB", 0], ["P", 63]],
			minlevel : 3,
			description : desc([
				"When myself or a creature within 30 ft misses an attack roll, I can use my Reaction to",
				"expend a use of my Channel Divinity to add a +10 bonus to the roll.",
			]),
			action : ["reaction", ""],
		},
		"subclassfeature6" : {
			name : "Channel Divinity: War God's Blessing",
			source : [["UA23PT6", 16], ["MJ:HB", 0], ["P", 63]],
			minlevel : 6,
			description : desc([
				"When I cast the \"Shield of Faith\" spell, the spell affects both myself & the creature it is cast on.",
				"Once per Long Rest, I can cast the \"Shield of Faith\" spell without expending a spell slot.",
			]),
			usages : 1,
			recovery : "long rest",
			action : ["action", ""],
		},
		"subclassfeature17" : {
			name : "Avatar of Battle",
			source : [["UA23PT6", 16], ["MJ:HB", 0], ["P", 63]],
			minlevel : 17,
			description : "\n   " + "I have resistance to Bludgeoning/Piercing/Slashing damage",
			dmgres : ["Bludgeoning", "Piercing", "Slashing"],
		},
	},
});

// Add UA23PT6 Paladin class
ClassList.paladin_ua23pt6 = {
	name : "Paladin (UA:PT-vi)",
	regExpSearch : /^((?=.*paladin)|((?=.*(exalted|sacred|holy))(?=.*(knight|fighter|warrior|warlord)))).*$/i,
	source : [["UA23PT6", 32], ["MJ:HB", 0]],
	primaryAbility : "Strength and Charisma",
	prerequisite : "Strength 13+ and Charisma 13+",
	prereqeval : function(v) {
		return What('Str') >= 13 && What('Cha') >= 13;
	},
	die : 10,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
	saves : ["Wis", "Cha"],
	skills : ["\n\n" + toUni("Paladin") + ": Choose two from Athletics, Insight, Intimidation, Medicine, Persuasion, Religion", ""],
	armor : [
		[true, true, true, true],
		[false, false, false, false],
	],
	weapons : [
		[true, true, [""]],
		[true, true, [""]],
	],
	equipment : "Paladin starting equipment:" +
		"\n \u2022 Chain mail," +
		"\n \u2022 Holy Symbol," +
		"\n \u2022 Javelin (6)," +
		"\n \u2022 Longsword," +
		"\n \u2022 Priest's Pack," +
		"\n \u2022 Shield," +
		"\n \u2022 and 9 gp;" +
		"\n\nAlternatively, choose 150 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Sacred Oath", []],
	attacks : [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	abilitySave : 6,
	spellcastingFactor : 2,
	spellcastingKnown : {
		spells : "list",
		prepared : true
	},
	spellcastingList : {
		class : ["paladin", "paladin_ua23pt6"],
	},
	features : {
		"lay on hands ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Lay on Hands",
			source : [["UA23PT6", 34], ["SRD", 31], ["P", 84], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"As a Bonus Action, I can use points in my pool to heal a touched, living creature's hit points",
				"I can neutralize poisons/diseases instead at a cost of 5 points per affliction",
				"Note that diseases have been rolled into the Poisoned condition as of UA23PT6",
			]),
			usages : [5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100],
			recovery : "long rest",
			action : [
				["bonus action", ""],
			],
		},
		"spellcasting ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Spellcasting",
			source : [["UA23PT6", 34], ["SRD", 31], ["P", 84], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can cast prepared paladin spells, using Charisma as my spellcasting ability",
				"I can use a holy symbol as a spellcasting focus for my paladin spells",
			]),
		},
		"weapon mastery ua23pt6" : { //Using Reaction Fields for this because there are too many possible weapons to choose from and I don't know how to code FeatureChoices to take that vast number of possible weapons into account.
			name : "Weapon Mastery",
			source : [["UA23PT6", 34], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can use the Mastery property of two kinds of weapons of my choice with which I have proficiency.",
				"I can change what weapons I can use the Mastery property of after finishing a Long Rest.",
			]),
			calcChanges : {
				atkAdd : masteryFunctions.weaponMasteryAtkAdd
			},
			action : [
				["reaction", "Wpn Mstry 1: [Wpn Name]"],
				["reaction", "Wpn Mstry 2: [Wpn Name]"],
			],
		},
		"paladins smite ua23pt6" : {
			name : "Paladin's Smite",
			source : [["UA23PT6", 34], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"I always have certain smite spells ready. Once per Long Rest, I can cast one of them without using a spell slot.",
				"At 2nd Lvl, I gain access to: Divine Smite & Thunderous Smite; At 5th Lvl, I gain access to: Shining Smite;",
				"At 9th Lvl, I gain access to: Blinding Smite; At 13th Lvl, I gain access to: Staggering Smite;",
				"At 17th Lvl, I gain access to: Banishing Smite",
			]),
			spellcastingExtra : ["banishing smite ua23pt6", "blinding smite ua23pt6", "divine smite ua23pt6", "shining smite ua23pt6", "staggering smite ua23pt6", "thunderous smite ua23pt6"],
		},
		"fighting style ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Fighting Style",
			source : [["UA23PT6", 34], ["SRD", 31], ["P", 84], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"Choose a Fighting Style feat for the paladin using the \"Choose Feature\" button above.",
				"The chosen option will appear in pg 3's Notes section & in the list of feats",
			]),
		},
		"channel divinity ua23pt6" : {
			name : "Channel Divinity",
			source : [["UA23PT6", 35], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can channel divine energy to cause an effect; the save for this is my paladin spell DC.",
				"Available effect is Divine Sense; I gain additional effect options at higher levels in this class.",
				"I can use Channel Divinity 2 times at 2nd Level & 3 times at Paladin Level 11 onward.",
			]),
			additional : "; regain 1 per Short Rest",
			usages : [0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
			recovery : "long rest",
		},
		"divine sense ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Channel Divinity: Divine Sense",
			source : [["UA23PT6", 35], ["SRD", 30], ["P", 84], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I sense celestials/fiends/undead/consecrated/desecrated within 60 ft",
				"For 10 minutes or until Incapacitated, I sense the location of any creature of those types & know its creature type"
			]),
			action : ["bonus action", ""],
		},
		"subclassfeature3" : { //Ripped directly from ListClasses.js and then altered
			name : "Sacred Oath",
			source : [["SRD", 16], ["P", 58]],
			minlevel : 3,
			description : desc('Choose a Sacred Oath you swear to and put it in the "Class" field '),
		},
		"faithful steed ua23pt6" : {
			name : "Faithful Steed",
			source : [["UA23PT6", 35], ["MJ:HB", 0]],
			minlevel : 5,
			description : desc([
				"I now always have the Find Steed (UA23PT6) spell prepared.",
			]),
			spellcastingBonus : {
				name : "Find Steed (UA23PT6)",
				spells : ["find steed ua23pt6"],
				selection : ["find steed ua23pt6"],
				times : 1,
			},
		},
		"aura of protection ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Aura of Protection",
			source : [["UA23PT6", 35], ["SRD", 32], ["P", 85], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"While I'm conscious and not Incapacitated, allies not behind Total Cover within range and I can add my Cha mod (min 1) to saves.",
				"A creature can benefit from only one Aura of Protection at a time, choosing which when entering the auras.",
				"Aura increases in size to a 30 ft radius at Paladin Level 18.",
			]),
			additional : ["", "", "", "", "", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "30-foot aura", "30-foot aura", "30-foot aura"],
			addMod : { type : "save", field : "all", mod : "max(Cha|1)", text : "While I'm conscious I can add my Charisma modifier (min 1) to all my saving throws." },
		},
		"abjure foes ua23pt6" : {
			name : "Channel Divinity: Abjure Foes",
			source : [["UA23PT6", 12], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"As a Magic action, in 30 ft, target Cha mod (min 1) number of creatures I can see within 60 ft",
				"Each must succeed Wis saving throw or have Dazed & Frightened conditions for 1 min or until it takes damage",
			]),
			action : ["action", ""],
		},
		"aura of courage ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Aura of Courage",
			source : [["UA23PT6", 35], ["SRD", 32], ["P", 85], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"While I'm conscious, allies within range of Aura of Protection and I can't be frightened",
				"Frightened allies that enter the aura are no longer affected by the condition while in the aura",
				"Aura increases in size to a 30 ft radius at Paladin Level 18.",
			]),
			additional : ["", "", "", "", "", "", "", "", "", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "30-foot aura", "30-foot aura", "30-foot aura"],
			savetxt : { immune : ["frightened"] },
		},
		"radiant strikes ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Radiant Strikes",
			source : [["UA23PT6", 35], ["SRD", 32], ["P", 85], ["MJ:HB", 0]],
			minlevel : 11,
			description : desc("Whenever I hit a creature with a melee weapon or unarmed strike, I do an extra 1d8 radiant damage"),
			calcChanges : {
				atkAdd : [
					function (fields, v) { //Not sure if I set the below function up correctly
						if (v.isMeleeWeapon||(v.isNaturalWeapon && v.isMeleeWeapon)) fields.Description += (fields.Description ? '; ' : '') + '+1d8 Radiant damage';
					},
					"With my melee weapon & unarmed strike attacks I deal an extra 1d8 radiant damage."
				]
			},
		},
		"restoring touch ua23pt6" : {
			name : "Restoring Touch",
			source : [["UA23PT6", 36], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"My Lay on Hands Feature can now also remove the following conditions, using 5 points from my pool for each condition:",
				"Blinded, Charmed, Dazed, Deafened, Frightened, Paralyzed, or Stunned.",
				"The points used to remove a condition do not also restore Hit Points to the creature.",
			]),
		},
	},
};

//// Add Paladin "Fighting Style" choices
AddFeatureChoice(ClassList.paladin_ua23pt6.features["fighting style ua23pt6"], true, "Fighting Style: Defense", {
	name : "Fighting Style: Defense",
	extraname : "Paladin 2",
	source : [["UA23PT6", 34], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Defense Fighting Style feat.",
	prereqeval : function (v) { return classes.known.paladin_ua23pt6.level >= 2 ? true : "skip"; },
	eval : function() { AddFeat("Defense Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Defense Fighting Style (UA23PT6)"); }
}, "2nd-level paladin Fighting Style choice");
AddFeatureChoice(ClassList.paladin_ua23pt6.features["fighting style ua23pt6"], true, "Fighting Style: Dueling", {
	name : "Fighting Style: Dueling",
	extraname : "Paladin 2",
	source : [["UA23PT6", 34], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Dueling Fighting Style feat.",
	prereqeval : function (v) { return classes.known.paladin_ua23pt6.level >= 2 ? true : "skip"; },
	eval : function() { AddFeat("Dueling Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Dueling Fighting Style (UA23PT6)"); }
}, "2nd-level paladin Fighting Style choice");
AddFeatureChoice(ClassList.paladin_ua23pt6.features["fighting style ua23pt6"], true, "Fighting Style: Great Weapon Fighting", {
	name : "Fighting Style: Great Weapon Fighting",
	extraname : "Paladin 2",
	source : [["UA23PT6", 34], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Great Weapon Fighting Style feat.",
	prereqeval : function (v) { return classes.known.paladin_ua23pt6.level >= 2 ? true : "skip"; },
	eval : function() { AddFeat("Great Weapon Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Great Weapon Fighting Style (UA23PT6)"); }
}, "2nd-level paladin Fighting Style choice");
AddFeatureChoice(ClassList.paladin_ua23pt6.features["fighting style ua23pt6"], true, "Fighting Style: Protection", {
	name : "Fighting Style: Protection",
	extraname : "Paladin 2",
	source : [["UA23PT6", 34], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Protection Fighting Style feat.",
	prereqeval : function (v) { return classes.known.paladin_ua23pt6.level >= 2 ? true : "skip"; },
	eval : function() { AddFeat("Protection Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Protection Fighting Style (UA23PT6)"); }
}, "2nd-level paladin Fighting Style choice");

//// Add Paladin optional choices; Ripped directly from all_WotC_pub+UA.js and then altered
AddFeatureChoice(ClassList.paladin_ua23pt6.features["spellcasting ua23pt6"], true, "Access to Dunamancy Spells", {
	name : "Dunamancy Spells",
	extraname : "Optional Paladin 2",
	source : [["W", 186]],
	description : desc([
		"All dunamancy spells are added to the paladin spell list, each still pending DM's approval"
	]),
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "paladin_ua23pt6" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["gift of alacrity", "magnify gravity", "fortune's favor", "immovable object", "wristpocket", "pulse wave", "gravity sinkhole", "temporal shunt"]);
			},
			"This optional class feature expands the spell list of the paladin class with all dunamancy spells (spell level in brackets): Gift of Alacrity (1), Magnify Gravity (1), Fortune's Favor (2), Immovable Object (2), Wristpocket (2), Pulse Wave (3), Gravity Sinkhole (4), and Temporal Shunt (5)."
		]
	}
}, "Optional 2nd-level paladin features");
AddFeatureChoice(ClassList.paladin_ua23pt6.features["spellcasting ua23pt6"], true, "Additional Paladin Spells", {
	name : "Additional Paladin Spells",
	extraname : "Optional Paladin 2",
	source : [["T", 52]],
	description : "",
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "paladin_ua23pt6" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["gentle repose", "prayer of healing", "warding bond"]);
			},
			"This optional class feature expands the spell list of the paladin class with the following spells (spell level in brackets): Gentle Repose (2), Prayer of Healing (2), and Warding Bond (2)."
		]
	}
}, "Optional 2nd-level paladin features");
AddFeatureChoice(ClassList.paladin_ua23pt6.features["channel divinity ua23pt6"], true, "Harness Divine Power", {
	name : "Channel Divinity: Harness Divine Power",
	extraname : "Optional Paladin 3",
	source : [["T", 52]],
	description : desc([
		"As a bonus action, I can expend a use of my channel divinity to regain one used spell slot",
		"The level of this spell slot can be no more than half my Proficiency Bonus (rounded up)",
		"I can only do this so many times per long rest, even if I have uses of channel divinity left"
	]),
	action : [["bonus action", ""]],
	usages : levels.map(function(n) {
		return n < 3 ? "" : n < 11 ? 1 : 2;
	}),
	recovery : "long rest"
}, "Optional 3rd-level paladin features");
AddFeatureChoice(ClassList.paladin_ua23pt6.features["divine sense ua23pt6"], true, "Martial Versatility", {
	name : "Martial Versatility",
	extraname : "Optional Paladin 4",
	source : [["T", 53]],
	description : " [ASI = Ability Score Improvement]\n   Whenever I gain an ASI from the paladin class, I can change my paladin fighting style",
	prereqeval : function (v) { return classes.known.paladin_ua23pt6.level >= 4 ? true : "skip"; }
}, "Optional 4th-level paladin features");

////// Add UA23PT6 Oath of Devotion Paladin subclass
AddSubClass("paladin_ua23pt6", "oath of devotion_ua23pt6", {
	regExpSearch : /^(?=.*(devotion))((?=.*paladin)|((?=.*(exalted|sacred|holy))(?=.*(knight|fighter|warrior|warlord)))).*$/i,
	subname : "Oath of Devotion",
	source : [["UA23PT6", 36], ["SRD", 32], ["P", 86], ["MJ:HB", 0]],
	spellcastingExtra : ["aid", "aid ua22cs", "beacon of hope", "commune", "dispel magic", "flame strike", "freedom of movement", "guardian of faith", "protection from evil and good", "shield of faith", "zone of truth"],
	toNotesPage : [{
		name : "Tenants of Devotion",
		note : [
			"Though the exact words and strictures of the Oath of Devotion vary, Paladins of this oath share these tenets:",
			" \u2022 Honesty. Don’t lie or cheat. Let your word be your promise.",
			" \u2022 Courage. Never fear to act, though caution is wise.",
			" \u2022 Compassion. Aid others, protect the weak, and punish those who threaten them. Show mercy to your foes, but temper it with wisdom.",
			" \u2022 Honor. Treat others with fairness, and let your honorable deeds be an example to them.",
			" \u2022 Duty. Be responsible for your actions and their consequences, protect those entrusted to your care, and obey those who have just authority over you.",
		],
		page3notes : true,
		popupName : "Tenants of Devotion",
		source : [["UA23PT6", 37], ["MJ:HB", 0]],
	}],
	features : {
		"subclassfeature3" : { //Ripped directly from ListClasses.js and then altered
			name : "Channel Divinity: Sacred Weapon",
			source : [["UA23PT6", 37], ["SRD", 33], ["P", 86], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, for 1 minute, I add my Cha modifier to hit for one weapon I'm holding",
				"It emits bright light in a 20-ft radius and equal dim light, & I can choose to deal Radiant dmg instead of normal dmg",
				"Effect ends if Incapacitated, not holding or carrying the weapon, or willingly end it with a Bonus Action",
			]),
			action : ["bonus action", ""],
			calcChanges : {
				atkCalc : [
					function (fields, v, output) {
						if (classes.known.paladin_ua23pt6 && classes.known.paladin_ua23pt6.level > 2 && !v.isSpell && (/^(?=.*sacred)(?=.*weapon).*$/i).test(v.WeaponTextName)) {
							output.extraHit += What('Cha Mod');
						};
					},
					"If I include the words 'Sacred Weapon' in the name of a weapon, it gets my Charisma modifier added to its To Hit."
				]
			},
		},
		"subclassfeature7" : { //Ripped directly from ListClasses.js and then altered
			name : "Aura of Devotion",
			source : [["UA23PT6", 37], ["SRD", 33], ["P", 86], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc([
				"While I'm conscious, allies within range and I can't be charmed",
				"Aura increases in size to a 30 ft radius at Paladin Level 18.",
			]),
			additional : ["", "", "", "", "", "", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "30-foot aura", "30-foot aura", "30-foot aura"],
			savetxt : { immune : ["charmed"] },
		},
		"subclassfeature15" : {
			name : "Blessed Healer",
			source : [["UA23PT6", 37], ["MJ:HB", 0]],
			minlevel : 15,
			description : desc([
				"When I cast any of my Paladin's Smite spells, allies within range and I have Half Cover (+2 AC)",
				"Effect ends at the start of my next turn",
			]),
		},
		"subclassfeature20" : { //Ripped directly from ListClasses.js and then altered
			name : "Holy Nimbus",
			source : [["UA23PT6", 37], ["SRD", 33], ["P", 86], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"As an Bonus Action, I shine with a 30-ft radius bright light and equal dim light for 1 minute",
				"If an enemy starts its turn in the bright light, it takes Radiant damage equal to Prof Bonus + Cha mod",
				"For the duration, I have advantage on saves vs. spells cast by fiends and undead",
				"I can do this once per long rest, or by expending a 5th-level or higher spell slot (SS 5+)",
			]),
			recovery : "long rest",
			usages : 1,
			altResource : "SS 5+",
			action : ["bonus action", ""],
		},
	},
});

////// Add UA23PT6 Oath of Glory Paladin subclass
AddSubClass("paladin_ua23pt6", "oath of glory_ua23pt6", {
	regExpSearch : /^(?=.*(devotion))((?=.*paladin)|((?=.*(exalted|sacred|holy))(?=.*(knight|fighter|warrior|warlord)))).*$/i,
	subname : "Oath of Glory",
	source : [["UA23PT6", 37], ["T", 53], ["MOT", 29], ["MJ:HB", 0]],
	spellcastingExtra : ["guiding bolt", "heroism", "enhance ability", "magic weapon", "haste", "protection from energy", "compulsion", "freedom of movement", "commune", "flame strike"],
	toNotesPage : [{
		name : "Tenants of Glory",
		note : [
			"Though the exact words and strictures of the Oath of Glory vary, Paladins of this oath share these tenets:",
			" \u2022 Actions over Words. Strive to be known by glorious deeds, not words.",
			" \u2022 Challenges Are but Tests. Face hardships with courage, and encourage your allies to face them with you.",
			" \u2022 Hone the Body. Like raw stone, your body must be worked so its potential can be realized.",
			" \u2022 Discipline the Soul. You must marshal the discipline to overcome failings within yourself that threaten to dim the glory of you and your friends.",
		],
		page3notes : true,
		popupName : "Tenants of Glory",
		source : [["UA23PT6", 38], ["MJ:HB", 0]],
	}],
	features : {
		"subclassfeature3" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Channel Divinity: Peerless Athlete",
			source : [["UA23PT6", 38], ["T", 54], ["MOT", 29], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can get adv. on Str (Athletics) \u0026 Dex (Acrobatics) checks for 1 hour",
				"In that time, I also add +10 ft to jumps, and double what I can carry, push, drag, \u0026 lift"
			]),
			action : [["bonus action", ""]],
		},
		"subclassfeature3.1" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Channel Divinity: Inspiring Smite",
			source : [["UA23PT6", 38], ["T", 54], ["MOT", 29], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"Immediately after dealing damage with any Paladin's Smite, I can grant temporary HP",
				"I distribute the temporary HP how I choose across creatures within 30 ft, including me"
			]),
			additional : levels.map(function (n) {
				return n < 3 ? "" : "2d8 + " + n + " temporary HP";
			}),
		},
		"subclassfeature7" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Aura of Alacrity",
			source : [["UA23PT6", 38], ["T", 54], ["MOT", 29], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc([
				"If I'm not incapacitated, allies and I starting their turn in range gain bonus speed for that turn.",
				"Aura increases in size to a 30 ft radius at Paladin Level 18.",
			]),
			speed : { walk : { spd : "+10", enc : "+10" } },
			additional : "+10 ft walking speed",
		},
		"subclassfeature15" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Glorious Defense",
			source : [["UA23PT6", 38], ["T", 54], ["MOT", 29], ["MJ:HB", 0]],
			minlevel : 15,
			description : desc([
				"As a reaction when I or another in 10 ft is hit with an attack roll, I can grant bonus AC",
				"I must be able to see the attacker; I add my Cha mod (min 1) to the AC for that attack",
				"If it misses, I can do a weapon attack vs. the attacker, if in reach, as part of this reaction"
			]),
			usages : "Charisma modifier per ",
			usagescalc : "event.value = Math.max(1, What('Cha Mod'));",
			recovery : "long rest",
			action : [["reaction", ""]],
		},
		"subclassfeature20" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Living Legend",
			source : [["UA23PT6", 38], ["T", 54], ["MOT", 29], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"As a bonus action, I can empower myself with legends, gaining the following for 1 min:",
				" \u2022 My otherworldly presence grants me advantage on Charisma checks",
				" \u2022 Once on each of my turns when I miss with a weapon attack, I can have it hit instead",
				" \u2022 As a reaction when I fail a saving throw, I can reroll it, but must use the new roll",
				"I can do this once per long rest, or by expending a 5th-level or higher spell slot (SS 5+)",
			]),
			recovery : "long rest",
			usages : 1,
			altResource : "SS 5+",
			action : [["bonus action", ""]],
		},
	},
});

////// Add UA23PT6 Oath of the Ancients Paladin subclass
AddSubClass("paladin_ua23pt6", "oath of of the ancients_ua23pt6", {
	regExpSearch : /^(((?=.*(ancient|nature|natural|green|fey))((?=.*paladin)|((?=.*(exalted|sacred|holy))(?=.*(knight|fighter|warrior|warlord)))))|((?=.*(green|fey))(?=.*(knight|fighter|warrior|warlord)))).*$/i,
	subname : "Oath of the Ancients",
	source : [["UA23PT6", 38], ["SRD", 32], ["P", 86], ["MJ:HB", 0]],
	spellcastingExtra : ["ensnaring strike", "speak with animals", "moonbeam", "misty step", "plant growth", "protection from energy", "ice storm", "stoneskin", "commune with nature", "tree stride"],
	toNotesPage : [{
		name : "Tenants of the Ancients",
		note : [
			"Though the exact words and strictures of the Oath of Ancients vary, Paladins of this oath share these tenets:",
			" \u2022 Kindle the Light. Through your acts of mercy, kindness, and forgiveness, kindle the light of hope in the world, beating back despair.",
			" \u2022 Shelter the Light. Where life flourishes, stand against the forces that would render it barren.",
			" \u2022 Preserve Your Own Light. Delight in song, laughter, and art. If you allow the light to die in your own heart, you can’t preserve it in the world.",
			" \u2022 Be the Light. Be a glorious beacon for all who live in despair. Let the light of your joy and courage shine forth in all your deeds.",
		],
		page3notes : true,
		popupName : "Tenants of the Ancients",
		source : [["UA23PT6", 39], ["MJ:HB", 0]],
	}],
	features : {
		"subclassfeature3" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Channel Divinity: Nature's Wrath",
			source : [["UA23PT6", 39], ["P", 87], ["MJ:HB", 0]],
			minlevel : 3,
			description : "\n   " + "As an action, creatures of my choice I can see within 15 ft must make a Str save" + "\n   " + "If it fails this save, it is Restrained for 1 min or until it succeeds on a save at the end of its turn",
			action : ["action", ""],
		},
		"subclassfeature7" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Aura of Warding",
			source : [["UA23PT6", 39], ["P", 87], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc([
				"Allies within range and I can't be have resistance to Necrotic, Psychic, and Radiant damage.",
				"Aura increases in size to a 30 ft radius at Paladin Level 18.",
			]),
			additional : ["", "", "", "", "", "", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "30-foot aura", "30-foot aura", "30-foot aura"],
			dmgres : ["Necrotic", "Psychic", "Radiant"],
		},
		"subclassfeature15" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Undying Sentinel",
			source : [["UA23PT6", 39], ["P", 87], ["MJ:HB", 0]],
			minlevel : 15,
			description : "\n   " + "If dropped to 0 hit points and not killed outright, I can choose to stay at 1 hit point, and I regain HP equal to 3x my Paladin Lvl" + "\n   " + "Additionally, I suffer no drawbacks of old age and can't be aged magically",
			additional : ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "Regain 45 HP", "Regain 48 HP", "Regain 51 HP", "Regain 54 HP", "Regain 57 HP", "Regain 60 HP"],
			recovery : "long rest",
			usages : 1,
		},
		"subclassfeature20" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Elder Champion",
			source : [["UA23PT6", 39], ["P", 87], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"As a Bonus Action, I imbue my Aura of Protection with primal power for 1 minute and gain benefits:",
				" \u2022 At the start of each of my turns, I regain 10 hit points",
				" \u2022 I can cast spells with a casting time of 1 action as a Bonus Action instead",
				" \u2022 Enemies within the aura have disadv. on saves vs. my spells and channel divinity",
				"I can do this once per long rest, or by expending a 5th-level or higher spell slot (SS 5+)",
			]),
			recovery : "long rest",
			usages : 1,
			altResource : "SS 5+",
			action : [["bonus action", ""]],
		},
	},
});

////// Add UA23PT6 Oath of Vengeance Paladin subclass
AddSubClass("paladin_ua23pt6", "oath of vengeance_ua23pt6", {
	regExpSearch : /^(((?=.*(vengeance|wrath))((?=.*paladin)|((?=.*(exalted|sacred|holy))(?=.*(knight|fighter|warrior|warlord)))))|((?=.*dark)(?=.*knight))|(?=.*avenger)).*$/i,
	subname : "Oath of Vengeance",
	source : [["UA23PT6", 39], ["P", 88], ["MJ:HB", 0]],
	spellcastingExtra : ["bane", "compelled duel", "hold person", "misty step", "haste", "protection from energy", "banishment", "banishment ua22cs", "dimension door", "hold monster", "scrying"],
	toNotesPage : [{
		name : "Tenants of Vengeance",
		note : [
			"Though the exact words and strictures of the Oath of Vengeance vary, Paladins of this oath share these tenets:",
			" \u2022 Fight the Greater Evil. Faced with a choice of fighting my sworn foes or combating a lesser evil, I choose the greater evil.",
			" \u2022 No Mercy for the Wicked. Ordinary foes might win my mercy, but my sworn enemies do not.",
			" \u2022 By Any Means Necessary. My qualms can’t get in the way of exterminating my foes.",
			" \u2022 Restitution. If my foes wreak ruin on the world, it is because I failed to stop them. I must help those harmed by my misdeeds.",
		],
		page3notes : true,
		popupName : "Tenants of Vengeance",
		source : [["UA23PT6", 40], ["MJ:HB", 0]],
	}],
	features : {
		"subclassfeature3" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Channel Divinity: Vow of Enmity",
			source : [["UA23PT6", 40], ["P", 88], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I utter a vow against a creature I can see within 30 ft.",
				"I get adv. on attacks against it for 1 minute or until it drops to 0 HP or falls Unconscious.",
				"If the creature drops to 0HP or falls Unconscious before vow ends, I can transfer the vow to a difference creature.",
				"This transfer can be done no more than once per turn.",
			]),
			action : ["bonus action", ""],
		},
		"subclassfeature7" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Relentless Avenger",
			source : [["UA23PT6", 40], ["P", 88], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc([
				"After I hit with an Opportunity Attack, I can reduce the creature Speed to 0.",
				"I can also move 1/2 my Speed in the same Reaction; this movement doesn't provoke Opportunity Attacks",
			]),
		},
		"subclassfeature15" : { //Ripped directly from all_WotC_pub+UA.js; UA text technically worded differently from 2014 text, but identical effect, so this gets the UA source
			name : "Soul of Vengeance",
			source : [["UA23PT6", 40], ["P", 88], ["MJ:HB", 0]],
			minlevel : 15,
			description : "\n   " + "When an enemy I have an active Vow of Enmity against makes an attack, I can react" + "\n   " + "As a reaction, I can make a melee weapon attack against it if it is within range",
			action : ["reaction", " (with Vow of Enmity)"],
		},
		"subclassfeature20" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Avenging Angel",
			source : [["UA23PT6", 40], ["P", 88], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"As an Bonus Action, I imbue my Aura of Protection with primal power for 10 minutes and gain benefits:",
				" \u2022 I gain a Fly Speed equal to my Speed and I can Hover",
				" \u2022 When an enemy creature first enters or starts its turn in the aura, it must make a Wis save",
				" \u2022 If failed, for 1 min or until it takes damage, it is frightened and attacks vs. it have adv.",
				"I can do this once per long rest, or by expending a 5th-level or higher spell slot (SS 5+)",
			]),
			recovery : "long rest",
			usages : 1,
			altResource : "SS 5+",
			action : ["bonus action", ""]
		},
	},
});

// Add UA23PT6 Ranger class
ClassList.ranger_ua23pt6 = {
	name : "Ranger (UA:PT-vi)",
	regExpSearch : /^((?=.*(ranger))|((?=.*(nature))(?=.*(knight|fighter|warrior|warlord)))).*$/i,
	source : [["UA23PT6", 41], ["MJ:HB", 0]],
	primaryAbility : "Dexterity and Wisdom",
	prerequisite : "Dexterity 13+ and Wisdom 13+",
	prereqeval : function(v) {
		return What('Dex') >= 13 && What('Wis') >= 13;
	},
	die : 10,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
	saves : ["Str", "Dex"],
	skills : ["\n\n" + toUni("Ranger") + ": Choose three from Animal Handling, Athletics, Insight, Investigation, Nature, Perception, Stealth, Survival", ": Choose one from Animal Handling, Athletics, Insight, Investigation, Nature, Perception, Stealth, Survival"],
	armor : [
		[true, true, false, true],
		[true, true, false, true],
	],
	weapons : [
		[true, true, [""]],
		[false, true, [""]],
	],
	equipment : "Ranger starting equipment:" +
		"\n \u2022 Studded Leather Armor," +
		"\n \u2022 Arrows (20)," +
		"\n \u2022 Druidic Focus (Sprig of Mistletoe)," +
		"\n \u2022 Explorer's Pack," +
		"\n \u2022 Longsword or Shortbow," +
		"\n \u2022 Quiver," +
		"\n \u2022 Scimitar," +
		"\n \u2022 Shortsword," +
		"\n \u2022 and 7 gp;" +
		"\n\nAlternatively, choose 150 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Ranger Archetype", []],
	attacks : [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	abilitySave : 5,
	spellcastingFactor : 2,
	spellcastingKnown : {
		spells : "list",
		prepared : true
	},
	spellcastingList : {
		class : ["ranger", "ranger_ua23pt6"],
	},
	features : {
		"deft explorer ua23pt6" : { //Favored Terrain components ripped directly from ListClasses.js and then altered
			name : "Deft Explorer",
			source : [["UA23PT6", 42], ["SRD", 36], ["P", 91], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I gain Expertise in one of the skills I chose to be Proficient in when I chose the Ranger class.",
				"In addition, I choose two types of terrain using the \"Choose Feature\" button above.",
				"I have Adv. on Int (Nature) checks about the chosen terrains, and I have Adv. on Wis (Survival) checks to track creatures in them.",
				"I can replace one of the chosen terrain types after a Long Rest.",
			]),
			skillstxt : "Expertise in one of the skills I chose to be Proficient in when I chose the Ranger class.",
			extraname : "Favored Terrain",
			extrachoices : ["Arctic", "Coast", "Desert", "Forest", "Grassland", "Mountain", "Swamp", "Underdark"],
			extraTimes : levels.map(function (n) { return n < 9 ? 2 : 4; }),
			"arctic" : {
				name : "Arctic",
				source : [["UA23PT6", 42], ["SRD", 36], ["P", 91], ["MJ:HB", 0]],
				description : "",
			},
			"coast" : {
				name : "Coast",
				source : [["UA23PT6", 42], ["SRD", 36], ["P", 91], ["MJ:HB", 0]],
				description : "",
			},
			"desert" : {
				name : "Desert",
				source : [["UA23PT6", 42], ["SRD", 36], ["P", 91], ["MJ:HB", 0]],
				description : "",
			},
			"forest" : {
				name : "Forest",
				source : [["UA23PT6", 42], ["SRD", 36], ["P", 91], ["MJ:HB", 0]],
				description : "",
			},
			"grassland" : {
				name : "Grassland",
				source : [["UA23PT6", 42], ["SRD", 36], ["P", 91], ["MJ:HB", 0]],
				description : "",
			},
			"mountain" : {
				name : "Mountain",
				source : [["UA23PT6", 42], ["SRD", 36], ["P", 91], ["MJ:HB", 0]],
				description : "",
			},
			"swamp" : {
				name : "Swamp",
				source : [["UA23PT6", 42], ["SRD", 36], ["P", 91], ["MJ:HB", 0]],
				description : "",
			},
			"underdark" : {
				name : "Underdark",
				source : [["UA23PT6", 42], ["SRD", 36], ["P", 91], ["MJ:HB", 0]],
				description : "",
			},
		},
		"spellcasting ua23pt6" : { //Copied and altered from Paladin class in this script
			name : "Spellcasting",
			source : [["UA23PT6", 43], ["SRD", 31], ["P", 84], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can cast prepared ranger spells, using Wisdom as my spellcasting ability",
				"I can use a Druidic Focus as a spellcasting focus for my ranger spells",
			]),
		},
		"weapon mastery ua23pt6" : { //Using Reaction Fields for this because there are too many possible weapons to choose from and I don't know how to code FeatureChoices to take that vast number of possible weapons into account.
			name : "Weapon Mastery",
			source : [["UA23PT6", 43], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can use the Mastery property of two kinds of weapons of my choice with which I have proficiency.",
				"I can change what weapons I can use the Mastery property of after finishing a Long Rest.",
			]),
			calcChanges : {
				atkAdd : masteryFunctions.weaponMasteryAtkAdd
			},
			action : [
				["reaction", "Wpn Mstry 1: [Wpn Name]"],
				["reaction", "Wpn Mstry 2: [Wpn Name]"],
			],
		},
		"favored enemy ua23pt6" : {
			name : "Favored Enemy",
			source : [["UA23PT6", 43], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"I now always have the Hunter's Mark (UA23PT6) spell prepared.",
				"I can cast it Wis mod (min 1) times without using a spell slot per Long Rest.",
			]),
			spellcastingBonus : {
				name : "Hunter's Mark (UA23PT6)",
				spells : ["hunter's mark ua23pt6"],
				selection : ["hunter's mark ua23pt6"],
				times : 1,
			},
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			action : [["bonus action", " (Hunter's Mark)"]],
		},
		"fighting style ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Fighting Style",
			source : [["UA23PT6", 43], ["SRD", 36], ["P", 91], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"Choose a Fighting Style feat for the ranger using the \"Choose Feature\" button above.",
				"The chosen option will appear in pg 3's Notes section & in the list of feats",
			]),
		},
		"subclassfeature3" : { //Ripped directly from ListClasses.js
			name : "Ranger Archetype",
			source : [["SRD", 37], ["P", 92]],
			minlevel : 3,
			description : desc('Choose a Ranger Archetype you strive to emulate and put it in the "Class" field ')
		},
		"roving ua23pt6" : {
			name : "Roving",
			source : [["UA23PT6", 43], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"My Speed increases by 10 feet when not wearing Heavy Armor.",
				"I also gain a Climb & Swim Speed equal to my Speed.",
			]),
			speed : {
				climb : { spd : "walk", enc : "walk" },
				swim : { spd : "walk", enc : "walk" },
				allModes : "+10",
			},
		},
		"conjure barrage ua23pt6" : {
			name : "Conjure Barrage",
			source : [["UA23PT6", 44], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"I now always have the Conjure Barrage (UA23PT6) spell prepared.",
			]),
			spellcastingBonus : {
				name : "Conjure Barrage (UA23PT6)",
				spells : ["conjure barrage ua23pt6"],
				selection : ["conjure barrage ua23pt6"],
				times : 1,
			},
		},
		"tireless ua23pt6" : {
			name : "Tireless",
			source : [["UA23PT6", 44], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"Wis mod (min 1) number of times per Long Rest, I can use an action to gain Temp HP equal to 1d8 + Wis mod (min 1).",
				"Taking a Short Rest decreases my Exhaustion level, if any, by 1.",
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			action : [["action", " (Add Temp HP)"]],
		},
		"natures veil ua23pt6" : {
			name : "Nature's Veil",
			source : [["UA23PT6", 44], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"As a Bonus Action, I can make myself Invisible until the end of my next turn.",
				"I can do this a number times equal to my Wis mod (min 1).",
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			action : [["action", ""]],
		},
		"conjure volley ua23pt6" : {
			name : "Conjure Volley",
			source : [["UA23PT6", 44], ["MJ:HB", 0]],
			minlevel : 17,
			description : desc([
				"I now always have the Conjure Volley (UA23PT6) spell prepared.",
			]),
			spellcastingBonus : {
				name : "Conjure Volley (UA23PT6)",
				spells : ["conjure volley ua23pt6"],
				selection : ["conjure volley ua23pt6"],
				times : 1,
			},
		},
		"feral senses ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Feral Senses",
			source : [["UA23PT6", 44], ["SRD", 37], ["P", 92], ["MJ:HB", 0]],
			minlevel : 18,
			description : desc([
				"I gain 30 ft Blindsight.",
			]),
			vision : [["Blindsight", 30]],
		},
		"foe slayer ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Foe Slayer",
			source : [["UA23PT6", 44], ["SRD", 37], ["P", 92], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"I can add my Wis mod to the attack and damage roll vs. the target of my Hunter's Mark",
			]),
		},
	},
};

//// Add Ranger "Fighting Style" choices
AddFeatureChoice(ClassList.ranger_ua23pt6.features["fighting style ua23pt6"], true, "Fighting Style: Archery", {
	name : "Fighting Style: Archery",
	extraname : "Ranger 2",
	source : [["UA23PT6", 43], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Archery Fighting Style feat.",
	prereqeval : function (v) { return classes.known.ranger_ua23pt6.level >= 2 ? true : "skip"; },
	eval : function() { AddFeat("Archery Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Archery Fighting Style (UA23PT6)"); }
}, "2nd-level ranger Fighting Style choice");
AddFeatureChoice(ClassList.ranger_ua23pt6.features["fighting style ua23pt6"], true, "Fighting Style: Defense", {
	name : "Fighting Style: Defense",
	extraname : "Ranger 2",
	source : [["UA23PT6", 43], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Defense Fighting Style feat.",
	prereqeval : function (v) { return classes.known.ranger_ua23pt6.level >= 2 ? true : "skip"; },
	eval : function() { AddFeat("Defense Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Defense Fighting Style (UA23PT6)"); }
}, "2nd-level ranger Fighting Style choice");
AddFeatureChoice(ClassList.ranger_ua23pt6.features["fighting style ua23pt6"], true, "Fighting Style: Dueling", {
	name : "Fighting Style: Dueling",
	extraname : "Ranger 2",
	source : [["UA23PT6", 43], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Dueling Fighting Style feat.",
	prereqeval : function (v) { return classes.known.ranger_ua23pt6.level >= 2 ? true : "skip"; },
	eval : function() { AddFeat("Dueling Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Dueling Fighting Style (UA23PT6)"); }
}, "2nd-level ranger Fighting Style choice");
AddFeatureChoice(ClassList.ranger_ua23pt6.features["fighting style ua23pt6"], true, "Fighting Style: Two-Weapon Fighting", {
	name : "Fighting Style: Two-Weapon Fighting",
	extraname : "Ranger 2",
	source : [["UA23PT6", 43], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Two-Weapon Fighting Style feat.",
	prereqeval : function (v) { return classes.known.ranger_ua23pt6.level >= 2 ? true : "skip"; },
	eval : function() { AddFeat("Two-Weapon Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Two-Weapon Fighting Style (UA23PT6)"); }
}, "2nd-level ranger Fighting Style choice");

//// Add Ranger optional choices
AddFeatureChoice(ClassList.ranger_ua23pt6.features["spellcasting ua23pt6"], true, "Access to Dunamancy Spells", { //Ripped directly from all_WotC_pub+UA.js and then altered
	name : "Dunamancy Spells",
	extraname : "Optional Ranger 1",
	source : [["W", 186]],
	description : desc([
		"All dunamancy spells are added to the ranger spell list, each still pending DM's approval"
	]),
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "ranger_ua23pt6" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["gift of alacrity", "magnify gravity", "fortune's favor", "immovable object", "wristpocket", "pulse wave", "gravity sinkhole", "temporal shunt"]);
			},
			"This optional class feature expands the spell list of the ranger class with all dunamancy spells (spell level in brackets): Gift of Alacrity (1), Magnify Gravity (1), Fortune's Favor (2), Immovable Object (2), Wristpocket (2), Pulse Wave (3), Gravity Sinkhole (4), and Temporal Shunt (5)."
		]
	}
}, "Optional 1st-level ranger features");
AddFeatureChoice(ClassList.ranger_ua23pt6.features["spellcasting ua23pt6"], true, "Additional Ranger Spells", { //Ripped directly from all_WotC_pub+UA.js and then altered
	name : "Additional Ranger Spells",
	extraname : "Optional Ranger 1",
	source : [["T", 57]],
	description : "",
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if ((spName !== "ranger" && spName !== "rangerua") || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["entangle", "searing smite", "aid", "aid ua22cs", "enhance ability", "gust of wind", "magic weapon", "elemental weapon", "meld into stone", "revivify", "dominate beast", "greater restoration"]);
			},
			"This optional class feature expands the spell list of the ranger class with the following spells (spell level in brackets): Entangle (1), Searing Smite (1), Aid (2), Enhance Ability (2), Gust of Wind (2), Magic Weapon (2), Elemental Weapon (3), Meld into Stone (3), Revivify (3), Dominate Beast (4), and Greater Restoration (5)."
		]
	},
	prereqeval : function (v) { return (classes.known.ranger && classes.known.ranger.level >= 2) || (classes.known.rangerau && classes.known.rangerau.level >= 2) ? true : "skip"; }
}, "Optional 1st-level ranger features");

////// Add UA23PT6 Beast Master Ranger subclass
AddSubClass("ranger_ua23pt6", "beast master_ua23pt6", {
	regExpSearch : /^(?=.*(beast))((?=.*(master))|((?=.*(nature|natural))(?=.*(knight|fighter|warrior|warlord)))).*$/i,
	subname : "Beast Master Ranger",
	source : [["UA23PT6", 45], ["P", 93], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Ranger's Companion",
			source : [["UA23PT6", 45], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"Choose a primal beast using the \"Companion Options\" button on the Companion Sheet.",
				"I have my choice of a \"Beast of the Land\", a \"Beast of the Sea\", or a \"Beast of the Sky\";",
				"After summoning, I can summon a different primal beast after a Long Rest.",
			]),
		},
		"subclassfeature7" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Exceptional Training",
			source : [["UA23PT6", 46], ["P", 93], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc([
				"My Primal Companion's attacks count can deal Force damage or its normal damage type.",
				"As a bonus action, I can command it to take the Dash/Disengage/Dodge/Help action on its turn.",
			]),
		},
		"subclassfeature11" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Bestial Fury",
			source : [["UA23PT6", 46], ["P", 93], ["MJ:HB", 0]],
			minlevel : 11,
			description : desc([
				"When I command my Primal Companion to use the Attack action, it can attack twice on its turn.",
				"Additionally, Primal Companion deals extra Force damage to target of my Hunter's Mark spell;",
				"This second benefit occurs only the 1st time each turn the Primal Companion hits a creature.",
			]),
		},
		"subclassfeature15" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Share Spells",
			source : [["UA23PT6", 46], ["P", 93], ["MJ:HB", 0]],
			minlevel : 15,
			description : desc([
				"When I cast a spell on myself, I can have it also affect my Primal Companion if it is within 30 ft.",
			]),
		},
	},
});

////// Add UA23PT6 Gloom Stalker Ranger subclass
AddSubClass("ranger_ua23pt6", "gloom stalker_ua23pt6", {
	regExpSearch : /^((?=.*(ranger))|((?=.*(nature))(?=.*(knight|fighter|warrior|warlord))))(?=.*gloom)(?=.*stalker).*$/i,
	subname : "Gloom Stalker Ranger",
	source : [["UA23PT6", 46], ["X", 42], ["MJ:HB", 0]],
	spellcastingExtra : ["disguise self", "rope trick", "fear", "greater invisibility", "seeming"],
	features : {
		"subclassfeature3" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Dread Ambusher",
			source : [["UA23PT6", 46], ["X", 42], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can add my Wisdom modifier to my initiative rolls, and I get +10 ft speed in the first turn of combat.",
				"Additionally, once per turn when I hit with a weapon, I can deal +1d8 Psychic damage to target;",
				"That target make Wis save or be Frightened until start of my next turn. I can do this Wis mod times per Long Rest.",
			]),
			addMod : { type : "skill", field : "Init", mod : "max(Wis|0)", text : "I can add my Wisdom modifier to my initiative rolls." }
		},
		"subclassfeature3.1" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Umbral Sight",
			source : [["UA23PT6", 46], ["X", 42], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I gain 60 ft Darkvision, or add 60 ft to Darkvision if I already had it from any source.",
				"When I'm entirely in darkness, I have the Invisible condition to any creature that relies",
				"  on Darkvision to see me in that darkness.",
			]),
			vision : [["Darkvision", "fixed 60"], ["Darkvision", "+60"]]
		},
		"subclassfeature7" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Iron Mind",
			source : [["UA23PT6", 46], ["X", 42], ["MJ:HB", 0]],
			minlevel : 7,
			description : "\n   " + "I gain proficiency with Wis saves, or if I'm already proficient, either Int or Cha saves",
			saves : ["Wis"]
		},
		"subclassfeature11" : {
			name : "Stalker's Flurry",
			source : [["UA23PT6", 47], ["MJ:HB", 0]],
			minlevel : 11,
			description : desc([
				"When I use the Frighten effect of my Dread Ambusher feature, I can do one of the following:",
				" \u2022 Sudden Strike. I can attack another creature within 5 ft of the original target that is within weapon range.",
				" \u2022 Mass Fear. Each creature within 10 ft of the target make Wis save or be Frightened until start of my next turn.",
			]),
		},
		"subclassfeature15" : { //Ripped directly from all_WotC_pub+UA.js and then altered
			name : "Shadowy Dodge",
			source : [["UA23PT6", 47], ["X", 42], ["MJ:HB", 0]],
			minlevel : 15,
			description : desc([
				"As a reaction when I'm attacked, I can impose disadv. on the attack roll.",
				"If the attack then misses, I can teleport up to 30 ft.",
			]),
			action : ["reaction", " (when attacked)"]
		},
	},
});

////// Add UA23PT6 Hunter Ranger subclass
AddSubClass("ranger_ua23pt6", "hunter_ua23pt6", {
	regExpSearch : /^(?=.*(hunter|huntress)).*$/i,
	subname : "Hunter Ranger",
	source : [["UA23PT6", 47], ["SRD", 37], ["P", 93], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Hunter's Prey",
			source : [["UA23PT6", 47], ["SRD", 37], ["P", 93], ["MJ:HB", 0]],
			minlevel : 3,
			description : "\n   " + "Choose a Hunter's Prey option using the \"Choose Feature\" button above.",
			extraname : "Hunter's Prey",
			extrachoices : ["Hunter's Prey: Colossus Slayer", "Hunter's Prey: Horde Breaker", "Hunter's Prey: Retaliator"],
			extraTimes : levels.map(function (n) { return n < 11 ? 1 : 2; }),
			"hunter's prey: colossus slayer" : {
				name : "Hunter's Prey: Colossus Slayer",
				source : [["UA23PT6", 47], ["SRD", 37], ["P", 93], ["MJ:HB", 0]],
				description : desc("Once per turn, when hitting someone that is below max HP, I do an extra 1d8 damage"),
			},
			"hunter's prey: horde breaker" : {
				name : "Hunter's Prey: Horde Breaker",
				source : [["UA23PT6", 47], ["SRD", 37], ["P", 93], ["MJ:HB", 0]],
				description : desc("Once per turn, when I hit a creature, I can make an attack vs. another within 5 ft of it"),
			},
			"hunter's prey: retaliator" : {
				name : "Hunter's Prey: Retaliator",
				source : [["UA23PT6", 47], ["MJ:HB", 0]],
				description : desc("As a Reaction, when an enemy in 5 ft attacks me, I can attack it once"),
				action : ["reaction", ""],
			},
		},
		"subclasfeature3.1" : {
			name : "Hunter's Lore",
			source : [["UA23PT6", 47], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"While a creature is marked by my Hunter's Mark, I know the following about it:",
				"Damage/condition immunities, damage resistances, and/or damage vulnerabilities.",
			]),
		},
		"subclassfeature7" : {
			name : "Defensive Tactics",
			source : [["UA23PT6", 47], ["MJ:HB", 0]],
			minlevel : 7,
			description : "\n   " + "Choose a Defensive Tactics option using the \"Choose Feature\" button above.",
			extraname : "Defensive Tactics",
			extrachoices : ["Defensive Tactics: Evasion", "Defensive Tactics: Hunter's Leap", "Defensive Tactics: Uncanny Dodge"],
			extraTimes : levels.map(function (n) { return n < 15 ? 1 : 2; }),
			"defensive tactics: evasion" : { //Description & savetxt attributes ripped directly from Monk 7 in ListClasses.js
				name : "Defensive Tactics: Evasion",
				source : [["UA23PT6", 47], ["MJ:HB", 0]],
				description : desc("My Dexterity saves vs. areas of effect negate damage on success and halve it on failure"),
				savetxt : { text : ["Dex save vs. area effects: fail \u2015 half dmg, success \u2015 no dmg"] },
			},
			"defensive tactics: hunter's leap" : {
				name : "Defensive Tactics: Hunter's Leap",
				source : [["UA23PT6", 47], ["MJ:HB", 0]],
				description : desc([
					"When a creature I can see comes within 5 ft, I can use a Reaction to move half my Speed",
					"  without provoking Opportunity Attacks",
				]),
				action : ["reaction", ""],
			},
			"defensive tactics: uncanny dodge" : { //Description & action attributes ripped directly from Rogue 5 in ListClasses.js
				name : "Defensive Tactics: Uncanny Dodge",
				source : [["UA23PT6", 47], ["MJ:HB", 0]],
				description : desc("As a Reaction, I can halve the damage of an attack from an attacker that I can see"),
				action : ["reaction", ""],
			},
		},
		"subclassfeature11" : {
			name : "Superior Hunter's Prey",
			source : [["UA23PT6", 47], ["MJ:HB", 0]],
			minlevel : 11,
			description : "\n   " + "Choose another Hunter's Prey option using the \"Choose Feature\" button above.",
		},
		"subclassfeature15" : {
			name : "Superior Hunter's Defense",
			source : [["UA23PT6", 47], ["MJ:HB", 0]],
			minlevel : 15,
			description : "\n   " + "Choose another Defensive Tactics option using the \"Choose Feature\" button above.",
		},
	},
});

// Add UA23PT6 Rogue class
ClassList.rogue_ua23pt6 = {
	name : "Rogue (UA:PT-vi)",
	regExpSearch : /(rogue)/i,
	source : [["UA23PT6", 48], ["MJ:HB", 0]],
	primaryAbility : "Dexterity",
	prerequisite : "Dexterity 13+",
	prereqeval : function(v) {
		return What('Dex') >= 13;
	},
	die : 8,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 5, 5, 5, 6, 6],
	saves : ["Dex", "Int"],
	skills : ["\n\n" + toUni("Rogue") + ": Choose four from Acrobatics, Athletics, Deception, Insight, Intimidation, Investigation, Perception, Persuasion, Sleight of Hand, Stealth", ": Choose one from Acrobatics, Athletics, Deception, Insight, Intimidation, Investigation, Perception, Persuasion, Sleight of Hand, Stealth"],
	armor : [
		[true, false, false, false],
		[true, false, false, false],
	],
	toolProfs : {
		primary : [["Thieves' tools", "Dex"]],
		secondary : [["Thieves' tools", "Dex"]],
	},
	weapons : [
		[true, true, ["Martial weapons with the Finesse property"]],
		[false, true, ["Martial weapons with the Finesse property"]],
	],
	equipment : "Rogue starting equipment:" +
		"\n \u2022 Leather Armor," +
		"\n \u2022 Arrows (20)," +
		"\n \u2022 Burglar's Pack," +
		"\n \u2022 Dagger (2)," +
		"\n \u2022 Quiver," +
		"\n \u2022 Shortbow," +
		"\n \u2022 Shortsword," +
		"\n \u2022 Thieves' tools," +
		"\n \u2022 and 18 gp;" +
		"\n\nAlternatively, choose 110 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Roguish Archetype", []],
	attacks : [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
	abilitySave : 2,
	features : {
		"expertise ua23pt6" : function() { //Ripped directly from ListClasses.js; left unaltered aside from adding UA source
			var a = {
				name : "Expertise",
				source : [["UA23PT6", 49], ["SRD", 39], ["P", 96]],
				minlevel : 1,
				description : desc("I gain expertise with two skills/thieves' tools I am proficient with; two more at 6th level"),
				skillstxt : "Expertise with any two skill proficiencies and/or thieves' tools, and two more at 6th level",
				additional : levels.map(function (n) {
					return "with " + (n < 6 ? 2 : 4) + " skills";
				}),
				extraname : "Expertise",
				extrachoices : ["Acrobatics", "Animal Handling", "Arcana", "Athletics", "Deception", "History", "Insight", "Intimidation", "Investigation", "Medicine", "Nature", "Perception", "Performance", "Persuasion", "Religion", "Sleight of Hand", "Stealth", "Survival", "Thieves' Tools"],
				extraTimes : levels.map(function (n) { return n < 6 ? 2 : 4; }),
				"thieves' tools" : {
					name : "Thieves' Tools Expertise", description : "",
					source : [["SRD", 39], ["P", 96]],
					prereqeval : function(v) {
						if ((/thieve.?s.*tools/i).test(What('Too Text')) && tDoc.getField("Too Prof").isBoxChecked(0)) {
							return tDoc.getField("Too Exp").isBoxChecked(0) ? "markButDisable" : true;
						} else {
							return CurrentProfs.tool["thieves' tools"] || (/thieve.?s.{1,3}tools/i).test(v.toolProfs.toString());
						}
					},
					eval : function () {
						if ((/thieve.?s.*tools/i).test(What('Too Text'))) {
							Checkbox('Too Exp', true);
						};
					},
					removeeval : function () {
						if ((/thieve.?s.*tools/i).test(What('Too Text'))) {
							Checkbox('Too Exp', false);
						};
					},
				},
			};
			for (var i = 0; i < a.extrachoices.length; i++) {
				var attr = a.extrachoices[i].toLowerCase();
				if (a[attr]) continue;
				a[attr] = {
					name : a.extrachoices[i] + " Expertise",
					description : "",
					source : a.source,
					skills : [[a.extrachoices[i], "only"]],
					prereqeval : function(v) {
						return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
					}
				};
			}
			return a;
		}(),
		"sneak attack ua23pt6" : { //Ripped directly from ListClasses.js; left unaltered aside from adding UA source
			name : "Sneak Attack",
			source : [["UA23PT6", 49], ["SRD", 39], ["P", 96]],
			minlevel : 1,
			description : desc([
				"Once per turn, I can add damage to a finesse/ranged weapon attack if I have advantage",
				"I don't need adv. if the target has a conscious enemy within 5 ft and I don't have disadv."
			]),
			additional : levels.map(function (n) {
				return Math.ceil(n / 2) + "d6";
			}),
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (classes.known.rogue && classes.known.rogue.level && !v.isSpell && !v.isDC && (v.isRangedWeapon || (/\bfinesse\b/i).test(fields.Description))) {
							v.sneakAtk = Math.ceil(classes.known.rogue.level / 2);
							fields.Description += (fields.Description ? '; ' : '') + 'Sneak attack ' + v.sneakAtk + 'd6';
						};
					},
					"Once per turn, when I attack with a ranged or finesse weapon while I have advantage or an conscious ally is within 5 ft of the target, I can add my sneak attack damage to the attack.",
					700
				]
			}
		},
		"thieves cant ua23pt6" : { //Ripped directly from ListClasses.js; left unaltered aside from adding UA source
			name : "Thieves' Cant",
			source : [["UA23PT6", 50], ["SRD", 39], ["P", 96]],
			minlevel : 1,
			description : desc("I know the secret rogue language that I can use to convey messages inconspicuously"),
			languageProfs : ["Thieves' Cant"]
		},
		"weapon mastery ua23pt6" : { //Using Reaction Fields for this because there are too many possible weapons to choose from and I don't know how to code FeatureChoices to take that vast number of possible weapons into account.
			name : "Weapon Mastery",
			source : [["UA23PT6", 50], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can use the Mastery property of two kinds of weapons of my choice with which I have proficiency.",
				"I can change what weapons I can use the Mastery property of after finishing a Long Rest.",
			]),
			calcChanges : {
				atkAdd : masteryFunctions.weaponMasteryAtkAdd
			},
			action : [
				["reaction", "Wpn Mstry 1: [Wpn Name]"],
				["reaction", "Wpn Mstry 2: [Wpn Name]"],
			],
		},
		"cunning action ua23pt6" : { //Ripped directly from ListClasses.js; left unaltered aside from adding UA source
			name : "Cunning Action",
			source : [["UA23PT6", 50], ["SRD", 40], ["P", 96]],
			minlevel : 2,
			description : desc("I can use a Bonus Action to take the Dash, Disengage, or Hide action"),
			action : ["bonus action", ""]
		},
		"steady aim ua23pt6" : { //Description attribute ripped from all_WotC_pub+UA.js
			name : "Steady Aim",
			source : [["UA23PT6", 50], ["T", 62], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action if I don't move during my turn, I can give myself Adv. on my next attack",
				"This attack roll has to be in the same turn and my speed is 0 until the end of the turn",
			]),
			action : ["bonus action", ""]
		},
		"subclassfeature3" : { //Ripped directly from ListClasses.js
			name : "Roguish Archetype",
			source : [["UA23PT6", 50], ["SRD", 40], ["P", 96], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc('Choose a Roguish Archetype you strive to emulate and put it in the "Class" field ')
		},
		"cunning strike ua23pt6" : {
			name : "Cunning Strike",
			source : [["UA23PT6", 50], ["MJ:HB", 0]],
			minlevel : 5,
			description : desc([
				"When I deal Sneak Attack damage, I can add one of the following effects.",
				"Each effect has a die cost, which is the number of Sneak Attack damage dice I must forego to add the effect.",
				"Remove the die before rolling damage, and the effect occurs immediately after the damage is dealt.",
				" \u2022 Disarm (1d6). Target make a Dex save or it drops one item of my choice that it’s holding.",
				" \u2022 Poison (1d6). Target make a Con save or it gains the Poisoned condition for 1 min;",
				"  Target save at end of turn to end condition. I need a Poisoner's Kit on my person to use this one.",
				" \u2022 Trip (1d6). If target is Large or smaller, it makes a Dex save or gains the Prone condition.",
				" \u2022 Withdraw (1d6). Immediately after the attack, I move half my Speed without provoking Opportunity Attacks.",
			]),
		},
		"uncanny dodge ua23pt6" : { //Ripped directly from ListClasses.js; left unaltered aside from adding UA source
			name : "Uncanny Dodge",
			source : [["UA23PT6", 50], ["SRD", 40], ["P", 96]],
			minlevel : 5,
			description : desc("As a Reaction, I can halve the damage of an attack from an attacker that I can see"),
			action : ["reaction", ""]
		},
		"evasion ua23pt6" : { //Ripped directly from ListClasses.js; left unaltered aside from adding UA source
			name : "Evasion",
			source : [["UA23PT6", 50], ["SRD", 40], ["P", 96]],
			minlevel : 7,
			description : desc("My Dexterity saves vs. areas of effect negate damage on success and halve it on failure"),
			savetxt : { text : ["Dex save vs. area effects: fail \u2015 half dmg, success \u2015 no dmg"] }
		},
		"reliable talent ua23pt6" : { //Ripped directly from ListClasses.js; left unaltered aside from adding UA source
			name : "Reliable Talent",
			source : [["UA23PT6", 51], ["SRD", 40], ["P", 96]],
			minlevel : 7,
			description : desc("If I make an ability check where I add my Proficiency Bonus, rolls of 9 or lower are 10")
		},
		"improved cunning strike ua23pt6" : {
			name : "Improved Cunning Strike",
			source : [["UA23PT6", 51], ["MJ:HB", 0]],
			minlevel : 11,
			description : desc([
				"I can use up to two Cunning Strike effects when I deal Sneak Attack damage.",
				"I have to pay the die cost for each effect.",
			]),
		},
		"devious strikes ua23pt6" : {
			name : "Devious Strikes",
			source : [["UA23PT6", 51], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"I gain the following new Cunning Strike effects:",
				" \u2022 Daze (2d6). Target make a Con save or it gains the Dazed condition until end of its next turn.",
				" \u2022 Knock Out (6d6). Target make a Con save or it gains the Unconscious condition for 1 min;",
				"  Target save at end of turn to end condition. Condition ends if target takes any damage.",
				" \u2022 Obscure (3d6). Target make a Dex save or it gains the Blinded condition until end of its next turn.",
			]),
		},
		"slippery mind ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Slippery Mind",
			source : [["UA23PT6", 51], ["SRD", 40], ["P", 96], ["MJ:HB", 0]],
			minlevel : 15,
			description : desc("I am proficient with Wisdom and Charisma saving throws"),
			saves : ["Wis", "Cha"]
		},
		"elusive ua23pt6" : { //Ripped directly from ListClasses.js; left unaltered aside from adding UA source
			name : "Elusive",
			source : [["UA23PT6", 51], ["SRD", 40], ["P", 96]],
			minlevel : 18,
			description : desc("Attackers do not gain advantage on attacks vs. me, unless I am Incapacitated")
		},
		"stroke of luck ua23pt6" : { //Ripped directly from ListClasses.js and then altered
			name : "Stroke of Luck",
			source : [["UA23PT6", 51], ["SRD", 40], ["P", 97], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc("I can turn a failed d20 Test into a natural 20"),
			recovery : "short rest",
			usages : 1
		},
	},
};

////// Add UA23PT6 Arcane Trickster Rogue subclass
AddSubClass("rogue_ua23pt6", "arcane trickster_ua23pt6", { //Ripped directly from all_WotC_pub+UA.js and then altered
	regExpSearch : /^(?=.*(trickster|rogue))(?=.*\b(eldritch|arcane|magic|mage)\b).*$/i,
	subname : "Arcane Trickster",
	source : [["UA23PT6", 51], ["P", 98], ["MJ:HB", 0]],
	abilitySaveAlt : 4,
	spellcastingFactor : 3,
	spellcastingList : {
		"class" : ["wizard", "wizard_ua23pt7"],
		level : [0, 4],
	},
	spellcastingTable : [
		[0, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 0
		[0, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 1
		[0, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 2
		[2, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 3
		[3, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 4
		[3, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 5
		[3, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 6
		[4, 2, 0, 0, 0, 0, 0, 0, 0], //lvl 7
		[4, 2, 0, 0, 0, 0, 0, 0, 0], //lvl 8
		[4, 2, 0, 0, 0, 0, 0, 0, 0], //lvl 9
		[4, 3, 0, 0, 0, 0, 0, 0, 0], //lvl10
		[4, 3, 0, 0, 0, 0, 0, 0, 0], //lvl11
		[4, 3, 0, 0, 0, 0, 0, 0, 0], //lvl12
		[4, 3, 2, 0, 0, 0, 0, 0, 0], //lvl13
		[4, 3, 2, 0, 0, 0, 0, 0, 0], //lvl14
		[4, 3, 2, 0, 0, 0, 0, 0, 0], //lvl15
		[4, 3, 3, 0, 0, 0, 0, 0, 0], //lvl16
		[4, 3, 3, 0, 0, 0, 0, 0, 0], //lvl17
		[4, 3, 3, 0, 0, 0, 0, 0, 0], //lvl18
		[4, 3, 3, 1, 0, 0, 0, 0, 0], //lvl19
		[4, 3, 3, 1, 0, 0, 0, 0, 0], //lvl20
	],
	spellcastingKnown : {
		cantrips : [0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
		spells : "list",
		prepared : true,
	},
	features : {
		"subclassfeature3" : {
			name : "Spellcasting",
			source : [["UA23PT6", 52], ["P", 98], ["MJ:HB", 0]],
			minlevel : 3,
			description : "\n   " + "I can cast known/prepared Wizard cantrips/spells, using Intelligence as my spellcasting ability",
			additional : ["", "", "3 cantrips \u0026 3 spells prepared", "3 cantrips \u0026 4 spells prepared", "3 cantrips \u0026 4 spells prepared", "3 cantrips \u0026 4 spells prepared", "3 cantrips \u0026 6 spells prepared", "3 cantrips \u0026 6 spells prepared", "3 cantrips \u0026 6 spells prepared", "4 cantrips \u0026 7 spells prepared", "4 cantrips \u0026 7 spells prepared", "4 cantrips \u0026 7 spells prepared", "4 cantrips \u0026 9 spells prepared", "4 cantrips \u0026 9 spells prepared", "4 cantrips \u0026 9 spells prepared", "4 cantrips \u0026 10 spells prepared", "4 cantrips \u0026 10 spells prepared", "4 cantrips \u0026 10 spells prepared", "4 cantrips \u0026 11 spells prepared", "4 cantrips \u0026 11 spells prepared"],
			spellcastingBonus : [{
				name : "Mage Hand cantrip", // the Mage Hand cantrip gained at level 3
				spells : ["mage hand"],
				selection : ["mage hand"],
			}],
		},
		"subclassfeature3.1" : {
			name : "Mage Hand Legerdemain",
			source : [["UA23PT6", 52], ["P", 98]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can direct my Mage Hand",
				"With a Dex (Sleight of Hand) vs. Wis (Perception) checks, I can do so discreetly",
				"I can make it invisible and perform the following tasks:",
				" \u2022 Stow/retrieve an object the hand is holding in a container worn/carried by another",
				" \u2022 Use thieves' tools to pick locks and disarm traps at range",
			]),
			action : ["bonus action", ""],
			spellChanges : {
				"mage hand" : {
					description : "Invisible hand, carries 10 lb; 1 bns to control, use thieves' tools, or stow/retrieve obj; only 1 instance",
					changes : "My Mage Hand Legerdemain class feature expands my use of the Mage Hand cantrip and makes the spectral hand invisible."
				}
			}
		},
		"subclassfeature9" : {
			name : "Magical Ambush",
			source : [["UA23PT6", 52], ["P", 98], ["MJ:HB", 0]],
			minlevel : 9,
			description : "\n   " + "When I cast a spell while Invisible, the target(s) have Disadvantage against that spell"
		},
		"subclassfeature13" : {
			name : "Versatile Trickster",
			source : [["UA23PT6", 52], ["P", 98], ["MJ:HB", 0]],
			minlevel : 13,
			description : desc([
				"When I use the Disarm or Trip options of my Cunning Strike,",
				"I can also target that option at creature within 5 ft of Mage Hand.",
			]),
		},
		"subclassfeature17" : {
			name : "Spell Thief",
			source : [["UA23PT6", 52], ["P", 98]],
			minlevel : 17,
			description : "\n   " + "As a Reaction, after a spell is cast at me, I can try to negate and steal it" + "\n   " + "The caster makes a save against my spell DC with their spellcasting ability" + "\n   " + "On failure, the caster forgets how to cast that spell for eight hours" + "\n   " + "If I have a spell slot of a high enough level for it, I learn how to cast it during this time",
			action : ["reaction", ""],
			recovery : "long rest",
			usages : 1
		},
	},
});

////// Add UA23PT6 Assassin Rogue subclass
AddSubClass("rogue_ua23pt6", "assassin_ua23pt6", { //Ripped directly from all_WotC_pub+UA.js and then altered
	regExpSearch : /^(?=.*(trickster|rogue))(?=.*assassin).*$/i,
	subname : "Assassin",
	source : [["UA23PT6", 53], ["P", 97], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiencies",
			source : [["UA23PT6", 53], ["P", 97]],
			minlevel : 3,
			description : "\n   " + "I am proficient with Disguise Kits and Poisoner's Kits",
			toolProfs : ["Disguise kit", "Poisoner's kit"]
		},
		"subclassfeature3.1" : {
			name : "Assassinate",
			source : [["UA23PT6", 53], ["P", 97]],
			minlevel : 3,
			description : desc([
				"I have Adv. on attack rolls against creatures that have not taken a turn in combat yet.",
				"Any hit I score against such a creature takes extra damage equal to my Rogue level.",
				"I also have Adv. on Initiative rolls.",
			]),
		},
		"subclassfeature9" : {
			name : "Infiltration Expertise",
			source : [["UA23PT6", 53], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"While in a disguise created using my Disguise Kit, I have Adv. on Cha (Deception) checks",
				"  while pretending to be someone else. I can also unerringly mimic another person's speech,",
				"  handwriting, or both if I have spent at least 1 hour studying each one.",
			]),
		},
		"subclassfeature13" : {
			name : "Envenom Weapons",
			source : [["UA23PT6", 53], ["MJ:HB", 0]],
			minlevel : 13,
			description : desc([
				"When I use the Poison option of my Cunning Strike, the target takes +2d6 Poison damage",
				"  when it fails the saving throw. This extra damage ignores resistance to Poison damage.",
			]),
		},
		"subclassfeature17" : {
			name : "Death Strike",
			source : [["UA23PT6", 54], ["P", 97], ["MJ:HB", 0]],
			minlevel : 17,
			description : "\n   " + "When I hit a creature that has not taken a turn in combat yet, it must make a Con save or take double damage",
			additional : "Save DC: 8 + Dex mod + Proficiency bonus",
		},
	},
});

////// Add UA23PT6 Swashbuckler Rogue subclass
AddSubClass("rogue_ua23pt6", "swashbuckler_ua23pt6", { //Ripped directly from all_WotC_pub+UA.js and then altered
	regExpSearch : /^(?=.*(trickster|rogue))(?=.*swashbuckl).*$/i,
	subname : "Swashbuckler",
	source : [["UA23PT6", 53], ["S", 135], ["X", 47], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Fancy Footwork",
			source : [["UA23PT6", 53], ["S", 135], ["X", 47]],
			minlevel : 3,
			description : desc([
				"Enemies I make a melee attack against in my turn can't use Opportunity Attacks on me",
				"This lasts until the end of my current turn"
			])
		},
		"subclassfeature3.1" : {
			name : "Rakish Audacity",
			source : [["UA23PT6", 54], ["S", 136], ["X", 47]],
			minlevel : 3,
			description : desc([
				"I don't need Advantage to Sneak Attack if my target is the only one within 5 ft of me",
				"I still can't Sneak Attack if I have Disadv.; I add my Charisma modifier to Initiative rolls"
			]),
			addMod : { type : "skill", field : "Init", mod : "max(Cha|0)", text : "I can add my Charisma modifier to initiative rolls." }
		},
		"subclassfeature9" : {
			name : "Panache",
			source : [["UA23PT6", 54], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"I gain the following new Cunning Strike effects:",
				" \u2022 Goad (1d6). Target make a Con save or until end of next turn, gain disadv. on attacks",
				"  and can't do opportunity attacks vs. not-me",
				" \u2022 Awe (3d6). Targets of my choice within 30 ft make a Wis save or gain the Charmed condition until end of my next turn.",
			]),
		},
		"subclassfeature13" : {
			name : "Dashing Strikes",
			source : [["UA23PT6", 54], ["MJ:HB", 0]],
			minlevel : 13,
			description : desc([
				"I gain the following new Cunning Strike effects:",
				" \u2022 Parrying Stance (2d6). I gain a 1d6 bonus to my AC until the start of my next turn.",
				" \u2022 Invigorate (2d6). Target of my choice within 30 ft +1d6 to attack rolls and saving throws until end of its next turn.",
			]),
		},
		"subclassfeature17" : {
			name : "Master Duelist",
			source : [["UA23PT6", 54], ["MJ:HB", 0]],
			minlevel : 17,
			description : "\n   " + "Immediately after using Sneak Attack, I can make another attack against same target if it is the only one within 5 ft of me.",
		},
	},
});

////// Add UA23PT6 Thief Rogue subclass
AddSubClass("rogue_ua23pt6", "thief_ua23pt6", { //Ripped directly from ListsClasses.js and then altered
	regExpSearch : /^(?=.*(trickster|rogue))(?=.*(thief)).*$/i,
	subname : "Thief",
	source : [["UA23PT6", 54], ["SRD", 41], ["P", 97], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Fast Hands",
			source : [["UA23PT6", 54], ["SRD", 40], ["P", 97], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I can do one of the following:",
				" \u2022 Make a Dexterity (Sleight of Hand) check to pick a pocket",
				" \u2022 Use my Thieves' Tools to disarm a trap or open a lock",
				" \u2022 Take the Use an Object action or the Magic action to use a magic item.",
			]),
			action : ["bonus action", ""],
		},
		"subclassfeature3.1" : {
			name : "Second-Story Work",
			source : [["UA23PT6", 54], ["SRD", 41], ["P", 97], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I climb at my normal speed; On my turn, I can move on a ceiling without an ability check if",
				"  there is minimum 1 handhold during the move; I fall if I end my turn on the ceiling without a handhold.",
				"My jump distance is determined by my Dexterity instead of my Strength.",
			]),
			speed : { climb : { spd : "walk", enc : "walk" } },
		},
		"subclassfeature9" : {
			name : "Supreme Sneak",
			source : [["UA23PT6", 54], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"I gain the following new Cunning Strike effect:",
				" \u2022 Stealth Attack (1d6). If I have the Hide action's Invisible condition, this attack doesn't end that.",
				"  that condition on me if I end the turn behind Three-Quarters Cover or Total Cover.",
			]),
		},
		"subclassfeature13" : {
			name : "Use Magic Device",
			source : [["UA23PT6", 55], ["SRD", 41], ["P", 97]],
			minlevel : 13,
			description : desc([
				"I can attune to up to 4 magic items at once.",
				"When I use a magic item property that expends charges, roll 1d6; On a 6, I use the property without expending any charges.",
				"I can use any Spell Scroll, using Int as my Spellcasting Ability for the spell. If the spell is a cantrip or a 1st-lvl spell,",
				"  I can cast it reliably. If the scroll is of a higher level spell, I must succeed an Int (Arcana) check with a SC equal to",
				"  10 + the spell's level. On a successful check, I cast the spell, otherwise the scroll disintegrates.",
			]),
		},
		"subclassfeature17" : {
			name : "Thief's Reflexes",
			source : [["UA23PT6", 55], ["SRD", 41], ["P", 97], ["MJ:HB", 0]],
			minlevel : 17,
			description : desc([
				"I can take two turns on the first round of any combat",
				"The first turn is at my normal Initiative, and the second is at my Initiative - 10",
			]),
		},
	},
});

// Add UA23PT6 Spells
SpellsList["banishing smite ua23pt6"] = {
	name : "Banishing Smite (UA23PT6)",
	source : [["UA23PT6", 62], ["P", 216], ["MJ:HB", 0]],
	classes : ["paladin", "paladin_ua23pt6"],
	level : 5,
	school : "Conj",
	time : "1 bns",
	timeFull : "1 Bonus Action, which you take immediately after hitting a creature with a melee weapon or an Unarmed Strike",
	range : "S",
	components : "V",
	duration : "Conc, 1 m",
	save : "Cha",
	description : "Wea atk deals +5d10 Force dmg; if this brings target HP<51, I banish it until spell ends",
	descriptionFull : "As you hit the creature, your strike erupts with divine power. The target hit by the strike takes an extra 5d10 Force damage from the attack. If the attack reduces the target to 50 Hit Points or fewer, the target must succeed on a Charisma saving throw or be transported to a harmless demiplane for the duration." + "\n   " + "While in the demiplane, the target has the Incapacitated condition. When the spell ends on the target, it reappears in the space it left or in the nearest unoccupied space if that space is occupied.",
};
SpellsList["blinding smite ua23pt6"] = {
	name : "Blinding Smite (UA23PT6)",
	source : [["UA23PT6", 63], ["P", 219], ["MJ:HB", 0]],
	classes : ["paladin", "paladin_ua23pt6"],
	level : 3,
	school : "Evoc",
	time : "1 bns",
	timeFull : "1 Bonus Action, which you take immediately after hitting a creature with a melee weapon or an Unarmed Strike",
	range : "S",
	components : "V",
	duration : "1 m",
	save : "Con", //UA article doesn't specify which ability the save uses, so I'm defaulting to the 2014 version's save ability of Con.
	description : "Wea atk deals +3d8+1d8/SL Rad dmg; crea Blinded for 1 min, no 1st save; end of turn save to end",
	descriptionFull : "As you hit the target, your strike flares with light. The target hit by the strike takes an extra 3d8 Radiant damage from the attack, and the target has the Blinded condition until the spell ends. At the end of each of its turns, the Blinded target repeats the saving throw, ending the spell on itself on a success." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the extra damage increases by 1d8 for each slot level above 3rd.",
};
SpellsList["conjure barrage ua23pt6"] = { //Ripped directly from all_WotC_pub+UA.js and then altered
	name : "Conjure Barrage (UA23PT6)",
	source : [["UA23PT6", 63], ["P", 225], ["MJ:HB", 0]],
	classes : ["ranger", "ranger_ua23pt6"],
	level : 3,
	school : "Conj",
	time : "1 a",
	range : "S:60" + (typePF ? "-" : "") + "ft cone",
	rangeMetric : "S:18m cone",
	components : "V,S,M\u0192",
	compMaterial : "a melee or ranged weapon worth at least 1 CP",
	duration : "Instantaneous",
	save : "Dex",
	description : "Throw weapon or ammo; copies shot forward for 5d8 Force dmg; save halves)",
	descriptionFull : "You brandish the weapon used to cast the spell and conjure similar spectral weapons (or ammunition appropriate to the weapon) that shoot forward and then disappear. Each creature of your choice that you can see in a 60-foot cone must succeed on a Dexterity saving throw. A creature takes 5d8 Force damage on a failed save, or half as much damage on a successful one." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d8 for each slot level above 3rd.",
};
SpellsList["conjure volley ua23pt6"] = { //Ripped directly from all_WotC_pub+UA.js and then altered
	name : "Conjure Volley (UA23PT6)",
	source : [["UA23PT6", 63], ["P", 226], ["MJ:HB", 0]],
	classes : ["ranger", "ranger_ua23pt6"],
	level : 5,
	school : "Conj",
	time : "1 a",
	range : "150 ft",
	components : "V,S,M\u0192",
	compMaterial : "a melee or ranged weapon worth at least 1 CP",
	duration : "Instantaneous",
	save : "Dex",
	description : "Turn ammo/thrown wea into volley; 40-ft rad 20-ft high 8d8 Force dmg; save halves",
	descriptionFull : "You brandish the weapon used to cast the spell and choose a point within range. Hundreds of similar spectral weapons (or ammunition appropriate to the weapon) fall in a volley from above and then disappear. Each creature of your choice that you can see in a 40-foot-radius, 20- foot-high cylinder centered on that point must make a Dexterity saving throw. A creature takes 8d8 Force damage on a failed save, or half as much damage on a successful one."
};
SpellsList["divine smite ua23pt6"] = {
	name : "Blinding Smite (UA23PT6)",
	source : [["UA23PT6", 63], ["MJ:HB", 0]],
	classes : ["paladin", "paladin_ua23pt6"],
	level : 1,
	school : "Evoc",
	time : "1 bns",
	timeFull : "1 Bonus Action, which you take immediately after hitting a creature with a melee weapon or an Unarmed Strike",
	range : "S",
	components : "V",
	duration : "Instantaneous",
	description : "Wea atk deals +2d8+1d8/SL Rad dmg; Fiends and Undead take extra 1d8 Rad dmg",
	descriptionFull : "As you hit the target, your strike glows with divine power. The target takes an extra 2d8 Radiant damage from the attack. The damage increases by 1d8 if the target is a Fiend or an Undead." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d8 for each slot level above 1st.",
};
SpellsList["elementalism ua23pt6"] = {
	name : "Elementalism (UA23PT6)",
	source : [["UA23PT6", 63], ["MJ:HB", 0]],
	classes : ["druid", "druid_ua23pt8", "ranger", "ranger_ua23pt6", "sorcerer", "sorcerer_ua23pt7", "warlock", "warlock_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 0,
	school : "Trans",
	time : "1 bns",
	range : "30 ft",
	components : "V,S",
	duration : "Instantaneous",
	description : "Create minor elemental trick; breeze; dust/sand; embers/smoke; water mist; sculpt element; see book",
	descriptionFull : "You exert control over the elements, creating one of the following effects within range:" + "\n   " + "Beckon Air. You create a breeze strong enough to ripple cloth, stir dust, rustle leaves, and close open doors and shutters, all in a 5-foot (1.5m) cube. Doors and shutters being held open by someone or something aren’t affected." + "\n   " + "Beckon Earth. You create a thin shroud of dust or sand that covers surfaces in a 5-foot-square (1.5m-square) area, or you cause a single word to appear in your handwriting in a patch of dirt or sand." + "\n   " + "Beckon Fire. You create a thin cloud of harmless embers and colored, scented smoke in a 5-foot (1.5m) cube. You choose the color and scent, and the embers can light candles, torches, or lamps in that area. The smoke’s scent lingers for 1 minute." + "\n   " + "Beckon Water. You create a spray of cool mist that lightly dampens creatures and objects in a 5-foot (1.5m) cube. Alternatively, you create 1 cup of clean water either in an open container or on a surface, and the water evaporates in 1 minute." + "\n   " + "Sculpt Element. You cause dirt, sand, fire, smoke, mist, or water that can fit in a 1-foot (0.3m) cube to assume a crude shape (such as that of a creature or an object) for 1 hour.",
};
SpellsList["find steed ua23pt6"] = {
	name : "Find Steed (UA23PT6)",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	classes : ["paladin", "paladin_ua23pt6"],
	level : 2,
	school : "Conj",
	time : "1 a",
	range : "30 ft",
	components : "V,S",
	duration : "Instantaneous",
	description : "Gain the services of a steed; communicate with each other telepathically; share spells with it; see book",
	descriptionFull : "You gain the service of an otherworldly being, which manifests as a loyal steed in an unoccupied space of your choice within range. This creature uses the Otherworldly Steed stat block. If you already have a steed from this spell, your steed is replaced by the new one." + "\n   " + "The steed resembles a Large, rideable animal of your choice, such as a horse, a camel, a dire wolf, or an elk. Whenever you cast the spell, choose the steed’s creature type—Celestial, Fey, or Fiend—which determines certain traits in the stat block." + "\n   " + "Combat. The steed is an ally to you and your companions. In combat, it shares your initiative count, and it functions as a controlled mount while you ride it (as defined in the rules on mounted combat). If you have the Incapacitated condition, the steed takes its turn immediately after yours and acts independently, focusing on protecting you." + "\n   " + "Disappearance of the Steed. The steed disappears if it drops to 0 Hit Points, if you dismiss it as a Bonus Action, or if you die. When it disappears, it leaves behind anything it was wearing or carrying. If you cast this spell again, you decide whether you summon the steed that disappeared or a different one." + AtHigherLevels + "When you cast this spell using a Spell Slot of 3rd level or higher, use the higher level wherever the spell’s level appears in the stat block.",
};
SpellsList["hunter's mark ua23pt6"] = { //Ripped directly from ListsSpells.js and then altered
	name : "Hunter's Mark (UA23PT6)",
	source : [["UA23PT6", 64], ["P", 251], ["MJ:HB", 0]],
	classes : ["ranger", "ranger_ua23pt6"],
	level : 1,
	school : "Div",
	time : "1 bns",
	timeFull : "1 Bonus Action, which you take immediately after hitting a creature with a melee weapon or an Unarmed Strike",
	range : "90 ft",
	rangeMetric : "27 m",
	components : "V",
	duration : "Conc, 1 h",
	description : "1 crea +1d6 Force dmg from my weapon atks; adv. Wis (Perception/Survival) vs. target; SL3: 8h & 2d6 dmg; SL5: 24h & 3d6 dmg",
	descriptionFull : "You choose one creature you can see within range and magically mark it as your quarry. Until the spell ends, you deal an extra 1d6 Force damage to the target the first time you hit it with an attack roll on any turn. You also have Advantage on any Wisdom (Perception or Survival) check you make to find it. If the target drops to 0 Hit Points before this spell ends, you can use a Bonus Action to mark a new creature." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd or 4th level, you can maintain your concentration on the spell for up to 8 hours, and the extra damage increases to 2d6. When you use a spell slot of 5th level or higher, you can maintain your concentration on the spell for up to 24 hours, and the extra damage increases to 3d6."
};
SpellsList["power word heal ua23pt6"] = { //Ripped directly from all_WotC_pub+UA.js and then altered
	name : "Power Word Heal (UA23PT6)",
	source : [["UA23PT6", 65], ["P", 266], ["MJ:HB", 0]],
	classes : ["bard", "cleric", "cleric_ua23pt6"],
	level : 9,
	school : "Ench",
	time : "1 a",
	range : "60 ft",
	components : "V",
	duration : "Instantaneous",
	description : "1 crea heals all HP and stops being Charmed, Dazed, Frightened, Paralyzed, Stunned; it can use rea to stand up",
	descriptionShorter : "1 crea heals all HP, not Charmed, Dazed, Frightened, Paralyzed, Stunned; rea to stand up",
	descriptionFull : "A wave of healing energy washes over a creature you can see within range. The target regains all its Hit Points. If the creature has the Charmed, Dazed, Frightened, Paralyzed, or Stunned condition, the condition ends. If the creature has the Prone condition, it can use its reaction to stand up."
};
SpellsList["power word kill ua23pt6"] = { //Ripped directly from ListsSpells.js and then altered
	name : "Power Word Kill (UA23PT6)",
	source : [["UA23PT6", 65], ["SRD", 170], ["P", 266]],
	classes : ["bard", "sorcerer", "sorcerer_ua23pt7", "warlock", "warlock_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 9,
	school : "Ench",
	time : "1 a",
	range : "60 ft",
	components : "V",
	duration : "Instantaneous",
	description : "1 creature with 100 current HP or less dies; otherwise it takes 12d12 Psychic dmg",
	descriptionFull : "You utter a word of power that can compel one creature you can see within range to die instantly. If the creature you choose has 100 Hit Points or fewer, it dies. Otherwise, the target takes 12d12 Psychic damage."
};
SpellsList["searing smite ua23pt6"] = { //Ripped directly from all_WotC_pub+UA.js and then altered
	name : "Searing Smite (UA23PT6)",
	source : [["UA23PT6", 65], ["P", 274], ["MJ:HB", 0]],
	classes : ["cleric", "cleric_ua23pt6", "paladin", "paladin_ua23pt6"],
	level : 1,
	school : "Evoc",
	time : "1 bns",
	range : "Self",
	components : "V",
	duration : "1 min",
	save : "Con",
	description : "Wea atk deals +1d6+1d6/SL Fire dmg and target ignites: start of turn save to end or 1d6 dmg",
	descriptionShorter : "Wea atk deals +1d6+1d6/SL Fire dmg \u0026 ignites: start of turn save to end or 1d6 dmg",
	descriptionFull : "As you hit the target, your strike flares with white-hot intensity, and the target takes an extra 1d6 Fire damage from the attack and ignites with magical fire. At the start of each of its turns until the spell ends, the target takes 1d6 Fire damage and then must make a Constitution saving throw. On a failed save, the spell continues. On a successful save, the spell ends." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, any damage dealt by the spell increases by 1d6 for each slot level above 1st.",
	dynamicDamageBonus : {
		extraDmgGroupsSameType : /(end or )((?:\+?\d+d?\d*)+)/i
	},
};
SpellsList["shining smite ua23pt6"] = {
	name : "Shining Smite (UA23PT6)",
	source : [["UA23PT6", 65], ["MJ:HB", 0]],
	classes : ["paladin", "paladin_ua23pt6"],
	level : 2,
	school : "Trans",
	time : "1 bns",
	timeFull : "1 Bonus Action, which you take immediately after hitting a creature with a melee weapon or an Unarmed Strike",
	range : "S",
	components : "V",
	duration : "Conc, 1 min",
	description : "Wea atk deals +2d6+1d8/SL Rad dmg; Ends Invisible cond; Adv. on atks agnst crea; crea emits light; see book",
	descriptionFull : "As you hit the creature, your strike flares with divine light. The target hit by the strike takes an extra 2d6 Radiant damage from the attack. If the target has the Invisible condition, that condition ends on it. In addition, until the spell ends, the target sheds bright light in a 5-foot (1.5m) radius, attack rolls against it have Advantage, and it can’t benefit from the Invisible condition." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, the extra damage increases by 1d6 for each slot level above 2nd.",
};
SpellsList["staggering smite ua23pt6"] = { //Ripped directly from all_WotC_pub+UA.js and then altered
	name : "Staggering Smite (UA23PT6)",
	source : [["UA23PT6", 65], ["P", 278], ["MJ:HB", 0]],
	classes : ["paladin", "paladin_ua23pt6"],
	level : 4,
	school : "Ench",
	time : "1 bns",
	timeFull : "1 Bonus Action, which you take immediately after hitting a creature with a melee weapon or an Unarmed Strike",
	range : "S",
	components : "V",
	duration : "Instantaneous",
	save : "Wis",
	description : "Wea atk deals +4d6+1d6/SL Psychic dmg and save or Stunned until end next turn",
	descriptionFull : "As you hit the creature, your strike pierces both body and mind. The target takes an extra 4d6 Psychic damage from the attack, and the target must succeed on a Wisdom saving throw or have the Stunned condition until the end of your next turn." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level, the extra damage increases by 1d6.",
};
SpellsList["thunderous smite ua23pt6"] = {
	name : "Thunderous Smite (UA23PT6)",
	source : [["UA23PT6", 65], ["P", 282], ["MJ:HB", 0]],
	classes : ["paladin", "paladin_ua23pt6"],
	level : 1,
	school : "Evoc",
	time : "1 bns",
	timeFull : "1 Bonus Action, which you take immediately after hitting a creature with a melee weapon or an Unarmed Strike",
	range : "S",
	components : "V",
	duration : "Conc, 1 min",
	save : "Str",
	description : "Wea atk deals +2d6+1d6/SL Thunder dmg and save or 10 ft push and prone; audible in 300 ft",
	descriptionFull : "As you hit the target, your strike rings with thunder that is audible within 300 feet of you, and the target takes an extra 2d6 Thunder damage from the attack. Additionally, if the target is a creature, it must succeed on a Strength saving throw or be pushed 10 feet away from you and have the Prone condition." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d6 for each slot level above 1st.",
};
SpellsList["vicious mockery ua23pt6"] = { //Ripped directly from ListsSpells.js and then altered
	name : "Vicious Mockery (UA23PT6)",
	source : [["UA23PT6", 66], ["SRD", 189], ["P", 285], ["MJ:HB", 0]],
	classes : ["bard"],
	level : 0,
	school : "Ench",
	time : "1 a",
	range : "60 ft",
	components : "V",
	duration : "Instantaneous",
	save : "Wis",
	description : "1 creature save or 1d6 Psychic dmg and Dis. on next attack roll; +1d6 at CL 5, 11, and 17",
	descriptionCantripDie : "1 creature save or `CD`d6 Psychic dmg and dis. on next attack roll",
	descriptionFull : "You unleash a string of insults laced with subtle enchantments at one creature you can see or hear within range. The target must succeed on a Wisdom saving throw or take 1d6 Psychic damage and have Disadvantage on the next attack roll it makes before the end of its next turn." + "\n   " + "This spell’s damage increases by 1d6 when you reach certain Bard levels: 5th level (2d6), 11th level (3d6), and 17th level (4d6)."
};
SpellsList["wrathful smite ua23pt6"] = { //Ripped directly from all_WotC_pub+UA.js and then altered
	name : "Wrathful Smite (UA23PT6)",
	source : [["UA23PT6", 66], ["P", 289], ["MJ:HB", 0]],
	classes : ["cleric", "cleric_ua23pt6", "paladin", "paladin_ua23pt6"],
	level : 1,
	school : "Necro",
	time : "1 bns",
	timeFull : "1 Bonus Action, which you take immediately after hitting a creature with a melee weapon or an Unarmed Strike",
	range : "S",
	components : "V",
	duration : "1 min",
	save : "Wis",
	description : "Wea atk deals +1d6 Necrotic dmg and save or Frightened; end of turn save to end",
	descriptionFull : "As you hit the creature, your strike channels divine wrath. The target takes an extra 1d6 Necrotic damage from the attack, and it must succeed on a Wisdom saving throw or have the Frightened condition until the spell ends. At the end of each of its turns, the Frightened target repeats the saving throw, ending the spell on itself on a success." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d6 for each slot level above 1st.",
};

// Add UA23PT6 "Otherworldly Steed" companion template
CompanionList["otherworldly steed ua23pt6"] = {
	name : "Find Steed (UA23PT6)",
	nameMenu : "Otherworldly Steed (Find Steed UA23PT6 spell)",
	nameTooltop : "from the Find Steed (UA23PT6) Spell",
	nameOrigin : "2nd-Level conjuration spell",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	includeCheck : function(sCrea, objCrea, iCreaCR) {
		return /^(?=.*otherworldly)(?=.*steed).*$/i.test(sCrea);
	},
	notes : [{
		name : "Spell Description",
		description : "You gain the service of an otherworldly being, which manifests as a loyal steed in an unoccupied space of your choice within range. This creature uses the Otherworldly Steed stat block. If you already have a steed from this spell, your steed is replaced by the new one." + "\n   " + "The steed resembles a Large, rideable animal of your choice, such as a horse, a camel, a dire wolf, or an elk. Whenever you cast the spell, choose the steed’s creature type—Celestial, Fey, or Fiend—which determines certain traits in the stat block.",
		joinString : "\n   "
	}, {
		name : "Combat",
		description : "The steed is an ally to you and your companions. In combat, it shares your initiative count, and it functions as a controlled mount while you ride it (as defined in the rules on mounted combat). If you have the Incapacitated condition, the steed takes its turn immediately after yours and acts independently, focusing on protecting you.",
		joinString : "\n   "
	}, {
		name : "Disappearance of the Steed",
		description : "The steed disappears if it drops to 0 Hit Points, if you dismiss it as a Bonus Action, or if you die. When it disappears, it leaves behind anything it was wearing or carrying. If you cast this spell again, you decide whether you summon the steed that disappeared or a different one.",
		joinString : "\n   "
	}, {
		name : "At Higher Levels",
		description : "When you cast this spell using a Spell Slot of 3rd level or higher, use the higher level wherever the spell’s level appears in the stat block." + "\n   " + "The steed's HP, AC, & Damage change depending on the level the Find Steed (UA23PT6) spell was cast at:" + "\n      " + "- HP total equals 5 + 10 per spell level; the Otherworldly Steed has a number of Hit Dice equal to the spell's level;" + "\n      " + "- AC total equals 10 + 1 per spell level (natural armor);" + "\n   " + "   - Damage equals 1d8 + the spellls level of Radiant (Celestial), Psychic (Fey), or Necrotic (Fiend) damage.",
		joinString : "\n   "
	}],
};

// Add UA23PT6 "Otherworldly Steed" creatures, one for each spell level
CreatureList["otherworldly steed ua23pt6 lvl 2"] = {
	name : "2nd-Lvl Otherworldly Steed (UA23PT6)",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*steed).*$/i,
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["mount", "mount_not_al", "otherworldly steed ua23pt6"],
	companionApply : "mount",
	alignment : "Neutral",
	ac : 12,
	hp : 25,
	hd : [2, 10],
	speed : "60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [18, 12, 14, 6, 12, 8],
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Slam (UA23PT6)",
		ability : 6,
		damage : [1, 8, "Rad/Psy/Nec"],
		modifiers : ["", "2"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Slam as an Attack action; Damage depends on Creature Type",
		abilitytodamage : false,
		useSpellMod : ["paladin", "paladin_ua23pt6"],
	}],
	languages : "Telepathy 1 mi (1.61km) (only between you and the steed)",
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a spell of 1st level or higher, the steed regains the same number of Hit Points if you’re within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fey Step (Fey Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed, along with its rider, teleports to an unoccupied space of your choice up to 60 ft away from itself.",
		joinString : "\n   ",
	}, {
		name : "Fell Glare (Fiend Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed’s eyes gleam with fiendish light as it targets one creature it can perceive up to 60 ft away. The target must succeed on a Wisdom saving throw against your Spell Save DC or have the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch (Celestial Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed touches another creature and restores a number of Hit Points to it equal to 2d8 + the spell’s level.",
		joinString : "\n   ",
	}],
	header : "Mount",
};
CreatureList["otherworldly steed ua23pt6 lvl 3"] = {
	name : "3rd-Lvl Otherworldly Steed (UA23PT6)",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*steed).*$/i,
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["mount", "mount_not_al", "otherworldly steed ua23pt6"],
	companionApply : "mount",
	alignment : "Neutral",
	ac : 13,
	hp : 35,
	hd : [3, 10],
	speed : "60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [18, 12, 14, 6, 12, 8],
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Slam (UA23PT6)",
		ability : 6,
		damage : [1, 8, "Rad/Psy/Nec"],
		modifiers : ["", "3"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Slam as an Attack action; Damage depends on Creature Type",
		abilitytodamage : false,
		useSpellMod : ["paladin", "paladin_ua23pt6"],
	}],
	languages : "Telepathy 1 mi (1.61km) (only between you and the steed)",
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a spell of 1st level or higher, the steed regains the same number of Hit Points if you’re within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fey Step (Fey Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed, along with its rider, teleports to an unoccupied space of your choice up to 60 ft away from itself.",
		joinString : "\n   ",
	}, {
		name : "Fell Glare (Fiend Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed’s eyes gleam with fiendish light as it targets one creature it can perceive up to 60 ft away. The target must succeed on a Wisdom saving throw against your Spell Save DC or have the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch (Celestial Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed touches another creature and restores a number of Hit Points to it equal to 2d8 + the spell’s level.",
		joinString : "\n   ",
	}],
	header : "Mount",
};
CreatureList["otherworldly steed ua23pt6 lvl 4"] = {
	name : "4th-Lvl Otherworldly Steed (UA23PT6)",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*steed).*$/i,
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["mount", "mount_not_al", "otherworldly steed ua23pt6"],
	companionApply : "mount",
	alignment : "Neutral",
	ac : 14,
	hp : 45,
	hd : [4, 10],
	speed : "60 ft, fly 60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [18, 12, 14, 6, 12, 8],
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Slam (UA23PT6)",
		ability : 6,
		damage : [1, 8, "Rad/Psy/Nec"],
		modifiers : ["", "4"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Slam as an Attack action; Damage depends on Creature Type",
		abilitytodamage : false,
		useSpellMod : ["paladin", "paladin_ua23pt6"],
	}],
	languages : "Telepathy 1 mi (1.61km) (only between you and the steed)",
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a spell of 1st level or higher, the steed regains the same number of Hit Points if you’re within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fey Step (Fey Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed, along with its rider, teleports to an unoccupied space of your choice up to 60 ft away from itself.",
		joinString : "\n   ",
	}, {
		name : "Fell Glare (Fiend Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed’s eyes gleam with fiendish light as it targets one creature it can perceive up to 60 ft away. The target must succeed on a Wisdom saving throw against your Spell Save DC or have the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch (Celestial Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed touches another creature and restores a number of Hit Points to it equal to 2d8 + the spell’s level.",
		joinString : "\n   ",
	}],
	header : "Mount",
};
CreatureList["otherworldly steed ua23pt6 lvl 5"] = {
	name : "5th-Lvl Otherworldly Steed (UA23PT6)",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*steed).*$/i,
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["mount", "mount_not_al", "otherworldly steed ua23pt6"],
	companionApply : "mount",
	alignment : "Neutral",
	ac : 15,
	hp : 55,
	hd : [5, 10],
	speed : "60 ft, fly 60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [18, 12, 14, 6, 12, 8],
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Slam (UA23PT6)",
		ability : 6,
		damage : [1, 8, "Rad/Psy/Nec"],
		modifiers : ["", "5"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Slam as an Attack action; Damage depends on Creature Type",
		abilitytodamage : false,
		useSpellMod : ["paladin", "paladin_ua23pt6"],
	}],
	languages : "Telepathy 1 mi (1.61km) (only between you and the steed)",
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a spell of 1st level or higher, the steed regains the same number of Hit Points if you’re within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fey Step (Fey Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed, along with its rider, teleports to an unoccupied space of your choice up to 60 ft away from itself.",
		joinString : "\n   ",
	}, {
		name : "Fell Glare (Fiend Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed’s eyes gleam with fiendish light as it targets one creature it can perceive up to 60 ft away. The target must succeed on a Wisdom saving throw against your Spell Save DC or have the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch (Celestial Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed touches another creature and restores a number of Hit Points to it equal to 2d8 + the spell’s level.",
		joinString : "\n   ",
	}],
	header : "Mount",
};
CreatureList["otherworldly steed ua23pt6 lvl 6"] = {
	name : "6th-Lvl Otherworldly Steed (UA23PT6)",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*steed).*$/i,
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["mount", "mount_not_al", "otherworldly steed ua23pt6"],
	companionApply : "mount",
	alignment : "Neutral",
	ac : 16,
	hp : 65,
	hd : [6, 10],
	speed : "60 ft, fly 60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [18, 12, 14, 6, 12, 8],
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Slam (UA23PT6)",
		ability : 6,
		damage : [1, 8, "Rad/Psy/Nec"],
		modifiers : ["", "6"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Slam as an Attack action; Damage depends on Creature Type",
		abilitytodamage : false,
		useSpellMod : ["paladin", "paladin_ua23pt6"],
	}],
	languages : "Telepathy 1 mi (1.61km) (only between you and the steed)",
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a spell of 1st level or higher, the steed regains the same number of Hit Points if you’re within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fey Step (Fey Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed, along with its rider, teleports to an unoccupied space of your choice up to 60 ft away from itself.",
		joinString : "\n   ",
	}, {
		name : "Fell Glare (Fiend Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed’s eyes gleam with fiendish light as it targets one creature it can perceive up to 60 ft away. The target must succeed on a Wisdom saving throw against your Spell Save DC or have the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch (Celestial Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed touches another creature and restores a number of Hit Points to it equal to 2d8 + the spell’s level.",
		joinString : "\n   ",
	}],
	header : "Mount",
};
CreatureList["otherworldly steed ua23pt6 lvl 7"] = {
	name : "7th-Lvl Otherworldly Steed (UA23PT6)",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*steed).*$/i,
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["mount", "mount_not_al", "otherworldly steed ua23pt6"],
	companionApply : "mount",
	alignment : "Neutral",
	ac : 17,
	hp : 75,
	hd : [7, 10],
	speed : "60 ft, fly 60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [18, 12, 14, 6, 12, 8],
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Slam (UA23PT6)",
		ability : 6,
		damage : [1, 8, "Rad/Psy/Nec"],
		modifiers : ["", "7"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Slam as an Attack action; Damage depends on Creature Type",
		abilitytodamage : false,
		useSpellMod : ["paladin", "paladin_ua23pt6"],
	}],
	languages : "Telepathy 1 mi (1.61km) (only between you and the steed)",
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a spell of 1st level or higher, the steed regains the same number of Hit Points if you’re within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fey Step (Fey Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed, along with its rider, teleports to an unoccupied space of your choice up to 60 ft away from itself.",
		joinString : "\n   ",
	}, {
		name : "Fell Glare (Fiend Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed’s eyes gleam with fiendish light as it targets one creature it can perceive up to 60 ft away. The target must succeed on a Wisdom saving throw against your Spell Save DC or have the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch (Celestial Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed touches another creature and restores a number of Hit Points to it equal to 2d8 + the spell’s level.",
		joinString : "\n   ",
	}],
	header : "Mount",
};
CreatureList["otherworldly steed ua23pt6 lvl 8"] = {
	name : "8th-Lvl Otherworldly Steed (UA23PT6)",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*steed).*$/i,
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["mount", "mount_not_al", "otherworldly steed ua23pt6"],
	companionApply : "mount",
	alignment : "Neutral",
	ac : 18,
	hp : 85,
	hd : [8, 10],
	speed : "60 ft, fly 60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [18, 12, 14, 6, 12, 8],
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Slam (UA23PT6)",
		ability : 6,
		damage : [1, 8, "Rad/Psy/Nec"],
		modifiers : ["", "8"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Slam as an Attack action; Damage depends on Creature Type",
		abilitytodamage : false,
		useSpellMod : ["paladin", "paladin_ua23pt6"],
	}],
	languages : "Telepathy 1 mi (1.61km) (only between you and the steed)",
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a spell of 1st level or higher, the steed regains the same number of Hit Points if you’re within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fey Step (Fey Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed, along with its rider, teleports to an unoccupied space of your choice up to 60 ft away from itself.",
		joinString : "\n   ",
	}, {
		name : "Fell Glare (Fiend Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed’s eyes gleam with fiendish light as it targets one creature it can perceive up to 60 ft away. The target must succeed on a Wisdom saving throw against your Spell Save DC or have the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch (Celestial Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed touches another creature and restores a number of Hit Points to it equal to 2d8 + the spell’s level.",
		joinString : "\n   ",
	}],
	header : "Mount",
};
CreatureList["otherworldly steed ua23pt6 lvl 9"] = {
	name : "9th-Lvl Otherworldly Steed (UA23PT6)",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*steed).*$/i,
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	companion : ["mount", "mount_not_al", "otherworldly steed ua23pt6"],
	companionApply : "mount",
	alignment : "Neutral",
	ac : 19,
	hp : 95,
	hd : [9, 10],
	speed : "60 ft, fly 60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [18, 12, 14, 6, 12, 8],
	attacksAction : 1,
	attacks : [{
		name : "Otherworldly Slam (UA23PT6)",
		ability : 6,
		damage : [1, 8, "Rad/Psy/Nec"],
		modifiers : ["", "9"],
		range : "Melee (5 ft)",
		description : "One Otherworldly Slam as an Attack action; Damage depends on Creature Type",
		abilitytodamage : false,
		useSpellMod : ["paladin", "paladin_ua23pt6"],
	}],
	languages : "Telepathy 1 mi (1.61km) (only between you and the steed)",
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a spell of 1st level or higher, the steed regains the same number of Hit Points if you’re within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fey Step (Fey Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed, along with its rider, teleports to an unoccupied space of your choice up to 60 ft away from itself.",
		joinString : "\n   ",
	}, {
		name : "Fell Glare (Fiend Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed’s eyes gleam with fiendish light as it targets one creature it can perceive up to 60 ft away. The target must succeed on a Wisdom saving throw against your Spell Save DC or have the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch (Celestial Only; Recharges after a Long Rest)",
		description : "As a bonus action, the steed touches another creature and restores a number of Hit Points to it equal to 2d8 + the spell’s level.",
		joinString : "\n   ",
	}],
	header : "Mount",
};

// Add UA23PT6 "Otherworldly Slam" weapon
WeaponsList["otherworldly slam (ua23pt6)"] = {
	name : "Otherworldly Slam (UA23PT6)",
	source : [["UA23PT6", 64], ["SRD", 143], ["P", 240], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*otherworldly)(?=.*slam).*$/i,
	type : "Natural",
	ability : 6,
	abilitytodamage : false,
	damage : [1, 8, "Rad/Psy/Nec"],
	range : "Melee (5 ft)",
	description : "One Otherworldly Slam as an Attack action; Damage depends on Creature Type",
	list : "melee",
	useSpellMod : ["paladin", "paladin_ua23pt6"],
};

// Add UA23PT6 "Primal Companion" companion template
CompanionList["primal companion ua23pt6"] = {
	name : "Primal Companion (UA23PT6)",
	nameMenu : "Primal Companion (Beast Master UA23PT6)",
	nameTooltop : "companion for the Beast Master Ranger (UA23PT6)",
	nameOrigin : "3rd-Level subclass feature",
	source : [["UA23PT6", 45], ["MJ:HB", 0]],
	includeCheck : function(sCrea, objCrea, iCreaCR) {
		return /^(?=.*beast)(?=.*of)(?=.*the).*$/i.test(sCrea);
	},
	notes : [{
		name : "Subclass Feature Description",
		description : "You magically summon a primal beast, which draws strength from your bond with nature. The beast is friendly to you and your companions and obeys your commands. Choose its stat block—Beast of the Land, Beast of the Sea, or Beast of the Sky—which uses your Proficiency Bonus (PB) in several places. You also determine the kind of animal the beast is, choosing a kind appropriate for the stat block. Whatever kind you choose, the beast bears primal markings, indicating its supernatural origin.",
		joinString : "\n   "
	}, {
		name : "Combat",
		description : "In combat, the beast acts during your turn. It can move and use its Reaction on its own, but the only action it takes is the Dodge action, unless you take a Bonus Action on your turn to command it to take a different action. That action can be one in its stat block or some other action. You can also sacrifice one of your attacks when you take the Attack action to command the beast to take the Attack action. If you have the Incapacitated condition, the beast can take any action of its choice, not just Dodge.",
		joinString : "\n   "
	}, {
		name : "Death/Disappearance of the Beast",
		description : "If the beast has died within the last hour, you can you use your action to touch it and expend a spell slot of 1st level or higher. The beast returns to life after 1 minute with all its Hit Points." + "\n   " + "The beast vanishes if you die.",
		joinString : "\n   "
	}, {
		name : "Changing your chosen Primal Beast",
		description : "Whenever you finish a Long Rest, you can summon a different primal beast. The new beast appears in an unoccupied space within 5 feet of you, and you choose its stat block and appearance. If you already have a beast from this feature, it vanishes when the new beast appears.",
		joinString : "\n   "
	}],
};

// Add UA23PT6 "Primal Companion" creatures
CreatureList["beast of the land ua23pt6"] = {
	name : "Beast of the Land (UA23PT6)",
	source : [["UA23PT6", 45], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*beast)(?=.*of)(?=.*the)(?=.*land).*$/i,
	size : 3,
	type : ["Beast"],
	companion : ["companion", "companion_not_al", "primal companion ua23pt6"],
	companionApply : "companion",
	alignment : "Unaligned",
	ac : "13+Prof",
	hp : 10,
	hd : [1, 8],
	hdLinked : ["ranger", "ranger_ua23pt6"],
	speed : "40 ft, climb 40 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [14, 14, 15, 8, 14, 11],
	attacksAction : 1,
	calcChanges : {
		hp : function (totalHD, HDobj, prefix) {
			if (!classes.known.ranger && !classes.known.ranger_ua23pt6) return;
			var rgrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.ranger_ua23pt6.level;
			HDobj.alt.push(5 + 5 * rgrLvl);
			HDobj.altStr.push(" = 5 as a base\n + " + "5 \xD7" + rgrLvl + " from its master's Ranger level");
		},
		setAltHp : true,
		hpForceRecalc : true,
	},
	attacks : [{
		name : "Maul",
		ability : 1,
		damage : [1, 8, "Slashing"],
		modifiers : ["", "Prof"],
		range : "Melee (5 ft)",
		description : "+1d6 damage if hits after moving 20 ft straight in same round, see Charge",
		tooltip : "If the beast moves at least 20 feet straight toward a target and then hits it with a maul attack on the same turn, the target takes an extra 1d6 slashing damage. If the target is a creature, it must succeed on a Strength saving throw against your spell save DC or be knocked prone.",
		useSpellMod : ["ranger", "ranger_ua23pt6"]
	}, {
		name : "Charge",
		ability : 1,
		damage : ["Str save", "", "Knocked prone"],
		range : "Melee (5 ft)",
		description : "Str save or knocked prone; Only if maul hits after moving 20 ft straight in same round",
		tooltip : "If the beast moves at least 20 feet straight toward a target and then hits it with a maul attack on the same turn, the target takes an extra 1d6 slashing damage. If the target is a creature, it must succeed on a Strength saving throw against your spell save DC or be knocked prone.",
		abilitytodamage : false,
		dc : true,
		useSpellMod : ["ranger", "ranger_ua23pt6"]
	}],
	languages : "understands the languages you speak",
	features : [{
		name : "Primal Bond",
		description : "You can add your Proficiency Bonus to any ability check or saving throw that the beast makes.",
		joinString : "\n   ",
	}],
	header : "Companion",
};
CreatureList["beast of the sea ua23pt6"] = {
	name : "Beast of the Sea (UA23PT6)",
	source : [["UA23PT6", 45], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*beast)(?=.*of)(?=.*the)(?=.*sea).*$/i,
	size : 3,
	type : ["Beast"],
	companion : ["companion", "companion_not_al", "primal companion ua23pt6"],
	companionApply : "companion",
	alignment : "Unaligned",
	ac : "13+Prof",
	hp : 10,
	hd : [1, 8],
	hdLinked : ["ranger", "ranger_ua23pt6"],
	speed : "5 ft, swim 60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [14, 14, 15, 8, 14, 11],
	attacksAction : 1,
	calcChanges : {
		hp : function (totalHD, HDobj, prefix) {
			if (!classes.known.ranger && !classes.known.ranger_ua23pt6) return;
			var rgrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.ranger_ua23pt6.level;
			HDobj.alt.push(5 + 5 * rgrLvl);
			HDobj.altStr.push(" = 5 as a base\n + " + "5 \xD7" + rgrLvl + " from its master's Ranger level");
		},
		setAltHp : true,
		hpForceRecalc : true,
	},
	attacks : [{
		name : "Binding Strike",
		ability : 1,
		damage : [1, 6, "Bludg/Slash"],
		modifiers : ["", "Prof"],
		range : "Melee (5 ft)",
		description : "Target has the Grappled condition (escape DC = my Spell Save DC)",
		useSpellMod : ["ranger", "ranger_ua23pt6"]
	}],
	languages : "understands the languages you speak",
	features : [{
		name : "Primal Bond",
		description : "You can add your Proficiency Bonus to any ability check or saving throw that the beast makes.",
		joinString : "\n   ",
	}, {
		name : "Amphibious",
		description : "The beast can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Companion",
};
CreatureList["beast of the sky ua23pt6"] = {
	name : "Beast of the Sky (UA23PT6)",
	source : [["UA23PT6", 45], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*beast)(?=.*of)(?=.*the)(?=.*sky).*$/i,
	size : 4,
	type : ["Beast"],
	companion : ["companion", "companion_not_al", "primal companion ua23pt6"],
	companionApply : "companion",
	alignment : "Unaligned",
	ac : "13+Prof",
	hp : 8,
	hd : [1, 6],
	hdLinked : ["ranger", "ranger_ua23pt6"],
	speed : "10 ft, fly 60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [6, 16, 13, 8, 14, 11],
	attacksAction : 1,
	calcChanges : {
		extraAC : [{
			mod : 'Prof',
		}],
		hp : function (totalHD, HDobj, prefix) {
			if (!classes.known.ranger && !classes.known.ranger_ua23pt6) return;
			var rgrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.ranger_ua23pt6.level;
			HDobj.alt.push(4 + 4 * rgrLvl);
			HDobj.altStr.push(" = 4 as a base\n + " + "4 \xD7" + rgrLvl + " from its master's Ranger level");
		},
		setAltHp : true,
		hpForceRecalc : true,
	},
	attacks : [{
		name : "Shred",
		ability : 2,
		damage : [1, 4, "Slashing"],
		modifiers : ["", "Prof"],
		range : "Melee (5 ft)",
		description : "",
		tooltip : "",
		useSpellMod : ["ranger", "ranger_ua23pt6"]
	}],
	languages : "understands the languages you speak",
	features : [{
		name : "Primal Bond",
		description : "You can add your Proficiency Bonus to any ability check or saving throw that the beast makes.",
		joinString : "\n   ",
	}, {
		name : "Flyby",
		description : "The beast doesn’t provoke Opportunity Attacks when it flies out of an enemy’s reach.",
		joinString : "\n   ",
	}],
	header : "Companion",
};

// Add UA23PT6 "Binding Strike" weapon
WeaponsList["binding strike (ua23pt6)"] = {
	name : "Binding Strike (UA23PT6)",
	source : [["UA23PT6", 45], ["MJ:HB", 0]],
	regExpSearch : /^(?=.*binding)(?=.*strike).*$/i,
	type : "Natural",
	ability : 1,
	abilitytodamage : true,
	damage : [1, 6, "Bludg/Slash"],
	range : "Melee (5 ft)",
	description : "Target has the Grappled condition (escape DC = my Spell Save DC)",
	list : "melee",
	useSpellMod : ["ranger", "ranger_ua23pt6"],
};

// Add UA23PT6 Feats
FeatsList["archery fighting style ua23pt6"] = {
	name : "Archery Fighting Style (UA23PT6)",
	source : [["UA23PT6", 67], ["P", 72], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"]|features["fighting style ua23pt7"]|features["fighting style"]/i).test(classes.known);
	},
	description : desc("+2 bonus to attack rolls I make with ranged weapons"),
	calcChanges : {
		atkCalc : [
			function (fields, v, output) {
				if (v.isRangedWeapon && !v.isNaturalWeapon && !v.isDC) output.extraHit += 2;
			},
			"My ranged weapons get a +2 bonus on the To Hit."
		]
	},
};
FeatsList["defense fighting style ua23pt6"] = {
	name : "Defense Fighting Style (UA23PT6)",
	source : [["UA23PT6", 67], ["P", 72], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"]|features["fighting style ua23pt7"]|features["fighting style"]/i).test(classes.known);
	},
	description : desc("+1 bonus to AC when I'm wearing armor"),
	extraAC : {
		name : "Defense Fighting Style", // necessary for features referring to fighting style properties directly
		mod : 1,
		text : "I gain a +1 bonus to AC while wearing armor.",
		stopeval : function (v) { return !v.wearingArmor; }
	},
};
FeatsList["dueling fighting style ua23pt6"] = {
	name : "Dueling Fighting Style (UA23PT6)",
	source : [["UA23PT6", 67], ["P", 72], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"]|features["fighting style ua23pt7"]|features["fighting style"]/i).test(classes.known);
	},
	description : desc("+2 to damage rolls when wielding a melee weapon in one hand and no other weapons"),
	calcChanges : {
		atkCalc : [
			function (fields, v, output) {
				for (var i = 1; i <= FieldNumbers.actions; i++) {
					if ((/off.hand.attack/i).test(What('Bonus Action ' + i))) return;
				};
				if (v.isMeleeWeapon && !v.isNaturalWeapon && !(/((^|[^+-]\b)2|\btwo).?hand(ed)?s?\b/i).test(fields.Description)) output.extraDmg += 2;
			},
			"When I'm wielding a melee weapon in one hand and no weapon in my other hand, I do +2 damage with that melee weapon. This condition will always be false if the bonus action 'Off-hand Attack' exists."
		]
	},
};
FeatsList["great weapon fighting style ua23pt6"] = {
	name : "Great Weapon Fighting Style (UA23PT6)",
	source : [["UA23PT6", 67], ["P", 72], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"]|features["fighting style ua23pt7"]|features["fighting style"]/i).test(classes.known);
	},
	description : desc("Reroll 1 or 2 on damage if wielding two-handed/versatile melee weapon in both hands"),
	calcChanges : {
		atkAdd : [
			function (fields, v) {
				if (v.isMeleeWeapon && (/(\bversatile|((^|[^+-]\b)2|\btwo).?hand(ed)?s?)\b/i).test(fields.Description)) {
					fields.Description += (fields.Description ? '; ' : '') + 'Re-roll 1 or 2 on damage die' + ((/versatile/i).test(fields.Description) ? ' when two-handed' : '');
				}
			},
			"While wielding a two-handed or versatile melee weapon in two hands, I can re-roll a 1 or 2 on any damage die once."
		]
	},
};
FeatsList["protection fighting style ua23pt6"] = {
	name : "Protection Fighting Style (UA23PT6)",
	source : [["UA23PT6", 67], ["P", 72], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"]|features["fighting style ua23pt7"]|features["fighting style"]/i).test(classes.known);
	},
	description : desc([
		"As a reaction, I can give disadv. on an attack made vs. someone within 5 ft of me",
		"I need to be wielding a shield and be able to see the attacker to do this"
	]),
	action : ["reaction", ""],
};
FeatsList["two_weapon fighting style ua23pt6"] = {
	name : "Two-Weapon Fighting Style (UA23PT6)",
	source : [["UA23PT6", 67], ["P", 72], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"]|features["fighting style ua23pt7"]|features["fighting style"]/i).test(classes.known);
	},
	description : desc("When I make the extra attack granted by the Light weapon property, I can add my ability modifier to the damage of the extra attack"),
};

//// >>>>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA23PT7 Content >>> ////
//// >>>>>>>>>>>>>>>>>>>>>>> ////

// Add UA23PT7 Fighter class
ClassList.fighter_ua23pt7 = {
	name : "Fighter (UA:PT-vii)",
	regExpSearch : /(?=.*(fighter|warrior|militant|warlord|phalanx|gladiator|trooper)).*$/i,
	source : [["UA23PT7", 9], ["MJ:HB", 0]],
	primaryAbility : "Strength or Dexterity",
	prerequisite : "Strength 13+ or Dexterity 13+",
	prereqeval : function(v) {
		return (What('Str') >= 13 || What('Dex') >= 13);
	},
	die : 10,
	improvements : [0, 0, 0, 1, 1, 2, 2, 3, 3, 3, 3, 4, 4, 5, 5, 6, 6, 6, 7, 7],
	saves : ["Str", "Con"],
	skills : ["\n\n" + toUni("Fighter") + ": Choose two from Acrobatics, Animal Handling, Athletics, History, Insight, Intimidation, Persuasion, Perception, Survival", ""],
	armor : [
		[true, true, true, true],
		[true, true, false, true],
	],
	weapons : [
		[true, true, [""]],
		[false, true, [""]],
	],
	equipment : "Fighter starting equipment:" +
		"\n \u2022 Chain Mail," +
		"\n \u2022 Crossbow Bolts (20)," +
		"\n \u2022 Dungeoneer's Pack," +
		"\n \u2022 Greatsword," +
		"\n \u2022 Light Crossbow," +
		"\n \u2022 Quiver," +
		"\n \u2022 and 11 gp;" +
		"\n OR;" +
		"\n \u2022 Chain Mail," +
		"\n \u2022 Crossbow Bolts (20)," +
		"\n \u2022 Dungeoneer's Pack," +
		"\n \u2022 Longsword," +
		"\n \u2022 Shield," +
		"\n \u2022 Light Crossbow," +
		"\n \u2022 Quiver," +
		"\n \u2022 and 36 gp;" +
		"\n\nAlternatively, choose 175 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Martial Archetype", []],
	attacks : [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4,],
	features : {
		"fighting style ua23pt7" : { //Ripped directly from "ListClasses.js" and then altered
			name : "Fighting Style",
			source : [["UA23PT7", 10], ["SRD", 24], ["P", 72], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"Choose a Fighting Style feat for the Fighter using the \"Choose Feature\" button above.",
				"The chosen option will appear in pg 3's Notes section & in the list of feats.",
				"Upon gaining a Fighter Lvl, I can replace the feat chosen with another Fighting Style feat.",
			]),
		},
		"second wind ua23pt7" : { //Ripped directly from "ListClasses.js" and then altered
			name : "Second Wind",
			source : [["UA23PT7", 10], ["SRD", 24], ["P", 72], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"As a Bonus Action, I regain 1d10 + fighter level HP;",
				"I can use this a number of times per Long Rest, regaining one expended use after a Short Rest.",
				"I can use this 2 times at Fighter Lvl 1, 3 times at Fighter Lvl 4, \u0026 4 times at Fighter Lvl 10.",
			]),
			additional : levels.map(function (n) {
				return "1d10+" + n;
			}),
			limfeaname : "Second Wind (Regain 1/SR)",
			usages : [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
			recovery : "long rest",
			action : ["bonus action", ""]
		},
		"weapon mastery ua23pt7" : {
			/* 	-SCRIPT AUTHOR NOTE-
				This feature calls the masteryFunctions.weaponMasteryAtkAdd function (made by Joost/MPMB) for the
				actual weapon description alterations. The feature also lets the user select via extrachoices what
				Weapons they currently have chosen to add Mastery properties to. The extrachoices options are
				functionally useless, but I'm leaving it in here because I know some users in my own play group need
				what the extrachoices does to realize "Oh, I need to remove the word 'Mastery' from one of my weapons
				to use the Mastery property of a different weapon".
				Joost/MPMB, you can remove the extrachoices aspect of this if you want when you get around to updating
				the sheet code yourself for the revised rules.
			*/
			name : "Weapon Mastery",
			source : [["UA23PT7", 11], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can use the Mastery property of 3 kinds of weapons of my choice with which I have proficiency.",
				"I can change what weapons I can use the Mastery property of after finishing a Long Rest.",
				"I can choose 4 kinds of weapons when I reach Fighter lvl 4, 5 kinds at Fighter Lvl 10, \u0026 6 at Fighter Lvl 16.",
				"My chosen weapon types will appear in the pg 3 Notes section.",
			]),
			calcChanges : {
				atkAdd : masteryFunctions.weaponMasteryAtkAdd
			},
			extraname : "Weapon Mastery",
			extrachoices : ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Light Crossbow", "Dart", "Shortbow", "Sling", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "War Pick", "Warhammer", "Whip", "Blowgun", "Hand Crossbow", "Heavy Crossbow", "Longbow", "Pistol", "Musket", "Pistol Automatic", "Revolver", "Hunting Rifle", "Automatic Rifle", "Shotgun", "Laser Pistol", "Antimatter Rifle", "Laser Rifle"],
			extraTimes : levels.map(function (n) { return n < 4 ? 3 : n < 10 ? 4 : n < 16 ? 5 : 6; }),
			"club" : {
				name : "Club",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"dagger" : {
				name : "Dagger",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"greatclub" : {
				name : "Greatclub",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"handaxe" : {
				name : "Handaxe",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"javelin" : {
				name : "Javelin",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"light hammer" : {
				name : "Light Hammer",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"mace" : {
				name : "Mace",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"quarterstaff" : {
				name : "Quarterstaff",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"sickle" : {
				name : "Sickle",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"spear" : {
				name : "Spear",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"light crossbow" : {
				name : "Light Crossbow",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"dart" : {
				name : "Dart",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"shortbow" : {
				name : "Shortbow",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"sling" : {
				name : "Sling",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"battleaxe" : {
				name : "Battleaxe",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"flail" : {
				name : "Flail",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"glaive" : {
				name : "Glaive",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"greataxe" : {
				name : "Greataxe",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"greatsword" : {
				name : "Greatsword",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"halberd" : {
				name : "Halberd",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"lance" : {
				name : "Lance",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"longsword" : {
				name : "Longsword",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"maul" : {
				name : "Maul",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"morningstar" : {
				name : "Morningstar",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"pike" : {
				name : "Pike",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"rapier" : {
				name : "Rapier",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"scimitar" : {
				name : "Scimitar",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"shortsword" : {
				name : "Shortsword",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"trident" : {
				name : "Trident",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"war pick" : {
				name : "War Pick",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"warhammer" : {
				name : "Warhammer",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"whip" : {
				name : "Whip",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"blowgun" : {
				name : "Blowgun",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"hand crossbow" : {
				name : "Hand Crossbow",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"heavy crossbow" : {
				name : "Heavy Crossbow",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"longbow" : {
				name : "Longbow",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"pistol" : {
				name : "Pistol",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"musket" : {
				name : "Musket",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"pistol automatic" : {
				name : "Pistol Automatic",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"revolver" : {
				name : "Revolver",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"hunting rifle" : {
				name : "Hunting Rifle",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"automatic rifle" : {
				name : "Automatic Rifle",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"shotgun" : {
				name : "Shotgun",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"laser pistol" : {
				name : "Laser Pistol",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"antimatter rifle" : {
				name : "Antimatter Rifle",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"laser rifle" : {
				name : "Laser Rifle",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
		},
		"action surge ua23pt7" : { //Ripped directly from "ListClasses.js" and then altered
			name : "Action Surge",
			source : [["UA23PT7", 11], ["SRD", 25], ["P", 72], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"I can take one additional action, except the Magic action, on my turn on top of my normally allowed actions.",
				"I gain another use per Short Rest of this feature at Fighter Lvl 17, but can only use one per turn.",
			]),
			usages : [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2],
			recovery : "short rest",
		},
		"tactical mind ua23pt7" : {
			name : "Tactical Mind",
			source : [["UA23PT7", 11], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"When I fail an Ability Check, I can expend a use of Second Wind to roll a 1d10 to add to the Ability Check.",
				"Expending a use of Second Wind in this manner forgoes the normal healing that Second Wind provides.",
				"If the check still fails after adding the 1d10, this use of Second Wind isn't expended.",
			]),
		},
		"subclassfeature3" : { //Ripped directly from "ListClasses.js" and then altered
			name : "Martial Archetype",
			source : [["UA23PT7", 11], ["SRD", 25], ["P", 72], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc('Choose a Martial Archetype you strive to emulate and put it in the "Class" field '),
		},
		"indomitable ua23pt7" : { //Ripped directly from "ListClasses.js" and then altered
			name : "Indomitable",
			source : [["UA23PT7", 11], ["SRD", 25], ["P", 72], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"I can reroll a failed saving throw with a bonus equal to my Fighter Lvl, but must keep the new result",
				"I gain another use per Long Rest starting at Fighter lvl 13, \u0026 a 3rd use starting at Fighter Lvl 17.",
			]),
			usages : [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3],
			recovery : "long rest",
		},
		"master of armaments ua23pt7" : {
			name : "Master of Armaments",
			source : [["UA23PT7", 11], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"After a Long Rest, I can choose any of the kinds of Mastery weapons I'm using \u0026 replace the Mastery",
				"  property of each with another Mastery property for which it qualifies. These property changes apply only",
				"  for me, not for others, and the changes end for me when I finish my next Long Rest.",
				"For reference, the prerequisites for each Mastery property will be listed in the pg 3 Notes section.",
			]),
			calcChanges : {
				atkAdd : masteryFunctions.masterOfArmamentsAtkAdd
			},
			toNotesPage : [{
				name : "Master of Armaments: Mastery Property Prerequisites",
				source : [["UA23PT7", 11], ["MJ:HB", 0]],
				note : [
					"For reference, here are the prerequisites for each Mastery property:",
					" \u2022 Cleave: Melee Weapon, Heavy Property",
					" \u2022 Graze: Melee Weapon, Heavy Property",
					" \u2022 Nick: Light Property",
					" \u2022 Push: Heavy, Two-Handed, or Versatile Property",
					" \u2022 Sap: Versatile Property or lacking a Weapon Property (ex: Mace, Flail)",
					" \u2022 Slow: No prerequisites",
					" \u2022 Topple: Heavy, Reach, or Versatile Property",
					" \u2022 Vex: Ammunition, Finesse, or Light Property",
				],
				page3notes : true,
				popupName : "Master of Armaments: Mastery Property Prerequisites",
			}],
		},
		"studied attacks ua23pt7" : {
			name : "Studied Attacks",
			source : [["UA23PT7", 11], ["MJ:HB", 0]],
			minlevel : 13,
			description : desc([
				"After missing an attack roll against a creature, I gain Adv. on my next attack roll against that creature",
				"  before the end of my next turn.",
			]),
		},
	},
};

//// Add Fighter "Fighting Style" choices
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Archery", {
	name : "Fighting Style: Archery",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Archery Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Archery Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Archery Fighting Style (UA23PT6)"); }
}, "1st-level fighter Fighting Style choice");
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Blind Fighting", {
	name : "Fighting Style: Blind Fighting",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Blind Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Blind Fighting Style (UA23PT7)"); },
	removeeval : function() { RemoveFeat("Blind Fighting Style (UA23PT7)"); }
}, "1st-level fighter Fighting Style choice");
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Defense", {
	name : "Fighting Style: Defense",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Defense Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Defense Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Defense Fighting Style (UA23PT6)"); }
}, "1st-level fighter Fighting Style choice");
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Dueling", {
	name : "Fighting Style: Dueling",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Dueling Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Dueling Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Dueling Fighting Style (UA23PT6)"); }
}, "1st-level fighter Fighting Style choice");
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Great Weapon Fighting", {
	name : "Fighting Style: Great Weapon Fighting",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Great Weapon Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Great Weapon Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Great Weapon Fighting Style (UA23PT6)"); }
}, "1st-level fighter Fighting Style choice");
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Interception", {
	name : "Fighting Style: Interception",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Interception Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Interception Fighting Style (UA23PT7)"); },
	removeeval : function() { RemoveFeat("Interception Fighting Style (UA23PT7)"); }
}, "1st-level fighter Fighting Style choice");
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Protection", {
	name : "Fighting Style: Protection",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Protection Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Protection Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Protection Fighting Style (UA23PT6)"); }
}, "1st-level fighter Fighting Style choice");
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Superior Technique", {
	name : "Fighting Style: Superior Technique",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Superior Technique Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Superior Technique Fighting Style (UA23PT7)"); },
	removeeval : function() { RemoveFeat("Superior Technique Fighting Style (UA23PT7)"); }
}, "1st-level fighter Fighting Style choice");
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Thrown Weapon", {
	name : "Fighting Style: Thrown Weapon",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Thrown Weapon Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Thrown Weapon Fighting Style (UA23PT7)"); },
	removeeval : function() { RemoveFeat("Thrown Weapon Fighting Style (UA23PT7)"); }
}, "1st-level fighter Fighting Style choice");
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Two-Weapon Fighting", {
	name : "Fighting Style: Two-Weapon Fighting",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Two-Weapon Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Two-Weapon Fighting Style (UA23PT6)"); },
	removeeval : function() { RemoveFeat("Two-Weapon Fighting Style (UA23PT6)"); }
}, "1st-level fighter Fighting Style choice");
AddFeatureChoice(ClassList.fighter_ua23pt7.features["fighting style ua23pt7"], true, "Fighting Style: Unarmed Fighting", {
	name : "Fighting Style: Unarmed Fighting",
	extraname : "Fighter 1",
	source : [["UA23PT7", 10], ["MJ:HB", 0]],
	description : "\n   " + "I have chosen the Unarmed Fighting Style feat.",
	prereqeval : function (v) { return classes.known.fighter_ua23pt7.level >= 1 ? true : "skip"; },
	eval : function() { AddFeat("Unarmed Fighting Style (UA23PT7)"); },
	removeeval : function() { RemoveFeat("Unarmed Fighting Style (UA23PT7)"); }
}, "1st-level fighter Fighting Style choice");

////// Add UA23PT7 Battle Master Fighter subclass
AddSubClass("fighter_ua23pt7", "battle master_ua23pt7", {
	regExpSearch : /^(?=.*(war|fighter|battle|martial))(?=.*master).*$/i,
	subname : "Battle Master",
	fullname : "Battle Master",
	source : [["UA23PT7", 12], ["P", 73], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : { //Ripped directly from "all_WotC_pub+UA.js"
			name : "Combat Superiority",
			source : [["P", 73]],
			minlevel : 3,
			description : "\n   " + "I gain a number of Superiority Dice that I can use to fuel special Maneuvers" + "\n   " + "I regain all Superiority Dice after a Short Rest",
			additional : ["", "", "d8", "d8", "d8", "d8", "d8", "d8", "d8", "d10", "d10", "d10", "d10", "d10", "d10", "d10", "d10", "d12", "d12", "d12"],
			usages : [0, 0, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6],
			recovery : "short rest"
		},
		"subclassfeature3.1" : { //Ripped directly from "all_WotC_pub+UA.js" and then altered; Adding all TCE Maneuvers, not just the ones in UA23PT7
			name : "Maneuvers",
			source : [["UA23PT7", 12], ["P", 73], ["MJ:HB", 0]],
			minlevel : 3,
			description : "\n   " + 'Use the "Choose Feature" button above to add a Maneuver to the third page' + "\n   " + "I can use a Maneuver by expending a Superiority Die (only one Maneuver per attack)",
			additional : levels.map(function (n) {
				return n < 3 ? "" : (n < 7 ? 3 : n < 10 ? 5 : n < 15 ? 7 : 9) + " known";
			}),
			extraname : "Maneuver",
			extrachoices : ["Ambush", "Bait and Switch", "Brace", "Commander's Strike", "Commanding Presence", "Disarming Attack", "Distracting Strike", "Evasive Footwork", "Feinting Attack", "Goading Attack", "Grappling Strike", "Lunging Attack", "Maneuvering Attack", "Menacing Attack", "Parry", "Precision Attack", "Pushing Attack", "Quick Toss", "Rally", "Riposte", "Sweeping Attack", "Tactical Assessment", "Trip Attack"],
			extraTimes : levels.map(function (n) {
				return n < 3 ? 0 : n < 7 ? 3 : n < 10 ? 5 : n < 15 ? 7 : 9;
			}),
			"ambush" : {
				name : "Ambush",
				source : [["UA23PT7", 13], ["T", 42], ["UA:CFV", 5], ["MJ:HB", 0]],
				description : desc([
					"When I make an initiative roll or a Dex (Stealth) check, I can add a Superiority Die to it.",
					"I can't do this if I'm Incapacitated.",
				]),
			},
			"bait and switch" : {
				name : "Bait and Switch",
				source : [["UA23PT7", 13], ["T", 42], ["MJ:HB", 0]],
				description : desc([
					"On my turn, I can expend a Superiority Die to swap places with an ally within 5 ft.",
					"I can't do this if the ally is Incapacitated or unwilling to swap.",
					"Doing this costs me 5 ft of movement, but this doesn't provoke opportunity attacks.",
					"Me or my ally (my choice) can then add the Superiority Die to AC until my next turn starts.",
				]),
			},
			"brace" : {
				name : "Brace",
				source : [["T", 42], ["MJ:HB", 0]],
				description : desc([
					"As a Reaction when a creature I can see moves within my melee reach, I can attack it.",
					"I expend a Superiority Die and make one weapon attack, adding the die to the damage.",
				]),
				action : [["reaction", "Brace"]],
			},
			"commander's strike" : {
				name : "Commander's Strike",
				source : [["UA23PT7", 13], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"I forgo one attack of my Attack action to direct an ally I see/hear.",
					"The ally can use a Reaction to make an attack, adding the Superiority Die to damage.",
				]),
			},
			"commanding presence" : {
				name : "Commanding Presence",
				source : [["UA23PT7", 13], ["T", 42], ["MJ:HB", 0]],
				description : desc([
					"When I make a Performance, Intimidation, or Persuasion check, I can add a Superiority Die to it.",
				]),
			},
			"disarming attack" : {
				name : "Disarming Attack",
				source : [["UA23PT7", 13], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"Use after hitting a creature; I add the Superiority Die to my attack's damage.",
					"Target makes a Strength save or drops a held object of my choice to its feet.",
				]),
			},
			"distracting strike" : {
				name : "Distracting Strike",
				source : [["UA23PT7", 13], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"Use after hitting a creature; I add the Superiority Die to my attack's damage.",
					"The next attack of an ally before my next turn has Adv. against the creature.",
				]),
			},
			"evasive footwork" : {
				name : "Evasive Footwork",
				source : [["UA23PT7", 13], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"Use when moving at least 5 ft; I add the Superiority Die to my AC until the end of my turn.",
				]),
			},
			"feinting attack" : {
				name : "Feinting Attack",
				source : [["UA23PT7", 13], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"As a Bonus Action, I can feint to gain Adv. on my next attack this turn vs. a target in 5 ft.",
					"If I hit, add the Superiority Die to my attack's damage.",
				]),
				action : [["bonus action", ""]],
			},
			"goading attack" : {
				name : "Goading Attack",
				source : [["UA23PT7", 13], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"Use after hitting a creature; I add the Superiority Die to my attack's damage.",
					"Target makes a Wis save or has Disadv. vs. other targets until the end of my next turn.",
				]),
			},
			"grappling strike" : {
				name : "Grappling Strike",
				source : [["T", 42], ["MJ:HB", 0]],
				description : desc([ //The alterations made to bring this in line with the UA Grapple rules are of my own creation
					"Immediately after hitting with a melee attack, I can use a Bonus Action to try to Grapple Unarmed Strike.",
					"I subtract the Superiority Die from the target's Str or Dex save; I can only do this on my own turn.",
				]),
				action : [["bonus action", " (after melee hit)"]],
			},
			"lunging attack" : {
				name : "Lunging Attack",
				source : [["UA23PT7", 13], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"I can spend a Superiority Die to take the Dash action as a Bonus Action.",
					"If after moving at least 10 ft in a straight line immediately before hitting with a",
					"  melee attack as part of Attack action, I add the Superiority Die to my attack's damage.",
				]),
				action : [["bonus action", " (Dash)"]],
			},
			"maneuvering attack" : {
				name : "Maneuvering Attack",
				source : [["UA23PT7", 13], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"Use after hitting a creature; I add the Superiority Die to my attack's damage.",
					"Ally who can see/hear me can use Reaction to move half speed without opportunity attack from the target.",
				]),
			},
			"menacing attack" : {
				name : "Menacing Attack",
				source : [["UA23PT7", 13], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"Use after hitting a creature; I add the Superiority Die to my attack's damage.",
					"Target makes a Wisdom save or is Frightened of me until the end of my next turn.",
				]),
			},
			"parry" : {
				name : "Parry",
				source : [["UA23PT7", 13], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"When damaged in melee, I can use a Reaction to reduce damage taken by",
					"  Superiority Die + Str/Dex mod, my choice.",
				]),
				action : [["reaction", " (when damaged in melee)"]],
			},
			"precision attack" : {
				name : "Precision Attack",
				source : [["UA23PT7", 14], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"After missing with an attack roll, I add the Superiority Die to my attack roll,",
					"  potentially causing it to instead hit.",
				]),
			},
			"pushing attack" : {
				name : "Pushing Attack",
				source : [["UA23PT7", 14], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"Use after hitting a creature; I add the Superiority Die to my attack's damage.",
					"If target is Large or smaller, it must make a Strength save or be pushed up to 15 ft away.",
				]),
			},
			"quick toss" : {
				name : "Quick Toss",
				source : [["T", 42], ["MJ:HB", 0]],
				description : desc([
					"As a Bonus Action, I can use a Superiority Die to do a ranged attack with a thrown weapon.",
					"I can draw a thrown weapon as part of making this attack; I add the die to the damage.",
				]),
				action : [["bonus action", ""]],
			},
			"rally" : {
				name : "Rally",
				source : [["UA23PT7", 14], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"As a Bonus Action, ally that can see/hear me gets temporary HP equal to",
					"  Superiority Die + Int/Wis/Cha mod, my choice.",
				]),
				action : [["bonus action", ""]],
			},
			"riposte" : {
				name : "Riposte",
				source : [["UA23PT7", 14], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"When missed in melee, I can use my Reaction to make one melee attack vs. the attacker.",
					"If the attack hits, I add the Superiority Die to my attack's damage.",
				]),
				action : [["reaction", " (after missed in melee)"]],
			},
			"sweeping attack" : {
				name : "Sweeping Attack",
				source : [["UA23PT7", 14], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"Use after hitting a creature and a second creature is within 5 ft of the first.",
					"If the original attack roll hits this second creature, it takes the Superiority Die in damage.",
				]),
			},
			"tactical assessment" : {
				name : "Tactical Assessment",
				source : [["UA23PT7", 13], ["T", 42], ["MJ:HB", 0]],
				description : desc([
					"When I make an Investigation, History, or Insight check, I can add a Superiority Die to it.",
				]),
			},
			"trip attack" : {
				name : "Trip Attack",
				source : [["UA23PT7", 14], ["P", 74], ["MJ:HB", 0]],
				description : desc([
					"Use after hitting a creature; I add the Superiority Die to my attack's damage.",
					"If target is Large or smaller, it must make a Strength save or be knocked Prone.",
				]),
			},
		},
		"subclassfeature3.2" : { //Ripped directly from "all_WotC_pub+UA.js" and then altered
			name : "Student of War",
			source : [["UA23PT7", 12], ["P", 73], ["MJ:HB", 0]],
			minlevel : 3,
			description : "\n   " + "I have proficiency with one Artisan's Tool set \u0026 one Fighter skill of my choice",
			toolProfs : [["Artisan's tools", 1]],
			skillstxt : "Choose one from Acrobatics, Animal Handling, Athletics, History, Insight, Intimidation, Persuasion, Perception, and Survival",
		},
		"subclassfeature7" : {
			name : "Know Your Enemy",
			source : [["UA23PT7", 12], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc([
				"As a Bonus Action, I can focus on a creature I can see within 30 ft.",
				"I know what damage immunities, resistances, and/or vulnerabilities, if it has any.",
				"I can do this once per Long Rest, or I can use a Superiority Die to restore a use as a Free Action.",
			]),
			action : [["bonus action", ""]],
			usages : 1,
			altResource : "1 Sup. Die",
			recovery : "long rest",
		},
		"subclassfeature10" : { //Ripped directly from "all_WotC_pub+UA.js"
			name : "Improved Combat Superiority",
			source : [["UA23PT7", 12], ["P", 74]],
			minlevel : 10,
			description : "\n   " + "My Superiority Dice turn into d10s at 10th level and into d12s at 18th level"
		},
		"subclassfeature15" : {
			name : "Relentless",
			source : [["UA23PT7", 12], ["MJ:HB", 0]],
			minlevel : 15,
			description : desc([
				"Once per turn, when I use a Maneuver, I can roll a d8 and use the number rolled instead",
				"of expending a use of Superiority Die.",
			]),
		},
	},
});

////// Add UA23PT7 Brawler Fighter subclass
AddSubClass("fighter_ua23pt7", "brawler_ua23pt7", {
	regExpSearch : /^(?=.*brawler).*$/i,
	subname : "Brawler",
	fullname : "Brawler",
	source : [["UA23PT7", 14], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Unarmed Expert",
			source : [["UA23PT7", 14], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"My Unarmed Strikes deal 1d6 damage, or 1d8 damage when I have both hands free.",
				"At Fighter Lvl 18, this damage increases to 1d8 dmg, or 1d10 dmg when both hands are free.",
			]),
			calcChanges : { //Ripped directly from Monk "ListsClasses.js" and then altered
				atkAdd : [
					function (fields, v) {
						if (classes.known.fighter_ua23pt7 && classes.known.fighter_ua23pt7.level && v.baseWeaponName == "unarmed strike") {
							var aBrawlerDie = function (n) { return n < 3 ? 1 : n < 18 ? 6 : 8; }(classes.known.fighter_ua23pt7.level);
							try {
								var curDie = eval_ish(fields.Damage_Die.replace('d', '*'));
							} catch (e) {
								var curDie = 'x';
							}
							if (isNaN(curDie) || curDie < aBrawlerDie) {
								fields.Damage_Die = '1d' + aBrawlerDie;
							}
							if (fields.Mod === 1 || fields.Mod === 2 || What(AbilityScores.abbreviations[fields.Mod - 1] + " Mod") < What(AbilityScores.abbreviations[v.StrDex - 1] + " Mod")) {
								fields.Mod = v.StrDex;
							}
							fields.Description += (fields.Description ? '; ' : '') + 'Versatile (d8 [Lvl 3])/(d10 [Lvl 18])';
						}
					},
					"My Unarmed Strikes deal 1d6 damage instead of 1, which increases to 1d8 if I have both hands free to make an Unarmed Strike with. At Fighter Lvl 18, the dmg increases to 1d8/1d10.",
					5
				],
			},
		},
		"subclassfeature3.1" : {
			name : "Improvised Expert",
			source : [["UA23PT7", 14], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"After a Long Rest, I add either the Light or Thrown weapon property to my one-handed Improvised Weapons",
				"  \u0026 and either the Reach or Thrown weapon property to my two-handed Improvised Weapons.",
				"Additionally, when I attack with my one-handed Improvised Weapons, I can add either the Sap, Slow,",
				"  or Vex Weapon Mastery property for that attack. Likewise, when I attack with my two-handed Improvised",
				"  Weapons, I can add either the Cleave, Push, or Topple Weapon Mastery property for that attack.",
				'Use the "Choose Feature" button above to choose which property to add to each kind of Improvised Weapon.',
			]),
			weaponProfs : [false, false, ["Improvised weapons"]],
			additional : ["", "", "2d10 + 3 damage", "2d10 + 4 damage", "2d10 + 5 damage", "2d10 + 6 damage", "2d10 + 7 damage", "2d10 + 8 damage", "2d10 + 9 damage", "2d10 + 10 dmg", "2d10 + 11 dmg", "2d10 + 12 dmg", "2d10 + 13 dmg", "2d10 + 14 dmg", "2d10 + 15 dmg", "2d10 + 16 dmg", "2d10 + 17 dmg", "2d10 + 18 dmg", "2d10 + 19 dmg", "2d10 + 20 dmg"],
			action : ["action", ""],
		},
		"subclassfeature7" : {
			name : "Grappling Expert",
			source : [["UA23PT7", 14], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc([
				"As a Bonus Action I can make one Unarmed Strike using the Grapple or Shove options.",
				"In addition, at the start of each of my turns, I can deal 1d6 Bldug. dmg to one creature",
				"  Grappled by me.",
			]),
			action : ["bonus action", "Unarmed Strike (Grapple/Shove)"],
		},
		"subclassfeature10" : {
			name : "Dirty Fighting",
			source : [["UA23PT7", 15], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"I have Adv. on attacks made with Improvised Weapons \u0026 Unarmed Strikes against",
				"  a creature Grappled by me.",
			]),
		},
		"subclassfeature15" : {
			name : "Improvised Specialist",
			source : [["UA23PT7", 15], ["MJ:HB", 0]],
			minlevel : 15,
			description : desc([
				"I add my Proficiency Bonus to damage with Improvised Weapons. I can also use two Mastery",
				"  properties from Improvised Expert, instead of one.",
			]),
			calcChanges : {
				atkCalc : [
					function (fields, v, output) {
						if (v.baseWeaponName == ("improvised weapon")) {
							output.extraDmg += What('Prof');
						}
						if( (/two-handed/i.test(fields.Description + v.WeaponName)) && (/improvised weapon/i.test(v.theWea.type) || (/improvised/i).test(v.WeaponName + v.baseWeaponName))) {
							output.die = 12;
						}
					},
					"My Improvised Weapons deal extra damage equal to my Proficiency Bonus & my Two-handed Improvised Weapons use a d12 damage die..",
					1
				],
			},
		},
	},
});
if (ClassSubList["fighter_ua23pt7-brawler_ua23pt7"]) {
	AddFeatureChoice(ClassSubList["fighter_ua23pt7-brawler_ua23pt7"].features["subclassfeature3.1"], true, "One-Handed 1: Light", {
		name : "One-Handed 1: Light",
		extraname : "Brawler Fighter 3",
		source : [["UA23PT7", 14], ["MJ:HB", 0]],
		description : "\n   " + "I have chosen to add the Light weapon property to my one-handed Improvised Weapons.",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if ((/improvised/i).test(v.WeaponName + v.baseWeaponName) && (/improvised weapon/i).test(v.theWea.type)) {
						fields.Description += (fields.Description ? '; ' : '') + 'Light';
						fields.Range = 'Melee';
					}
				},
				"I have chosen to add the Light weapon property to my one-handed Improvised Weapons."
			]
		},
	}, "Improvised Expert choices");
	AddFeatureChoice(ClassSubList["fighter_ua23pt7-brawler_ua23pt7"].features["subclassfeature3.1"], true, "One-Handed 1: Thrown", {
		name : "One-Handed 1: Thrown",
		extraname : "Brawler Fighter 3",
		source : [["UA23PT7", 14], ["MJ:HB", 0]],
		description : "\n   " + "I have chosen to add the Thrown weapon property to my one-handed Improvised Weapons, with a range of 20 ft/60 ft.",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if ((/improvised/i).test(v.WeaponName + v.baseWeaponName) && (/improvised weapon/i).test(v.theWea.type)) {
						fields.Description += (fields.Description ? '; ' : '') + 'Thrown';
						fields.Range = '20/60 ft';
					}
				},
				"I have chosen to add the Thrown weapon property to my one-handed Improvised Weapons, with a range of 20 ft/60 ft."
			]
		},
	}, "Improvised Expert choices");
	AddFeatureChoice(ClassSubList["fighter_ua23pt7-brawler_ua23pt7"].features["subclassfeature3.1"], true, "Two-Handed 1: Reach", {
		name : "Two-Handed 1: Reach",
		extraname : "Brawler Fighter 3",
		source : [["UA23PT7", 14], ["MJ:HB", 0]],
		description : "\n   " + "I have chosen to add the Reach weapon property to my two-handed Improvised Weapons.",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if( (/two-handed/i.test(fields.Description + v.WeaponName)) && (/improvised weapon/i.test(v.theWea.type) || (/improvised/i).test(v.WeaponName + v.baseWeaponName))) {
						fields.Description += (fields.Description ? '; ' : '') + 'Reach';
					}
				},
				"I have chosen to add the Reach weapon property to my two-handed Improvised Weapons."
			]
		},
	}, "Improvised Expert choices");
	AddFeatureChoice(ClassSubList["fighter_ua23pt7-brawler_ua23pt7"].features["subclassfeature3.1"], true, "Two-Handed 1: Thrown", {
		name : "Two-Handed 1: Thrown",
		extraname : "Brawler Fighter 3",
		source : [["UA23PT7", 14], ["MJ:HB", 0]],
		description : "\n   " + "I have chosen to add the Thrown weapon property to my two-handed Improvised Weapons, with a range of 10 ft/30 ft.",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if( (/two-handed/i.test(fields.Description + v.WeaponName)) && (/improvised weapon/i.test(v.theWea.type) || (/improvised/i).test(v.WeaponName + v.baseWeaponName))) {
						fields.Description += (fields.Description ? '; ' : '') + 'Thrown';
						fields.Range = '10/30 ft';
					}
				},
				"I have chosen to add the Thrown weapon property to my two-handed Improvised Weapons, with a range of 10 ft/30 ft."
			]
		},
	}, "Improvised Expert choices");
	AddFeatureChoice(ClassSubList["fighter_ua23pt7-brawler_ua23pt7"].features["subclassfeature3.1"], true, "One-Handed 2: Sap Mastery", {
		name : "One-Handed 2: Sap Mastery",
		extraname : "Brawler Fighter 3",
		source : [["UA23PT7", 14], ["MJ:HB", 0]],
		description : "\n   " + "I have chosen to add the Sap Mastery property to my one-handed Improvised Weapons.",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if ((/improvised/i).test(v.WeaponName + v.baseWeaponName) && (/improvised weapon/i).test(v.theWea.type)) {
						fields.Description += (fields.Description ? '; ' : '') + 'Mstry: Sap';
					}
				},
				"I have chosen to add the Sap Mastery property to my one-handed Improvised Weapons."
			]
		},
	}, "Improvised Expert choices");
	AddFeatureChoice(ClassSubList["fighter_ua23pt7-brawler_ua23pt7"].features["subclassfeature3.1"], true, "One-Handed 2: Slow Mastery", {
		name : "One-Handed 2: Slow Mastery",
		extraname : "Brawler Fighter 3",
		source : [["UA23PT7", 14], ["MJ:HB", 0]],
		description : "\n   " + "I have chosen to add the Slow Mastery property to my one-handed Improvised Weapons.",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if ((/improvised/i).test(v.WeaponName + v.baseWeaponName) && (/improvised weapon/i).test(v.theWea.type)) {
						fields.Description += (fields.Description ? '; ' : '') + 'Mstry: Slow';
					}
				},
				"I have chosen to add the Slow Mastery property to my one-handed Improvised Weapons."
			]
		},
	}, "Improvised Expert choices");
	AddFeatureChoice(ClassSubList["fighter_ua23pt7-brawler_ua23pt7"].features["subclassfeature3.1"], true, "One-Handed 2: Vex Mastery", {
		name : "One-Handed 2: Vex Mastery",
		extraname : "Brawler Fighter 3",
		source : [["UA23PT7", 14], ["MJ:HB", 0]],
		description : "\n   " + "I have chosen to add the Vex Mastery property to my one-handed Improvised Weapons.",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if ((/improvised/i).test(v.WeaponName + v.baseWeaponName) && (/improvised weapon/i).test(v.theWea.type)) {
						fields.Description += (fields.Description ? '; ' : '') + 'Mstry: Vex';
					}
				},
				"I have chosen to add the Vex Mastery property to my one-handed Improvised Weapons."
			]
		},
	}, "Improvised Expert choices");
	AddFeatureChoice(ClassSubList["fighter_ua23pt7-brawler_ua23pt7"].features["subclassfeature3.1"], true, "Two-Handed 2: Cleave Mastery", {
		name : "Two-Handed 2: Cleave Mastery",
		extraname : "Brawler Fighter 3",
		source : [["UA23PT7", 14], ["MJ:HB", 0]],
		description : "\n   " + "I have chosen to add the Cleave Mastery property to my two-handed Improvised Weapons.",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if( (/two-handed/i.test(fields.Description + v.WeaponName)) && (/improvised weapon/i.test(v.theWea.type) || (/improvised/i).test(v.WeaponName + v.baseWeaponName))) {
						fields.Description += (fields.Description ? '; ' : '') + 'Mstry: Cleave';
					}
				},
				"I have chosen to add the Cleave Mastery property to my two-handed Improvised Weapons."
			]
		},
	}, "Improvised Expert choices");
	AddFeatureChoice(ClassSubList["fighter_ua23pt7-brawler_ua23pt7"].features["subclassfeature3.1"], true, "Two-Handed 2: Push Mastery", {
		name : "Two-Handed 2: Push Mastery",
		extraname : "Brawler Fighter 3",
		source : [["UA23PT7", 14], ["MJ:HB", 0]],
		description : "\n   " + "I have chosen to add the Push Mastery property to my two-handed Improvised Weapons.",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if( (/two-handed/i.test(fields.Description + v.WeaponName)) && (/improvised weapon/i.test(v.theWea.type) || (/improvised/i).test(v.WeaponName + v.baseWeaponName))) {
						fields.Description += (fields.Description ? '; ' : '') + 'Mstry: Push';
					}
				},
				"I have chosen to add the Push Mastery property to my two-handed Improvised Weapons."
			]
		},
	}, "Improvised Expert choices");
	AddFeatureChoice(ClassSubList["fighter_ua23pt7-brawler_ua23pt7"].features["subclassfeature3.1"], true, "Two-Handed 2: Topple Mastery", {
		name : "Two-Handed 2: Topple Mastery",
		extraname : "Brawler Fighter 3",
		source : [["UA23PT7", 14], ["MJ:HB", 0]],
		description : "\n   " + "I have chosen to add the Topple Mastery property to my two-handed Improvised Weapons.",
		calcChanges : {
			atkAdd : [
				function (fields, v) {
					if( (/two-handed/i.test(fields.Description + v.WeaponName)) && (/improvised weapon/i.test(v.theWea.type) || (/improvised/i).test(v.WeaponName + v.baseWeaponName))) {
						fields.Description += (fields.Description ? '; ' : '') + 'Mstry: Topple';
					}
				},
				"I have chosen to add the Topple Mastery property to my two-handed Improvised Weapons."
			]
		},
	}, "Improvised Expert choices");
};

////// Add UA23PT7 Champion Fighter subclass
AddSubClass("fighter_ua23pt7", "champion_ua23pt7", {
	regExpSearch : /champion/i,
	subname : "Champion",
	fullname : "Champion",
	source : [["UA23PT7", 15], ["SRD", 25], ["P", 72], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : { //Ripped directly from "ListsClasses.js"
			name : "Improved Critical",
			source : [["SRD", 25], ["P", 72]],
			minlevel : 3,
			description : desc("I score a critical hit with my weapon attacks on a roll of 19 and 20."),
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (!v.isSpell && !v.CritChance && classes.known.fighter_ua23pt7 && classes.known.fighter_ua23pt7.level < 15) {
							fields.Description += (fields.Description ? '; ' : '') + 'Crit on 19-20';
							v.CritChance = 19;
						}
					},
					"My weapon attacks score a critical on a to hit roll of both 19 and 20.",
					19
				]
			}
		},
		"subclassfeature3.1" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Remarkable Athlete",
			source : [["UA23PT7", 15], ["SRD", 25], ["P", 72], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I have Adv. on Initiative rolls \u0026 Strength (Athletics) checks.",
				"When making running long jumps, I add my Strength modifier to the distance in feet.",
				"If using metric units, instead add Strength modifier * 0.3 to distance in meters.",
			]),
		},
		"subclassfeature7" : { //Though I list SRD & PHB sources for this, none of this code comes from the version of this in "ListsClasses.js"; It is actually copied from the Fighting Style feature above in the base class.
			name : "Additional Fighting Style",
			source : [["UA23PT7", 15], ["SRD", 25], ["P", 73], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc([
				"Choose another Fighting Style feat for the Fighter using the \"Choose Feature\" button above.",
				"The chosen option will appear in pg 3's Notes section & in the list of feats.",
			]),
		},
		"subclassfeature10" : {
			name : "Heroic Warrior",
			source : [["UA23PT7", 15], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"During combat, I can give myself Heroic Advantage (previously known as \"Inspiration\")",
				"  whenever I start my turn without it.",
			]),
		},
		"subclassfeature15" : { //Ripped directly from "ListsClasses.js"
			name : "Superior Critical",
			source : [["SRD", 25], ["P", 73]],
			minlevel : 15,
			description : desc("I score a critical hit with my weapon attacks on a roll of 18, 19, and 20."),
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.isSpell) return;
						if (v.CritChance && v.CritChance > 18) {
							fields.Description = fields.Description.replace('Crit on ' + CritChance + '-20', 'Crit on 18-20');
							v.CritChance = 18;
						} else if (!v.CritChance) {
							fields.Description += (fields.Description ? '; ' : '') + 'Crit on 18-20';
							v.CritChance = 18;
						}
					},
					"My weapon attacks also score a critical on a to hit roll of 18.",
					18
				]
			}
		},
		"subclassfeature18" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Survivor",
			source : [["UA23PT7", 15], ["SRD", 25], ["P", 73], ["MJ:HB", 0]],
			minlevel : 18,
			description : desc([
				"I have Adv. on death saving throws, and rolling 18-20 on such saves is equivalent to rolling a 20.",
				"At the start of my turn, if I'm not above half or at 0 HP, I regain 5 + Con mod HP.",
			]),
		},
	},
});

////// Add UA23PT6 Eldritch Knight Fighter subclass
AddSubClass("fighter_ua23pt7", "eldritch knight_ua23pt7", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /^(?!.*(exalted|sacred|holy|divine|nature|natural|purple.*dragon|green|arcane archer))(?=.*(knight|fighter|warrior|militant|warlord|gladiator|trooper))(?=.*\b(eldritch|arcane|magic|mage)\b).*$/i,
	subname : "Eldritch Knight",
	fullname : "Eldritch Knight",
	source : [["UA23PT7", 16], ["P", 75], ["MJ:HB", 0]],
	abilitySave : 4,
	spellcastingFactor : 3,
	spellcastingList : {
		"class" : ["wizard", "wizard_ua23pt7"],
		level : [0, 4],
	},
	spellcastingTable : [
		[0, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 0
		[0, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 1
		[0, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 2
		[2, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 3
		[3, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 4
		[3, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 5
		[3, 0, 0, 0, 0, 0, 0, 0, 0], //lvl 6
		[4, 2, 0, 0, 0, 0, 0, 0, 0], //lvl 7
		[4, 2, 0, 0, 0, 0, 0, 0, 0], //lvl 8
		[4, 2, 0, 0, 0, 0, 0, 0, 0], //lvl 9
		[4, 3, 0, 0, 0, 0, 0, 0, 0], //lvl10
		[4, 3, 0, 0, 0, 0, 0, 0, 0], //lvl11
		[4, 3, 0, 0, 0, 0, 0, 0, 0], //lvl12
		[4, 3, 2, 0, 0, 0, 0, 0, 0], //lvl13
		[4, 3, 2, 0, 0, 0, 0, 0, 0], //lvl14
		[4, 3, 2, 0, 0, 0, 0, 0, 0], //lvl15
		[4, 3, 3, 0, 0, 0, 0, 0, 0], //lvl16
		[4, 3, 3, 0, 0, 0, 0, 0, 0], //lvl17
		[4, 3, 3, 0, 0, 0, 0, 0, 0], //lvl18
		[4, 3, 3, 1, 0, 0, 0, 0, 0], //lvl19
		[4, 3, 3, 1, 0, 0, 0, 0, 0], //lvl20
	],
	spellcastingKnown : {
		cantrips : [0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
		spells : "list",
		prepared : true,
	},
	features : {
		"subclassfeature3" : {
			name : "Spellcasting",
			source : [["UA23PT7", 16], ["P", 75], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can cast known/prepared Wizard cantrips/spells, using Intelligence as my spellcasting ability.",
				"Two of the spells I prepare must be from the Abjuration or Evocation schools of magic.",
				"When I gain a Fighter Lvl, I can swap one known cantrip for another on the Wizard spell list.",
			]),
			additional : ["", "", "2 cantrips \u0026 3 spells prepared", "2 cantrips \u0026 4 spells prepared", "2 cantrips \u0026 4 spells prepared", "2 cantrips \u0026 4 spells prepared", "2 cantrips \u0026 5 spells prepared", "2 cantrips \u0026 6 spells prepared", "2 cantrips \u0026 6 spells prepared", "3 cantrips \u0026 7 spells prepared", "3 cantrips \u0026 8 spells prepared", "3 cantrips \u0026 8 spells prepared", "3 cantrips \u0026 9 spells prepared", "3 cantrips \u0026 10 spells prepared", "3 cantrips \u0026 10 spells prepared", "3 cantrips \u0026 11 spells prepared", "3 cantrips \u0026 11 spells prepared", "3 cantrips \u0026 11 spells prepared", "3 cantrips \u0026 12 spells prepared", "3 cantrips \u0026 13 spells prepared"],
		},
		"subclassfeature3.1" : {
			name : "War Bond",
			source : [["UA23PT7", 16], ["P", 75], ["MJ:HB", 0]],
			minlevel : 3,
			description : "\n   " + "I can bond with up to two weapons by spending a Short Rest (1 hr) with each." + "\n   " + "I can't be disarmed of a bonded weapon unless I am Incapacitated \u0026 I can summon one as a Bonus Action.",
			action : ["bonus action", ""],
		},
		"subclassfeature7" : {
			name : "War Magic",
			source : [["UA23PT7", 16], ["P", 75], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc([
				"When I take the Attack action on my turn, I can replace one of the attacks with one of my",
				"  Wizard cantrips that has a casting time of an action.",
			]),
		},
		"subclassfeature10" : {
			name : "Eldritch Strike",
			source : [["UA23PT7", 16], ["P", 75], ["MJ:HB", 0]],
			minlevel : 10,
			description : "\n   " + "A creature hit by my weapon attack has Disadv. on the save vs. the next spell I cast." + "\n   " + "This lasts until the end of my next turn.",
		},
		"subclassfeature15" : {
			name : "Arcane Charge",
			source : [["UA23PT7", 16], ["P", 75], ["MJ:HB", 0]],
			minlevel : 15,
			description : "\n   " + "When I use Action Surge, I can also teleport up to 30 ft to an empty space I can see." + "\n   " + "I can do so before or after the extra action.",
		},
		"subclassfeature18" : {
			name : "Improved War Magic",
			source : [["UA23PT7", 16], ["P", 75], ["MJ:HB", 0]],
			minlevel : 18,
			description : desc([
				"When I take the Attack action on my turn, I can replace two of the attacks with one of my",
				"  Wizard cantrips that has a casting time of an action, one cantrip per attack replaced.",
			]),
		},
	},
});

// Add UA23PT7 Sorcerer class
ClassList.sorcerer_ua23pt7 = {
	name : "Sorcerer (UA:PT-vii)",
	regExpSearch : /sorcerer/i,
	source : [["UA23PT7", 18], ["MJ:HB", 0]],
	primaryAbility : "Charisma",
	prerequisite : "Charisma 13+",
	prereqeval : function(v) {
		return What('Cha') >= 13;
	},
	die : 6,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
	saves : ["Con", "Cha"],
	skills : ["\n\n" + toUni("Sorcerer") + ": Choose two from Arcana, Deception, Insight, Intimidation, Persuasion, Religion", ""],
	weapons : [
		[true, false, [""]],
		[false, false, [""]],
	],
	equipment : "Sorcerer starting equipment:" +
		"\n \u2022 Arcane Focus (Crystal)," +
		"\n \u2022 Dagger (2)," +
		"\n \u2022 Dungeoneer's Pack," +
		"\n \u2022 Spear," +
		"\n \u2022 and 28 gp;" +
		"\n\nAlternatively, choose 50 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Sorcerous Origin", []],
	attacks : [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
	abilitySave : 6,
	spellcastingFactor : 1,
	spellcastingKnown : {
		cantrips : [4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6],
		spells : "list",
		prepared : true,
	},
	spellcastingList : {
		class : ["sorcerer", "sorcerer_ua23pt7"],
	},
	features : {
		"innate sorcery ua23pt7" : {
			name : "Innate Sorcery",
			source : [["UA23PT7", 19], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"As a Bonus Action, I gaining the following benefits for 1 min:",
				" \u2022 The spell save DC of my Sorcerer spells increase by 1.",
				" \u2022 I have Adv. on attack rolls of Sorcerer spells I cast.",
				"I can use this feature twice, regaining all expended uses after a Long Rest.",
			]),
			usages : 2,
			recovery : "long rest",
			action : [
				["bonus action", ""],
			],
		},
		"spellcasting ua23pt7" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Spellcasting",
			source : [["UA23PT7", 20], ["SRD", 43], ["P", 101], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can cast Sorcerer cantrips/spells that I know/prepare, using Charisma as my spellcasting ability.",
				"I can use an arcane focus as a spellcasting focus for my sorcerer spells."
			]),
			additional : levels.map(function (n, idx) {
				var cantr = [4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6][idx];
				var splls = [2, 4, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22][idx];
				return cantr + " cantrips \u0026 " + splls + " spells prepared";
			}),
		},
		"font of magic ua23pt7" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Font of Magic",
			source : [["UA23PT7", 20], ["SRD", 43], ["P", 101], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"As a Bonus Action, I can use Sorcery Points to create spell slots and vice versa.",
				"I can convert spell slots to Sorcery Points at a rate of 1 point per spell slot level.",
				"I can convert Sorcery Points to spell slots, which last until I finish a Long Rest, as follows:",
				"Level 1 for 2 Sorcery Points;   level 2 for 3 Sorcery Points;   level 3 for 5 Sorcery Points;",
				"Level 4 for 6 Sorcery Points;   level 5 for 7 Sorcery Points",
			]),
			usages : [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
			recovery : "long rest",
			action : ["bonus action", "Font of Magic"],
			additional : "Sorcery Points",
			limfeaname : "Sorcery Points",
		},
		"subclassfeature3" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Sorcerous Origin",
			source : [["UA23PT7", 21], ["SRD", 43], ["P", 101], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc('Choose the Sorcerous Origin for your innate powers and put it in the "Class" field ')
		},
		"metamagic ua23pt7" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Metamagic",
			source : [["UA23PT7", 21], ["SRD", 44], ["P", 101], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				'Use the "Choose Feature" button above to add a Metamagic option to the third page.',
				"I can use only 1 Metamagic option on a spell unless otherwise written."
			]),
			additional : levels.map(function (n) {
				return n < 3 ? "" : (n < 10 ? 2 : n < 17 ? 4 : 6) + " known";
			}),
			extraname : "Metamagic Option",
			extrachoices : ["Careful Spell", "Distant Spell", "Empowered Spell", "Extended Spell", "Heightened Spell", "Quickened Spell", "Seeking Spell", "Subtle Spell", "Transmuted Spell", "Twinned Spell"],
			extraTimes : levels.map(function (n) {
				return n < 3 ? 0 : n < 10 ? 2 : n < 17 ? 4 : 6;
			}),
			"careful spell" : {
				name : "Careful Spell",
				source : [["UA23PT7", 21], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
				description : " [1 Sorcery Point]" + desc([
					"If the spell allows a saving throw, I can protect Cha modifier number of creatures.",
					"The selected creatures automatically succeed on their saving throws vs. the spell.",
					"The selected creatures take no damage if they would normally take half damage on a successful save.",
				]),
			},
			"distant spell" : {
				name : "Distant Spell",
				source : [["UA23PT7", 21], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
				description : " [1 Sorcery Point]" + desc("I double the range of the spell or make the range 30 ft if the range was touch."),
			},
			"empowered spell" : {
				name : "Empowered Spell",
				source : [["UA23PT7", 21], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
				description : " [1 Sorcery Point]" + desc([
					"If the spell uses damage dice, I can reroll my Charisma modifier number of damage dice.",
					"I can Empower a spell even if I use another Metamagic option on it.",
				]),
			},
			"extended spell" : {
				name : "Extended Spell",
				source : [["UA23PT7", 22], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
				description : " [1 Sorcery Point]" + desc([
					"If the spell has a duration of at least 1 min, I can double it, up to 24 hours.",
					"If the spell requires Concentration, I have Adv. on Concentration checks.",
				]),
			},
			"heightened spell" : {
				name : "Heightened Spell",
				source : [["UA23PT7", 22], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
				description : " [2 Sorcery Points]" + desc("If the spell allows a saving throw, I can have one target get Disadv. on their saves."),
			},
			"quickened spell" : {
				name : "Quickened Spell",
				source : [["UA23PT7", 22], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
				description : " [2 Sorcery Points]" + desc([
					"If the spell has a casting time of 1 action, I can cast it as a Bonus Action.",
					"I can't do this if I've already cast a spell of lvl 1 or higher, nor can I cast",
					"  a spell of lvl 1 or higher after modifying a spell in this manner.",
				]),
				action : ["bonus action", ""],
			},
			"seeking spell" : { //Ripped directly from "all_WotC_pub+UA.js" and then altered
				name : "Seeking Spell",
				source : [["UA23PT7", 22], ["T", 66], ["MJ:HB", 0]],
				description : " [1 Sorcery Point]" + desc([
					"If I miss an attack roll for a spell, I can reroll the d20 and must use the new roll",
					"I can do this even if I already used another Metamagic option during the casting of the spell",
				]),
			},
			"subtle spell" : {
				name : "Subtle Spell",
				source : [["UA23PT7", 22], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
				description : " [1 Sorcery Point]" + desc([
					"I can cast the spell without the need to use Somatic, Verbal, or Material components,",
					"  except Material components that are consumed by the spell or that have a specified cost.",
				]),
			},
			"transmuted spell" : { //Ripped directly from "all_WotC_pub+UA.js" and then altered
				name : "Transmuted Spell",
				source : [["UA23PT7", 22], ["T", 66], ["MJ:HB", 0]],
				description : " [1 Sorcery Point]" + desc([
					"If the spell deals one of the below damage types, I can change it to another on the list",
					"These damage types are: Acid, Cold, Fire, Lightning, Poison, or Thunder",
				]),
			},
			"twinned spell" : {
				name : "Twinned Spell",
				source : [["UA23PT7", 22], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
				description : " [1 Sorcery Point]" + desc([
					"If the spell can target an additional creature by upcasting it, I can increase the",
					"  spell's effective level by 1.",
				]),
			},
		},
		"sorcerous restoration ua23pt7" : {
			name : "Sorcerous Restoration",
			source : [["UA23PT7", 22], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
			minlevel : 5,
			description : desc([
				"If I roll Initiative or finish a Short Rest with 0 remaining Sorcery Points, I regain a number",
				"  of Sorcery Points equal to my Sorcerer Lvl divided by 5 (round down).",
			]),
		},
		"sorcery incarnate ua23pt7" : {
			name : "Sorcery Incarnate",
			source : [["UA23PT7", 22], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc([
				"While my Innate Sorcery feature is active, I can use up to two of my Metamagic options on each",
				"  spell I cast. Additionally, If I have no more available uses of Innate Sorcery, I can expend",
				"  2 Sorcery Points instead to activate Innate Sorcery.",
			]),
		},
		"arcane apotheosis ua23pt7" : {
			name : "Arcane Aposteosis",
			source : [["UA23PT7", 22], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"While my Innate Sorcery feature is active, I can use one Metamagic option on each of my turns without",
				"  expending Sorcery Points on it.",
			]),
		},
	},
};

//// Add Sorcerer optional choices; Ripped directly from "all_WotC_pub+UA.js" and then altered
AddFeatureChoice(ClassList.sorcerer_ua23pt7.features["spellcasting ua23pt7"], true, "Access to Dunamancy Spells", {
	name : "Dunamancy Spells",
	extraname : "Optional Sorcerer 1",
	source : [["W", 186]],
	description : desc([
		"All dunamancy spells are added to the sorcerer spell list, each still pending DM's approval"
	]),
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "sorcerer_ua23pt7" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["sapping sting", "gift of alacrity", "magnify gravity", "fortune's favor", "immovable object", "wristpocket", "pulse wave", "gravity sinkhole", "temporal shunt", "gravity fissure", "tether essence", "dark star", "reality break", "ravenous void", "time ravage"]);
			},
			"This optional class feature expands the spell list of the sorcerer class with all dunamancy spells (spell level in brackets): Sapping Sting (cantrip), Gift of Alacrity (1), Magnify Gravity (1), Fortune's Favor (2), Immovable Object (2), Wristpocket (2), Pulse Wave (3), Gravity Sinkhole (4), Temporal Shunt (5), Gravity Fissure (6), Tether Essence (7), Dark Star (8), Reality Break (8),Ravenous Void (9), and Time Ravage (9)."
		]
	}
}, "Optional sorcerer features");
AddFeatureChoice(ClassList.sorcerer_ua23pt7.features["spellcasting ua23pt7"], true, "Additional Sorcerer Spells", {
	name : "Additional Sorcerer Spells",
	extraname : "Optional Sorcerer 1",
	source : [["T", 65]],
	description : "",
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "sorcerer_ua23pt7" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["grease", "flame blade", "flaming sphere", "magic weapon", "vampiric touch", "fire shield", "bigby's hand", "flesh to stone", "otiluke's freezing sphere", "demiplane"]);
			},
			"This optional class feature expands the spell list of the sorcerer class with the following spells (spell level in brackets): Grease (1), Flame Blade (2), Flaming Sphere (2), Magic Weapon (2), Vampiric Touch (3), Fire Shield (4), Bigby's Hand (5), Flesh to Stone (6), Otiluke's Freezing Sphere (6), and Demiplane (8)."
		]
	}
}, "Optional sorcerer features");
AddFeatureChoice(ClassList.sorcerer_ua23pt7.features["spellcasting ua23pt7"], true, "Sorcerous Versatility (prereq: level 4 sorcerer)", {
	name : "Sorcerous Versatility",
	extraname : "Optional Sorcerer 4",
	source : [["T", 66]],
	description : " [ASI = Ability Score Improvement]" + desc([
		"Whenever I gain an ASI from the sorcerer class, I can change a cantrip or Metamagic choice",
		"I can select either another cantrip from the sorcerer spell list or another Metamagic option"
	]),
	prereqeval : function (v) { return classes.known.sorcerer_ua23pt7.level >= 4 ? true : "skip"; }
}, "Optional sorcerer features");
AddFeatureChoice(ClassList.sorcerer_ua23pt7.features["spellcasting ua23pt7"], true, "Magical Guidance (prereq: level 5 sorcerer)", {
	name : "Magical Guidance",
	extraname : "Optional Sorcerer 5",
	source : [["T", 66]],
	description : " [1 Sorcery Point]\n   When I make an ability check that fails, I can reroll the d20 and must use the new roll",
	prereqeval : function (v) { return classes.known.sorcerer_ua23pt7.level >= 5 ? true : "skip"; }
}, "Optional sorcerer features");
AddFeatureChoice(ClassList.sorcerer_ua23pt7.features["font of magic ua23pt7"], true, "Imbuing Touch (UA:CFV)", {
	name : "Imbuing Touch",
	extraname : "Optional Sorcerer 2",
	source : [["UA:CFV", 10]],
	description : " [2 Sorcery Points]\n   As an action, I can touch a nonmagical weapon and make it count as magical for 1 minute",
	action : [["action", " (2 Sorcery Points)"]]
}, "Optional 2nd-level sorcerer features");
AddFeatureChoice(ClassList.sorcerer_ua23pt7.features["font of magic ua23pt7"], true, "Sorcerous Fortitude (UA:CFV)", {
	name : "Sorcerous Fortitude",
	extraname : "Optional Sorcerer 2",
	source : [["UA:CFV", 10]],
	description : " [1+ Sorcery Points]\n   As an action, I can gain 1d4 temporary hit points per Sorcery Point I spend",
	action : [["action", " (1+ Sorcery Points)"]]
}, "Optional 2nd-level sorcerer features");

////// Add UA23PT7 Draconic Sorcerer subclass
AddSubClass("sorcerer_ua23pt7", "draconic bloodline", {
	regExpSearch : /^(?=.*(sorcerer))(?=.*(draconic|dragon)).*$/i,
	subname : "Draconic Bloodline",
	source : [["UA23PT7", 22], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Draconic Resilience",
			source : [["UA23PT7", 22], ["SRD", 45], ["P", 102], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"When I am not wearing armor, my AC is 10 + Dexterity modifier + Charisma modifier.",
				"My hit point maximum increases by 3 + an amount equal to my Sorcerer level."
			]),
			calcChanges : {
				hp : function (totalHD) {
					if (classes.known.sorcerer_ua23pt7) {
						return [3 + classes.known.sorcerer_ua23pt7.level, "Draconic Resilience (sorcerer level)"];
					}
				}
			},
			armorOptions : [{
				regExpSearch : /^(?=.*(dragon|draconic))(?=.*(hide|skin|scales|resilience)).*$/i,
				name : "Draconic Resilience",
				source : [["UA23PT7", 22], ["SRD", 45], ["P", 102], ["MJ:HB", 0]],
				ac : "10+Cha",
				affectsWildShape : true
			}],
			armorAdd : "Draconic Resilience"
		},
		"subclassfeature3.1" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Dragon Ancestor / Dragon Speech",
			source : [["UA23PT7", 23], ["SRD", 44], ["P", 102], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				'Choose a Dragon Ancestor using the "Choose Feature" button above.',
				"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
			]),
			choices : ["Black Dragon Ancestor", "Blue Dragon Ancestor", "Brass Dragon Ancestor", "Bronze Dragon Ancestor", "Copper Dragon Ancestor", "Gold Dragon Ancestor", "Green Dragon Ancestor", "Red Dragon Ancestor", "Silver Dragon Ancestor", "White Dragon Ancestor"],
			"black dragon ancestor" : {
				name : "Black Dragon Ancestor",
				description : desc([
					"I have draconic ancestry with black dragons, which are affiliated with acid damage.",
					"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
				]),
				dependentChoices : "acid"
			},
			"blue dragon ancestor" : {
				name : "Blue Dragon Ancestor",
				description : desc([
					"I have draconic ancestry with blue dragons, which are affiliated with lightning damage.",
					"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
				]),
				dependentChoices : "lightning"
			},
			"brass dragon ancestor" : {
				name : "Brass Dragon Ancestor",
				description : desc([
					"I have draconic ancestry with brass dragons, which are affiliated with fire damage.",
					"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
				]),
				dependentChoices : "fire"
			},
			"bronze dragon ancestor" : {
				name : "Bronze Dragon Ancestor",
				description : desc([
					"I have draconic ancestry with bronze dragons, which are affiliated with lightning dmg.",
					"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
				]),
				dependentChoices : "lightning"
			},
			"copper dragon ancestor" : {
				name : "Copper Dragon Ancestor",
				description : desc([
					"I have draconic ancestry with copper dragons, which are affiliated with acid damage.",
					"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
				]),
				dependentChoices : "acid"
			},
			"gold dragon ancestor" : {
				name : "Gold Dragon Ancestor",
				description : desc([
					"I have draconic ancestry with gold dragons, which are affiliated with fire damage.",
					"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
				]),
				dependentChoices : "fire"
			},
			"green dragon ancestor" : {
				name : "Green Dragon Ancestor",
				description : desc([
					"I have draconic ancestry with green dragons, which are affiliated with poison damage.",
					"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
				]),
				dependentChoices : "poison"
			},
			"red dragon ancestor" : {
				name : "Red Dragon Ancestor",
				description : desc([
					"I have draconic ancestry with red dragons, which are affiliated with fire damage.",
					"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
				]),
				dependentChoices : "fire"
			},
			"silver dragon ancestor" : {
				name : "Silver Dragon Ancestor",
				description : desc([
					"I have draconic ancestry with silver dragons, which are affiliated with cold damage.",
					"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
				]),
				dependentChoices : "cold"
			},
			"white dragon ancestor" : {
				name : "White Dragon Ancestor",
				description : desc([
					"I have draconic ancestry with white dragons, which are affiliated with cold damage.",
					"I can speak, read, \u0026 write Draconic, and can be understood by all creatures of the Dragon type.",
				]),
				dependentChoices : "cold"
			},
			languageProfs : ["Draconic"],
			choiceDependencies : [{
				feature : "subclassfeature6",
				choiceAttribute : true
			}],
		},
		"subclassfeature6" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Elemental Affinity",
			source : [["UA23PT7", 23], ["SRD", 45], ["P", 102], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				'Choose a Dragon Ancestor using the "Choose Feature" button above.',
				"I add Cha mod for spell damage if matching my dragon ancestor's affiliated type.",
				"I also gain permanent Resistance to my dragon ancestor's affiliated type."
			]),
			choices : ["acid", "cold", "fire", "lightning", "poison"],
			choicesNotInMenu : true,
			"acid" : {
				name : "Acid Elemental Affinity",
				description : desc([
					"I add my Charisma modifier to one damage roll of a spell if it does acid damage.",
					"I also gain permanent Acid Resistance.",
				]),
				dmgres : ["Acid"],
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							if (classes.known.sorcerer_ua23pt7 && classes.known.sorcerer_ua23pt7.level > 5 && v.isSpell && (/acid/i).test(fields.Damage_Type)) {
								output.extraDmg += What('Cha Mod');
							}
						},
						"Cantrips and spells that deal acid damage get my Charisma modifier added to their damage."
					],
					spellAdd : [
						function (spellKey, spellObj, spName) {
							if (!spellObj.psionic) return genericSpellDmgEdit(spellKey, spellObj, "acid", "Cha", true);
						},
						"Cantrips and spells that deal acid damage get my Charisma modifier added to their damage."
					]
				}
			},
			"cold" : {
				name : "Cold Elemental Affinity",
				description : desc([
					"I add my Charisma modifier to one damage roll of a spell if it does cold damage",
					"I also gain permanent Cold Resistance.",
				]),
				dmgres : ["Cold"],
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							if (classes.known.sorcerer_ua23pt7 && classes.known.sorcerer_ua23pt7.level > 5 && v.isSpell && (/cold/i).test(fields.Damage_Type)) {
								output.extraDmg += What('Cha Mod');
							}
						},
						"Cantrips and spells that deal cold damage get my Charisma modifier added to their damage."
					],
					spellAdd : [
						function (spellKey, spellObj, spName) {
							if (!spellObj.psionic) return genericSpellDmgEdit(spellKey, spellObj, "cold", "Cha", true);
						},
						"Cantrips and spells that deal cold damage get my Charisma modifier added to their damage."
					]
				}
			},
			"fire" : {
				name : "Fire Elemental Affinity",
				description : desc([
					"I add my Charisma modifier to one damage roll of a spell if it does fire damage",
					"I also gain permanent Fire Resistance.",
				]),
				dmgres : ["Fire"],
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							if (classes.known.sorcerer_ua23pt7 && classes.known.sorcerer_ua23pt7.level > 5 && v.isSpell && (/fire/i).test(fields.Damage_Type)) {
								output.extraDmg += What('Cha Mod');
							}
						},
						"Cantrips and spells that deal fire damage get my Charisma modifier added to their damage."
					],
					spellAdd : [
						function (spellKey, spellObj, spName) {
							if (!spellObj.psionic) return genericSpellDmgEdit(spellKey, spellObj, "fire", "Cha", true);
						},
						"Cantrips and spells that deal fire damage get my Charisma modifier added to their damage."
					]
				}
			},
			"lightning" : {
				name : "Lightning Elemental Affinity",
				description : desc([
					"I add my Charisma modifier to one damage roll of a spell if it does lightning damage",
					"I also gain permanent Fire Resistance.",
				]),
				dmgres : ["Lightning"],
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							if (classes.known.sorcerer_ua23pt7 && classes.known.sorcerer_ua23pt7.level > 5 && v.isSpell && (/lightning/i).test(fields.Damage_Type)) {
								output.extraDmg += What('Cha Mod');
							}
						},
						"Cantrips and spells that deal lightning damage get my Charisma modifier added to their damage."
					],
					spellAdd : [
						function (spellKey, spellObj, spName) {
							if (!spellObj.psionic) return genericSpellDmgEdit(spellKey, spellObj, "lightn\\.?|lightning", "Cha", true);
						},
						"Cantrips and spells that deal lightning damage get my Charisma modifier added to their damage."
					]
				}
			},
			"poison" : {
				name : "Poison Elemental Affinity",
				description : desc([
					"I add my Charisma modifier to one damage roll of a spell if it does poison damage",
					"I also gain permanent Poison Resistance.",
				]),
				dmgres : ["Poison"],
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							if (classes.known.sorcerer_ua23pt7 && classes.known.sorcerer_ua23pt7.level > 5 && v.isSpell && (/poison/i).test(fields.Damage_Type)) {
								output.extraDmg += What('Cha Mod');
							}
						},
						"Cantrips and spells that deal poison damage get my Charisma modifier added to their damage."
					],
					spellAdd : [
						function (spellKey, spellObj, spName) {
							if (!spellObj.psionic) return genericSpellDmgEdit(spellKey, spellObj, "poison", "Cha", true);
						},
						"Cantrips and spells that deal poison damage get my Charisma modifier added to their damage."
					]
				}
			},
		},
		"subclassfeature14" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Dragon Wings",
			source : [["UA23PT7", 23], ["SRD", 45], ["P", 103], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"As a Bonus Action, I can sprout dragon wings from my back, gaining a Fly Speed equal to my",
				"  current Speed until I dismiss the wings as a Bonus Action or I become Incapacitated.",
				"When the wings manifest, I can decide if they are spectral or physical. If they are physical,",
				"  I must not be wearing somthing that obstructs them, like armor.",
			]),
			action : ["bonus action", " (start/stop)"],
			speed : { fly : { spd : "walk", enc : "walk" } }
		},
		"subclassfeature18" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Draconic Presence",
			source : [["UA23PT7", 23], ["SRD", 45], ["P", 103], ["MJ:HB", 0]],
			minlevel : 18,
			description : desc([
				"As a Bonus Action, I create 60-ft radius aura of awe/fear for up to 1 minute.",
				"All hostiles in this aura must make a Wis save or be Charmed (awe) or Frightened (fear).",
				"Once a creature fails, it has the condition until it leaves the area of the aura.",
			]),
			additional : "5 Sorcery Points",
			action : ["bonus action", ""]
		},
	},
});

////// Add UA23PT7 Wild Magic Sorcerer subclass
AddSubClass("sorcerer_ua23pt7", "wild magic", {
	regExpSearch : /^(?=.*(mage|magus|sorcerer))(?=.*(wild|chaos|chaotic)).*$/i,
	subname : "Wild Magic",
	fullname : "Wild Mage",
	source : [["UA23PT7", 23], ["P", 103], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : { //Ripped directly from "all_WotC_pub+UA.js" and then altered
			name : "Wild Magic Surge",
			source : [["UA23PT7", 23], ["P", 103], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"When I cast a spell with a spell slot, I can roll a d20, but no more than once per turn.",
				"If the result is a 20, I roll on the Wild Magic Surge table found on the \"Notes\" page.",
				"Metamagic can't affect spells cast because of the surge, but they require no concentration.",
			]),
			toNotesPage : [{
				name : "Wild Magic Surge Table",
				source : [["P", 104]],
				popupName : "Wild Mage's Wild Magic Surge Table, part 1",
				additional : "results 01-50",
				note : [
					"My spellcasting can unleash surges of untamed magic. Immediately after I cast a sorcerer spell of 1st level or higher, the DM can have me roll a d20. If I roll a 1, a Wild Magic Surge happens. Roll on the table below to create a random magical effect. A surge can happen only once per turn.",
					"If a Wild Magic effect is a spell, it's too wild to be affected by Metamagic. If it normally requires concentration, it doesn't require concentration in this case; the spell lasts for its full duration.",
					"d100  Effect",
					"01-02 Roll on this table at the start of each of your turns for the next minute, ignoring this result on subsequent rolls.",
					"03-04 For the next minute, you can see any invisible creature if you have line of sight to it.",
					"05-06 A modron chosen and controlled by the DM appears in an unoccupied space within 5 ft of you, then disappears 1 minute later.",
					"07-08 You cast fireball as a 3rd-level spell centered on yourself.",
					"09-10 You cast magic missile as a 5th-level spell.",
					"11-12 Roll a d10. Your height changes by a number of inches equal to the roll. If the roll is odd, you shrink. If the roll is even, you grow.",
					"13-14 You cast confusion centered on yourself.",
					"15-16 For the next minute, you regain 5 hit points at the start of each of your turns.",
					"17-18 You grow a long beard made of feathers that remains until you sneeze, at which point the feathers explode out from your face.",
					"19-20 You cast grease centered on yourself.",
					"21-22 Creatures have disadvantage on saving throws against the next spell you cast in the next minute that involves a saving throw.",
					"23-24 Your skin turns a vibrant shade of blue. A remove curse spell can end this effect.",
					"25-26 An eye appears on your forehead for the next minute.",
					"27-28 For the next minute, all your spells with a casting time feet of 1 action have a casting time of 1 bonus action.",
					"29-30 You teleport up to 60 ft to an unoccupied space of your choice that you can see.",
					"31-32 You are transported to the Astral Plane until the end of your next turn, after which time you return to the space you previously occupied or the nearest unoccupied space if that space is occupied.",
					"33-34 Maximize the damage of the next damaging spell you cast within the next minute.",
					"35-36 Roll a d10. Your age changes by a number of years equal to the roll. If the roll is odd, you get younger (minimum 1 year old). If the roll is even, you get older.",
					"37-38 1d6 flumphs controlled by the DM appear in unoccupied spaces within 60 ft of you and are frightened of you. They vanish after 1 minute.",
					"39-40 You regain 2d10 hit points.",
					"41-42 You turn into a potted plant until the start of your next turn. While a plant, you are incapacitated and have vulnerability to all damage. If you drop to 0 hit points, your pot breaks, and your form reverts.",
					"43-44 For the next minute, you can teleport up to 20 ft as a bonus action on each of your turns.",
					"45-46 You cast levitate on yourself.",
					"47-48 A unicorn controlled by the DM appears in a space within 5 ft of you, then disappears 1 minute later.",
					"49-50 You can't speak for the next minute. Whenever you try, pink bubbles float out of your mouth."
				]
			}, {
				name : "Wild Magic Surge Table",
				source : [["P", 104]],
				popupName : "Wild Mage's Wild Magic Surge Table, part 2",
				additional : "results 51-100",
				note : [
					"d100  Effect",
					"51-52 A spectral shield hovers near you for the next minute, granting you a +2 bonus to AC and immunity to magic missile.",
					"53-54 You are immune to being intoxicated by alcohol for the next 5d6 days.",
					"55-56 Your hair falls out but grows back within 24 hours.",
					"57-58 For the next minute, any flammable object you touch that isn't being worn or carried by another creature bursts into flame.",
					"59-60 You regain your lowest-level expended spell slot.",
					"61-62 For the next minute, you must shout when you speak.",
					"63-64 You cast fog cloud centered on yourself.",
					"65-66 Up to three creatures you choose within 30 ft of you take 4d10 lightning damage.",
					"67-68 You are frightened by the nearest creature until the end of your next turn.",
					"69-70 Each creature within 30 ft of you becomes invisible for the next minute. The invisibility ends on a creature when it attacks or casts a spell.",
					"71-72 You gain resistance to all damage for the next minute.",
					"73-74 A random creature within 60 ft of you becomes poisoned for 1d4 hours.",
					"75-76 You glow with bright light in a 30-ft radius for the next minute. Any creature that ends its turn within 5 ft of you is blinded until the end of its next turn.",
					"79-80 Illusory butterflies and flower petals flutter in the air within 10 ft of you for the next minute.",
					"77-78 You cast polymorph on yourself. If you fail the saving throw, you turn into a sheep for the spell's duration.",
					"81-82 You can take one additional action immediately.",
					"83-84 Each creature within 30 ft of you takes 1d10 necrotic damage. You regain hit points equal to the sum of the necrotic damage dealt.",
					"85-86 You cast mirror image.",
					"87-88 You cast fly on a random creature within 60 ft of you.",
					"89-90 You become invisible for the next minute. During that time, other creatures can't hear you. The invisibility ends if you attack or cast a spell.",
					"91-92 If you die within the next minute, you immediately come back to life as if by the reincarnate spell.",
					"93-94 Your size increases by one size category for the next minute.",
					"95-96 You and all creatures within 30 ft of you gain vulnerability to piercing damage for the next minute.",
					"97-98 You are surrounded by faint, ethereal music for the next minute.",
					"99-100 You regain all expended Sorcery Points."
				]
			}],
		},
		"subclassfeature3.1" : { //Ripped directly from "all_WotC_pub+UA.js" and then altered
			name : "Tides of Chaos",
			source : [["UA23PT7", 23], ["P", 103], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"Once per Long Rest, I can gain Advantage on one d20 Test.",
				"If I cast a Sorcerer spell with a spell slot before I regain the use of this feature,",
				"  I immediately roll on the Wild Magic Surge table \u0026 regain my use of this feature.",
			]),
			recovery : "long rest",
			usages : 1,
		},
		"subclassfeature6" : { //Ripped directly from "all_WotC_pub+UA.js" and then altered
			name : "Bend Luck",
			source : [["UA23PT7", 23], ["P", 103], ["MJ:HB", 0]],
			minlevel : 6,
			description : "\n   " + "As a Reaction, I can add/subtract 1d4 from a d20 Test made by another creature I can see.",
			action : ["reaction", " (1 Sorcery Point)"],
			additional : "1 Sorcery Point"
		},
		"subclassfeature14" : { //Ripped directly from "all_WotC_pub+UA.js"
			name : "Controlled Chaos",
			source : [["UA23PT7", 23], ["P", 103]],
			minlevel : 14,
			description : "\n   " + "Whenever I roll on the Wild Magic Surge table, I can roll twice and use either result."
		},
		"subclassfeature18" : { //Ripped directly from "all_WotC_pub+UA.js" and then heavily altered
			name : "Spell Bombardment",
			source : [["UA23PT7", 23], ["P", 103], ["MJ:HB", 0]],
			minlevel : 18,
			description : desc([
				"Immediately after I cast a Sorcerer spell with a spell slot, I can create an effect that casts a",
				"  spell of my choice from the Wild Magic Surge table, regaining all expended Sorcery Points.",
				"Upon using this feature, I can't do so again until I finish 1d4 Long Rests.",
			]),
			recovery : "1d4 long rest",
			usages : 1,
		},
	},
});

// Add UA23PT7 Warlock class
ClassList.warlock_ua23pt7 = {
	name : "Warlock (UA:PT-vii)",
	regExpSearch : /warlock/i,
	source : [["UA23PT7", 25], ["MJ:HB", 0]],
	primaryAbility : "Charisma",
	prerequisite : "Charisma 13+",
	prereqeval : function(v) {
		return What('Cha') >= 13;
	},
	die : 8,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
	saves : ["Wis", "Cha"],
	skills : ["\n\n" + toUni("Warlock") + ": Choose two from Arcana, Deception, History, Intimidation, Investigation, Nature, Religion", ""],
	armor : [
		[true, false, false, false],
		[true, false, false, false],
	],
	weapons : [
		[true, false, [""]],
		[true, false, [""]],
	],
	equipment : "Warlock starting equipment:" +
		"\n \u2022 Arcane Focus (Orb)," +
		"\n \u2022 Book (Occult Lore)," +
		"\n \u2022 Dagger (2)," +
		"\n \u2022 Leather Armor," +
		"\n \u2022 Scholar’s Pack," +
		"\n \u2022 Sickle," +
		"\n \u2022 and 15 gp;" +
		"\n\nAlternatively, choose 100 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Otherworldly Patron", []],
	attacks : [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
	abilitySave : 6,
	spellcastingFactor : "warlock1",
	spellcastingKnown : {
		cantrips : [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
		spells : "list",
		prepared : true
	},
	spellcastingList : {
		class : ["warlock", "warlock_ua23pt7"],
		level : [0, 5], //lower and higher limit
	},
	features : {
		"eldritch invocations ua23pt7" : { //Ripped directly from "ListsClasses.js" & "all_WotC_pub+UA.js" and then altered; "Book of Ancient Secrets" functions were bundled into "Pact of the Tome" in the UA, so it has been removed from this list;
			name : "Eldritch Invocations",
			source : [["UA23PT7", 26], ["SRD", 47], ["P", 107], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				'Use the "Choose Feature" button above to add Eldritch Invocations to the third page',
				"Whenever I gain a warlock level, I can replace an invocation I know with another"
			]),
			additional : levels.map(function (n) {
				return (n < 2 ? 1 : n < 5 ? 3 : n < 7 ? 5 : n < 9 ? 6 : n < 12 ? 7 : n < 15 ? 8 : n < 18 ? 9 : 10) + " invocations known";
			}),
			extraname : "Eldritch Invocation",
			extrachoices : ["Agonizing Blast (prereq: Warlock cantrip)", "Arcane Gunslinger (prereq: Pact of the Blade)", "Armor of Shadows", "Ascendant Step (prereq: level 5 warlock)", "Aspect of the Moon (prereq: Pact of the Tome)", "Beast Speech", "Beguiling Influence", "Bewitching Whispers (prereq: level 7 warlock)", "Bond of the Talisman (prereq: level 12 warlock, Pact of the Talisman)", "Burning Hex (prereq: the Hexblade patron)", "Caiphon's Beacon (prereq: the Great Old One patron)", "Chains of Carceri (prereq: level 15 warlock, Pact of the Chain)", "Chilling Hex (prereq: the Hexblade patron)", "Chronicle of the Raven Queen (prereq: the Raven Queen patron, Pact of the Tome)", "Claw of Acamar (prereq: the Great Old One patron, Pact of the Blade)", "Cloak of Flies (prereq: level 5 warlock)", "Curse Bringer (prereq: the Hexblade patron, Pact of the Blade)", "Devil's Sight", "Dreadful Word (prereq: level 7 warlock)", "Eldritch Armor (prereq: Pact of the Blade)", "Eldritch Mind", "Eldritch Sight", "Eldritch Smite (prereq: level 5 warlock, Pact of the Blade)", "Eldritch Spear (prereq: Eldritch Blast cantrip)", "Eyes of the Rune Keeper", "Far Scribe (prereq: level 5 warlock, Pact of the Tome)", "Fiendish Vigor", "Gaze of Khirad (prereq: level 7 warlock, the Great Old One patron)", "Gaze of Two Minds (prereq: level 5 warlock)", "Ghostly Gaze (prereq: level 7 warlock)", "Gift of the Depths (prereq: level 5 warlock)", "Gift of the Ever-Living Ones (prereq: Pact of the Chain)", "Gift of the Protectors (prereq: level 9 warlock, Pact of the Tome)", "Grasp of Hadar (prereq: Eldritch Blast cantrip)", "Green Lord's Gift (prereq: the Archfey patron)", "Improved Pact Weapon (prereq: Pact of the Blade)", "Investment of the Chain Master (prereq: level 5 warlock, prereq: Pact of the Chain)", "Kiss of Mephistopheles (prereq: level 5 warlock, the Fiend patron, Eldritch Blast cantrip)", "Lance of Lethargy (prereq: Eldritch Blast cantrip)", "Lessons of the Old Ones (prereq: level 2 warlock, repeatable)", "Lifedrinker (prereq: level 9 warlock, Pact of the Blade)", "Mace of Dispater (prereq: the Fiend patron, Pact of the Blade)", "Maddening Hex (prereq: level 5 warlock, Hex spell or warlock feature that curses)", "Mask of Many Faces", "Master of Myriad Forms (prereq: level 5 warlock)", "Minions of Chaos (prereq: level 9 warlock)", "Mire the Mind (prereq: level 5 warlock)", "Misty Visions", "Moon Bow (prereq: the Archfey patron, Pact of the Blade)", "One with Shadows (prereq: level 5 warlock)", "Otherworldly Leap (prereq: level 2 warlock)", "Pact of the Blade", "Pact of the Star Chain (prereq: the Seeker patron)", "Pact of the Chain (prereq: level 2 warlock)", "Pact of the Talisman", "Pact of the Tome", "Path of the Seeker (prereq: the Seeker patron)", "Protection of the Talisman (prereq: level 7 warlock, Pact of the Talisman)", "Raven Queen's Blessing (prereq: the Raven Queen patron, Eldritch Blast cantrip)", "Rebuke of the Talisman (prereq: Pact of the Talisman)", "Relentless Hex (prereq: level 7 warlock, Hex spell or warlock feature that curses)", "Repelling Blast (prereq: Eldritch Blast cantrip)", "Sculptor of Flesh (prereq: level 7 warlock)", "Seeker's Speech (prereq: the Seeker patron)", "Shroud of Shadow (prereq: level 15 warlock)", "Shroud of Ulban (prereq: level 18 warlock, the Great Old One patron)", "Sign of Ill Omen (prereq: level 5 warlock)", "Superior Pact Weapon (prereq: level 9 warlock, Pact of the Blade)", "Thief of Five Fates", "Thirsting Blade (prereq: level 5 warlock, Pact of the Blade)", "Tomb of Levistus (prereq: level 5 warlock)", "Trickster's Escape (prereq: level 7 warlock)", "Ultimate Pact Weapon (prereq: level 15 warlock, Pact of the Blade)", "Undying Servitude (prereq: level 5 warlock)", "Visions of Distant Realms (prereq: level 9 warlock)", "Voice of the Chain Master (prereq: Pact of the Chain)", "Whispers of the Grave (prereq: level 7 warlock)", "Witch Sight (prereq: level 15 warlock)"],
			extraTimes : levels.map(function (n) {
				return n < 2 ? 1 : n < 5 ? 3 : n < 7 ? 5 : n < 9 ? 6 : n < 12 ? 7 : n < 15 ? 8 : n < 18 ? 9 : 10;
			}),
			"agonizing blast (prereq: warlock cantrip)" : {
				name : "Agonizing Blast",
				description : desc([
					"I can add my Charisma modifier to the damage of one of my known Warlock cantrips.",
					"I can change which cantrip benefits from this invocation upon gaining a Warlock level.",
				]),
				source : [["UA23PT7", 29], ["SRD", 48], ["P", 110], ["MJ:HB", 0]],
				submenu : "[improves Warlock cantrips]",
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							if (classes.known.warlock_ua23pt7 && v.thisWeapon[3] && v.thisWeapon[4].indexOf('warlock_ua23pt7') !== -1 && SpellsList[v.thisWeapon[3]].level === 0) {
								output.extraDmg += What('Cha Mod');
							}
						},
						"My Warlock cantrips get my Charisma modifier added to their damage."
					],
					spellAdd : [
						function (spellKey, spellObj, spName) {
							if (spName.indexOf("warlock_ua23pt7") == -1 || !What("Cha Mod") || Number(What("Cha Mod")) <= 0 || spellObj.psionic || spellObj.level !== 0) return;
							return genericSpellDmgEdit(spellKey, spellObj, "\\w+\\.?", "Cha");
						},
						"I add my Charisma modifier to the damage of my Warlock cantrips."
					]
				}
			},
			"arcane gunslinger (prereq: pact of the blade)" : {
				name : "Arcane Gunslinger",
				description : desc([
					"My pact weapon can take firearm forms."
				]),
				source : [["UA:MM", 3]],
				submenu : "[improves Pact of the Blade]",
				prereqeval : function(v) { return GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; },
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (v.isRangedWeapon && /firearm/i.test(v.theWea.type + " " + v.theWea.list) && /\bpact\b/i.test(v.WeaponTextName)) {
								v.pactWeapon = true;
							}
						},
						"If I include the word 'Pact' in a firearm weapon's name, it gets treated as my Pact Weapon.",
						90
					]
				},
			},
			"armor of shadows" : {
				name : "Armor of Shadows",
				description : desc("I can cast Mage Armor on myself at will, without using a spell slot."),
				source : [["UA23PT7", 29], ["SRD", 48], ["P", 110], ["MJ:HB", 0]],
				spellcastingBonus : {
					name : "Armor of Shadows",
					spells : ["mage armor"],
					selection : ["mage armor"],
					firstCol : "atwill"
				},
			},
			"ascendant step (prereq: level 5 warlock)" : {
				name : "Ascendant Step",
				description : desc("I can cast Levitate on myself at will, without using a spell slot."),
				source : [["UA23PT7", 29], ["SRD", 48], ["P", 110], ["MJ:HB", 0]],
				submenu : "[warlock level  5+]",
				spellcastingBonus : {
					name : "Ascendant Step",
					spells : ["levitate"],
					selection : ["levitate"],
					firstCol : "atwill"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5; },
			},
			"aspect of the moon (prereq: pact of the tome)" : {
				name : "Aspect of the Moon",
				description : "\n   " + "I don't need sleep nor can be forced to by any means; I can rest while doing light activity.",
				source : [["X", 56], ["UA:RCO", 5]],
				submenu : "[improves Pact of the Tome]",
				prereqeval : function(v) { return GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the tome'; },
				savetxt : { text : ["Nothing can force me to sleep"] },
			},
			"beast speech" : {
				name : "Beast Speech",
				description : desc("I can cast Speak with Animals at will, without using a spell slots."),
				source : [["SRD", 48], ["P", 110]],
				spellcastingBonus : {
					name : "Beast Speech",
					spells : ["speak with animals"],
					selection : ["speak with animals"],
					firstCol : "atwill"
				}
			},
			"beguiling influence" : {
				name : "Beguiling Influence",
				description : desc("I gain proficiencies with the Deception and Persuasion skills."),
				source : [["SRD", 48], ["P", 110]],
				skills : ["Deception", "Persuasion"]
			},
			"bewitching whispers (prereq: level 7 warlock)" : {
				name : "Bewitching Whispers",
				description : desc("Once per long rest, I can cast Compulsion using a warlock spell slot."),
				source : [["SRD", 48], ["P", 110]],
				submenu : "[warlock level  7+]",
				usages : 1,
				recovery : "long rest",
				spellcastingBonus : {
					name : "Bewitching Whispers",
					spells : ["compulsion"],
					selection : ["compulsion"],
					firstCol : "oncelr"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 7; }
			},
			"bond of the talisman (prereq: level 12 warlock, pact of the talisman)" : {
				name : "Bond of the Talisman",
				source : [["T", 70]],
				submenu : "[improves Pact of the Talisman]",
				description : desc([
					"As an Action, I can teleport to the unoccupied space closest to the wearer of my talisman.",
					"The talisman's wearer can do the same to teleport to me; Only works if both on same plane."
				]),
				prereqeval : function(v) {
					return classes.known.warlock_ua23pt7.level >= 12 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7').indexOf("pact of the talisman") !== -1;
				},
				action : [["action", ""]],
				usages : "Proficiency bonus per ",
				usagescalc : "event.value = How('Proficiency Bonus')",
				recovery : "long rest",
			},
			"burning hex (prereq: the hexblade patron)" : {
				name : "Burning Hex",
				description : desc([
					"As a Bonus Action, I can cause a target affected by my hexblade's curse to take damage.",
					"It immediately takes Fire damage equal to my Charisma modifier (min 1)."
				]),
				source : [["UA:WnW", 3]],
				submenu : "[improves Hex spell or warlock feature that curses]",
				prereqeval : function(v) { return (/hexblade/).test(classes.known.warlock_ua23pt7.subclass); },
				action : ["bonus action", ""],
			},
			"caiphon's beacon (prereq: the great old one patron)" : {
				name : "Caiphon's Beacon",
				description : desc([
					"I gain Proficiencies with the Deception and Stealth skills.",
					"I have Advantage on attack rolls against charmed creatures."
				]),
				source : [["UA:WnW", 3]],
				prereqeval : function(v) { return (/great old one/).test(classes.known.warlock_ua23pt7.subclass); },
				skills : ["Deception", "Stealth"],
			},
			"chains of carceri (prereq: level 15 warlock, pact of the chain)" : {
				name : "Chains of Carceri",
				description : desc([
					"I can cast Hold Monster at will if the target is a celestial, fiend, or elemental.",
					"This uses no spell slots/material comp.; I can only target an individual once per long rest."
				]),
				source : [["SRD", 49], ["P", 110]],
				submenu : "[improves Pact of the Chain]",
				spellcastingBonus : {
					name : "Chains of Carceri",
					spells : ["hold monster"],
					selection : ["hold monster"],
					firstCol : "atwill"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 15 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the chain'; },
				spellChanges : {
					"speak with animals" : {
						components : "V,S",
						compMaterial : "",
						description : "1 celestial, fiend, or elemental, save or paralyzed; extra save at end of each turn",
						changes : "With the Chains of Carceri invocation I can cast Hold Monster without a material component, but only on a celestial, fiend, or elemental."
					}
				}
			},
			"chilling hex (prereq: the hexblade patron)" : {
				name : "Chilling Hex",
				description : desc([
					"As a Bonus Action, I can swirl frost around a target affected by my hexblade's curse.",
					"All creatures within 5 ft of the target take Cold damage equal to my Cha modifier (min 1)."
				]),
				source : [["UA:WnW", 3]],
				submenu : "[improves Hex spell or warlock feature that curses]",
				prereqeval : function(v) { return (/hexblade/).test(classes.known.warlock_ua23pt7.subclass); },
				action : ["bonus action", ""],
			},
			"chronicle of the raven queen (prereq: the raven queen patron, pact of the tome)" : {
				name : "Chronicle of the Raven Queen",
				description : desc([
					"Within 1 minute of a creature's death, I can use my book of shadows to ask it 1 question.",
					"To do this, I need to put the corpse's hand on the book and speak the question aloud.",
					"Its spirit writes the answer, to the best of its knowledge, in blood in a language I choose."
				]),
				source : [["UA:WnW", 3]],
				submenu : "[improves Pact of the Tome]",
				prereqeval : function(v) { return (/raven queen/).test(classes.known.warlock_ua23pt7.subclass) && classes.known.warlock_ua23pt7.level >= 3 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the tome'; },
				action : ["bonus action", ""],
			},
			"claw of acamar (prereq: the great old one patron, pact of the blade)": {
				name : "Claw of Acamar",
				description : desc([
					"As a pact weapon, I can create a black, lead flail with grasping tentacles for a head.",
					"It has Reach and can reduce a creature's Speed to 0 on a hit until the end of my next turn.",
					"On a hit, I can expend a spell slot to have it do +2d8 Necrotic damage per spell slot level."
				]),
				source : [["UA:WnW", 3]],
				submenu : "[improves Pact of the Blade]",
				prereqeval : function(v) { return (/great old one/).test(classes.known.warlock_ua23pt7.subclass) && classes.known.warlock_ua23pt7.level >= 3 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; },
				weaponOptions : {
					baseWeapon : "flail",
					regExpSearch : /^(?=.*\bclaw\b)(?=.*\bacamar\b).*$/i,
					name : "Claw of Acamar",
					source : [["UA:WnW", 3]],
					pactWeapon : true,
					description : "Pact weapon, reach; On hit: Reduces speed to 0, Expend spell slot for +2d8 necrotic damage per slot level"
				},
				weaponsAdd : ['Claw of Acamar'],
			},
			"cloak of flies (prereq: level 5 warlock)" : {
				name : "Cloak of Flies",
				description : desc([
					"As a Bonus Action, I can surround myself with a 5-ft radius magical aura of buzzing flies.",
					"It lasts until I'm Incapacitated or dismiss it as a Bonus Action; Total cover block the aura.",
					"The aura grants me Adv. on Cha (Intimidation), but Disadv. on all other Cha checks.",
					"Creatures starting their turn in the aura take my Cha mod (min 0) in Poison damage."
				]),
				source : [["X", 56], ["UA:RCO", 5]],
				submenu : "[warlock level  5+]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5; },
				recovery : "short rest",
				usages : 1,
				action : ["bonus action", " (start/stop)"],
			},
			"curse bringer (prereq: the hexblade patron, pact of the blade)" : {
				name : "Curse Bringer",
				description : desc([
					"As a pact weapon, I can create a silver greatsword with black runes etched in the blade.",
					"If I bring a target of my hexblade's curse to 0 HP with it, I can move the curse to another.",
					"It can reduce a creature's Speed to 0 on a hit until the end of my next turn.",
					"On a hit, I can expend a spell slot to have it do +2d8 Slashing damage per spell slot level."
				]),
				source : [["UA:WnW", 4]],
				submenu : "[improves Pact of the Blade]",
				prereqeval : function(v) { return (/hexblade/).test(classes.known.warlock_ua23pt7.subclass) && classes.known.warlock_ua23pt7.level >= 3 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; },
				weaponOptions : {
					baseWeapon : "greatsword",
					regExpSearch : /^(?=.*\bcurse)(?=.*bringer\b).*$/i,
					name : "Curse Bringer",
					source : [["UA:WnW", 4]],
					pactWeapon : true,
					description : "Pact weapon, heavy, two-handed; On hit: Reduces speed to 0, Expend spell slot for +2d8 slashing damage per slot level"
				},
				weaponsAdd : ['Curse Bringer'],
			},
			"devil's sight" : {
				name : "Devil's Sight",
				description : desc("I can see in Dim Light as well as magical and nonmagical Darkness out to 120 ft."),
				source : [["UA23PT7", 29], ["SRD", 49], ["P", 110], ["MJ:HB", 0]],
				vision : [["Devil's sight", 120]]
			},
			"dreadful word (prereq: level 7 warlock)" : {
				name : "Dreadful Word",
				description : desc("Once per long rest, I can cast Confusion using a warlock spell slot."),
				source : [["SRD", 49], ["P", 110]],
				submenu : "[warlock level  7+]",
				usages : 1,
				recovery : "long rest",
				spellcastingBonus : {
					name : "Dreadful Word",
					spells : ["confusion"],
					selection : ["confusion"],
					firstCol : "oncelr"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 7 ; }
			},
			"eldritch armor (prereq: pact of the blade)" : {
				name : "Eldritch Armor",
				source : [["UA:CFV", 11]],
				submenu : "[improves Pact of the Blade]",
				description : desc([
					"As an Action, I can touch an unattended suit of armor and instantly don it.",
					"I am Proficient with this suit of armor until it is removed."
				]),
				prereqeval : function(v) {
					return GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade';
				},
				action : [["action", ""]],
			},
			"eldritch mind" : {
				name : "Eldritch Mind",
				source : [["T", 71]],
				description : "\n   I have Advantage on my Constitution saving throws to maintain concentration on a spell.",
				savetxt : { text : "Adv. on Con (Concentration) saves" },
			},
			"eldritch sight" : {
				name : "Eldritch Sight",
				description : desc("I can cast Detect Magic at will, without using a spell slot."),
				source : [["SRD", 49], ["P", 110]],
				spellcastingBonus : {
					name : "Eldritch Sight",
					spells : ["detect magic"],
					selection : ["detect magic"],
					firstCol : "atwill"
				}
			},
			"eldritch smite (prereq: level 5 warlock, pact of the blade)" : { //Ripped directly from "all_WotC_pub+UA.js" and then altered
				name : "Eldritch Smite",
				description : desc([
					"Once per turn when I hit a creature with my pact weapon, I can empower the strike.",
					"By expending a Warlock spell slot, the creature takes extra damage and is knocked Prone.",
					"It takes 1d8 Force damage and another 1d8 Force damage per level of the spell slot.",
					"The target is only knocked Prone if it is Huge or smaller."
				]),
				source : [["UA23PT7", 29], ["X", 56], ["MJ:HB", 0]],
				submenu : "[improves Pact of the Blade]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; }
			},
			"eldritch spear (prereq: eldritch blast cantrip)" : {
				name : "Eldritch Spear",
				description : desc("My Eldritch Blast cantrip has a range of 300 ft"),
				source : [["UA23PT7", 29], ["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				submenu : "[improves Warlock cantrips]",
				calcChanges : { //?????????????????????????????????????????????????????????????????????????????
					atkAdd : [
						function (fields, v) {
							if (fields.Range >= 10) fields.Range = 300 * (v.rangeM ? v.rangeM : 1) + ' ft';
						},
						"My Eldritch Blast cantrip has a range of 300 ft."
					]
				},
				spellChanges : {
					"eldritch blast" : {
						range : "300 ft",
						changes : "My Eldritch Blast cantrip has a range of 300 ft."
					}
				}
			},
			"eyes of the rune keeper" : {
				name : "Eyes of the Rune Keeper",
				description : desc("I can read all writing"),
				source : [["SRD", 49], ["P", 111]]
			},
			"far scribe (prereq: level 5 warlock, pact of the tome)" : {
				name : "Far Scribe",
				source : [["T", 71]],
				submenu : "[improves Pact of the Tome]",
				description : desc([
					"My book of shadows has a new page; As an Action, a creature can write its name on it.",
					"This page can hold my Proficiency Bonus in creature names; I can remove one as an Action.",
					"I can cast Sending without a spell slot or material components, targeting one on the page.",
					"Instead of saying the message, I write it on the page and any reply appears there as well.",
					"This writing disappears after 1 minute; The target still hears the message in their mind."
				]),
				prereqeval : function(v) {
					return classes.known.warlock_ua23pt7.level >= 5 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the tome';
				},
				action : [["action", " (erase name)"]],
				spellcastingBonus : {
					name : "Far Scribe",
					spells : ["sending"],
					selection : ["sending"],
					firstCol : "atwill"
				},
				spellChanges : {
					"sending" : {
						components : "V,S",
						compMaterial : "",
						description : "Send 25 word message to crea named in book of shadows; it recognizes me and can respond 25 words",
						changes : "By using Far Scribe, I can cast Sending without using a spell slot or material components, but only to target one of the creatures that wrote their name in my book of shadows. Instead of speaking the message, I write it in my book and any response appears there as well, lasting for 1 minute. The target still hears the message in their mind."
					}
				},
			},
			"fiendish vigor" : {
				name : "Fiendish Vigor",
				description : desc("I can cast False Life on myself at will, without using a spell slot. I also gain the max amount of Temp HP."),
				source : [["UA23PT7", 29], ["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				spellcastingBonus : {
					name : "Fiendish Vigor",
					spells : ["false life"],
					selection : ["false life"],
					firstCol : "atwill"
				},
				spellChanges : {
					"false life" : {
						components : "V,S,M",
						compMaterial : "A small amount of alcohol or distilled spirits",
						description : "I gain 8 temporary hit points for the duration",
						changes : "With the Fiendish Vigor invocation, I gain the max amount of Temp HP when I can cast False Life."
					}
				}
			},
			"gaze of khirad (prereq: level 7 warlock, the great old one patron)" : {
				name : "Gaze of Khirad",
				description : desc([
					"As an Action, I can see through solid object out to 30 ft until the end of my current turn"
				]),
				source : [["UA:WnW", 4]],
				submenu : "[warlock level  7+]",
				prereqeval : function(v) { return (/great old one/).test(classes.known.warlock_ua23pt7.subclass) && classes.known.warlock_ua23pt7.level >= 7; },
				action : ["action", ""],
			},
			"gaze of two minds (prereq: level 5 warlock)" : {
				name : "Gaze of Two Minds",
				description : desc([
					"As a Bonus Action, I can touch a willing creature and perceive through its senses (not my own).",
					"This lasts until the end of my next turn, but I can use a Bonus Action to extend the duration.",
					"While perceiving through the other creature's senses, I benefit from any special senses it has,",
					"  and I can cast spells as if I were in either my space or the space the other creature, so long",
					"  as it is within 60 ft of me.",
				]),
				source : [["UA23PT7", 29], ["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				submenu : "[warlock level  5+]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5 ; }
			},
			"ghostly gaze (prereq: level 7 warlock)" : {
				name : "Ghostly Gaze",
				description : desc([
					"As an Action, I can gain Darkvision, and the ability to see through solid objects, out to 30 ft.",
					"Objects appear ghostly to me; This lasts up to 1 minute, while I'm concentrating on this."
				]),
				source : [["X", 56]],
				submenu : "[warlock level  7+]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 7; },
				recovery : "short rest",
				usages : 1,
				action : ["action", ""],
			},
			"gift of the depths (prereq: level 5 warlock)" : {
				name : "Gift of the Depths",
				description : desc([
					"I can breathe underwater and I have a Swim Speed equal to my Walking Speed.",
					"Once per Long Rest, I can cast Water Breathing without using a spell slot (PHB 287)."
				]),
				source : [["UA23PT7", 29], ["X", 57], ["UA:RCO", 6], ["MJ:HB", 0]],
				submenu : "[warlock level  5+]",
				spellcastingBonus : {
					name : "Gift of the Depths",
					spells : ["water breathing"],
					selection : ["water breathing"],
					firstCol : 'oncelr'
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5; },
				speed : { swim : { spd : "walk", enc : "walk" } },
			},
			"gift of the ever-living ones (prereq: pact of the chain)" : {
				name : "Gift of the Ever-Living Ones",
				description : "\n   " + "When I regain HP while my familiar is within 100 ft, I regain the max the dice can roll.",
				source : [["X", 57], ["UA:RCO", 6]],
				submenu : "[improves Pact of the Chain]",
				prereqeval : function(v) { return GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the chain'; },
			},
			"gift of the protectors (prereq: level 9 warlock, pact of the tome)" : {
				name : "Gift of the Protectors",
				source : [["UA23PT7", 29], ["T", 71], ["MJ:HB", 0]],
				submenu : "[improves Pact of the Tome]",
				description : desc([
					"My Book of Shadows has a new page; As an action, a creature can write its name on it.",
					"This page can hold my Proficiency Bonus in creature names; I can remove one as a Magic action.",
					"If a creature whose name is on the page drops to 0 HP, it magically drops to 1 HP instead.",
					"Once this occurs, no creature can benefit from this Invocation until I finish a Long Rest.",
					"This doesn't work if the creature would be killed outright.",
				]),
				prereqeval : function(v) {
					return classes.known.warlock_ua23pt7.level >= 9 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the tome';
				},
				action : [["action", " (erase name)"]],
				usages : 1,
				recovery : "long rest",
			},
			"grasp of hadar (prereq: eldritch blast cantrip)" : { //Altered to be in alignment with UA Repelling Blast
				name : "Grasp of Hadar",
				description : desc("Once per turn when my Eldritch Blast hits a Large or smaller creature, I can move it up to 10 ft closer to me in a straight line."),
				source : [["X", 57], ["UA:RCO", 6], ["MJ:HB", 0]],
				submenu : "[improves Eldritch Blast]",
				prereqeval : function(v) { return v.hasEldritchBlast; },
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (v.baseWeaponName == 'eldritch blast') fields.Description += '; Target moved 10 ft to me';
						},
						"When I hit a Large or smaller creature with my Eldritch Blast cantrip once or more times in a turn, I can move it in a straight line 10 ft closer to me."
					]
				},
			},
			"green lord's gift (prereq: the archfey patron)" : {
				name : "Green Lord's Gift",
				description : desc([
					"When I regain HP, all dice for determining the HP I heal are treated as rolling maximum."
				]),
				source : [["UA:WnW", 4]],
				prereqeval : function(v) { return (/\barchfey\b/).test(classes.known.warlock_ua23pt7.subclass); },
			},
			"improved pact weapon (prereq: pact of the blade)" : { //Some of this Invocation's functions were absorbed into baseline Pact of the Blade, so this has been altered accordingly
				name : "Improved Pact Weapon",
				description : desc([
					"Any pact weapon I create is a +1 magic weapon, if it isn't already a +1 magic weapon.",
					"I can now also conjure a shortbow, longbow, or light or heavy crossbow as my pact weapon."
				]),
				source : [["X", 57]],
				submenu : "[improves Pact of the Blade]",
				prereqeval : function(v) { return GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; },
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							if ((/^(shortbow|longbow|light crossbow|heavy crossbow)$/).test(v.baseWeaponName) && (/\bpact\b/i).test(v.WeaponTextName)) {
								v.pactWeapon = true;
							}
							// Test if this is a pact weapon, has no + bonus from somewhere else, and doesn't already have a improved pact weapon bonus
							if (v.pactWeapon && !output.magic) {
								var bContinue = true;
								// Now test if this isn't a weaponOptions addition with a static + bonus set to the modifier fields
								if (v.theWea && v.theWea.isMagicWeapon && v.theWea.modifiers) {
									// Test the first two modifiers to see if both offer a +1 or more. Returns `true` if one contains no numbers or is less than the improved pact weapon bonus
									var bContinue = v.theWea.modifiers.slice(0, 2).some(function (n) {
										if (!n || !/\d/.test(n)) {
											var nmbr = 0;
										} else if (isNaN(n)) {
											var nmbr = n.match(/(^|\+|-)\d+\b/g);
											nmbr = !nmbr ? 0 : nmbr.reduce(function(a, b) {return Number(a) + Number(b)});
										} else {
											var nmbr = Number(n);
										}
										return nmbr < 1;
									});
								}
								// if the continue boolean wasn't set to false, we can proceed
								if (bContinue) {
									v.pactMag = 1;
									output.magic = 1;
								}
							}
						},
						"If I include the word 'Pact' in a the name of a melee weapon, shortbow, longbow, light crossbow, or heavy crossbow, it will be treated as my Pact Weapon.\n \u2022 If my Pact Weapon doesn't already include a magical bonus in its name and is not a magic weapon with at least a +1 bonus, the calculation will add +1 to its To Hit and Damage.",
						290
					],
					atkAdd : [
						function (fields, v) {
							if ((/^(shortbow|longbow|light crossbow|heavy crossbow)$/).test(v.baseWeaponName) && (/\bpact\b/i).test(v.WeaponTextName)) {
								v.pactWeapon = true;
							}
						}, "", 90]
				},
			},
			"investment of the chain master (prereq: level 5 warlock, prereq: pact of the chain)" : {
				name : "Investment of the Chain Master",
				source : [["UA23PT7", 29], ["T", 71], ["MJ:HB", 0]],
				submenu : "[improves Pact of the Chain]",
				description : desc([
					"When I cast Find Familiar, the summoned create has additional benefits:",
					"\u2022 It gains a Flying or Swimming Speed of 40 ft (my choice at casting)",
					"\u2022 As a Bonus Action, I can command it to take the Attack action",
					"\u2022 Its weapon attacks can, if I desire, instead deal Necrotic or Radiant damage",
					"\u2022 If it forces a creature to make a saving throw, it uses my spell save DC",
					"\u2022 As a Reaction when it takes damage, I can grant it Resistance against that damage"
				]),
				action : [["bonus action", " (command to attack)"], ["reaction", " (give resistance)"]],
				prereqeval : function(v) {
					return classes.known.warlock_ua23pt7.level >= 5 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the chain';
				},
				calcChanges : {
					companionCallback : [function(prefix, oCrea, bAdd, sCompType) {
						if (sCompType !== "pact_of_the_chain") return;
						var strFea = "\u25C6 Investment of the Chain Master (TCoE 71): The familiar gains 40 ft fly or swim speed (my choice), its attacks can instead deal Necrotic or Radiant damage, and it can use my spell save DC instead of its own DC's (if any).";
						var strSpd = "fly or swim 40 ft";
						if (What("Unit System") === "metric") {
							strFea = ConvertToMetric(strFea, 0.5);
							strSpd = ConvertToMetric(strSpd, 0.5);
						}
						var aFnc = bAdd ? AddString : RemoveString;
						aFnc(prefix + "Comp.Use.Features", strFea, true);
						aFnc(prefix + "Comp.Use.Speed", strSpd, typePF ? ",\n" : ", ");
						for (var i = 1; i <= 3; i++) {
							var baseFld = prefix + "Comp.Use.Attack." + i;
							var weaDescrFld = baseFld + ".Description";
							var strWeaDescr = What(weaDescrFld);
							if (bAdd && What(baseFld + ".Weapon Selection") && !(/(,|;)? ?can instead deal necrotic or radiant damage/i).test(strWeaDescr)) {
								AddString(weaDescrFld, "Can instead deal Necrotic or Radiant damage", "; ");
							} else if (!bAdd) {
								Value(weaDescrFld, strWeaDescr.replace(/(,|;)? ?can instead deal necrotic or radiant damage/i, ''));
							}
						}
					},
					"My pact of the chain familiars gain an extra feature listing the extra bonuses they gain."]
				},
			},
			"kiss of mephistopheles (prereq: level 5 warlock, the fiend patron, eldritch blast cantrip)" : {
				name : "Kiss of Mephistopheles",
				description : desc([
					"As a Bonus Action when my Eldritch Blast hits, I can cast Fireball using a warlock spell slot.",
					"The origin of the Fireball is the creature that was hit with my Eldritch Blast attack."
				]),
				source : [["UA:WnW", 4]],
				submenu : "[improves Eldritch Blast]",
				prereqeval : function(v) { return v.hasEldritchBlast && classes.known.warlock_ua23pt7.level >= 5 && (/\bfiend\b/).test(classes.known.warlock_ua23pt7.subclass); },
				action : ["bonus action", ""],
			},
			"lance of lethargy (prereq: eldritch blast cantrip)" : {
				name : "Lance of Lethargy",
				description : desc([
					"Once per turn when my Eldritch Blast hits a creature, I can reduce its Speed by 10 ft.",
					"This Speed reduction lasts until the end of my next turn."
				]),
				source : [["X", 57]],
				submenu : "[improves Eldritch Blast]",
				prereqeval : function(v) { return v.hasEldritchBlast; },
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (v.baseWeaponName == 'eldritch blast') fields.Description += '; 1 target -10 ft speed';
						},
						"Once on each of my turns when I hit a creature with my Eldritch Blast cantrip, I can reduce its Speed by 10 ft until the end of my next turn."
					]
				},
			},
			"lessons of the old ones (prereq: level 2 warlock, repeatable)": {
				name : "Lessons of the Old Ones",
				description : desc([
					"I gain one Feat of my choice that lacks prerequisites.",
					"I can take this Invocation multiple times, but must take a different Feat each time.",
					"Do note that the sheet will not reflect more than one instance of this Invocation.",
				]),
				source : [["UA23PT7", 29], ["MJ:HB", 0]],
				submenu : "[warlock level  2+]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 2; },
			},
			"lifedrinker (prereq: level 9 warlock, pact of the blade)" : {
				name : "Lifedrinker",
				description : desc([
					"My pact weapon does extra necrotic damage equal to my Charisma modifier.",
				]),
				source : [["UA23PT7", 30], ["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				submenu : "[improves Pact of the Blade]",
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (v.pactWeapon) fields.Description += (fields.Description ? '; ' : '') + '+Cha mod necrotic damage (included above)';
						},
						"My Charisma modifier will be added to the damage of my Pact Weapons. However, it won't say in the damage box that this added damage is of the necrotic type, as it can only display a single damage type."
					],
					atkCalc : [
						function (fields, v, output) {
							if (v.pactWeapon) output.extraDmg += What('Cha Mod');
						}, ""
					]
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 9 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; },
			},
			"mace of dispater (prereq: the fiend patron, pact of the blade)" : {
				name : "Mace of Dispater",
				description : desc([
					"As a pact weapon, I can create an iron mace forged in Dis, the 2nd layer of the Nine Hells.",
					"I can knock a target Prone with it on a hit, if the target's size is Huge or smaller.",
					"On a hit, I can expend a spell slot to have it do +2d8 Force damage per spell slot level."
				]),
				source : [["UA:WnW", 4]],
				submenu : "[improves Pact of the Blade]",
				prereqeval : function(v) { return (/\bfiend\b/).test(classes.known.warlock_ua23pt7.subclass) && classes.known.warlock_ua23pt7.level >= 3 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; },
				weaponOptions : {
					baseWeapon : "mace",
					regExpSearch : /^(?=.*\bmace\b)(?=.*\bdispater\b).*$/i,
					name : "Mace of Dispater",
					source : [["UA:WnW", 4]],
					pactWeapon : true,
					description : "Pact weapon; On hit: knock Huge or smaller prone, Expend spell slot for +2d8 force damage per slot level"
				},
				weaponsAdd : ['Mace of Dispater'],
			},
			"maddening hex (prereq: level 5 warlock, hex spell or warlock feature that curses)" : {
				name : "Maddening Hex",
				description : desc([
					"As a Bonus Action, I cause pain around a target hexed by me that I can see within 30 ft.",
					"It and any of my choice I can see in 5 ft of it take my Cha mod (min 1) in psychic damage.",
					"The Hex spell and all of my Warlock features that curse are considered a hex for this."
				]),
				source : [["X", 57]],
				submenu : "[improves Hex spell or warlock feature that curses]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5 && (isSpellUsed('hex', true) || (/hexblade/).test(classes.known.warlock_ua23pt7.subclass)); },
				action : ["bonus action", ""],
			},
			"mask of many faces" : {
				name : "Mask of Many Faces",
				description : desc("I can cast Disguise Self at will, without using a spell slot."),
				source : [["UA23PT7", 30], ["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				spellcastingBonus : {
					name : "Mask of Many Faces",
					spells : ["disguise self"],
					selection : ["disguise self"],
					firstCol : "atwill"
				}
			},
			"master of myriad forms (prereq: level 5 warlock)" : {
				name : "Master of Myriad Forms",
				description : desc("I can cast Alter Self at will, without using a spell slot."),
				source : [["UA23PT7", 30], ["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				submenu : "[warlock level 5+]",
				spellcastingBonus : {
					name : "Mask of Myriad Forms",
					spells : ["alter self"],
					selection : ["alter self"],
					firstCol : "atwill"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5; }
			},
			"minions of chaos (prereq: level 9 warlock)" : {
				name : "Minions of Chaos",
				description : desc("Once per Long Rest, I can cast Conjure Elemental using a warlock spell slot."),
				source : [["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				submenu : "[warlock level  9+]",
				usages : 1,
				recovery : "long rest",
				spellcastingBonus : [{
					name : "Minions of Chaos: 2014 Conjure Elemental",
					spells : ["conjure elemental"],
					selection : ["conjure elemental"],
					firstCol : "oncelr",
				}, {
					name : "Minions of Chaos: UA23PT8 Conjure Elemental",
					spells : ["conjure elemental ua23pt8"],
					selection : ["conjure elemental ua23pt8"],
					firstCol : "oncelr",
				}],
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 9; }
			},
			"mire the mind (prereq: level 5 warlock)" : {
				name : "Mire the Mind",
				description : desc("Once per long rest, I can cast Slow using a warlock spell slot."),
				source : [["SRD", 49], ["P", 111]],
				submenu : "[warlock level  5+]",
				usages : 1,
				recovery : "long rest",
				spellcastingBonus : {
					name : "Mire the Mind",
					spells : ["slow"],
					selection : ["slow"],
					firstCol : "oncelr"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5; }
			},
			"misty visions" : {
				name : "Misty Visions",
				description : desc("I can cast Silent Image at will, without using a spell slot."),
				source : [["UA23PT7", 30], ["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				spellcastingBonus : {
					name : "Misty Visions",
					spells : ["silent image"],
					selection : ["silent image"],
					firstCol : "atwill"
				},
			},
			"moon bow (prereq: the archfey patron, pact of the blade)" : {
				name : "Moon Bow",
				description : desc([
					"As a pact weapon, I can create a longbow that creates arrows of white wood when drawn.",
					"Its arrows last for 1 minute; I have Advantage on attack rolls against lycanthropes with it.",
					"On a hit, I can expend a spell slot to have it do +2d8 Radiant damage per spell slot level."
				]),
				source : [["UA:WnW", 4]],
				submenu : "[improves Pact of the Blade]",
				prereqeval : function(v) { return (/\barchfey\b/).test(classes.known.warlock_ua23pt7.subclass) && classes.known.warlock_ua23pt7.level >= 3 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; },
				weaponOptions : {
					baseWeapon : "longbow",
					regExpSearch : /^(?=.*\bmoon)(?=.*bow\b).*$/i,
					name : "Moon Bow",
					source : [["UA:WnW", 4]],
					pactWeapon : true,
					description : "Pact weapon, heavy, two-handed; Adv. vs. lycanthropes; On hit, expend spell slot for +2d8 radiant damage per slot level"
				},
				weaponsAdd : ['Moon Bow'],
			},
			"one with shadows (prereq: level 5 warlock)" : {
				name : "One with Shadows",
				description : desc([
					"As a Magic Action, when I'm in an area of Dim Light or Darkness, I can cast Invisibility",
					"  on myself, without using a spell slot.",
				]),
				source : [["UA23PT7", 30], ["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				submenu : "[warlock level  5+]",
				spellcastingBonus : {
					name : "One with Shadows",
					spells : ["invisibility"],
					selection : ["invisibility"],
					firstCol : "atwill"
				},
				action : ["action", ""],
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5; }
			},
			"otherworldly leap (prereq: level 2 warlock)" : {
				name : "Otherworldly Leap",
				description : desc("I can cast Jump on myself at will, without using a spell slot."),
				source : [["UA23PT7", 30], ["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				submenu : "[warlock level  2+]",
				spellcastingBonus : [{
					name : "Otherworldly Leap: 2014 Jump",
					spells : ["jump"],
					selection : ["jump"],
					firstCol : "atwill",
				}, {
					name : "Otherworldly Leap: UA23PT7 Jump",
					spells : ["jump ua23pt7"],
					selection : ["jump ua23pt7"],
					firstCol : "atwill",
				}],
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 2; },
			},
			"pact of the blade" : {
				name : "Pact of the Blade",
				description : desc([
					"As a Bonus Action, I can create a pact weapon in my empty hand; I'm proficient in its use,",
					"  can use its Mastery Property, \u0026 can use it as a spellcasting focus.",
					"I must add the word \"Mastery\" to the name of the weapon to display the Mastery property.",
					"I can choose the type of melee weapon every time I create it, and it has those statistics.",
					"The weapon disappears if it is more than 5 ft away from me for 1 minute.",
					"I can use a Bonus Action to re-summon it in any form and can dismiss it as no action."
				]),
				source : [["UA23PT7", 30], ["SRD", 47], ["P", 107], ["MJ:HB", 0]],
				action : ["bonus action", ""],
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							if ((v.theWea.pactWeapon || ((v.isMeleeWeapon || v.theWea.isMagicWeapon || v.thisWeapon[1]) && (/\bpact\b/i).test(v.WeaponTextName))) && What('Cha Mod') > What(AbilityScores.abbreviations[fields.Mod - 1] + ' Mod')) {
								fields.Mod = 6;
								v.pactWeapon = true;
							}
						}, "",
						90,
					],
					atkAdd : [
						function (fields, v) {
							if ((v.pactWeapon || v.theWea.pactWeapon || ((v.isMeleeWeapon || v.theWea.isMagicWeapon || v.thisWeapon[1]) && (/\bpact\b/i).test(v.WeaponTextName))) && What('Cha Mod') > What(AbilityScores.abbreviations[fields.Mod - 1] + ' Mod')) {
								fields.Mod = 6;
								v.pactWeapon = true;
								fields.Proficiency = true;
								masteryFunctions.weaponMasteryAtkAdd[0](fields, v, true);
							}
						},
						"If I include the word 'Pact' in a melee or magic weapon's name, it gets treated as my Pact Weapon.",
						290
					],
				},
			},
			"pact of the chain (prereq: level 2 warlock)" : {
				name : "Pact of the Chain",
				description : desc([
					"I can cast Find Familiar, without using a spell slot, \u0026 it can be a Pseudodragon,",
					"  Imp, Quasit, or Sprite. When taking the Attack action, I can forgo 1 attack to have my",
					"  familiar make one attack of its own instead with its Reaction."
				]),
				source : [["UA23PT7", 31], ["SRD", 47], ["P", 107], ["MJ:HB", 0]],
				spellcastingBonus : [{
					name : "Pact of the Chain: 2014 Find Familiar",
					spells : ["find familiar"],
					selection : ["find familiar"],
					firstCol : "awtill",
				}, {
					name : "Pact of the Chain: UA23DP Find Familiar",
					spells : ["find familiar ua23dp"],
					selection : ["find familiar ua23dp"],
					firstCol : "awtill",
				}],
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 2; },
			},
			"pact of the star chain (prereq: the seeker patron)" : {
				name : "Pact of the Star Chain",
				source : [["UA:TF", 1]],
				description : desc([
					"My patron grants me an item of power which disappears when I die.",
					"While it is on my person, I can cast Augury as a Ritual.",
					"Additionally, once per Short Rest, I can get Advantage on an Intelligence check.",
					"If I lose this item I can perform a 1-hour ceremony to get a replacement."
				]),
				usages : 1,
				recovery : "short rest",
				spellcastingBonus : {
					name : "Pact of the Star Chain",
					spells : ["augury"],
					selection : ["augury"],
					firstCol : "(R)",
				},
				spellChanges : {
					"augury" : {
						time : "11 min",
						changes : "With my Pact of the Star Chain boon I can cast Augury only as a ritual, thus requiring 10 extra minutes to cast it."
					}
				},
				prereqeval : function(v) {
					return classes.known.warlock_ua23pt7 && classes.known.warlock_ua23pt7.subclass.indexOf("the seeker") !== -1 ? true : "skip";
				},
			},
			"pact of the talisman" : {
				name : "Pact of the Talisman",
				source : [["T", 70]],
				description : desc([
					"When the wearer of this amulet fails an ability check, they can add +1d4 to the roll.",
					"I can give the talisman to others to use; The talisman turns to ash when I die.",
					"If I lose my talisman, I can perform a 1-hour ceremony to gain a replacement.",
					"This ceremony destroys the previous amulet and can be done during a Short or Long Rest."
				]),
				usages : "Proficiency bonus per ",
				usagescalc : "event.value = How('Proficiency Bonus')",
				recovery : "long rest",
			},
			"pact of the tome" : {
				name : "Pact of the Tome",
				source : [["UA23PT7", 31], ["SRD", 48], ["P", 108], ["MJ:HB", 0]],
				description : desc([
					"I have a Book of Shadows that I can use a spellcasting focus.",
					"The book contains any three cantrips of my choosing along with any two 1st lvl ritual spells.",
					"I can cast these cantrips \u0026 spells as long as I have the book on my person.",
					"Regardless of the lists they come from, these count as warlock cantrips/spells to me.",
					"I gain one level one spell slot. Once expended, I can't gain another slot from this feature",
					"  until I finish a Long Rest. I can get a replacement book at the end of a Short or Long Rest.",
				]),
				spellcastingBonus : [{
					name : "Pact of the Tome: Cantrips",
					"class" : "any",
					level : [0, 0],
					times : 3,
				},{
					name : "Pact of the Tome: 1st-level Spells",
					"class" : "any",
					level : [1, 1],
					times : 2,
				}],
				limfeaname : "Pact of the Tome: 1st-lvl Spell Slot",
				usages : 1,
				recovery : "long rest",
			},
			"path of the seeker (prereq: the seeker patron)" : {
				name : "Path of the Seeker",
				description : desc([
					"I ignore Difficult Terrain; I have Advantage on saving throws against being Paralyzed",
					"I also have Advantage on checks to escape a Grapple, manacles, or rope bindings"
				]),
				source : [["UA:WnW", 4]],
				prereqeval : function(v) { return (/\bseeker\b/).test(classes.known.warlock_ua23pt7.subclass); },
				savetxt : { adv_vs : ["paralyzed"] },
			},
			"protection of the talisman (prereq: level 7 warlock, pact of the talisman)" : {
				name : "Protection of the Talisman",
				source : [["T", 71]],
				submenu : "[improves Pact of the Talisman]",
				description : "\n   " + "When the wearer of my talisman fails a saving throw, they can add +1d4 to the roll.",
				prereqeval : function(v) {
					return classes.known.warlock_ua23pt7.level >= 7 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7').indexOf("pact of the talisman") !== -1;
				},
				usages : "Proficiency bonus per ",
				usagescalc : "event.value = How('Proficiency Bonus')",
				recovery : "long rest",
			},
			"raven queen's blessing (prereq: the raven queen patron, eldritch blast cantrip)" : {
				name : "Raven Queen's Blessing",
				description : desc([
					"When I score a Critical Hit with Eldritch Blast, I can choose an ally I can see within 30 ft.",
					"That ally can immediately expend one HD to regain HP, just like after a Short Rest."
				]),
				source : [["UA:WnW", 5]],
				submenu : "[improves Eldritch Blast]",
				prereqeval : function(v) { return v.hasEldritchBlast && (/raven queen/).test(classes.known.warlock_ua23pt7.subclass); },
			},
			"rebuke of the talisman (prereq: pact of the talisman)" : {
				name : "Rebuke of the Talisman",
				source : [["T", 71]],
				submenu : "[improves Pact of the Talisman]",
				description : desc([
					"As a Reaction when the wearer of my talisman is hit, I deal damage and push the attacker.",
					"To be able to do this, I have to see the attacker and it has to be within 30 ft of me.",
					"I deal it my Proficiency Bonus in psychic damage and push it 10 ft straight away from the talisman."
				]),
				prereqeval : function(v) {
					return GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7').indexOf("pact of the talisman") !== -1;
				},
				action : [["reaction", ""]],
			},
			"relentless hex (prereq: level 7 warlock, hex spell or warlock feature that curses)" : {
				name : "Relentless Hex",
				description : desc([
					"As a Bonus Action, I can teleport to a target hexed by me that I can see within 30 ft.",
					"I teleport up to 30 ft to an unoccupied space that I can see within 5 ft of the target."
				]),
				source : [["X", 57]],
				submenu : "[improves Hex spell or warlock feature that curses]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 7 && (isSpellUsed('hex', true) || (/hexblade/).test(classes.known.warlock_ua23pt7.subclass)); },
				action : ["bonus action", ""],
			},
			"repelling blast (prereq: eldritch blast cantrip)" : {
				name : "Repelling Blast",
				description : desc("I can have Large or smaller creatures hit by my Eldritch Blast cantrip be pushed up to 10 ft straight away from me."),
				source : [["UA23PT7", 31], ["SRD", 49], ["P", 111], ["MJ:HB", 0]],
				submenu : "[improves Eldritch Blast]",
				prereqeval : function(v) { return v.hasEldritchBlast; },
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (v.baseWeaponName == 'eldritch blast') fields.Description += '; Target pushed back 10 ft';
						},
						"When I hit a Large or smaller creature with my Eldritch Blast cantrip, it is pushed up to 10 ft straight away from me."
					]
				},
				spellChanges : {
					"eldritch blast" : {
						description : "Spell attack beam 1d10 Force damage \u0026 push 10 ft; beams can be combined; +1 beam at CL5,11,17; see book",
						descriptionShorter : "Spell atk beam 1d10 Force damage \u0026 push 10 ft; can combine beams; +1 beam at CL5,11,17; see book",
						descriptionCantripDie : "Spell atk for `CD` beam(s), each 1d10 Force damage \u0026 push 10 ft; can combine/split beams; see book",
						descriptionFull : "A beam of crackling energy streaks toward a creature within range. Make a ranged spell attack against the target. On a hit, the target takes 1d10 force damage. Additionally, if the target is Large or smaller, it can be pushed up to 10 ft straight away from you." + "\n   " + "The spell creates more than one beam when you reach higher levels - two beams at 5th level, three beams at 11th level, and four beams at 17th level. You can direct the beams at the same target or at different ones. Make a separate attack roll for each beam.",
						changes : "When I hit a Large or smaller creature with my Eldritch Blast cantrip, it is pushed 10 ft straight away from me."
					}
				},
			},
			"sculptor of flesh (prereq: level 7 warlock)" : {
				name : "Sculptor of Flesh",
				description : desc("Once per long rest, I can cast Polymorph using a warlock spell slot."),
				source : [["SRD", 50], ["P", 111]],
				submenu : "[warlock level  7+]",
				usages : 1,
				recovery : "long rest",
				spellcastingBonus : {
					name : "Sculptor of Flesh",
					spells : ["polymorph"],
					selection : ["polymorph"],
					firstCol : "oncelr"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 7; }
			},
			"seeker's speech (prereq: the seeker patron)" : {
				name : "Seeker's Speech",
				description : desc([
					"When I finish a Long Rest, I pick two Languages that I know until I finish my next Long Rest."
				]),
				source : [["UA:WnW", 5]],
				prereqeval : function(v) { return (/\bseeker\b/).test(classes.known.warlock_ua23pt7.subclass); },
			},
			"shroud of shadow (prereq: level 15 warlock)" : {
				name : "Shroud of Shadow",
				description : "\n   " + "I can cast Invisibility at will, without using spell slots (PHB 254).",
				source : [["X", 57], ["UA:RCO", 6]],
				submenu : "[warlock level 15+]",
				spellcastingBonus : {
					name : "Shroud of Shadow",
					spells : ["invisibility"],
					selection : ["invisibility"],
					firstCol : 'atwill'
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 15; },
				spellChanges : {
					"invisibility" : {
						description : "1 crea invisible; attacking/casting makes the crea visible; anything worn/carried also invisible",
						changes : "With the Shroud of Shadow invocation I can cast Invisibility at will, but when I do so I am unable to cast it using a higher level spell slot."
					}
				},
			},
			"shroud of ulban (prereq: level 18 warlock, the great old one patron)" : {
				name : "Shroud of Ulban",
				description : desc([
					"As an Action, I can turn myself Invisible for 1 minute.",
					"If I attack, deal damage, or force a creature to make a save, I become visible again.",
					"However, I only become visible at the end of the current turn."
				]),
				source : [["UA:WnW", 4]],
				submenu : "[warlock level 18+]",
				prereqeval : function(v) { return (/great old one/).test(classes.known.warlock_ua23pt7.subclass) && classes.known.warlock_ua23pt7.level >= 18; },
				action : ["action", ""],
			},
			"sign of ill omen (prereq: level 5 warlock)" : {
				name : "Sign of Ill Omen",
				description : desc("Once per long rest, I can cast Bestow Curse using a warlock spell slot."),
				source : [["SRD", 50], ["P", 111]],
				submenu : "[warlock level  5+]",
				usages : 1,
				recovery : "long rest",
				spellcastingBonus : {
					name : "Sign of Ill Omen",
					spells : ["bestow curse"],
					selection : ["bestow curse"],
					firstCol : "oncelr"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5; }
			},
			"superior pact weapon (prereq: level 9 warlock, pact of the blade)" : {
				name : "Superior Pact Weapon",
				description : desc([
					"Any pact weapon I create is a +2 magic weapon, if it isn't already a magic weapon."
				]),
				source : [["UA:WnW", 5]],
				submenu : "[improves Pact of the Blade]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 9 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; },
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							// Test if this is a pact weapon, has no + bonus in its name, is not a magic weapon, and doesn't already have a improved pact weapon bonus
							var iPactWeaBonus = 2;
							if (v.pactWeapon && !v.thisWeapon[1] && !(v.theWea && v.theWea.isMagicWeapon) && ((!v.pactMag && !output.magic) || (v.pactMag && v.pactMag < iPactWeaBonus))) {
								if (v.pactMag) output.magic -= v.pactMag;
								v.pactMag = iPactWeaBonus;
								output.magic += v.pactMag;
							}
						},
						"If my Pact Weapon doesn't already include a magical bonus in its name or gets it from somewhere else and is not a magic weapon, the calculation will add +2 to its To Hit and Damage."
					]
				},
			},
			"thief of five fates" : {
				name : "Thief of Five Fates",
				description : desc("Once per long rest, I can cast Bane using a warlock spell slot."),
				source : [["SRD", 50], ["P", 111]],
				usages : 1,
				recovery : "long rest",
				spellcastingBonus : {
					name : "Thief of Five Fates",
					spells : ["bane"],
					selection : ["bane"],
					firstCol : "oncelr"
				}
			},
			"thirsting blade (prereq: level 5 warlock, pact of the blade)" : {
				name : "Thirsting Blade",
				description : desc([
					"When taking the Attack action, I can attack twice with my pact weapon.",
					"Upon reaching 11th level in this class, I can attack thrice with my pact weapon.",
				]),
				source : [["UA23PT7", 31], ["SRD", 50], ["P", 111], ["MJ:HB", 0]],
				submenu : "[improves Pact of the Blade]",
				action : ['action', 'Pact Weapon (2 attacks per action)'],
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; }
			},
			"tomb of levistus (prereq: level 5 warlock)" : {
				name : "Tomb of Levistus",
				description : desc([
					"As a Reaction when I take damage, I can entomb myself in ice until the end of my turn.",
					"During, I get 10 temp. HP per Warlock level, which I use to absorb the triggering damage.",
					"After, till the ice is gone, I also get Vulnerability to Fire, 0 Speed, and am Incapacitated."
				]),
				source : [["X", 57], ["UA:RCO", 6]],
				submenu : "[warlock level  5+]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5; },
				recovery : "short rest",
				usages : 1,
				action : ["reaction", ""],
				additional : levels.map( function(n) { return (n * 10) + " temp HP"; }),
			},
			"trickster's escape (prereq: level 7 warlock)" : {
				name : "Trickster's Escape",
				description : "\n   " + "Once per Long Rest, I can cast Freedom of Movement on myself without using a spell slot",
				source : [["X", 57], ["UA:RCO", 7]],
				submenu : "[warlock level  7+]",
				spellcastingBonus : {
					name : "Trickster's Escape",
					spells : ["freedom of movement"],
					selection : ["freedom of movement"],
					firstCol : 'oncelr'
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 7; },
				spellChanges : {
					"freedom of movement" : {
						range : "Self",
						description : "Magic can't reduce my speed, paralyze or restrain me; I can use 5 ft to escape nonmagical restrains",
						changes : "With the Trickster's Escape invocation I can cast Freedom of Movement, but only on myself."
					}
				},
			},
			"ultimate pact weapon (prereq: level 15 warlock, pact of the blade)" : {
				name : "Ultimate Pact Weapon",
				description : desc([
					"Any pact weapon I create is a +3 magic weapon, if it isn't already a magic weapon"
				]),
				source : [["UA:WnW", 5]],
				submenu : "[improves Pact of the Blade]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 15 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; },
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							// Test if this is a pact weapon, has no + bonus in its name, is not a magic weapon, and doesn't already have a improved pact weapon bonus
							var iPactWeaBonus = 3;
							if (v.pactWeapon && !v.thisWeapon[1] && !(v.theWea && v.theWea.isMagicWeapon) && ((!v.pactMag && !output.magic) || (v.pactMag && v.pactMag < iPactWeaBonus))) {
								if (v.pactMag) output.magic -= v.pactMag;
								v.pactMag = iPactWeaBonus;
								output.magic += v.pactMag;
							}
						},
						"If my Pact Weapon doesn't already include a magical bonus in its name or gets it from somewhere else and is not a magic weapon, the calculation will add +3 to its To Hit and Damage."
					]
				},
			},
			"undying servitude (prereq: level 5 warlock)" : {
				name : "Undying Servitude",
				description : "\n   Once per long rest, I can cast Animate Dead without using a spell slot.",
				source : [["T", 71]],
				submenu : "[warlock level  5+]",
				usages : 1,
				additional : "no spell slot",
				recovery : "long rest",
				spellcastingBonus : {
					name : "Undying Servitude",
					spells : ["animate dead"],
					selection : ["animate dead"],
					firstCol : "oncelr"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 5; },
			},
			"visions of distant realms (prereq: level 9 warlock)" : {
				name : "Visions of Distant Realms",
				description : desc("I can cast Arcane Eye at will, without using a spell slot."),
				source : [["UA23PT7", 31], ["SRD", 50], ["P", 111], ["MJ:HB", 0]],
				submenu : "[warlock level 9+]",
				spellcastingBonus : {
					name : "Visions of Distant Realms",
					spells : ["arcane eye"],
					selection : ["arcane eye"],
					firstCol : "atwill"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 9; },
			},
			"voice of the chain master (prereq: pact of the chain)" : {
				name : "Voice of the Chain Master",
				description : desc([
					"While on the same plane as my familiar, I can communicate telepathically with it at any range.",
					"Also, I can perceive through its senses and have it speak with my voice while doing so."
				]),
				source : [["SRD", 50], ["P", 111], ["MJ:HB", 0]],
				submenu : "[improves Pact of the Chain]",
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 3 && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the chain'; },
			},
			"whispers of the grave (prereq: level 7 warlock)" : {
				name : "Whispers of the Grave",
				description : desc("I can cast Speak with Dead at will, without using a spell slot."),
				source : [["UA23PT7", 31], ["SRD", 50], ["P", 111], ["MJ:HB", 0]],
				submenu : "[warlock level  7+]",
				spellcastingBonus : {
					name : "Whispers of the Grave",
					spells : ["speak with dead"],
					selection : ["speak with dead"],
					firstCol : "atwill"
				},
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 7; },
			},
			"witch sight (prereq: level 15 warlock)" : {
				name : "Witch Sight",
				description : desc("I have Truesight with a range of 30 ft."),
				source : [["UA23PT7", 31], ["SRD", 50], ["P", 111], ["MJ:HB", 0]],
				submenu : "[warlock level 15+]",
				vision : [["Witch sight (Truesight)", 30]],
				prereqeval : function(v) { return classes.known.warlock_ua23pt7.level >= 15; },
			}
		},
		"pact magic ua23pt7" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Pact Magic",
			source : [["UA23PT7", 27], ["SRD", 46], ["P", 107], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can cast Warlock cantrips/spells that I have prepared, using Charisma as my spellcasting ability.",
				"I can use an arcane focus as a spellcasting focus for my Warlock spells.",
				"I regain all expended Pact Magic spell slots on a Short or Long Rest.",
			]),
			additional : levels.map(function (n, idx) {
				var cantr = [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4][idx];
				var splls = [2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15][idx];
				var slots = n < 2 ? 1 : n < 11 ? 2 : n < 17 ? 3 : 4;
				var sllvl = n < 3 ? 1 : n < 5 ? 2 : n < 7 ? 3 : n < 9 ? 4 : 5;
				return cantr + " cantrips \u0026 " + splls + " spells prepared; " + slots + "\xD7 " + Base_spellLevelList[sllvl] + " spell slot";
			}),
			calcChanges : {
				spellList : [
					function(spList, spName, spType) {
						// Stop this is not the class' spell list or if this is for a bonus spell entry
						if (spName !== "warlock" && spType.indexOf("bonus") !== -1) return;
						spList.extraspells = spList.extraspells.concat(["bane", "detect magic", "speak with animals"]);
					},
					"Adds the \"Bane\", \"Detect Magic\", & \"Speak with Animals\" spells to the Warlock class' spell list.",
					101,
				]
			},
		},
		"magical cunning ua23pt7" : {
			name : "Magical Cunning",
			source : [["UA23PT7", 27], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"Once per Long Rest when all of my Pact Magic spell slots are expended, I can perform a ritual",
				"  for 1 minute to regain half of those spell slots (round up).",
			]),
			usages : 1,
			recovery : "long rest",
		},
		"subclassfeature3" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Otherworldly Patron",
			source : [["UA23PT7", 27], ["SRD", 46], ["P", 107], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc('Choose the Otherworldly Patron you have a bargain with and put it in the "Class" field ')
		},
		"contact patron ua23pt7" : {
			name : "Contact Patron",
			source : [["UA23PT7", 28], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"I now always have the Contact Other Plane spell prepared. Once per Long Rest, I can cast it",
				"  without using a spell slot to contact my patron, automatically succeeding on the saving throw.",
			]),
			spellcastingBonus : {
				name : "Contact Patron",
				spells : ["contact other plane"],
				selection : ["contact other plane"],
				times : 1,
			},
			usages : 1,
			recovery : "long rest",
		},
		"mystic arcanum ua23pt7" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Mystic Arcanum",
			source : [["UA23PT7", 28], ["SRD", 48], ["P", 108], ["MJ:HB", 0]],
			minlevel : 11,
			description : desc([
				"I can choose one spell from the warlock spell list of each level mentioned above.",
				"I can cast these spells each once per long rest without needing to use a spell slot.",
				"Whenever I gain a Warlock lvl, I can replace one of my arcanum spells with another of the same lvl.",
			]),
			additional : ["", "", "", "", "", "", "", "", "", "", "6th level", "6th level", "6th and 7th level", "6th and 7th level", "6th, 7th, and 8th level", "6th, 7th, and 8th level", "6th, 7th, 8th, and 9th level", "6th, 7th, 8th, and 9th level", "6th, 7th, 8th, and 9th level", "6th, 7th, 8th, and 9th level"],
			spellcastingBonus : [{
				name : "Mystic Arcanum (6th-level)",
				"class" : ["warlock", "warlock_ua23pt7"],
				level : [6, 6],
				firstCol : "oncelr"
			}, {
				name : "Mystic Arcanum (7th-level)",
				"class" : ["warlock", "warlock_ua23pt7"],
				level : [7, 7],
				firstCol : "oncelr",
				times : levels.map(function (n) { return n < 13 ? 0 : 1; })
			}, {
				name : "Mystic Arcanum (8th-level)",
				"class" : ["warlock", "warlock_ua23pt7"],
				level : [8, 8],
				firstCol : "oncelr",
				times : levels.map(function (n) { return n < 15 ? 0 : 1; })
			}, {
				name : "Mystic Arcanum (9th-level)",
				"class" : ["warlock", "warlock_ua23pt7"],
				level : [9, 9],
				firstCol : "oncelr",
				times : levels.map(function (n) { return n < 17 ? 0 : 1; })
			}],
		},
		"eldritch master ua23pt7" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Eldritch Master",
			source : [["UA23PT7", 28], ["SRD", 48], ["P", 108], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"When I use my Magical Cunning feature, I regain all used Pact Magic spells slots.",
			]),
			recovery : "long rest",
			usages : 1,
		},
	},
};

//// Add Warlock optional choices
AddFeatureChoice(ClassList.warlock_ua23pt7.features["pact magic ua23pt7"], true, "Access to Dunamancy Spells", {
	name : "Dunamancy Spells",
	extraname : "Optional Warlock 1",
	source : [["W", 186]],
	description : desc([
		"All dunamancy spells are added to the Warlock spell list, each still pending DM's approval"
	]),
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "warlock_ua23pt7" || (spType.indexOf("bonus") !== -1 && (!spList["class"] || spList["class"] !== "warlock_ua23pt7"))) return;
				spList.extraspells = spList.extraspells.concat(["sapping sting", "gift of alacrity", "magnify gravity", "fortune's favor", "immovable object", "wristpocket", "pulse wave", "gravity sinkhole", "temporal shunt", "gravity fissure", "tether essence", "dark star", "reality break", "ravenous void", "time ravage"]);
			},
			"This optional class feature expands the spell list of the Warlock class with all dunamancy spells (spell level in brackets): Sapping Sting (cantrip), Gift of Alacrity (1), Magnify Gravity (1), Fortune's Favor (2), Immovable Object (2), Wristpocket (2), Pulse Wave (3), Gravity Sinkhole (4), Temporal Shunt (5), Gravity Fissure (6), Tether Essence (7), Dark Star (8), Reality Break (8),Ravenous Void (9), and Time Ravage (9)."
		]
	}
}, "Optional 1st-level warlock features");
AddFeatureChoice(ClassList.warlock_ua23pt7.features["pact magic ua23pt7"], true, "Additional Warlock Spells", {
	name : "Additional Warlock Spells",
	extraname : "Optional Warlock 1",
	source : [["T", 70]],
	description : "",
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "warlock_ua23pt7" || (spType.indexOf("bonus") !== -1 && (!spList["class"] || spList["class"] !== "warlock_ua23pt7"))) return;
				spList.extraspells = spList.extraspells.concat(["mislead", "planar binding", "teleportation circle", "gate", "weird"]);
			},
			"This optional class feature expands the spell list of the Warlock class with the following spells (spell level in brackets): Mislead (5), Planar Binding (5), Teleportation Circle (5), Gate (9), and Weird (9)."
		]
	}
}, "Optional 1st-level warlock features");
AddFeatureChoice(ClassList.warlock_ua23pt7.features["magical cunning ua23pt7"], true, "Eldritch Versatility", {
	name : "Eldritch Versatility",
	extraname : "Optional Warlock 4",
	source : [["T", 70]],
	description : " [ASI = Ability Score Improvement]" + desc([
		"Whenever I gain an ASI from the warlock class, I can change one of the following things:",
		" \u2022 I can replace one warlock cantrip with another cantrip from the warlock spell list",
		" \u2022 I can replace my pact boon for another",
		" \u2022 If I have Mystic Arcanum, I can replace one spell from it with another of the same level"
	]),
	prereqeval : function (v) { return classes.known.warlock_ua23pt7.level >= 4 ? true : "skip"; }
}, "Optional 4th-level warlock features");
/*AddFeatureChoice(ClassList.warlock_ua23pt7.features["pact magic ua23pt7"], true, "Pact of the Blade Mastery Properties", {
	name : "Pact of the Blade Mastery Properties",
	extraname : "Optional Warlock 1",
	source : [["UA23PT7", 30], ["SRD", 47], ["P", 107], ["MJ:HB", 0]],
	description : desc([
		"This feature adds the appropriate Mastery Property to my pact weapons.",
	]),
	calcChanges : {
		atkAdd : [
			function (fields, v) {
				masteryFunctions.weaponMasteryAtkAdd[0](fields, v, true);
			},
			'My pact weapon gets its mastery feature added to its description.',
			291
		]
	},
	prereqeval : function (v) { return classes.known.warlock_ua23pt7.level >= 2 ? true : "skip" && GetFeatureChoice('class', 'warlock_ua23pt7', 'eldritch invocations ua23pt7') == 'pact of the blade'; }
}, "Optional 1st-level warlock features");*/

////// Add UA23PT7 Archfey Patron Warlock subclass
AddSubClass("warlock_ua23pt7", "the archfey", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /^(?=.*fey)(?=.*warlock).*$/i,
	subname : "the Archfey",
	source : [["UA23PT7", 31], ["P", 109], ["MJ:HB", 0]],
	spellcastingExtra : ["misty step", "faerie fire", "sleep", "calm emotions", "phantasmal force", "blink", "plant growth", "dominate beast", "greater invisibility", "dominate person", "seeming"],
	features : {
		"subclassfeature3" : {
			name : "Steps of the Fey",
			source : [["UA23PT7", 32], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can cast Misty Step Cha mod (min 1) times without using a spell slot per Long Rest.",
				"I can choose to apply one of the following additional effects when I cast the spell:",
				" \u2022 Refreshing Step. Immediately after I teleport, one creature I can see within 10 feet",
				"  of me gains 1d10 Temporary Hit Points.",
				" \u2022 Taunting Step. Creatures within 5 feet of the space I left must succeed on a Wis saving throw",
				"  or have Disadv. on attack rolls against creatures other than me until the start of my next turn.",
			]),
			usages : "Charisma modifier per ",
			usagescalc : "event.value = Math.max(1, What('Cha Mod'));",
			recovery : "long rest",
			action : ["bonus action", ""]
		},
		"subclassfeature6" : {
			name : "Misty Escape",
			source : [["UA23PT7", 32], ["P", 109], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"As a Reaction, when I take damage, I can cast Misty Step; Additionally, the following effects",
				"  are among my Steps of the Fey options:",
				" \u2022 Disappearing Step. I can turn Invisible until the start of my next turn or until I",
				"  attack or cast a spell.",
				" \u2022 Dreadful Step. Creatures within 5 feet of the space I left or the space I appear in",
				"  (my choice) must succeed on a Wis saving throw or take 2d10 Psychic damage.",
			]),
			action : ["reaction", " (taking damage)"],
		},
		"subclassfeature10" : {
			name : "Beguiling Defenses",
			source : [["UA23PT7", 32], ["P", 109], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"Once per Long Rest, I can use a Reaction when a creature hits me with an attack roll,",
				"  reducing the damage I take by half (round down), and I can force the attacker to make a",
				"  Wis save or take Psychic damage equal to the damage I took.",
				"Additionally, I am immune to being charmed.",
			]),
			recovery : "long rest",
			usages : 1,
			action : ["reaction", " (when damaged)"],
			savetxt : { immune : ["charmed"] },
		},
		"subclassfeature14" : {
			name : "Bewitching Magic",
			source : [["UA23PT7", 32], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"Immediately after casting an Enchantment or Illusion spell using an action \u0026 a spell slot,",
				"  I can cast Misty Step as part of the same action \u0026 without using a spell slot.",
			]),
		},
	},
});

////// Add UA23PT7 Celestial Patron Warlock subclass
AddSubClass("warlock_ua23pt7", "the celestial", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /^(?=.*warlock)(?=.*celestial).*$/i,
	subname : "the Celestial",
	source : [["UA23PT7", 32], ["X", 54], ["MJ:HB", 0]],
	spellcastingExtra : ["cure wounds", "cure wounds ua23pt8", "guiding bolt", "flaming sphere", "lesser restoration", "daylight", "revivify", "guardian of faith", "wall of fire", "flame strike", "greater restoration"],
	features : {
		"subclassfeature3" : {
			name : "Bonus Cantrips",
			source : [["UA23PT7", 33], ["X", 54]],
			minlevel : 3,
			description : "\n   " + "I learn the Light and Sacred Flame cantrips, not counting for the number I can know.",
			spellcastingBonus : [{
				name : "Bonus Cantrips",
				spells : ["light"],
				selection : ["light"]
			}, {
				name : "Bonus Cantrips",
				spells : ["sacred flame"],
				selection : ["sacred flame"]
			}],
		},
		"subclassfeature3.1" : {
			name : "Healing Light",
			source : [["UA23PT7", 33], ["X", 54], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I can heal a creature I can see within 60 ft by expending dice.",
				"I can expend up to my Charisma modifier (min 1) of dice from my pool at a time.",
				"The target heals HP equal to the roll of the dice; I regain all expended dice on a Long Rest."
			]),
			usages : levels.map(function (n) { return (n + 1) + "d6 per "; }),
			usagescalc : "event.value = !classes.known.warlock_ua23pt7 ? '' : (1 + classes.known.warlock_ua23pt7.level) + 'd6';",
			recovery : "long rest",
			action : ["bonus action", ""]
		},
		"subclassfeature6" : {
			name : "Radiant Soul",
			source : [["UA23PT7", 33], ["X", 55]],
			minlevel : 6,
			description : desc([
				"I add my Cha modifier once to the Fire or Radiant damage of cantrips and spells I cast.",
				"This bonus only applies to one target; Also, I have Resistance to Radiant damage."
			]),
			dmgres : ["Radiant"],
			calcChanges : {
				atkCalc : [
					function (fields, v, output) {
						if (v.isSpell && (/fire|radiant/i).test(fields.Damage_Type)) {
							output.extraDmg += What('Cha Mod');
						}
					},
					"Cantrips and spells that fire or radiant damage get my Charisma modifier added to their damage to one target."
				],
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (!spellObj.psionic) return genericSpellDmgEdit(spellKey, spellObj, "fire|radiant", "Cha", true);
					},
					"Cantrips and spells that fire or radiant damage get my Charisma modifier added to their damage to one target."
				]
			}
		},
		"subclassfeature10" : {
			name : "Celestial Resilience",
			source : [["UA23PT7", 33], ["X", 55], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"When I finish a Short or Long Rest, or I use my Magical Cunning feature, I and up to five allies",
				"  gain Temp HP. I get my Warlock level + Cha mod, while my allies get half my Warlock level + Cha mod.",
			]),
			additional : levels.map(function (n) { return n < 10 ? "" : "Me: " + n + "+Cha mod; Allies: " + Math.floor(n / 2) + "+Cha mod"; })
		},
		"subclassfeature14" : {
			name : "Searing Vengeance",
			source : [["UA23PT7", 33], ["X", 55], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"At the start of my turn when I would make a death save, I can instead spring back up.",
				"I recover HP equal to half my current HP maximum, and can then stand up if I choose.",
				"When I recover HP in this manner, creatures of my choice within 30 ft take 2d8 + Cha mod in",
				"  Radiant damage, becoming Blinded until the end of my current turn."
			]),
			usages : 1,
			recovery : "long rest"
		},
	},
});

////// Add UA23PT7 Fiend Patron Warlock subclass
AddSubClass("warlock_ua23pt7", "the fiend", { //Ripped directly from "ListsClasses.js" and then altered
	regExpSearch : /^(?=.*(fiend|devil|demon|daemon|hell|abyss))(?=.*warlock).*$/i,
	subname : "the Fiend",
	source : [["UA23PT7", 33], ["SRD", 50], ["P", 109], ["MJ:HB", 0]],
	spellcastingExtra : ["burning hands", "command", "suggestion", "scorching ray", "fireball", "stinking cloud", "fire shield", "wall of fire", "geas", "insect plague"],
	features : {
		"subclassfeature3" : {
			name : "Dark One's Blessing",
			source : [["UA23PT7", 34], ["SRD", 50], ["P", 109], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"When myself or another within 10 ft of me reduce a hostile to 0 HP, I gain spellcasting mod +",
				"  Warlock level Temp HP (min 1).",
			]),
		},
		"subclassfeature6" : {
			name : "Dark One's Own Luck",
			source : [["UA23PT7", 34], ["SRD", 50], ["P", 109], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"When I make an ability check or saving throw, I can add 1d10 after rolling the d20.",
				"I can do this spellcasting mod (min 1) times per Long Rest, but no more than once per roll.",
			]),
			recovery : "long rest",
			usages : "Charisma modifier per ",
			usagescalc : "event.value = Math.max(1, What('Cha Mod'));",
		},
		"subclassfeature10" : {
			name : "Fiendish Resilience",
			source : [["UA23PT7", 34], ["SRD", 51], ["P", 109], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"After a Short or Long Rest, I can choose one damage type, other than Force, to become Resistant to.",
				"This lasts until I choose another type."
			])
		},
		"subclassfeature14" : {
			name : "Hurl Through Hell",
			source : [["UA23PT7", 34], ["SRD", 51], ["P", 109], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"When I hit a creature with an attack roll, I can instantly transport it through Lower Planes.",
				"Target must succeed a Cha save or it disappears \u0026 hurtles through a nightmarish landscape.",
				"It takes 8d10 Psychic damage if not a Fiend, is Incapacitated, \u0026 reappears where it left or in",
				"  the nearest unoccupied space at the end of my next turn, at which point it is no longer Incapacitated.",
				"I can only use this feature once per Long Rest.",
			]),
			recovery : "long rest",
			usages : 1,
		},
	},
});

////// Add UA23PT7 Great Old One Patron Warlock subclass
AddSubClass("warlock_ua23pt7", "the great old one", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /^(((?=.*(tharizdun|cthulhu))(?=.*warlock))|((?=.*(great|dread))(?=.*(ancient|old))(?=.*\b(one|entity)\b))).*$/i,
	subname : "the Great Old One",
	source : [["UA23PT7", 34], ["P", 110], ["MJ:HB", 0]],
	spellcastingExtra : ["dissonant whispers", "tasha's hideous laughter", "detect thoughts", "phantasmal force", "clairvoyance", "sending", "dominate beast", "evard's black tentacles", "dominate person", "telekinesis"],
	features : {
		"subclassfeature3" : {
			name : "Awakened Mind",
			source : [["UA23PT7", 35], ["P", 110], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can telepathically speak with another creature I can see within 30 ft.",
				"Myself \u0026 the chosen creature can speak telepathically with each other while we are within",
				"  Cha mod (min 1) number of miles of each other. The other can understand me only if I speak",
				"  mentally in a language they know.",
				"This connection lasts for a number of minutes equal to my Warlock level, \u0026 ends early if I",
				"  gain the Incapacitated condition, die, or I use this feature with another creature.",
			]),
		},
		"subclassfeature3.1" : {
			name : "Psychic Spells",
			source : [["UA23PT7", 35], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can change the damage type of my Warlock spells to Psychic damage.",
				"I can cast Enchantment \u0026 Illusion Warlock spells without verbal or somatic components.",
			]),
		},
		"subclassfeature6" : {
			name : "Clairvoyant Combatant",
			source : [["UA23PT7", 35], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"When I connect with a creature using my Awakened Mind feature, I can force that creature to make",
				"  a Wis save. If it fails, it has Disadv. on attack rolls against me, \u0026 I have Adv. on attack",
				"  rolls against it. These effects last for the duration of the bond.",
				"I can do this once per Short or Long Rest, or by expending a 2nd-level or higher spell slot (SS 2+)",
			]),
			recovery : "short rest",
			usages : 1,
			altResource : "SS 2+",
		},
		"subclassfeature10" : {
			name : "Thought Shield",
			source : [["UA23PT7", 35], ["P", 110], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"No one can read my mind unless I allow it; I have Resistance to Psychic damage.",
				"When I take Psychic damage, the dealer of the Psychic damage takes the same amount.",
			]),
			dmgres : ["Psychic"]
		},
		"subclassfeature10.1" : {
			name : "Eldritch Hex",
			source : [["UA23PT7", 35], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"I always have the Hex spell prepared; The target of my Hex spells also have Disadv. on saving throws.",
			]),
			spellcastingBonus : {
				name : "Eldritch Hex",
				spells : ["hex"],
				selection : ["hex"],
				times : 1,
			},
			spellChanges : {
				"hex" : {
					description : "1 crea +1d6 Necrotic dmg from my atks; Dis. on chosen ability checks \u0026 saves; SL3: conc, 8h; SL5: conc, 24h",
					descriptionShorter : "1 crea +1d6 Necrotic dmg from my atks; Dis. chosen abi chks \u0026 saves; SL3: conc, 8h; SL5: conc, 24h",
					descriptionFull : "You place a curse on a creature that you can see within range. Until the spell ends, you deal an extra 1d6 necrotic damage to the target whenever you hit it with an attack. Also, choose one ability when you cast the spell. The target has disadvantage on ability checks \u0026 saving throws made with the chosen ability." + "\n   " + "If the target drops to 0 hit points before this spell ends, you can use a Bonus Action on a subsequent turn of yours to curse a new creature." + "\n   " + "A Remove Curse cast on the target ends this spell early." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd or 4th level, you can maintain your concentration on the spell for up to 8 hours. When you use a spell slot of 5th level or higher, you can maintain your concentration on the spell for up to 24 hours.",
					changes : "The target of my Hex spells also have Disadv. on saving throws.",
				},
			},
		},
		"subclassfeature14" : {
			name : "Create Thrall",
			source : [["UA23PT7", 35], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"I always have the Summon Aberration spell prepared; When I cast the spell, I can modify it so",
				"  that it doesn't require Concentration. If I do so, the spell's duration becomes 1 minute and",
				"  when summoned, the Aberration has a number of Temp HP equal to my Warlock level + Cha mod.",
				"Additionally, the first time each turn the Aberration hits a creature under the effects of my Hex",
				"  spell, the Aberration deals extra Psychic damage equal to the bonus damage of the Hex spell.",
			]),
			spellcastingBonus : {
				name : "Create Thrall",
				spells : ["summon aberration"],
				selection : ["summon aberration"],
			},
		},
	},
});

// Add UA23PT7 Wizard class
ClassList.wizard_ua23pt7 = {
	name : "Wizard (UA:PT-vii)",
	regExpSearch : /^(?=.*(wizard|mage))(?!.*wild mage).*$/i,
	source : [["UA23PT7", 36], ["MJ:HB", 0]],
	primaryAbility : "Intelligence",
	prerequisite : "Intelligence 13+",
	prereqeval : function(v) {
		return What('Int') >= 13;
	},
	die : 6,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
	saves : ["Int", "Wis"],
	skills : ["\n\n" + toUni("Wizard") + ": Choose two from Arcana, History, Insight, Investigation, Medicine, Religion", ""],
	armor : [
		[false, false, false, false],
		[false, false, false, false],
	],
	weapons : [
		[false, false, [""]],
		[false, false, [""]],
	],
	equipment : "Wizard starting equipment:" +
		"\n \u2022 Arcane Focus (Quarterstaff)," +
		"\n \u2022 Dagger (2)," +
		"\n \u2022 Robe," +
		"\n \u2022 Scholar's Pack," +
		"\n \u2022 and 5 gp;" +
		"\n\nAlternatively, choose 55 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Arcane Tradition", []],
	attacks : [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
	abilitySave : 4,
	spellcastingFactor : 1,
	spellcastingKnown : {
		cantrips : [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
		spells : "book",
		prepared : true,
	},
	features : {
		"arcane recovery ua23pt7" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Arcane Recovery",
			source : [["UA23PT7", 37], ["SRD", 53], ["P", 115], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"Once per Long Rest, after a Short Rest, I can recover a number of 5th-level or lower spell slots.",
				"The recovered spell slots can have a combined level \u003c half my Wizard lvl (rounded up).",
			]),
			additional : levels.map(function (n) {
				var lvls = Math.ceil(n / 2);
				return lvls + " level" + (lvls > 1 ? "s" : "") + " of spell slots";
			}),
			usages : 1,
			recovery : "long rest",
		},
		"spellcasting ua23pt7" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Spellcasting",
			source : [["UA23PT7", 38], ["SRD", 52], ["P", 114], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can cast prepared Wizard cantrips/spells, using Intelligence as my spellcasting ability.",
				"I can use an Arcane Focus as a spellcasting focus for my Wizard spells.",
				"I can cast all Wizard spells in my spellbook as Rituals if they have the Ritual tag.",
				"I can copy any leveled spell I find into my spellbook at a cost of 2 hours \u0026 50gp per lvl.",
				"Whenever I gain a Wizard lvl after 1, I can add 2 Wizard spells of my to choice my spellbook;",
				"  Each of these spells must be of a lvl for which I have spell slots.",
				"I can copy a spell from my own spellbook into another book at a cost of 1 hour \u0026 10gp per",
				"  level. If I lose my spellbook, I can use the same procedure to transcribe my prepared Wizard",
				"  spells into a new spellbook.",
			]),
			/*	I have added language to the description regarding the copying of spells into a spellbook, how
				many spells a Wizard gets upon lvl up, & the cost of replacing/copying the spellbook; I'd
				personally rather have that info explicitly on the sheet than have to look it up every time it
				comes up. I know doing so tripled the length of the description, but I personally feel it is
				worth it. You can change it back if you want when you make the official revision updates to the
				class code, Joost.		-MasterJedi2014	*/
			additional : levels.map(function (n, idx) {
				return [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5][idx] + " cantrips known";
			}),
		},
		"scholar ua23pt7" : function() { //Copied directly from the Rogue's "Expertise" feature in "ListsClasses.js" and then altered
			var a = {
				name : "Scholar",
				source : [["UA23PT7", 39], ["MJ:HB", 0]],
				minlevel : 2,
				description : desc([
					"I specialized in an academic field of study. I gain Expertise in one of the following skills in",
					"  which I already have Proficiency: Arcana, History, Nature, or Religion.",
				]),
				skillstxt : "Expertise in one of the following skills in which I already have Proficiency: Arcana, History, Nature, or Religion.",
				extraname : "Expertise",
				extrachoices : ["Arcana", "History", "Nature", "Religion"],
				extraTimes : 1,
			};
			for (var i = 0; i < a.extrachoices.length; i++) {
				var attr = a.extrachoices[i].toLowerCase();
				if (a[attr]) continue;
				a[attr] = {
					name : a.extrachoices[i] + " Expertise",
					description : "",
					source : a.source,
					skills : [[a.extrachoices[i], "only"]],
					prereqeval : function(v) {
						return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
					}
				};
			}
			return a;
		}(),
		"subclassfeature3" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Arcane Tradition",
			source : [["UA23PT7", 39], ["SRD", 53], ["P", 115], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc('Choose the Arcane Tradition you studied and put it in the "Class" field '),
		},
		"memorize spell ua23pt7" : { //Original to the UA Wizard
			name : "Memorize Spell",
			source : [["UA23PT7", 39], ["MJ:HB", 0]],
			minlevel : 5,
			description : desc([
				"I can study my spellbook for 1 minute and prepare one extra 1st-lvl or higher spell from my",
				"  spellbook that wasn't already prepared. This spell is prepared until I use this feature to",
				"  prepare a different spell.",
			]),
		},
		"spell mastery ua23pt7" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Spell Mastery",
			source : [["UA23PT7", 39], ["SRD", 53], ["P", 115], ["MJ:HB", 0]],
			minlevel : 18,
			description : desc([
				"After a Long Rest, I can pick a 1st and 2nd-level spell in my spellbook;",
				"While prepared, I can cast them at their lowest levels without expending spell slots;",
				"I must expend a spell slot to cast these spells at a higher level.",
			]),
		},
		"signature spells ua23pt7" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Signature Spells",
			source : [["UA23PT7", 39], ["SRD", 54], ["P", 115], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"Two 3rd-level spells of my choice in my spellbook will always count as prepared.",
				"I can cast both at third level once per Short Rest or Long Rest without expending spell slots.",
				"I must expend a spell slot to cast these spells at a higher level.",
			]),
			recovery : "short rest",
			usages : 2,
		},
	},
};

//// Add Wizard optional choices
AddFeatureChoice(ClassList.wizard_ua23pt7.features["arcane recovery ua23pt7"], true, "Cantrip Formulas", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	name : "Cantrip Formulas",
	extraname : "Optional Wizard 3",
	source : [["T", 76]],
	description : desc([
		"I have scribed arcane formulas in my spellbook with which I formulate cantrips in my mind.",
		"Whenever I finish a Long Rest, I can use this to change a Wizard cantrip I know for another.",
	]),
	prereqeval : function (v) { return classes.known.wizard_ua23pt7.level >= 3 ? true : "skip"; },
}, "Optional 3rd-level wizard features");

////// Add UA23PT7 Abjurer Wizard subclass
AddSubClass("wizard_ua23pt7", "abjuration", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /(abjuration|abjurer)/i,
	subname : "School of Abjuration",
	fullname : "Abjurer",
	source : [["UA23PT7", 40], ["P", 115], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Abjuration Savant",
			source : [["UA23PT7", 40], ["P", 115], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can add two Abjuration spells from the Wizard spell list, each 2nd-lvl or lower, to my spellbook",
				"  for free. Additionally, when I gain a new level of spell slots in this class, I can add one",
				"  Abjuration spell from the Wizard spell list to my spellbook for free.",
			]), //The following code for this feature was ripped from the Eldritch Knight and then altered
			additional : ["", "", "2 Abjur. spells", "2 Abjur. spells", "3 Abjur. spells", "3 Abjur. spells", "4 Abjur. spells", "4 Abjur. spells", "5 Abjur. spells", "5 Abjur. spells", "6 Abjur. spells", "6 Abjur. spells", "7 Abjur. spells", "7 Abjur. spells", "8 Abjur. spells", "8 Abjur. spells", "9 Abjur. spells", "9 Abjur. spells", "10 Abjur. spells", "10 Abjur. spells"],
			spellcastingBonus : {
				name : "From the Abjuration school",
				"class" : ["wizard", "wizard_ua23pt7"],
				school : ["Abjur"],
				times : [0, 0, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10],
			},
		},
		"subclassfeature3.1" : {
			name : "Arcane Ward",
			source : [["UA23PT7", 40], ["P", 115], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"Whenever I cast an 1st-level or higher Abjuration spell with a spell slot, I make/heal a ward.",
				"I make it at max HP; When I cast an Abjur. spell again, it heals 2 HP per spell slot lvl.",
				"I can alternatively expend a spell slot as a Bonus Action to heal the ward 2 HP per slot lvl.",
				"It stays active at 0 HP and doesn't go away until I finish my next Long Rest.",
				"If I take damage, the ward takes the damage instead, but excess damage carries over to me.",
			]),
			additional : levels.map( function(n) {
				return n < 2 ? "" : "Ward max HP: " + (n * 2) + "+Int mod";
			}),
			usages : 1,
			recovery : "long rest",
			action : ["bonus action", "Heal Arcane Ward (2HP/SL)"],
		},
		"subclassfeature6" : {
			name : "Projected Ward",
			source : [["UA23PT7", 40], ["P", 115]],
			minlevel : 6,
			description : "\n   " + "As a Reaction, my Arcane Ward can absorb damage done to a creature within 30 ft.",
			action : ["reaction", ""],
		},
		"subclassfeature10" : {
			name : "Spell Breaker", //Previously known as "Improved Abjuration"
			source : [["UA23PT7", 40], ["P", 115], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"I now always have the Dispel Magic spell prepared.",
				"Additionally, I can add my Proficiency Bonus to its ability check.",
			]),
			spellcastingBonus : {
				name : "Spell Breaker",
				spells : ["dispel magic"],
				selection : ["dispel magic"],
				times : 1,
				firstCol : "markedbox",
			},
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (spellKey === "dispel magic") {
							var profB = Number(How("Proficiency Bonus"));
							var checkStr = "(" + AbilityScores.names.join("|") + "|spell(casting)?( ability )?) check";
							var checkRx = RegExp(checkStr + " \\(([+-]?\\d+)\\)", "i");
							var theBonus = profB;
							if (checkRx.test(spellObj.description)) {
								var theMatch = spellObj.description.match(checkRx);
								theBonus += Number(theMatch[2]);
								if (tDoc.getField("Remarkable Athlete").isBoxChecked(0) === 1 && theMatch[1].test(/Str|Dex|Con/i)) {
									theBonus -= Math.ceil(profB/2);
								} else if (tDoc.getField("Jack of All Trades").isBoxChecked(0) === 1) {
									theBonus -= Math.floor(profB/2);
								}
							} else {
								var theMatch = spellObj.description.match(RegExp(checkStr, "i"));
							}
							spellObj.description = spellObj.description.replace(theMatch[0], theMatch[1] + " check (" + (theBonus >= 0 ? "+" : "") + theBonus + ")");
							return true;
						}
					},
					"I add my Proficiency Bonus to ability checks required by Dispel Magic. This is shown on the spell sheet by a lowered DC on the check."
				]
			},
		},
		"subclassfeature14" : {
			name : "Spell Resistance",
			source : [["UA23PT7", 40], ["P", 116], ["MJ:HB", 0]],
			minlevel : 14,
			description : "\n   " + "I have Adv. on spell saves and Resistance to spell damage.",
			dmgres : ["Spells"],
			savetxt : { adv_vs : ["spells"] },
		},
	},
});

////// Add UA23PT7 Diviner Wizard subclass
AddSubClass("wizard_ua23pt7", "divination", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /(divination|diviner|divinator)/i,
	subname : "School of Divination",
	fullname : "Diviner",
	source : [["UA23PT7", 40], ["P", 116], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Divination Savant",
			source : [["UA23PT7", 40], ["P", 116], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([ //The following code for this feature was ripped from the Abjurer above and then altered
				"I can add two Divination spells from the Wizard spell list, each 2nd-lvl or lower, to my spellbook",
				"  for free. Additionally, when I gain a new level of spell slots in this class, I can add one",
				"  Divination spell from the Wizard spell list to my spellbook for free.",
			]),
			additional : ["", "", "2 Div. spells", "2 Div. spells", "3 Div. spells", "3 Div. spells", "4 Div. spells", "4 Div. spells", "5 Div. spells", "5 Div. spells", "6 Div. spells", "6 Div. spells", "7 Div. spells", "7 Div. spells", "8 Div. spells", "8 Div. spells", "9 Div. spells", "9 Div. spells", "10 Div. spells", "10 Div. spells"],
			spellcastingBonus : {
				name : "From the Divination school",
				"class" : ["wizard", "wizard_ua23pt7"],
				school : ["Div"],
				times : [0, 0, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10],
			},
		},
		"subclassfeature3.1" : {
			name : "Portent",
			source : [["UA23PT7", 41], ["P", 116], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"After a Long Rest, I roll dice and keep the results to be used before my next rest.",
				"A result can replace any d20 Test made by me or a creature I can see.",
				"I choose to switch them before the dice to be replaced are rolled; Max once per turn.",
			]),
			additional : levels.map( function(n) {
				return n < 2 ? "" : (n < 14 ? 2 : 3) + "d20 after a long rest";
			}),
		},
		"subclassfeature6" : {
			name : "Expert Divination",
			source : [["UA23PT7", 41], ["P", 116], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"When I cast a Divination spell \u2265 2nd-lvl using a spell slot, I regain 1 spent spell slot",
				"  of a lower level than the one I cast \u0026 \u003c 5th-lvl.",
			]),
		},
		"subclassfeature10" : {
			name : "The Third Eye",
			source : [["UA23PT7", 41], ["P", 116], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"As a Bonus Action, I gain one of the following benefits until my next Short or Long Rest:",
				"  Darkvision 60ft, cast See Invisibility for free, or read any language.",
			]),
			recovery : "short rest",
			usages : 1,
			action : ["bonus action", ""],
		},
		"subclassfeature14" : {
			name : "Greater Portent",
			source : [["UA23PT7", 41], ["P", 117]],
			minlevel : 14,
			description : "\n   " + "I can roll 3d20 instead of 2d20 when using my Portent feature."
		},
	},
});

////// Add UA23PT7 Evoker Wizard subclass
AddSubClass("wizard_ua23pt7", "evoker", { //Ripped directly from "ListsClasses.js" and then altered
	regExpSearch : /(evocation|evocer|evoker)/i,
	subname : "School of Evocation",
	fullname : "Evoker",
	source : [["UA23PT7", 41], ["SRD", 54], ["P", 117], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Evocation Savant",
			source : [["UA23PT7", 41], ["SRD", 54], ["P", 117], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([ //The following code for this feature was ripped from the Abjurer above and then altered
				"I can add two Evocation spells from the Wizard spell list, each 2nd-lvl or lower, to my spellbook",
				"  for free. Additionally, when I gain a new level of spell slots in this class, I can add one",
				"  Evocation spell from the Wizard spell list to my spellbook for free.",
			]),
			additional : ["", "", "2 Evoc. spells", "2 Evoc. spells", "3 Evoc. spells", "3 Evoc. spells", "4 Evoc. spells", "4 Evoc. spells", "5 Evoc. spells", "5 Evoc. spells", "6 Evoc. spells", "6 Evoc. spells", "7 Evoc. spells", "7 Evoc. spells", "8 Evoc. spells", "8 Evoc. spells", "9 Evoc. spells", "9 Evoc. spells", "10 Evoc. spells", "10 Evoc. spells"],
			spellcastingBonus : {
				name : "From the Evocation school",
				"class" : ["wizard", "wizard_ua23pt7"],
				school : ["Evoc"],
				times : [0, 0, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10],
			},
		},
		"subclassfeature3.1" : {
			name : "Potent Cantrip",
			source : [["UA23PT7", 41], ["SRD", 54], ["P", 117], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc("Any cantrips I cast still deal half damage on a successful save or if I miss the atk roll."),
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.isSpell && v.isDC && v.thisWeapon[3] && SpellsList[v.thisWeapon[3]].save) {
							fields.Description = fields.Description.replace(/ success - no( damage|thing)/ , "success - half damage");
						}
						if (v.isSpell && !v.isDC && v.thisWeapon[3] && !SpellsList[v.thisWeapon[3]].save) {
							fields.Description += (fields.Description ? '; ' : '') + 'half damage on a miss';
						}
					},
					"My cantrips still do half damage on a successful saving throw or if I miss the atk roll, but none of their other effects."
				],
				spellAdd : [ //I am not experienced enough at JS coding to alter this part correctly, so I am going to leave this part as is for now.
					function (spellKey, spellObj, spName) {
						if (spellObj.psionic || spellObj.level || !spellObj.save || !(/\d+d\d+/).test(spellObj.description)) return;
						var startDescr = spellObj.description;
						spellObj.description = spellObj.description.replace("at CL 5, 11, and 17", "CL 5, 11, 17").replace(/damage/ig, "dmg").replace(/creatures?/ig, "crea").replace("save or ", "").replace("at casting or entering", "at cast/enter").replace(/(; \+\d+d\d+.*$|$)/, "; save: half dmg only$1");
						switch (spellKey) {
							case "lightning lure" :
								spellObj.description = spellObj.description.replace(/(Lightn|pull)(ing|ed)/gi, "$1");
								break;
							case "create bonfire" :
								spellObj.description = spellObj.description.replace("half dmg only", "half dmg");
								break;
						}
						return startDescr !== spellObj.description;
					}, //The below line is the only line of this part of the code I have altered at the moment.
					"My cantrips still do half damage on a successful saving throw or if I miss the atk roll, but none of their other effects."
				],
			},
		},
		"subclassfeature6" : {
			name : "Sculpt Spells",
			source : [["UA23PT7", 41], ["SRD", 54], ["P", 117]],
			minlevel : 3,
			description : desc([
				"If I cast an Evocation spell affecting others I can see, I can protect 1 + the spell's level.",
				"The chosen automatically succeed on their saving throws vs. the spell.",
				"They also take no damage if the spell would normally deal half damage on a save."
			]),
		},
		"subclassfeature10" : {
			name : "Empowered Evocation",
			source : [["UA23PT7", 41], ["SRD", 54], ["P", 117], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc("I can add my Int modifier to a single damage roll of any Wizard Evocation spell I cast."),
			calcChanges : {
				atkCalc : [
					function (fields, v, output) {
						if (v.thisWeapon[4].indexOf("wizard") !== -1 && SpellsList[v.thisWeapon[3]] && SpellsList[v.thisWeapon[3]].school === "Evoc") {
							output.extraDmg += What('Int Mod');
						}
					},
					"I add my Intelligence modifier to a single damage roll of any Wizard Evocation spell I cast."
				],
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (spName.indexOf("wizard") !== -1 && !spellObj.psionic && spellObj.school === "Evoc") return genericSpellDmgEdit(spellKey, spellObj, "\\w+\\.?", "Int", true);
					},
					"I add my Intelligence modifier to a single damage roll of any Wizard Evocation spell I cast."
				],
			},
		},
		"subclassfeature14" : {
			name : "Overchannel",
			source : [["UA23PT7", 42], ["SRD", 54], ["P", 118]],
			minlevel : 14,
			description : desc([
				"When I cast a 5th-lvl or lower Wizard spell that damages, it can deal max damage on the turn",
				"  I cast it. Every time I do this after the first instance before taking a Long Rest, I suffer",
				"  2d12 Necrotic dmg per spell lvl. This necrotic damage ignores Resistances/Immunities.",
				"I can't overchannel cantrips."
			]),
			extraLimitedFeatures : [{
				name : "Overchannel",
				recovery : "long rest",
				usages : "1 + \u221E"
			}],
		},
	},
});

////// Add UA23PT7 Illusionist Wizard subclass
AddSubClass("wizard_ua23pt7", "illusion", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /(illusion|illusionist|illusionary)/i,
	subname : "School of Illusion",
	fullname : "Illusionist",
	source : [["UA23PT7", 42], ["P", 118], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Illusion Savant",
			source : [["UA23PT7", 42], ["P", 118], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([ //The following code for this feature was ripped from the Abjurer above and then altered
				"I can add two Illusion spells from the Wizard spell list, each 2nd-lvl or lower, to my spellbook",
				"  for free. Additionally, when I gain a new level of spell slots in this class, I can add one",
				"  Illusion spell from the Wizard spell list to my spellbook for free.",
			]),
			additional : ["", "", "2 Illus. spells", "2 Illus. spells", "3 Illus. spells", "3 Illus. spells", "4 Illus. spells", "4 Illus. spells", "5 Illus. spells", "5 Illus. spells", "6 Illus. spells", "6 Illus. spells", "7 Illus. spells", "7 Illus. spells", "8 Illus. spells", "8 Illus. spells", "9 Illus. spells", "9 Illus. spells", "10 Illus. spells", "10 Illus. spells"],
			spellcastingBonus : {
				name : "From the Illusion school",
				"class" : ["wizard", "wizard_ua23pt7"],
				school : ["Illus"],
				times : [0, 0, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10],
			},
		},
		"subclassfeature3.1" : {
			name : "Improved Minor Illusion",
			source : [["UA23PT7", 42], ["P", 118]],
			minlevel : 3,
			description : "\n   " + "I gain the knowledge of the Minor Illusion cantrip (or another if I already knew it)." + "\n   " + "When I cast it, I can create both a sound and an image with a single casting.",
			spellcastingBonus : {
				name : "Minor Illusion cantrip",
				spells : ["minor illusion"],
				selection : ["minor illusion"]
			},
			spellChanges : {
				"minor illusion" : {
					description : "5-ft cube illusion includes visible and audible; Int(Investigation) check vs. Spell DC; see book",
					changes : "My Improved Minor Illusion class feature allows me to make both a sound and an image with a single casting."
				},
			},
		},
		"subclassfeature6" : {
			name : "Malleable Illusion",
			source : [["UA23PT7", 42], ["P", 118], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"After I cast an Illusion spell that lasts 1 min or longer, I can use a Bonus Action to change it.",
				"I can only change the nature of the illusion, using the spell’s normal parameters of the illusion.",
				"I can only make changes to an Illusion spell I can see.",
			]),
			action : ["bonus action", ""],
		},
		"subclassfeature10" : {
			name : "Illusory Self",
			source : [["UA23PT7", 42], ["P", 118], ["MJ:HB", 0]],
			minlevel : 10,
			description : "\n   " + "As a Reaction, when I'm attacked, I can impose an illusion that makes the attack miss.",
			action : ["reaction", ""],
			recovery : "short rest",
			usages : 1,
			altResource : "SS 2+",
		},
		"subclassfeature14" : {
			name : "Illusory Reality",
			source : [["P", 118]],
			minlevel : 14,
			description : desc([
				"As a Bonus Action, after I cast a 1st-level or higher Illusion spell, I can make it partially real.",
				"One inanimate, nonmagical object that is part of the illusion becomes real for 1 minute.",
				"The object can't be something that deal damage or imposes any conditions.",
			]),
			action : ["bonus action", ""],
		},
	},
});

// Add Feat Versions of TCE Fighting Styles
FeatsList["blind fighting style ua23pt7"] = {
	name : "Blind Fighting Style (UA23PT7)",
	source : [["UA23PT7", 10], ["T", 41], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"]|features["fighting style ua23pt7"]|features["fighting style"]/i).test(classes.known);
	},
	description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
		"I have Blindsight with 10 ft range, allowing me to see anything not behind total cover",
		"In range, I can see Invisible, but not Hidden, things, even when Blinded or in darkness",
	]),
	vision : [["Blindsight", 10]], //Ripped directly from "all_WotC_pub+UA.js"
};
FeatsList["interception fighting style ua23pt7"] = {
	name : "Interception Fighting Style (UA23PT7)",
	source : [["UA23PT7", 10], ["T", 41], ["UA:CFV", 12], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"]|features["fighting style ua23pt7"]|features["fighting style"]/i).test(classes.known);
	},
	description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
		"As a Reaction when a creature I can see hits another within 5 ft of me, I can intercept",
		"I reduce the damage the target takes by 1d10 + my Proficiency Bonus (min 0 damage)",
		"I can't be the target and it requires me wielding a shield or a simple or martial weapon"
	]),
	action : [["reaction", ""]], //Ripped directly from "all_WotC_pub+UA.js"
};
FeatsList["superior technique fighting style ua23pt7"] = {
	name : "Superior Technique Fighting Style (UA23PT7)",
	source : [["UA23PT7", 10], ["T", 41], ["T", 42], ["UA:CFV", 5], ["P", 74], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"]|features["fighting style ua23pt7"]|features["fighting style"]/i).test(classes.known);
	},
	description : " [1 maneuver; d6, 1\xD7 per short rest]" + desc([ //Ripped directly from "all_WotC_pub+UA.js"
		"I gain one superiority die (d6) that I can expend to fuel a special Maneuver",
		"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice",
		"I choose a Maneuver upon selecting this feat",
	]),
	extraLimitedFeatures : [{ //Ripped directly from "all_WotC_pub+UA.js"
		name : "Combat Superiority",
		usages : 1,
		additional : 'd6',
		recovery : "short rest",
		addToExisting : true
	}],
	choices : ["Ambush", "Bait and Switch", "Brace", "Commander's Strike", "Commanding Presence", "Disarming Attack", "Distracting Strike", "Evasive Footwork", "Feinting Attack", "Goading Attack", "Grappling Strike", "Lunging Attack", "Maneuvering Attack", "Menacing Attack", "Parry", "Precision Attack", "Pushing Attack", "Quick Toss", "Rally", "Riposte", "Sweeping Attack", "Tactical Assessment", "Trip Attack"],
	"ambush" : {
		name : "Superior Technique [Ambush] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Ambush: When I make an initiative roll or a Dex (Stealth) check,",
			"I can add a superiority die to it. I can't do this if I'm Incapacitated.",
		]),
	},
	"bait and switch" : {
		name : "Superior Technique [Bait and Switch] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Bait and Switch: On my turn, I can expend a superiority die to swap",
			"places with an ally within 5 ft. I can't do this if the ally is Incapacitated or unwilling",
			"to swap. Doing this costs me 5 ft of movement, but this doesn't provoke opportunity attacks.",
			"Me or my ally (my choice) can then add the superiority die to AC until my next turn starts.",
		]),
	},
	"brace" : {
		name : "Superior Technique [Brace] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Brace: As a Reaction when a creature I can see moves within my melee",
			"reach, I can attack it. I expend a superiority die and make one weapon attack, adding the die",
			"to the damage.",
		]),
		action : [["reaction", "Brace"]],
	},
	"commander's strike" : {
		name : "Superior Technique [Commander's Strike] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Commander's Strike: I forgo one attack of my Attack action to direct",
			"an ally I see/hear. The ally can use a Reaction to make an attack, adding the superiority",
			"die to damage.",
		]),
	},
	"commanding presence" : {
		name : "Superior Technique [Commanding Presence] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Commanding Presence: When I make a Performance, Intimidation, or",
			"Persuasion check, I can add a superiority die to it.",
		]),
	},
	"disarming attack" : {
		name : "Superior Technique [Disarming Attack] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Disarming Attack: Use after hitting a creature; I add the superiority",
			"die to my attack's damage. Target makes a Strength save or drops a held object of my choice",
			"to its feet.",
		]),
	},
	"distracting strike" : {
		name : "Superior Technique [Distracting Strike] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Distracting Strike: Use after hitting a creature; I add the superiority",
			"die to my attack's damage. The next attack of an ally before my next turn has Adv. against",
			"the creature.",
		]),
	},
	"evasive footwork" : {
		name : "Superior Technique [Evasive Footwork] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Evasive Footwork: Use when moving at least 5 ft; I add the",
			"superiority die to my AC until the end of my turn.",
		]),
	},
	"feinting attack" : {
		name : "Superior Technique [Feinting Attack] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Feinting Attack: As a Bonus Action, I can feint to gain Adv. on my next",
			"attack this turn vs. a target in 5 ft. If I hit, add the superiority die to my attack's damage.",
		]),
		action : ["bonus action", "Feinting Attack"],
	},
	"goading attack" : {
		name : "Superior Technique [Goading Attack] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Goading Attack: Use after hitting a creature; I add the superiority",
			"die to my attack's damage. Target makes a Wis save or has Disadv. vs. other targets until",
			"the end of my next turn.",
		]),
	},
	"grappling strike" : {
		name : "Superior Technique [Grappling Strike] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered; The alterations made to bring this in line with the UA Grapple rules are of my own creation
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Grappling Strike: Immediately after hitting with a melee attack, I can",
			"use a Bonus Action to try to Grapple Unarmed Strike. I subtract the superiority die from the",
			"target's Str or Dex save; I can only do this on my own turn.",
		]),
		action : [["bonus action", "Grappling Strike (after melee hit)"]],
	},
	"lunging attack" : {
		name : "Superior Technique [Lunging Attack] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Lunging Attack: I can spend a superiority die to take the Dash action",
			"as a Bonus Action. If after moving at least 10 ft in a straight line immediately before hitting",
			"with a melee attack as part of Attack action, I add the superiority die to my attack's damage.",
		]),
		action : ["bonus action", "Lunging Attack (Dash)"],
	},
	"maneuvering attack" : {
		name : "Superior Technique [Maneuvering Attack] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Maneuvering Attack: Use after hitting a creature; I add the superiority",
			"die to my attack's damage. Ally who can see/hear me can use Reaction to move half speed without",
			"opportunity attack from the target.",
		]),
	},
	"menacing attack" : {
		name : "Superior Technique [Menacing Attack] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Menacing Attack: Use after hitting a creature; I add the superiority",
			"die to my attack's damage. Target makes a Wisdom save or is Frightened of me until the end",
			"of my next turn.",
		]),
	},
	"parry" : {
		name : "Superior Technique [Parry] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Parry: When damaged in melee, I can use a Reaction to reduce",
			"damage taken by superiority die + Str/Dex mod, my choice.",
		]),
		action : [["reaction", "Parry (when damaged in melee)"]],
	},
	"precision attack" : {
		name : "Superior Technique [Precision Attack] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Precision Attack: After missing with an attack roll, I add the",
			"superiority die to my attack roll, potentially causing it to instead hit.",
		]),
	},
	"pushing attack" : {
		name : "Superior Technique [Pushing Attack] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Pushing Attack: Use after hitting a creature; I add the superiority",
			"die to my attack's damage. If target is Large or smaller, it must make a Strength save or",
			"be pushed up to 15 ft away.",
		]),
	},
	"quick toss" : {
		name : "Superior Technique [Quick Toss] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Quick Toss: As a Bonus Action, I can use a superiority die to do a",
			"ranged attack with a thrown weapon. I can draw a thrown weapon as part of making this attack;",
			"I add the die to the damage.",
		]),
		action : [["bonus action", "Quick Toss"]],
	},
	"rally" : {
		name : "Superior Technique [Rally] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Rally: As a Bonus Action, ally that can see/hear me gets",
			"temporary HP equal to superiority die + Int/Wis/Cha mod, my choice.",
		]),
		action : [["bonus action", "Rally"]],
	},
	"riposte" : {
		name : "Superior Technique [Riposte] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Riposte: When missed in melee, I can use my Reaction to make one melee",
			"attack vs. the attacker. If the attack hits, I add the superiority die to my attack's damage.",
		]),
		action : [["reaction", "Riposte (after missed in melee)"]],
	},
	"sweeping attack" : {
		name : "Superior Technique [Sweeping Attack] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Sweeping Attack: Use after hitting a creature and a second creature",
			"is within 5 ft of the first. If the original attack roll hits this second creature, it takes",
			"the superiority die in damage.",
		]),
	},
	"tactical assessment" : {
		name : "Superior Technique [Tactical Assessment] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Tactical Assessment: When I make an Investigation, History, or Insight",
			"check, I can add a superiority die to it.",
		]),
	},
	"trip attack" : {
		name : "Superior Technique [Trip Attack] (UA23PT7)",
		description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
			"I gain one superiority die (d6) that I can expend to fuel a special Maneuver.",
			"I can only use one Maneuver per attack; DCs are 8 + Prof B. + Str/Dex mod, my choice.",
			"My chosen Maneuver is Trip Attack: Use after hitting a creature; I add the superiority",
			"die to my attack's damage. If target is Large or smaller, it must make a Strength save or",
			"be knocked Prone.",
		]),
	},
};
FeatsList["thrown weapon fighting style ua23pt7"] = {
	name : "Thrown Weapon Fighting Style (UA23PT7)",
	source : [["UA23PT7", 10], ["T", 42], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"]|features["fighting style ua23pt7"]|features["fighting style"]/i).test(classes.known);
	},
	description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
		"I can draw a weapon with the thrown property as part of the attack I make with it",
		"In addition, my ranged attacks made with thrown weapons deal +2 damage"
	]),
	calcChanges : { //Ripped directly from "all_WotC_pub+UA.js"
		atkAdd : [
			function (fields, v) {
				if (v.isThrownWeapon && v.isMeleeWeapon) {
					fields.Description += (fields.Description ? '; ' : '') + '+2 damage when thrown';
				}
			},
			"I deal +2 damage when I hit a ranged attack made with a thrown weapon."
		],
		atkCalc : [
			function (fields, v, output) {
				if (v.isThrownWeapon && !v.isMeleeWeapon) {
					output.extraDmg += 2;
				}
			},
			""
		]
	},
};
FeatsList["unarmed fighting style ua23pt7"] = {
	name : "Unarmed Fighting Style (UA23PT7)",
	source : [["UA23PT7", 10], ["T", 42], ["MJ:HB", 0]],
	allowDuplicates : false,
	prerequisite : "Fighting Style Feature",
	prereqeval : function(v) {
		return (/features["fighting style ua23pt6"] | features["fighting style ua23pt7"] | features["fighting style"]/i).test(classes.known);
	},
	description : desc([ //Ripped directly from "all_WotC_pub+UA.js" and then altered
		"My Unarmed Strikes deal 1d6 damage, or 1d8 damage when I have both hands free",
		"At the start of my turn, I can deal 1d4 bludgeoning damage to one target I'm grappling",
	]),
	calcChanges : { //Ripped directly from "all_WotC_pub+UA.js" and then altered
		atkAdd : [
			function (fields, v) {
				if (v.baseWeaponName == "unarmed strike") {
					if (fields.Damage_Die == 1 || fields.Damage_Die == "1d4") fields.Damage_Die = '1d6';
					fields.Description += (fields.Description ? '; ' : '') + 'Versatile (d8)';
				}
			},
			"My Unarmed Strikes deal 1d6 damage instead of 1, which increases to 1d8 if I have both hands free to make an Unarmed Strike with.",
			1
		]
	},
};

// Add UA23PT7 Spells
SpellsList["arcane eruption ua23pt7"] = {
	name : "Arcane Eruption (UA23PT7)",
	source : [["UA23PT7", 43], ["MJ:HB", 0]],
	classes : ["sorcerer", "sorcerer_ua23pt7"],
	level : 4,
	school : "Evoc",
	time : "1 a",
	range : "120 ft",
	rangeMetric : "36m",
	components : "V,S",
	duration : "Instantaneous",
	save : "Dex",
	description : "20 ft rad sphere; 6d6 Acid/Cold/Fire/Lghtng/Poison/Psychic/Thunder dmg w/ Condition, half on save; see book",
	descriptionFull : "Churning magical energy explodes in a 20-foot- radius sphere centered on a point you choose within range. When you cast the spell, you select the type of damage dealt by the explosion: Acid, Cold, Fire, Lightning, Poison, Psychic, or Thunder. Each creature in the sphere must make a Dexterity saving throw. On a failed save, a creature takes 6d6 damage of the chosen type. On a successful save, a creature takes half as much damage." + "\n   " + "Choose one of those d6s. The number rolled on that die determines a condition that’s applied to each creature that failed the save, as shown below. A creature has the condition until the end of your next turn." + "\n" + "d6   Additional Effect" + "\n" + "1    Incapacitated" + "\n" + "2    Blinded" + "\n" + "3    Frightened" + "\n" + "4    Poisoned" + "\n" + "5    Charmed" + "\n" + "6    Deafened" + AtHigherLevels + "When you cast this spell using a spell slot of level 5 or higher, the damage increases by 1d6 for each slot level above 4.",
};
SpellsList["counterspell ua23pt7"] = {
	name : "Counterspell (UA23PT7)",
	source : [["UA23PT7", 43], ["SRD", 131], ["P", 228], ["MJ:HB", 0]],
	classes : ["sorcerer", "sorcerer_ua23pt7", "warlock", "warlock_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 3,
	school : "Abjur",
	time : "1 rea",
	timeFull : "Reaction, which you take when you see a creature within 60 feet of yourself casting a spell with Verbal, Somatic, or Material components",
	range : "60 ft",
	rangeMetric : "18m",
	components : "S",
	duration : "Instantaneous",
	save : "Con",
	description : "Stop a spell being cast; target make Con save to continue casting; target doesn't use spell slot on fail", //Ripped directly from "ListsSpells.js" and then heavily altered
	descriptionFull : "You attempt to interrupt a creature in the process of casting a spell. The creature must make a Constitution saving throw. On a failed save, the spell dissipates with no effect, and the action, Bonus Action, or Reaction used to cast it is wasted. If that spell was cast with a spell slot, the slot isn’t expended.",
};
SpellsList["jump ua23pt7"] = {
	name : "Jump (UA23PT7)",
	source : [["UA23PT7", 43], ["SRD", 158], ["P", 254], ["MJ:HB", 0]],
	classes : ["artificer", "druid", "druid_ua23pt8", "ranger", "ranger_ua23pt6", "sorcerer", "sorcerer_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 1,
	school : "Trans",
	time : "1 bns",
	range : "Touch",
	components : "V,S,M",
	compMaterial : "A grasshopper’s hind leg",
	duration : "1 min",
	description : "For duration, 1+1/SL creature(s) can jump 30 ft using 10 ft of movement", //Ripped directly from "ListsSpells.js" and then heavily altered
	descriptionFull : "You touch a willing creature. Once on each of its turns until the spell ends, that creature can jump up to 30 feet by spending only 10 feet of movement." + AtHigherLevels + "When you cast this spell using a spell slot of level 2 or higher, you can target one additional creature for each slot level above 1.",
};
SpellsList["sorcerous burst ua23pt7"] = {
	name : "Sorcerous Burst (UA23PT7)",
	source : [["UA23PT7", 44], ["MJ:HB", 0]],
	classes : ["sorcerer", "sorcerer_ua23pt7"],
	level : 0,
	school : "Evoc",
	time : "1 a",
	range : "120 ft",
	rangeMetric : "36m",
	components : "V,S",
	duration : "Instantaneous",
	description : "Ranged spell atk; 1d8 Acid/Cold/Fire/Lghtng/Poison/Psychic/Thunder dmg; +1d8 per 8; +1d8 at CL 5/11/17",
	descriptionCantripDie : "Ranged spell atk; `CD`d8 Acid/Cold/Fire/Lghtng/Poison/Psychic/Thunder dmg; +1d8 per 8",
	descriptionFull : "You cast sorcerous energy at one creature or object within range. Make a ranged attack roll against the target. On a hit, the target takes 1d8 damage. If you roll an 8 on a d8 for this spell, you can roll another d8, and add it to the damage." + "\n   " + "Whenever you cast this spell, the maximum number of these d8s you can add to the spell’s damage equals your spellcasting ability modifier." + "\n   " + "You choose the damage type each time you cast this spell: Acid, Cold, Fire, Lightning, Poison, Psychic, or Thunder." + "\n   " + "Cantrip Upgrade. This spell’s damage increases by 1d8 when you reach level 5 (2d8), 11 (3d8), and 17 (4d8).",
};

// Add Two-Handed Improvised Weapon; made with help from user @TrackAtNite
WeaponsList["two-handed improvised weapon"] = {
	regExpSearch : /^(?=.*two-handed)(?=.*improvised)(?=.*weapon).*$/i,
	name : "Two-handed improvised weapon",
	source : [["UA23PT7", 14], ["SRD", 65], ["P", 147], ["MJ:HB", 0]],
	list : "improvised",
	ability : 1,
	range : "Melee",
	description : "Damage die, type, range, etc. are at the DM's discretion; Two-handed",
	abilitytodamage : true,
	baseWeapon : "improvised weapon",
};

//// >>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA23BC Spells >>> ////
//// >>>>>>>>>>>>>>>>>>>>> ////

// Add spells
SpellsList["acid splash ua23bc"] = {
	name : "Acid Splash (UA23BC)",
	source : [["UA23BC", 22], ["SRD", 114], ["P", 211], ["MJ:HB", 0]],
	classes : ["artificer", "sorcerer", "sorcerer_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 0,
	school : "Evoc",
	time : "1 a",
	range : "60 ft",
	rangeMetric : "18 m",
	components : "V,S",
	duration : "Instantaneous",
	save : "Dex",
	description : "Creatures within 5 ft rad sphere save or 1d6 Acid dmg; +1d6 at CL 5, 11, and 17", //Ripped directly from "ListsSpells.js" and then altered
	descriptionCantripDie : "Creatures within 5 ft rad sphere save or `CD`d6 Acid dmg", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "You create an acidic bubble and hurl it at a point within range, where it explodes in a 5 ft radius sphere. Each creature in that sphere must succeed on a Dexterity saving throw or take 1d6 Acid damage." + "\n   " + "Cantrip Upgrade. This spell’s damage increases by 1d6 when you reach levels 5 (2d6), 11 (3d6), and 17 (4d6).",
};
SpellsList["blade ward ua23bc"] = {
	name : "Blade Ward (UA23BC)",
	source : [["UA23BC", 22], ["MJ:HB", 0]],
	classes : ["bard", "bard_ua22xc", "sorcerer", "sorcerer_ua23pt7", "warlock", "warlock_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 0,
	school : "Abjur",
	time : "1 rea",
	timeFull : "1 reaction, which you take in response to a visible creature targeting you with a melee attack",
	range : "Self",
	components : "V,S",
	duration : "Instantaneous",
	description : "Reaction to impose Disadvantage on 1 melee atk against me",
	descriptionFull : "You trace a sigil of warding, imposing Disadvantage on the creature’s attack roll against you.",
};
SpellsList["chill touch ua23bc"] = {
	name : "Chill Touch (UA23BC)",
	source : [["UA23BC", 22], ["SRD", 124], ["P", 221], ["MJ:HB", 0]],
	classes : ["sorcerer", "sorcerer_ua23pt7", "warlock", "warlock_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 0,
	school : "Necro",
	time : "1 a",
	range : "Touch",
	components : "V,S",
	duration : "Instantaneous",
	description : "Melee spell atk for 1d10 Necrotic dmg; can't regain HP; +1d10 at CL 5, 11, and 17", //Ripped directly from "ListsSpells.js" and then altered
	descriptionShorter : "Melee spell atk for 1d10 Necrotic dmg; can't regain HP; +1d10 at CL 5/11/17", //Ripped directly from "ListsSpells.js" and then altered
	descriptionCantripDie : "Melee spell atk for `CD`d10 Necrotic dmg; can't regain hp", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "You channel the chill of the grave toward one creature you try to touch. Make a melee spell attack against the target. On a hit, the target takes 1d10 Necrotic damage, and it can’t regain Hit Points until the end of your next turn." + "\n   " + "Cantrip Upgrade. This spell’s damage increases by 1d10 when you reach levels 5 (2d10), 11 (3d10), and 17 (4d10).",
};
SpellsList["friends ua23bc"] = {
	name : "Friends (UA23BC)",
	source : [["UA23BC", 22], ["MJ:HB", 0]],
	classes : ["bard", "bard_ua22xc", "sorcerer", "sorcerer_ua23pt7", "warlock", "warlock_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 0,
	school : "Ench",
	time : "1 a",
	range : "10 ft",
	rangeMetric : "3 m",
	components : "S,M",
	compMaterial : "Some makeup",
	duration : "Conc, 1 min",
	save : "Wis",
	description : "1 Humanoid crea currently not hostile save or be Charmed for duration",
	descriptionFull : "You magically emanate a sense of friendship toward one visible creature within range. The target must succeed on a Wisdom saving throw or have the Charmed condition for the duration. The target succeeds automatically if it isn’t a Humanoid, if you’re fighting it, or if you have cast this spell on it within the past 24 hours." + "\n   " + "The spell ends early if the target takes damage or if you make an attack roll, deal damage, or force anyone to make a saving throw.",
};
SpellsList["poison spray ua23bc"] = {
	name : "Poison Spray (UA23BC)",
	source : [["UA23BC", 22], ["SRD", 169], ["P", 266], ["MJ:HB", 0]],
	classes : ["artificer", "druid", "druid_ua23pt8", "sorcerer", "sorcerer_ua23pt7", "warlock", "warlock_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 0,
	school : "Necro",
	time : "1 a",
	range : "30 ft",
	rangeMetric : "9 m",
	components : "V,S",
	duration : "Instantaneous",
	description : "Ranged spell atk for 1d12 Poison dmg; +1d12 at CL 5, 11, and 17", //Ripped directly from "ListsSpells.js" and then altered
	descriptionCantripDie : "Ranged spell atk for `CD`d12 Poison dmg", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "You launch a mist of toxic energy at a creature within range. Make a ranged spell attack against the target. On a hit, the target takes 1d12 Poison damage." + "\n   " + "Cantrip Upgrade. This spell’s damage increases by 1d12 when you reach levels 5 (2d12), 11 (3d12), and 17 (4d12).",
};
SpellsList["produce flame ua23bc"] = {
	name : "Produce Flame (UA23BC)",
	source : [["UA23BC", 23], ["SRD", 172], ["P", 269], ["MJ:HB", 0]],
	classes : ["druid", "druid_ua23pt8"],
	level : 0,
	school : "Conj",
	time : "1 bns",
	range : "Self",
	components : "V,S",
	duration : "10 min (D)",
	description : "Flame 20 ft bright light; per turn 60 ft ranged spell attack for 1d8 Fire dmg; +1d8 at CL 5, 11, and 17", //Ripped directly from "ListsSpells.js" and then altered
	descriptionCantripDie : "Flame 20 ft bright light; once 60 ft ranged spell attack for `CD`d8 Fire dmg", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "A flickering flame appears in your hand and remains there for the duration. While there, the flame emits no heat and ignites nothing, and it sheds bright light in a 20-foot radius and dim light for an additional 20 feet. The spell ends if you dismiss it as a Bonus Action or if you cast it again." + "\n   " + "Until the spell ends, you can take a Magic action to hurl fire at a creature or an object within 60 feet of you. Make a ranged spell attack. On a hit, the target takes 1d8 fire damage." + "\n   " + "Cantrip Upgrade. This spell’s damage increases by 1d8 when you reach levels 5 (2d8), 11 (3d8), and 17 (4d8).",
};
SpellsList["shillelagh ua23bc"] = {
	name : "Shillelagh (UA23BC)",
	source : [["UA23BC", 23], ["SRD", 179], ["P", 275], ["MJ:HB", 0]],
	classes : ["druid", "druid_ua23pt8"],
	level : 0,
	school : "Trans",
	time : "1 bns",
	range : "Touch",
	components : "V,S,M",
	compMaterial : "Mistletoe, a shamrock leaf, and a Club or Quarterstaff",
	duration : "1 min",
	description : "Club/Quarterstaff I hold does d8 Bludg/Force dmg \u0026 uses spllcstng ablty instead of Str; d10 at CL5, d12 at 11, 2d6 at 17", //Ripped directly from "ListsSpells.js" and then altered
	descriptionShorter : "Club/Quarterstaff I hold does d8 Bludg/Force dmg \u0026 uses spllcstng ablty instead of Str; CL5:d10; 11:d12; 17:2d6", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "A Club or Quarterstaff you are holding is imbued with nature’s power. For the duration, you can use your spellcasting ability instead of Strength for the attack and damage rolls of melee attacks using that weapon, and the weapon’s damage die becomes a d8. If the attack deals damage, it can be Force damage or the weapon’s normal damage type (your choice)." + "\n   " + "The spell ends early if you cast it again or if you let go of the weapon." + "\n   " + "Cantrip Upgrade. The weapon’s damage die changes when you reach levels 5 (d10), 11 (d12), and 17 (2d6).",
};
SpellsList["shocking grasp ua23bc"] = {
	name : "Shocking Grasp (UA23BC)",
	source : [["UA23BC", 23], ["SRD", 179], ["P", 275], ["MJ:HB", 0]],
	classes : ["artificer", "sorcerer", "sorcerer_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 0,
	school : "Evoc",
	time : "1 a",
	range : "Touch",
	components : "V,S",
	duration : "Instantaneous",
	description : "Melee spell atk for 1d8 Lightning dmg, no Opp. Atks until next turn; +1d8 at CL 5, 11, and 17", //Ripped directly from "ListsSpells.js" and then altered
	descriptionCantripDie : "Melee spell atk for `CD`d8 Lightning dmg, no Opp. Atks until next turn", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "Lightning springs from your hand to deliver a shock to a creature you try to touch. Make a melee spell attack against the target. On a hit, the target takes 1d8 Lightning damage, and it can’t make Opportunity Attacks until the start of its next turn." + "\n   " + "Cantrip Upgrade. This spell’s damage increases by 1d8 when you reach levels 5 (2d8), 11 (3d8), and 17 (4d8).",
};
SpellsList["spare the dying ua23bc"] = {
	name : "Spare the Dying (UA23BC)",
	source : [["UA23BC", 23], ["SRD", 181], ["P", 277], ["MJ:HB", 0]],
	classes : ["artificer", "cleric", "cleric_ua23pt6", "druid", "druid_ua23pt8"],
	level : 0,
	school : "Necro",
	time : "1 a",
	range : "15 ft",
	rangeMetric : "4.5 m",
	components : "V,S",
	duration : "Instantaneous",
	description : "1 creature with 0 current HP becomes Stable; range incr. at CL 5 (30 ft), 11 (60 ft), \u0026 17 (120 ft)", //Ripped directly from "ListsSpells.js" and then altered
	descriptionShorter : "1 creature with 0 current HP becomes Stable; CL5: 30 ft; 11: 60 ft; 17: 120 ft",
	descriptionFull : "Choose a creature within range that has 0 Hit Points yet is alive. The creature becomes Stable." + "\n   " + "Cantrip Upgrade. The spell’s range doubles when you reach levels 5 (30 feet), 11 (60 feet), and 17 (120 feet).",
};
SpellsList["true strike ua23bc"] = {
	name : "True Strike (UA23BC)",
	source : [["UA23BC", 23], ["MJ:HB", 0]],
	classes : ["bard", "bard_ua22xc", "sorcerer", "sorcerer_ua23pt7", "warlock", "warlock_ua23pt7", "wizard", "wizard_ua23pt7"],
	level : 0,
	school : "Div",
	time : "1 a",
	range : "Self",
	components : "S,M",
	compMaterial : "A weapon with which you have Proficiency",
	duration : "Instantaneous",
	description : "Wpn deals normal/Radiant dmg \u0026 uses spllcstng ablty; +1d6 Radiant damage at CL 5, 11, \u0026 17",
	descriptionCantripDie : "Wpn deals normal/Radiant dmg \u0026 uses spllcstng ablty; +`CD-1`d6 Radiant dmg",
	descriptionFull : "Guided by a flash of magical insight, you make one attack with the weapon used in the spell’s casting. The attack uses your spellcasting ability for the attack and damage rolls instead of using Strength or Dexterity. If the attack deals damage, it can be Radiant damage or the weapon’s normal damage type (your choice)." + "\n   " + "Cantrip Upgrade. Whether you choose to deal Radiant damage or the weapon’s normal damage type, the attack deals extra Radiant damage when you reach levels 5 (1d6), 11 (2d6), and 17 (3d6).",
};

//// >>>>>>>>>>>>>>>>>>>>>>> ////
//// >>> UA23PT8 Content >>> ////
//// >>>>>>>>>>>>>>>>>>>>>>> ////

// Add UA23PT8 Barbarian class
ClassList.barbarian_ua23pt8 = {
	name : "Barbarian (UA:PT-viii)",
	regExpSearch : /^((?=.*(marauder|barbarian|(norse|tribes?|clans?)(wo)?m(a|e)n))|((?=.*(warrior|fighter))(?=.*(feral|tribal)))).*$/i,
	source : [["UA23PT8", 1], ["MJ:HB", 0]],
	primaryAbility : "Strength",
	prerequisite : "Strength 13+",
	prereqeval : function(v) {
		return (What('Str') >= 13);
	},
	die : 12,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
	saves : ["Str", "Con"],
	skills : ["\n\n" + toUni("Barbarian") + ": Choose two from Animal Handling, Athletics, Intimidation, Nature, Perception, Survival", ""],
	armor : [
		[true, true, false, true],
		[false, false, false, true],
	],
	weapons : [
		[true, true, [""]],
		[false, true, [""]],
	],
	equipment : "Barbarian starting equipment:" +
		"\n \u2022 Explorer's Pack," +
		"\n \u2022 Handaxe (4)," +
		"\n \u2022 Greataxe \u0026 15 gp -or- Battleaxe, Shield, \u0026 25 gp" +
		"\n\nAlternatively, choose 75 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Primal Path", []],
	attacks : [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	features : {
		"rage ua23pt8" : { //Ripped directly from "ListsClasses.js" and then heavily altered
			name : "Rage",
			source : [["UA23PT8", 3], ["SRD", 8], ["P", 48], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"Start/end as Bonus Action when not wearing Heavy Armor; add damage to melee weapons that use Str.",
				"Adv. on Strength checks/saves (not attacks); Resistance to Bludgeoning/Piercing/Slashing.",
				"While Raging, I can't maintain Concentration on a spell, nor can I cast spells.",
				"The Rage lasts until the end of my next turn, \u0026 it ends early if I don Heavy Armor or have",
				"  the Incapacitated condition. If my Rage is still active on my next turn, I can extend the Rage",
				"  for another round by doing one of more of the following: Make an attack roll against an enemy,",
				"  force an enemy to make a saving throw, or take a Bonus Action to extend my Rage.",
				"I can maintain a Rage for up to 10 minutes. I regain one expended Rage upon finishing a Short Rest.",
			]),
			additional : levels.map(function (n) {
				return "+" + (n < 9 ? 2 : n < 16 ? 3 : 4) + " melee damage";
			}),
			usages : [2, 2, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, "\u221E\xD7 per "],
			recovery : "long rest",
			action : ["bonus action", " (start/end)"],
			dmgres : [["Bludgeoning", "Bludgeon. (in rage)"], ["Piercing", "Piercing (in rage)"], ["Slashing", "Slashing (in rage)"]],
			savetxt : { text : ["Adv. on Str saves in rage"] },
			calcChanges : {
				atkCalc : [
					function (fields, v, output) {
						if ((v.theWea.ability = 1) && classes.known.barbarian_ua23pt8 && classes.known.barbarian_ua23pt8.level && (/\brage\b/i).test(v.WeaponTextName)) {
							output.extraDmg += classes.known.barbarian_ua23pt8.level < 9 ? 2 : classes.known.barbarian_ua23pt8.level < 16 ? 3 : 4;
						}
					},
					"If I include the word 'Rage' in a melee weapon's name, the calculation will add my Rage's bonus damage to it."
				]
			}
		},
		"unarmored defense ua23pt8" : { //Ripped directly from "ListsClasses.js"
			name : "Unarmored Defense",
			source : [["UA23PT8", 3], ["SRD", 8], ["P", 48]],
			minlevel : 1,
			description : desc("Without armor, my AC is 10 + Dexterity modifier + Constitution modifier + shield"),
			armorOptions : [{
				regExpSearch : /justToAddToDropDown/,
				name : "Unarmored Defense (Con)",
				source : [["SRD", 8], ["P", 48]],
				ac : "10+Con",
				affectsWildShape : true
			}],
			armorAdd : "Unarmored Defense (Con)",
		},
		"weapon mastery ua23pt8" : { //Ripped directly from the Fighter in "UA2023PT7 Content [by MasterJedi2014] V4.js" and then altered
			/*	-SCRIPT AUTHOR NOTE-
				This feature calls the masteryFunctions.weaponMasteryAtkAdd function (made by Joost/MPMB) for the
				actual weapon description alterations. The feature also lets the user select via extrachoices what
				Weapons they currently have chosen to add Mastery properties to. The extrachoices options are
				functionally useless, but I'm leaving it in here because I know some users in my own play group need
				what the extrachoices does to realize "Oh, I need to remove the word 'Mastery' from one of my weapons
				to use the Mastery property of a different weapon".
				Joost/MPMB, you can remove the extrachoices aspect of this if you want when you get around to updating
				the sheet code yourself for the revised rules.
			*/
			name : "Weapon Mastery",
			source : [["UA23PT8", 3], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can use the Mastery property of 2 kinds of weapons of my choice.",
				"I can change what weapons I can use the Mastery property of after finishing a Long Rest.",
				"I can choose 3 kinds of weapons when I reach Barbarian lvl 4 \u0026 4 kinds at Barbarian Lvl 10.",
				"My chosen weapon types will appear in the pg 3 Notes section.",
			]),
			calcChanges : {
				atkAdd : masteryFunctions.weaponMasteryAtkAdd
			},
			extraname : "Weapon Mastery",
			extrachoices : ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Light Crossbow", "Dart", "Shortbow", "Sling", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "War Pick", "Warhammer", "Whip", "Blowgun", "Hand Crossbow", "Heavy Crossbow", "Longbow", "Pistol", "Musket", "Pistol Automatic", "Revolver", "Hunting Rifle", "Automatic Rifle", "Shotgun", "Laser Pistol", "Antimatter Rifle", "Laser Rifle"],
			extraTimes : levels.map(function (n) { return n < 4 ? 2 : n < 10 ? 3 : 4; }),
			"club" : {
				name : "Club",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"dagger" : {
				name : "Dagger",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"greatclub" : {
				name : "Greatclub",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"handaxe" : {
				name : "Handaxe",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"javelin" : {
				name : "Javelin",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"light hammer" : {
				name : "Light Hammer",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"mace" : {
				name : "Mace",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"quarterstaff" : {
				name : "Quarterstaff",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"sickle" : {
				name : "Sickle",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"spear" : {
				name : "Spear",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"light crossbow" : {
				name : "Light Crossbow",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"dart" : {
				name : "Dart",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"shortbow" : {
				name : "Shortbow",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"sling" : {
				name : "Sling",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"battleaxe" : {
				name : "Battleaxe",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"flail" : {
				name : "Flail",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"glaive" : {
				name : "Glaive",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"greataxe" : {
				name : "Greataxe",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"greatsword" : {
				name : "Greatsword",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"halberd" : {
				name : "Halberd",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"lance" : {
				name : "Lance",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"longsword" : {
				name : "Longsword",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"maul" : {
				name : "Maul",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"morningstar" : {
				name : "Morningstar",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"pike" : {
				name : "Pike",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"rapier" : {
				name : "Rapier",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"scimitar" : {
				name : "Scimitar",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"shortsword" : {
				name : "Shortsword",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"trident" : {
				name : "Trident",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"war pick" : {
				name : "War Pick",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"warhammer" : {
				name : "Warhammer",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"whip" : {
				name : "Whip",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"blowgun" : {
				name : "Blowgun",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"hand crossbow" : {
				name : "Hand Crossbow",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"heavy crossbow" : {
				name : "Heavy Crossbow",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"longbow" : {
				name : "Longbow",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"pistol" : {
				name : "Pistol",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"musket" : {
				name : "Musket",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"pistol automatic" : {
				name : "Pistol Automatic",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"revolver" : {
				name : "Revolver",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"hunting rifle" : {
				name : "Hunting Rifle",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"automatic rifle" : {
				name : "Automatic Rifle",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"shotgun" : {
				name : "Shotgun",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"laser pistol" : {
				name : "Laser Pistol",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"antimatter rifle" : {
				name : "Antimatter Rifle",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
			"laser rifle" : {
				name : "Laser Rifle",
				source : [["UA23PT8", 3], ["MJ:HB", 0]],
				description : "I can use the Mastery Property of this kind of weapon.",
			},
		},
		"reckless attack ua23pt8" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Reckless Attack",
			source : [["UA23PT8", 4], ["SRD", 9], ["P", 48], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"Adv. on Str. based attacks until the start of my next turn, but attacks vs. me adv. until next turn.",
			]),
		},
		"danger sense ua23pt8" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Danger Sense",
			source : [["UA23PT8", 4], ["SRD", 9], ["P", 48], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc("Adv. on Dexterity saves unless I am Incapacitated."),
			savetxt : { text : ["Adv. on Dex saves unless Incapacitated"] },
		},
		"subclassfeature3" : { //Ripped directly from "ListsClasses.js"
			name : "Primal Path",
			source : [["UA23PT8", 4], ["SRD", 9], ["P", 48]],
			minlevel : 3,
			description : desc('Choose a Primal Path that shapes the nature of your rage and put it in the "Class" field.')
		},
		"primal knowledge ua23pt8" : {
			name : "Primal Knowledge",
			source : [["UA23PT8", 4], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I gain proficiency in another skill of my choice from the list of skills for a Barb at Lvl 1.",
				"Whenever I make an ability check using one of the following skills, I can make it a Str. check:",
				"  Acrobatics, Intimidation, Perception, Stealth, or Survival.",
			]),
			skillstxt : "Choose one from Animal Handling, Athletics, Intimidation, Nature, Perception, Survival",
		},
		"fast movement ua23pt8" : { //Ripped directly from "ListsClasses.js"
			name : "Fast Movement",
			source : [["UA23PT8", 4], ["SRD", 9], ["P", 49]],
			minlevel : 5,
			description : desc("I gain +10 ft speed when I'm not wearing Heavy Armor."),
			speed : { allModes : "+10" },
		},
		"feral instinct ua23pt8" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Feral Instinct",
			source : [["UA23PT8", 4], ["SRD", 9], ["P", 49], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc("I get adv. on Initiative rolls."),
			advantages : [["Initiative", true]],
		},
		"instinctive pounce ua23pt8" : {
			name : "Instinctive Pounce",
			source : [["UA23PT8", 4], ["MJ:HB", 0]],
			minlevel : 7,
			description : desc("As part of the Bonus Action used to enter a Rage, I can Move up to half my Speed."),
		},
		"brutal strike ua23pt8" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Brutal Strike", //Previously known as "Brutal Critical"
			source : [["UA23PT8", 4], ["SRD", 9], ["P", 49], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"If I use Reckless Attack, I can forgo Adv. on the next attack roll I make on my turn with a Str.",
				"  based attack. If that attack hits, the target takes an extra 1d10 damage of the type dealt by",
				"  the attack, \u0026 I can use on Brutal Strike effect of my choice.",
				"I currently have the following effect options:",
				" \u2022 Forceful Blow. The target is pushed 15 ft straight away from me. I can then Move up to half",
				"  my Speed straight toward the target without provoking Opportunity Attacks.",
				" \u2022 Hamstring Blow. The target’s Speed is reduced by 15 ft until the start of my next turn.",
			]),
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if ((v.theWea.ability = 1) && classes.known.barbarian_ua23pt8 && classes.known.barbarian_ua23pt8.level > 8) {
							fields.Description += (fields.Description ? ', ' : '') + '+1d10 if Reckless Attack w/o Adv.';
						}
					},
					"If I forgo Adv. on the next attack roll on my turn I make with a Str. based attack, the target takes an extra 1d10 damage on a hit.",
					900,
				]
			},
		},
		"relentless rage ua23pt8" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Relentless Rage",
			source : [["UA23PT8", 4], ["SRD", 9], ["P", 49], ["MJ:HB", 0]],
			minlevel : 11,
			description : " [DC 10 + 5 per try, per short rest]" + desc([
				"If I drop to 0 HP while Raging, I can make a DC 10 Constitution save.",
				"The DC increases by 5 for every attempt until I finish a Short or Long Rest.",
				"If I succeed, my HP changes to a number equal to twice my Barbarian lvl.",
			]),
			additional : levels.map( function(n) {
				return n < 11 ? "" : "HP Gain: " + (n * 2);
			}),
			extraLimitedFeatures : [{
				name : "Relentless Rage",
				usages : 1,
				recovery : "short rest",
				usagescalc : "var FieldNmbr = parseFloat(event.target.name.slice(-2)); var usages = What('Limited Feature Used ' + FieldNmbr); var DCmod = Number(usages) * 5; event.value = (isNaN(Number(usages)) || usages === '') ? 'DC\u2003\u2003' : 'DC ' + Number(10 + DCmod);"
			}],
		},
		"brutal strike improvement ua23pt8" : {
			name : "Brutal Strike Improvement",
			source : [["UA23PT8", 4], ["MJ:HB", 0]],
			minlevel : 13,
			description : desc([
				"The following effects are now among my Brutal Strike options:",
				" \u2022 Staggering Blow. The target has Disadv. on the next saving throw it makes, \u0026 it can’t make",
				"   Opportunity Attacks until the start of my next turn.",
				" \u2022 Sundering Blow. The next attack roll by another creature against the target gains a bonus",
				"  to that roll equal to my Rage Damage value.",
			]),
		},
		"persistent rage ua23pt8" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Persistent Rage",
			source : [["UA23PT8", 5], ["SRD", 9], ["P", 49], ["MJ:HB", 0]],
			minlevel : 15,
			description : desc([
				"Once per Long Rest, when I roll Initiative, I can regain all expended uses of Rage.",
				"Additionally, my Rage only lasts less than 10 minutes if I fall Unconscious (instead of Incapacitated),",
				"  don Heavy Armor, or if I choose to end it early.",
			]),
			usages : 1,
			recovery : "long rest",
		},
		"indomitable might ua23pt8" : { //Ripped directly from "ListsClasses.js"
			name : "Indomitable Might",
			source : [["UA23PT8", 5], ["SRD", 9], ["P", 49]],
			minlevel : 18,
			description : desc("If a Strength check is lower than my Strength score, I can use my Strength score instead.")
		},
		"primal champion" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Primal Champion",
			source : [["UA23PT8", 5], ["SRD", 9], ["P", 49], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc("I add +4 to both my Strength and Constitution, and their maximums increase to 26."),
			scores : [4,0,4,0,0,0],
			scoresMaximum : [26,0,26,0,0,0],
		},
	},
};

////// Add UA23PT7 Path of the Beserker Barbarian subclass
AddSubClass("barbarian_ua23pt8", "beserker_ua23pt7", { //Ripped directly from "ListsClasses.js" and then altered
	regExpSearch : /^((?=.*\b(berserker|berserk|berserkr|ulfheonar)s?\b)|((?=.*(warrior|fighter))(?=.*(odin|thor)))).*$/i,
	subname : "Path of the Berserker",
	fullname : "Berserker (UA:PT-viii)",
	source : [["UA23PT7", 5], ["SRD", 9], ["P", 49], ["MJ:HB", 0]],
	abilitySave : 1,
	features : {
		"subclassfeature3" : {
			name : "Frenzy",
			source : [["UA23PT7", 5], ["SRD", 9], ["P", 49], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"If I use Reckless Attack with a Str. based attack while my Rage is active, I deal extra damage to",
				"  the 1st target I hit on my turn. The extra damage is my Rage Damage bonus in d6s, and consists",
				"  of the same type of damage as the attack normally deals.",
			]),
			additional : levels.map( function(n) {
				return "+" + (n < 9 ? 2 : n < 16 ? 3 : 4) + "d6 Frenzy damage";
			}),
		},
		"subclassfeature6" : {
			name : "Mindless Rage",
			source : [["UA23PT7", 5], ["SRD", 10], ["P", 49]],
			minlevel : 6,
			description : desc("While Raging, I can't be Charmed or Frightened, and such effects are suspended"),
			savetxt : { text : ["Immune to being Charmed/Frightened in Rage"] },
		},
		"subclassfeature10" : {
			name : "Retaliation",
			source : [["UA23PT7", 5], ["SRD", 10], ["P", 50], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"When an enemy within 5 ft damages me, I can make a melee attack as a Reaction.",
				"This melee attack can be made with a weapon or as an Unarmed Strike.",
			]),
			action : ["reaction", " (after taking damage)"]
		},
		"subclassfeature14" : {
			name : "Intimidating Presence",
			source : [["UA23PT7", 5], ["SRD", 10], ["P", 49], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"As a Bonus Action, Frighten creatures of my choice within 30 ft for 1 min if it fails a Wisdom save.",
				"If I am Raging, I can affect creatures within 60 ft instead. Creatures behind Total Cover cannot",
				"  be affected by this feature. A Frightened creature repeats the saving throw at the end of each",
				"  of its turns, ending the Frightened condition on itself on a successful save.",
				"I can do this once per Long Rest, though I can expend a use of Rage instead to activate this feature.",
			]),
			action : ["bonus action", ""],
			usages : 1,
			recovery : "long rest",
			altResource : "rage",
		},
	},
});

////// Add UA23PT7 Path of the Wild Heart Barbarian subclass (Formerly the Path of the Totem Warrior)
AddSubClass("barbarian_ua23pt8", "wild heart_ua23pt7", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /^(?=.*(wild heart))(?=.*totem)(?=.*(warrior|fighter|marauder|barbarian|viking|(norse|tribes?|clans?)(wo)?m(a|e)n)).*$/i,
	subname : "Path of the Wild Heart",
	fullname : "Wild Heart Barbarian (UA:PT-viii) (Formerly Totem Warrior)",
	source : [["UA23PT7", 6], ["P", 50], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Animal Speaker (Formerly 'Spirit Seeker')",
			source : [["UA23PT7", 6], ["P", 50], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can cast Beast Sense and Speak with Animals as rituals (PHB 217 \u0026 277).",
				"Wisdom is my spellcasting ability for these spells.",
			]),
			spellcastingBonus : {
				name : "Spirit Seeker",
				spells : ["beast sense", "speak with animals"],
				selection : ["beast sense", "speak with animals"],
				firstCol : "(R)",
				spellcastingAbility : 5,
				times : 2,
			},
			spellChanges : {
				"beast sense" : {
					time : "10 min",
					changes : "I can cast this spell only as a ritual, thus its casting time is 10 minutes longer."
				},
				"speak with animals" : {
					time : "10 min",
					changes : "I can cast this spell only as a ritual, thus its casting time is 10 minutes longer."
				},
			},
		},
		"subclassfeature3.1" : {
			name : "Rage of the Wilds (Formerly 'Totem Spirit')",
			source : [["UA23PT7", 6], ["P", 50], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				'Choose Rage of the Bear, Eagle, or Wolf using the "Choose Feature" button above.',
			]),
			choices : ["Bear", "Eagle", "Wolf"],
			"bear" : {
				name : "Rage of the Bear",
				description : desc([
					"When I activate Rage, I gain Resistance to 2 damage types of my choice, except Force/Psychic.",
					"I have Resistance to the chosen types until the Rage ends.",
					"I can change my \"Rage of the Wilds\" choice whenever I gain a Barbarian lvl.",
				]),
				dmgres : [["Bear Resist 1 (rage)", "Bear Resist 2 (rage)"]],
				eval : function() {
					processResistance(false, 'Barbarian: Rage', ClassList.barbarian_ua23pt8.features["rage ua23pt8"].dmgres);
				},
				removeeval : function() {
					processResistance(true, 'Barbarian: Rage', ClassList.barbarian_ua23pt8.features["rage ua23pt8"].dmgres);
				},
			},
			"eagle" : {
				name : "Rage of the Eagle",
				description : desc([
					"While Raging, I can use use a Bonus Action to take both the Dash \u0026 Disengage actions.",
					"I can change my \"Rage of the Wilds\" choice whenever I gain a Barbarian lvl.",
				]),
				action : ["bonus action", " (Dash \u0026 Disengage)"],
			},
			"wolf" : {
				name : "Rage of the Wolf",
				description : desc([
					"While Raging, friends have Adv. on melee attacks vs. hostiles within 10 ft of me.",
					"I can change my \"Rage of the Wilds\" choice whenever I gain a Barbarian lvl.",
				]),
			},
		},
		"subclassfeature6" : {
			name : "Aspect of the Wilds (Formerly 'Aspect of the Beast')",
			source : [["UA23PT7", 6], ["P", 50], ["MJ:HB", 0]],
			minlevel : 6,
			description : "\n   " + 'Choose Aspect of the Elephant, Owl, or Spider using the "Choose Feature" button above',
			choices : ["Elephant", "Owl", "Spider"],
			"elephant" : {
				name : "Aspect of the Elephant",
				description : desc([
					"I gain Proficiency in the Athletics or Insight skill. If I'm already Proficient in the skill,",
					"  I gain Expertise in it instead.",
					"I can change my \"Aspect of the Wilds\" choice whenever I gain a Barbarian lvl.",
				]),
				skillstxt : "Choose one from Athletics or Insight; Gain Expertise if already Proficient in chosen skill",
			},
			"owl" : {
				name : "Aspect of the Owl",
				description : desc([
					"I gain Proficiency in the Investigation or Perception skill. If I'm already Proficient in the",
					"  skill, I gain Expertise in it instead.",
					"I can change my \"Aspect of the Wilds\" choice whenever I gain a Barbarian lvl.",
				]),
				skillstxt : "Choose one from Investigation or Perception; Gain Expertise if already Proficient in chosen skill",
			},
			"spider" : {
				name : "Aspect of the Spider",
				description : desc([
					"I gain Proficiency in the Stealth or Survival skill. If I'm already Proficient in the skill,",
					"  I gain Expertise in it instead.",
					"I can change my \"Aspect of the Wilds\" choice whenever I gain a Barbarian lvl.",
				]),
				skillstxt : "Choose one from Stealth or Survival; Gain Expertise if already Proficient in chosen skill",
			},
		},
		"subclassfeature10" : {
			name : "Nature Speaker (Formerly 'Spirit Walker')",
			source : [["UA23PT7", 6], ["P", 50], ["MJ:HB", 0]],
			minlevel : 10,
			description : "\n   " + "I can cast Commune with Nature as a ritual. Wisdom is my spellcasting ability for this spell.",
			spellcastingBonus : {
				name : "Spirit Walker",
				spells : ["commune with nature"],
				selection : ["commune with nature"],
				spellcastingAbility : 5,
				firstCol : "(R)"
			},
			spellChanges : {
				"commune with nature" : {
					time : "11 min",
					changes : "I can cast this spell only as a ritual, thus its casting time is 10 minutes longer."
				},
			},
		},
		"subclassfeature14" : {
			name : "Power of the Wilds (Formerly 'Totemic Attunement')",
			source : [["UA23PT7", 6], ["P", 50], ["MJ:HB", 0]],
			minlevel : 14,
			description : "\n   " + 'Choose Power of the Lion, Falcon, or Ram using the "Choose Feature" button',
			choices : ["Lion", "Falcon", "Ram"],
			"lion" : {
				name : "Power of the Lion",
				description : desc([
					"While Raging, any enemies within 5 ft has Disadv. on attacks vs. targets other than myself",
					"  or another Barbarian with this feature.",
					"I can change my \"Power of the Wilds\" choice whenever I gain a Barbarian lvl.",
				]),
			},
			"falcon" : {
				name : "Power of the Falcon",
				description : desc([
					"While Raging without armor, I gain a Fly Speed equal to my Speed.",
					"I can change my \"Power of the Wilds\" choice whenever I gain a Barbarian lvl.",
				]),
				speed : { fly : { spd : "walk", enc : "walk" } },
			},
			"ram" : {
				name : "Power of the Ram",
				description : desc([
					"If my melee attack hits a Large or smaller creature while Raging, it must make a Str save.",
					"The DC = 8 + Prof Bonus + Str Mod, and it is knocked Prone if it fails.",
					"I can change my \"Power of the Wilds\" choice whenever I gain a Barbarian lvl.",
				]),
			},
		},
	},
});

////// Add UA23PT8 Path of the World Tree Barbarian subclass; Introduced as a part of the One D&D/5.1E Playtests
AddSubClass("barbarian_ua23pt8", "world tree_ua23pt8", {
	regExpSearch : /^(?=.*world)(?=.*tree).*$/i,
	subname : "Path of the World Tree",
	fullname : "World Tree Barbarian (UA:PT-viii)",
	source : [["UA23PT8", 5], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Vitality of the Tree",
			source : [["UA23PT8", 5], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"When I activate my Rage, I gain my Barbarian lvl in Temp HP. Additionally, while my Rage is active,",
				"  at the start of each of my turns, I can give another creature within 10 ft Temp HP equal to my",
				"  my Rage Damage bonus in d6s. These Temp HP last until depleted or until my Rage ends.",
			]),
			additional : levels.map(function (n) {
				return "+" + (n < 9 ? 2 : n < 16 ? 3 : 4) + "d6 Temp HP to another per turn";
			}),
		},
		"subclassfeature6" : {
			name : "Branches of the Tree",
			source : [["UA23PT8", 5], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"While my Rage is active, I use my Reaction to force a creature that starts its turn within 30 ft",
				"  of me to make a Strength save (DC = 8 + Prof Bonus + Str Mod) or be teleported to an unoccupied",
				"  space I can see within 5 ft of me or in the nearest unoccupied space I can see. After teleporting,",
				"  I can reduce its Speed to 0 until the end of the current turn.",
				"The space the target teleports to must be a surface or liquid that can support it.",
			]),
			action : ["reaction", ""],
		},
		"subclassfeature10" : {
			name : "Battering Roots",
			source : [["UA23PT8", 6], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"While using a Melee weapon with the Heavy or Versatile property, my reach with that weapon increases",
				"  by 10 ft, and I can activate the Push or Topple property in addition to any other Mastery property",
				"  I am using with that weapon.",
			]),
/*	-SCRIPT AUTHOR NOTE-
	Mastery properties don't seem to be being added to weapons correctly for now, & I cannot figure out why.
	This calcChanges code is based on the code from MPMB, but it seems to not be functioning at all for now;
	just to make sure that this code doesn't introduce any errors, it has been commented out for now.
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if ( !/mastery/i.test(v.WeaponTextName) ) return;
						var aOptionalMasteries = ['Slow'];
						if ( /heavy|versatile/i.test(fields.Description) ) {
							aOptionalMasteries.push('Push');
						}
						if ( /heavy|versatile/i.test(fields.Description) ) {
							aOptionalMasteries.push('Topple');
						}
						if ( v.mastery && aOptionalMasteries.indexOf(v.mastery) === -1 ) {
							aOptionalMasteries.push(v.mastery);
						}
						// Sort this new array
						aOptionalMasteries.sort();
						var sMasteries = 'Mstry: ' + aOptionalMasteries.join('/');
						// Add to the description (replace current "Mstry: X" if it exists)
						var rxMstry = /Mstry: (Slow|Nick|Push|Vex|Sap|Topple|Graze|Cleave)/i;
						if ( rxMstry.test(fields.Description) ) {
							fields.Description = fields.Description.replace(rxMstry, sMasteries);
							fields.Range = fields.Range.replace("Melee", "Melee (15 ft)");
						} else {
							// no "Mstry: X" string so just add it to the end
							fields.Description += (fields.Description ? '; ' : '') + sMasteries;
							fields.Range = fields.Range.replace("Melee", "Melee (15 ft)");
						}
					},
					'Weapons with the word "Mastery" & the Heavy or Versatile properties will have the Push & Topple Mastery properties appended to their descriptions.'
				],
			},*/
		},
		"subclassfeature14" : {
			name : "Travel Along the Tree",
			source : [["UA23PT8", 6], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"When I activate my Rage \u0026 as a Bonus Action while it's active, I can teleport up to 60 ft to",
				"  an unoccupied space I can see. Once per Rage, I can also bring up to 6 willing creatures within",
				"  10 ft of myself, increasing the teleport range to 500 ft. Each creature teleports to an",
				"  unoccupied space of my choice within 10 ft of me.",
			]),
			limfeaname : " (Teleport 6 others)",
			usages : 1,
			recovery : "rage",
		},
	},
});

////// Add UA23PT7 Path of the Zealot Barbarian subclass
AddSubClass("barbarian_ua23pt8", "zealot_ua23pt7", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /zealot/i,
	subname : "Path of the Zealot",
	fullname : "Zealot (UA:PT-viii)",
	source : [["UA23PT7", 7], ["X", 11], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Divine Fury",
			source : [["UA23PT7", 7], ["X", 11], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"While Raging, the first creature I hit with a weapon or Unarmed Strike in my turn gets extra damage.",
				"This is Necrotic or Radiant damage equal to 1d6 + half my Barbarian level.",
				'Choose a damage type using the "Choose Feature" button above.',
			]),
			additional : levels.map(function (n) { return n < 3 ? "" : "+1d6+" + Math.floor(n/2) + " damage"; }),
			choices : ["Necrotic Damage", "Radiant Damage"],
			"necrotic damage" : {
				name : "Divine Fury",
				description : desc([
					"While Raging, the first creature I hit with a weapon or Unarmed Strike in my turn gets extra damage.",
					"It takes an extra 1d6 + half my Barbarian level worth of Necrotic damage.",
				]),
				additional : levels.map(function (n) { return n < 3 ? "" : "+1d6+" + Math.floor(n/2) + " necrotic damage"; })
			},
			"radiant damage" : {
				name : "Divine Fury",
				description : desc([
					"While Raging, the first creature I hit with a weapon or Unarmed Strike in my turn gets extra damage.",
					"It takes an extra 1d6 + half my Barbarian level worth of Radiant damage.",
				]),
				additional : levels.map(function (n) { return n < 3 ? "" : "+1d6+" + Math.floor(n/2) + " radiant damage"; })
			},
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (!v.isSpell && classes.known.barbarian_ua23pt8 && classes.known.barbarian_ua23pt8.level > 2 && (/\brage\b/i).test(v.WeaponTextName)) {
							var theDMG = GetFeatureChoice('class', 'barbarian_ua23pt8', 'subclassfeature3');
							if (!theDMG) return;
							fields.Description += (fields.Description ? '; ' : '') + '+1d6+' + Math.floor(classes.known.barbarian_ua23pt8.level / 2) + ' ' + GetFeatureChoice('class', 'barbarian_ua23pt8', 'subclassfeature3') + ' on first hit each turn';
						};
					},
					"If I include the word 'Rage' in a melee weapon's name, it will show in its description that its first hit does extra damage."
				]
			},
		},
		"subclassfeature3.1" : {
			name : "Warrior of the Gods",
			source : [["UA23PT7", 7], ["X", 11], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"When a spell or magic item restores any of my HP, I can regain an extra d12 HP.",
				"I can use this benefit Con. mod number of times per Long Rest. Additionally, spells with the",
				"  sole effect of restoring me to life (not undeath) don't require Material comp.",
			]),
			limfeaname : " (+1d12 HP)",
			usages : "Constitution modifier per ",
			usagescalc : "event.value = Math.max(1, What('Con Mod'));",
			recovery : "long rest",
		},
		"subclassfeature6" : {
			name : "Fanatical Focus",
			source : [["UA23PT7", 8], ["X", 11]],
			minlevel : 6,
			description : desc([
				"When I fail a saving throw while Raging, I can reroll it and must use the new roll.",
				"I can use this ability only once per Rage."
			]),
			usages : 1,
			recovery : "rage",
		},
		"subclassfeature10" : {
			name : "Zealous Presence",
			source : [["UA23PT7", 8], ["X", 11], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"As a Bonus Action, I choose up to 10 creatures within 60 ft that can hear my battle cry.",
				"These creatures gain Adv. on attacks and saves until the start of my next turn.",
				"I can do this once per Long Rest, though I can expend a use of Rage instead to activate this feature.",
			]),
			usages : 1,
			recovery : "long rest",
			action : ["bonus action", ""],
			altResource : "rage",
		},
		"subclassfeature14" : {
			name : "Rage Beyond Death",
			source : [["UA23PT7", 8], ["X", 11], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"When my Relentless Rage successfully restores my HP, I gain the following benefits:",
				" \u2022 I have a Fly Speed equal to my Speed \u0026 can hover. I can move through creatures/objects",
				"  as if they were Difficult Terrain; I take 1d10 Force damage if I end turn inside creature/object.",
				" \u2022 When I'm hit by an attack roll, I can use my Reaction to turn that hit into a miss.",
				"This form lasts for 1 minute or until I regain any HP or drop to 0 HP.",
			]),
			usages : 1,
			recovery : "long rest",
			action : ["reaction", " (change enemy hit to miss)"],
		},
	},
});

// Add UA23PT8 Druid class
ClassList.druid_ua23pt8 = {
	name : "Druid (UA:PT-viii)",
	regExpSearch : /druid/i,
	source : [["UA23PT8", 7], ["MJ:HB", 0]],
	primaryAbility : "Wisdom",
	prerequisite : "Wisdom 13+",
	prereqeval : function(v) {
		return (What('Wis') >= 13);
	},
	die : 8,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
	saves : ["Int", "Wis"],
	skills : ["\n\n" + toUni("Druid") + ": Choose two from Arcana, Animal Handling, Insight, Medicine, Nature, Perception, Religion, Survival", ""],
	toolProfs : {
		primary : [["Herbalism Kit", "Wis"]],
	},
	armor : [
		[true, false, false, true],
		[true, false, false, true],
	],
	weapons : [
		[true, false, [""]],
		[false, false, [""]],
	],
	equipment : "Druid starting equipment:" +
		"\n \u2022 Druidic Focus (Quarterstaff)," +
		"\n \u2022 Explorer's Pack," +
		"\n \u2022 Herbalism Kit," +
		"\n \u2022 Leather Armor," +
		"\n \u2022 Shield," +
		"\n \u2022 Sickle," +
		"\n \u2022 9 gp" +
		"\n\nAlternatively, choose 50 gp worth of starting equipment instead of the class' starting equipment.",
	subclasses : ["Druid Circle", []],
	attacks : [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
	abilitySave : 5,
	spellcastingFactor : 1,
	spellcastingKnown : {
		cantrips : [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
		spells : "list",
		prepared : true,
	},
	spellcastingList : {
		class : ["druid", "druid_ua23pt8"],
	},
	features : {
		"druidic ua23pt8" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Druidic",
			source : [["UA23PT8", 8], ["SRD", 19], ["P", 66], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I know Druidic; Hidden messages with it can only be understood by those who know Druidic.",
				"Others can spot messages written in Druidic with a DC15 Investigation check.",
				"I also always have the Speak with Animals spell prepared.",
			]),
			languageProfs : ["Druidic"],
			spellcastingExtra : ["speak with animals"],
		},
		"primal order ua23pt8" : { //Ripped from Cleric in "UA2023PT6 Content [by MasterJedi2014] V4.js" and then altered
			name : "Primal Order",
			source : [["UA23PT8", 8], ["MJ:HB", 0]],
			minlevel : 1,
			description : "\n   " + "Choose a Primal Order using the \"Choose Feature\" button above. The chosen option will appear in pg 3's Notes section.",
		},
		"spellcasting ua23pt8" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Spellcasting",
			source : [["UA23PT8", 9], ["SRD", 19], ["P", 66], ["MJ:HB", 0]],
			minlevel : 1,
			description : desc([
				"I can cast prepared Druid cantrips/spells, using Wisdom as my spellcasting ability.",
				"I can use a Druidic Focus as a spellcasting focus for my Druid spells.",
				"I can cast my prepared Druid spells as Rituals if they have the Ritual tag.",
				"I can swap a known Druid cantrip for another every time I gain a Druid lvl.",
			]),
			additional : levels.map(function (n, idx) { //Ripped from Warlock in "UA2023PT7 Content [by MasterJedi2014] V4.js" and then altered
				var cantr = [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4][idx];
				var splls = [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22][idx];
				return cantr + " cantrips known \u0026 " + splls + " spells prepared";
			}),
		},
		"wild companion ua23pt8" : { //Ripped directly from "all_WotC_pub+UA.js" and then altered
			name : "Wild Companion",
			source : [["UA23PT8", 9], ["T", 35], ["UA:CFV", 4], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"I can expend a use of Wild Shape or a spell slot to cast Find Familiar without material comp.",
				"The Familiar always has the Fey type and disappears when I finish a Long Rest."
			]),
			spellcastingBonus : {
				name : "Wild Companion",
				spells : ["find familiar", "find familiar ua23dp"],
				selection : ["find familiar", "find familiar ua23dp"],
				firstCol : "Sp",
				times : 2,
			},
			spellChanges : {
				"find familiar" : {
					components : "V,S",
					compMaterial : "",
					description : "Gain the services of a fey familiar; can see through its eyes; it can deliver touch spells; see B",
					duration : "until Long Rest",
					changes : "By using my Wild Companion class feature, I can expend a spell slot of a use of Wild Shape to cast Find Familiar without material components. The familiar created this way always has the Fey type and disappears when I finish a Long Rest."
				},
				"find familiar ua23dp" : {
					components : "V,S",
					compMaterial : "",
					description : "Gain the services of a fey familiar; can see through its eyes; it can deliver touch spells; see B",
					duration : "until Long Rest",
					changes : "By using my Wild Companion class feature, I can expend a spell slot of a use of Wild Shape to cast Find Familiar without material components. The familiar created this way always has the Fey type and disappears when I finish a Long Rest."
				},
			},
		},
		"subclassfeature2.wild shape" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Wild Shape",
			source : [["UA23PT8", 9], ["SRD", 20], ["P", 66], ["MJ:HB", 0]],
			minlevel : 2,
			description : desc([
				"As a Bonus Action, I assume the shape of a Beast I have seen before with the following rules:",
				" \u2022 I gain all its game statistics except HD, HP, Int, Wis, Cha, \u0026 Proficiency Bonus;",
				" \u2022 I retain class features, languages, \u0026 feats, but I don't retain special senses;",
				" \u2022 I also retain my personality, memories, \u0026 ability to speak;",
				" \u2022 I keep my skill/saving throw prof.; if it has the same prof, I use whichever bonus is higher;",
				" \u2022 I can't cast spells in Beast form, but transforming doesn't break Concentration;",
				" \u2022 I can choose whether equipment falls to the ground, merges, or stays worn;",
				" \u2022 I gain Temp HP equal to my Druid level;",
				"I revert by running out of time, using Wild Shape again, or using a Bonus Action to end it.",
				"I regain one expended use of Wild Shape when I finish a Short Rest.",
				"I know a number of forms equal to 2 + half my Druid lvl (round up).",
			]),
			usages : [0, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, "\u221E\xD7 per "],
			recovery : "long rest",
			additional : levels.map(function (n) {
				if (n < 2) return "";
				var frms = 2 + Math.ceil(n/2);
				var cr = n < 4 ? "1/4" : n < 8 ? "1/2" : 1;
				var hr = Math.floor(n/2);
				var restr = n < 8 ? ", no Fly" : "";
				return frms + " forms known; CR " + cr + restr + "; " + hr + (restr.length ? " h" : " hours") + "; " + n + " Temp HP";
			}),
			limfeaname : "Wild Shape",
			action : ["bonus action", " (start/end)"],
		},
		"subclassfeature3" : { //Ripped directly from "ListsClasses.js"
			name : "Druid Circle",
			source : [["UA23PT8", 10], ["SRD", 21], ["P", 67]],
			minlevel : 3,
			description : desc('Choose a Circle you can identify with and put it in the "Class" field.')
		},
		"wild resurgence ua23pt8" : {
			name : "Wild Resurgence",
			source : [["UA23PT8", 10], ["MJ:HB", 0]],
			minlevel : 5,
			description : desc([
				"If I have no uses of Wild Shape left, I can give myself one by expending a spell slot (no",
				"  action required). I can do this only once per turn.",
				"Once per Long Rest, I can convert 1 use of Wild Shape into a 1st-lvl spell slot.",
			]),
			usages : 1,
			recovery : "long rest",
		},
		"elemental fury ua23pt8" : { //Ripped from Cleric in "UA2023PT6 Content [by MasterJedi2014] V4.js" and then altered
			name : "Elemental Fury",
			source : [["UA23PT8", 10], ["MJ:HB", 0]],
			minlevel : 7,
			description : "\n   " + "Choose an Elemental Fury option using the \"Choose Feature\" button above. The chosen option will appear in pg 3's Notes section.",
		},
		"commune with nature ua23pt8" : { //Ripped from Cleric in "UA2023PT6 Content [by MasterJedi2014] V4.js" and then altered
			name : "Commune with Nature",
			source : [["UA23PT8", 11], ["MJ:HB", 0]],
			minlevel : 9,
			description : desc([
				"I now always have the Commune with Nature spell prepared.",
			]),
			spellcastingBonus : {
				name : "Commune with Nature",
				spells : ["commune with nature"],
				selection : ["commune with nature"],
				times : 1,
			},
		},
		"improved elemental fury ua23pt8" : { //Ripped from Cleric in "UA2023PT6 Content [by MasterJedi2014] V4.js" and then altered
			name : "Improved Elemental Fury",
			source : [["UA23PT8", 11], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"The option I chose for Elemental Fury at 7th Lvl grows more powerful.",
			]),
		},
		"beast spells ua23pt8" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Beast Spells",
			source : [["UA23PT8", 11], ["SRD", 21], ["P", 67], ["MJ:HB", 0]],
			minlevel : 18,
			description : desc([
				"I can cast Druid spells while in a Beast form unless the spell has a costly Material component",
				"  or if it consumes its Material component.",
			]),
		},
		"archdruid ua23pt8" : { //Ripped directly from "ListsClasses.js" and then altered
			name : "Archdruid",
			source : [["UA23PT8", 11], ["SRD", 21], ["P", 67], ["MJ:HB", 0]],
			minlevel : 20,
			description : desc([
				"When I roll Initiative with no uses of Wild Shape left, I regain one expended use.",
				"I can convert uses of Wild Shape into a single spell slot (no action required). Each Wild Shape",
				"  use can be converted to 2 spell levels. EX: 2 Wild Shape uses = 1 lvl 4 spell slot. I can do",
				"  this once per Long Rest.",
				"I age more slowly, only 1 year for every 10 years that pass."
			]), //"Timeless Body" was rolled into "Archdruid"
			limfeaname : "Archdruid: Convert Wild Shapes to Spell Slot",
			usages : 1,
			recovery : "long rest",
		},
	},
};

//// Add Druid "Primal Order" choices
AddFeatureChoice(ClassList.druid_ua23pt8.features["primal order ua23pt8"], true, "Primal Order: Magician", {
	name : "Primal Order: Magician",
	extraname : "Druid 1",
	source : [["UA23PT8", 8], ["MJ:HB", 0]],
	description : "\n   " + "I know 1 extra cantrip from the Druid spell list & I add my Wis modifier to Intelligence (Nature) checks.",
	spellcastingBonus : [{
		name : "Druid cantrip",
		spellcastingAbility : 5,
		"class" : ["druid", "druid_ua23pt8"],
		level : [0, 0],
		firstCol : "atwill",
		times : 1
	}],
	addMod : [
		{ type : "skill", field : "Nature", mod : "Wis", text : "I can add my Wisdom modifier to Intelligence (Religion) checks." },
	],
	prereqeval : function (v) { return classes.known.druid_ua23pt8.level >= 1 ? true : "skip"; }
}, "1st-level druid Primal Order choice");
AddFeatureChoice(ClassList.druid_ua23pt8.features["primal order ua23pt8"], true, "Primal Order: Warden", {
	name : "Primal Order: Warden",
	extraname : "Druid 1",
	source : [["UA23PT8", 9], ["MJ:HB", 0]],
	description : "\n   " + "I gain Martial Weapons Proficiency & Meduim Armor training.",
	weaponProfs : [false, true],
	armorProfs : [
		[false, true, false, false],
	],
	prereqeval : function (v) { return classes.known.druid_ua23pt8.level >= 1 ? true : "skip"; }
}, "1st-level druid Primal Order choice");

//// Add Druid "Elemental Fury" choices
AddFeatureChoice(ClassList.druid_ua23pt8.features["elemental fury ua23pt8"], true, "Elemental Fury: Potent Spellcasting", {
	name : "Elemental Fury: Potent Spellcasting",
	extraname : "Druid 7",
	source : [["UA23PT8", 10], ["MJ:HB", 0]],
	description : "\n   " + "I add my Wisdom modifier to the damage I deal with my Druid cantrips;" + "\n   " + "At 14th Lvl, Druid cantrips with a range of at least 10 ft increase their range by an additional 300 ft.",
	calcChanges : {
		atkCalc : [
			function (fields, v, output) {
				if (classes.known.druid_ua23pt8 && classes.known.druid_ua23pt8.level > 7 && v.thisWeapon[3] && v.thisWeapon[4].indexOf('druid_ua23pt8') !== -1 && SpellsList[v.thisWeapon[3]].level === 0) {
					output.extraDmg += What('Wis Mod');
				};
			},
			"My Druid cantrips get my Wisdom modifier added to their damage.",
		],
		spellAdd : [
			function (spellKey, spellObj, spName) {
				if (spName.indexOf("druid_ua23pt8") == -1 || !What("Wis Mod") || Number(What("Wis Mod")) <= 0 || spellObj.psionic || spellObj.level !== 0) return;
				return genericSpellDmgEdit(spellKey, spellObj, "\\w+\\.?", "Wis");
			},
			"My Druid cantrips get my Wisdom modifier added to their damage.",
		],
	},
	prereqeval : function (v) { return classes.known.druid_ua23pt8.level >= 7 ? true : "skip"; }
}, "7th-level druid Elemental Fury choice");
AddFeatureChoice(ClassList.druid_ua23pt8.features["elemental fury ua23pt8"], true, "Elemental Fury: Primal Strike", {
	name : "Elemental Fury: Primal Strike",
	extraname : "Druid 7",
	source : [["UA23PT8", 11], ["MJ:HB", 0]],
	description : "\n   " + "Once per turn, when I hit a creature with a weapon or Beast form's attack in Wild Shape, I can do extra damage;" + "\n   " + "This extra damage consists of 1d8 of my choice of Cold, Fire, Lightning, or Thunder damage; damage increases at 14th Lvl.",
	additional : levels.map(function (n) {
		return n < 7 ? "" : "+" + (n < 14 ? 1 : 2) + "d8 Radiant/Necrotic damage (choice)";
	}),
	calcChanges : {
		atkAdd : [
			function (fields, v) {
				if (classes.known.druid_ua23pt8 && classes.known.druid_ua23pt8.level >= 7 && !v.isSpell) {
					fields.Description += (fields.Description ? '; ' : '') + 'Once per turn +' + (classes.known.druid_ua23pt8.level < 14 ? 1 : 2) + 'd8 Cold, Fire, Lightning, or Thunder damage';
				}
			},
			"Once per turn, when I hit a creature with a weapon or Beast form's attack in Wild Shape, I can do extra Cold, Fire, Lightning, or Thunder damage.",
		],
	},
	prereqeval : function (v) { return classes.known.druid_ua23pt8.level >= 7 ? true : "skip"; }
}, "7th-level druid Elemental Fury choice");

//// Add Druid optional choices; Ripped directly from "all_WotC_pub+UA.js" and then altered
AddFeatureChoice(ClassList.druid_ua23pt8.features["spellcasting ua23pt8"], true, "Access to Dunamancy Spells", {
	name : "Dunamancy Spells",
	extraname : "Optional Druid 1",
	source : [["W", 186]],
	description : desc([
		"All dunamancy spells are added to the Druid spell list, each still pending DM's approval."
	]),
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "druid_ua23pt8" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["sapping sting", "gift of alacrity", "magnify gravity", "fortune's favor", "immovable object", "wristpocket", "pulse wave", "gravity sinkhole", "temporal shunt", "gravity fissure", "tether essence", "dark star", "reality break", "ravenous void", "time ravage"]);
			},
			"This optional class feature expands the spell list of the Druid class with all dunamancy spells (spell level in brackets): Sapping Sting (cantrip), Gift of Alacrity (1), Magnify Gravity (1), Fortune's Favor (2), Immovable Object (2), Wristpocket (2), Pulse Wave (3), Gravity Sinkhole (4), Temporal Shunt (5), Gravity Fissure (6), Tether Essence (7), Dark Star (8), Reality Break (8),Ravenous Void (9), and Time Ravage (9)."
		]
	}
}, "Optional 1st-level druid features");
AddFeatureChoice(ClassList.druid_ua23pt8.features["spellcasting ua23pt8"], true, "Additional Druid Spells", {
	name : "Additional Druid Spells",
	extraname : "Optional Druid 1",
	source : [["T", 35]],
	description : "",
	calcChanges : {
		spellList : [
			function(spList, spName, spType) {
				// Stop this is not the class' spell list or if this is for a bonus spell entry
				if (spName !== "druid_ua23pt8" || spType.indexOf("bonus") !== -1) return;
				spList.extraspells = spList.extraspells.concat(["protection from evil and good", "augury", "continual flame", "enlarge/reduce", "aura of vitality", "elemental weapon", "revivify", "divination", "fire shield", "cone of cold", "flesh to stone", "symbol", "incendiary cloud"]);
			},
			"This optional class feature expands the spell list of the Druid class with the following spells (spell level in brackets): Protection from Evil and Good (1), Augury (2), Continual Flame (2), Enlarge/Reduce (2), Aura of Vitality (3), Elemental Weapon (3), Revivify (3), Divination (4), Fire Shield (4), Cone of Cold (5), Flesh to Stone (6), Symbol (7), and Incendiary Cloud (8)."
		]
	}
}, "Optional 1st-level druid features");

////// Add UA23PT6 Circle of the Land Druid subclass
AddSubClass("druid_ua23pt8", "circle of the land_ua23pt6", { //Ripped directly from "ListsClasses.js" and then heavily altered
	regExpSearch : /^(?=.*druid)(?=.*\b(land|arctic|coast|deserts?|forests?|grasslands?|steppes?|mountains?|swamps?|underdark)\b).*$/i,
	subname : "Circle of the Land",
	source : [["UA23PT6", 21], ["SRD", 21], ["P", 68], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Circle Spells",
			source : [["UA23PT6", 22], ["SRD", 21], ["P", 68], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc('Choose a terrain that grants you spells using the "Choose Feature" button above.'),
			choices : ["Arid", "Polar", "Temperate", "Tropical"],
			"arid" : {
				name : "Arid Circle Spells",
				description : desc([
					"My mystical connection to arid land infuses me with the ability to cast certain spells.",
					"These are always prepared, but don't count against the number of spells I can prepare.",
					"I can change the type of land chosen whenever I finish a Long Rest.",
				]),
				spellcastingExtra : ["blur", "burning hands", "fire bolt", "fireball", "blight", "wall of stone"],
			},
			"polar" : {
				name : "Polar Circle Spells",
				description : desc([
					"My mystical connection to polar land infuses me with the ability to cast certain spells.",
					"These are always prepared, but don't count against the number of spells I can prepare.",
					"I can change the type of land chosen whenever I finish a Long Rest.",
				]),
				spellcastingExtra : ["fog cloud", "hold person", "ray of frost", "sleet storm", "ice storm", "cone of cold"],
			},
			"temperate" : {
				name : "Temperate Circle Spells",
				description : desc([
					"My mystical connection to temperate land infuses me with the ability to cast certain spells.",
					"These are always prepared, but don't count against the number of spells I can prepare.",
					"I can change the type of land chosen whenever I finish a Long Rest.",
				]),
				spellcastingExtra : ["misty step", "shocking grasp", "shocking grasp ua23bc", "sleep", "lightning bolt", "freedom of movement", "tree stride"],
			},
			"tropical" : {
				name : "Tropical Circle Spells",
				description : desc([
					"My mystical connection to tropical land infuses me with the ability to cast certain spells.",
					"These are always prepared, but don't count against the number of spells I can prepare.",
					"I can change the type of land chosen whenever I finish a Long Rest.",
				]),
				spellcastingExtra : ["acid splash", "acid splash ua23bc", "ray of sickness", "web", "stinking cloud", "polymorph", "insect plague"],
			},
			choiceDependencies : [{
				feature : "subclassfeature10"
			}],
		},
		"subcalssfeature3.1" : {
			name : "Land's Aid",
			source : [["UA23PT6", 22], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a Magic action, I can expend a use of Wild Shape \u0026 choose a point within 60 ft of myself.",
				"Centered on that point, a 10 ft rad sphere of life-giving flowers \u0026 life-draining thorns appears.",
				"Each creature of my choice in that area must make a Con save. Creatures that fail take 2d6 Necrotic",
				"  damage, half that on a success. 1 creature of my choice in that area regains 2d6 HP.",
				"The damage \u0026 healing are rolled separately, and increase at Druid levels 10 (3d6) \u0026 14 (4d6).",
			]),
			additional : levels.map(function (n) {
				return "+" + (n < 10 ? 2 : n < 14 ? 3 : 4) + "d6 damage \u0026 healing";
			}),
		},
		"subclassfeature6" : {
			name : "Natural Recovery",
			source : [["UA23PT6", 22], ["SRD", 21], ["P", 68], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"Once per Long Rest, I can cast one of my Circle Spells without expending a spell slot.",
				"After a Short Rest, I can recover a number of 5th-level or lower spell slots.",
				"The spell slots recovered can have a combined lvl that is \u2264 half my Druid lvl (round up).",
			]),
			additional : levels.map(function (n) {
				return Math.ceil(n/2) + " levels of spell slots";
			}),
			usages : 1,
			recovery : "short rest",
		},
		"subclassfeature10" : {
			name : "Nature's Ward",
			source : [["UA23PT6", 22], ["SRD", 22], ["P", 68], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc('Choose a terrain that grants you a Resistance using the "Choose Feature" button above.'),
			choicesNotInMenu : true,
			choices : ["Arid", "Polar", "Temperate", "Tropical"],
			"arid" : {
				name : "Arid Circle Spells",
				description : desc([
					"My mystical bond with arid land protects me.",
					"I am immune to the Poisoned condition \u0026 have Resistance to Fire damage.",
				]),
				savetxt : { immune : ["poisoned"] },
				dmgres : [["Fire"]],
			},
			"polar" : {
				name : "Polar Circle Spells",
				description : desc([
					"My mystical bond with polar land protects me.",
					"I am immune to the Poisoned condition \u0026 have Resistance to Cold damage.",
				]),
				savetxt : { immune : ["poisoned"] },
				dmgres : [["Cold"]],
			},
			"temperate" : {
				name : "Temperate Circle Spells",
				description : desc([
					"My mystical bond with temperate land protects me.",
					"I am immune to the Poisoned condition \u0026 have Resistance to Lightning damage.",
				]),
				savetxt : { immune : ["poisoned"] },
				dmgres : [["Lightning"]],
			},
			"tropical" : {
				name : "Tropical Circle Spells",
				description : desc([
					"My mystical bond with tropical land protects me.",
					"I am immune to the Poisoned condition \u0026 have Resistance to Poison damage.",
				]),
				savetxt : { immune : ["poisoned"] },
				dmgres : [["Poison"]],
			},
		},
		"subclassfeature14" : {
			name : "Nature's Sanctuary",
			source : [["UA23PT6", 22], ["SRD", 22], ["P", 68], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"As a Magic action, I can expend a use of Wild Shape to cause spectral trees \u0026 vines to appear",
				"  in a 15 ft cube on the ground within 120 ft of myself. This cube lasts for 1 min or until I",
				"  am Incapacitated. Myself \u0026 my allies have Half Cover within the cube, \u0026 my allies gain",
				"  the current Resistance of my Nature's Ward while within the cube.",
				"I can use a Bonus Action to move the cube up to 60 ft to another grounded location.",
			]),
		},
	},
});

////// Add UA23PT8 Circle of the Moon Druid subclass
AddSubClass("druid_ua23pt8", "circle of the moon_ua23pt8", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /^(?=.*druid)((?=.*\bmoon\b)|((?=.*\bmany\b)(?=.*\bforms?\b))).*$/i,
	subname : "Circle of the Moon",
	source : [["UA23PT8", 11], ["P", 69], ["MJ:HB", 0]],
	spellcastingExtra : ["cure wounds", "cure wounds ua23pt8", "moonbeam", "starry wisp ua23pt8", "vampiric touch", "fount of moonlight ua23pt8", "dawn"],
	features : {
		"subclassfeature2.wild shape" : {
			name : "Wild Shape",
			source : [["UA23PT8", 12], ["P", 66], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I assume the shape of a Beast I have seen before with the following rules:",
				" \u2022 I gain all its game statistics except HD, HP, Int, Wis, Cha, \u0026 Proficiency Bonus;",
				" \u2022 I retain class features, languages, \u0026 feats, but I don't retain special senses;",
				" \u2022 I also retain my personality, memories, \u0026 ability to speak;",
				" \u2022 I keep my skill/saving throw prof.; if it has the same prof, I use whichever bonus is higher;",
				" \u2022 I can't cast spells in Beast form, but transforming doesn't break Concentration;",
				" \u2022 I can choose whether equipment falls to the ground, merges, or stays worn;",
				" \u2022 I gain Temp HP equal to thrice my Druid level; My AC = 13 + Wis mod;",
				"I revert by running out of time, using Wild Shape again, or using a Bonus Action to end it.",
				"I regain one expended use of Wild Shape when I finish a Short Rest.",
				"I know a number of forms equal to 2 + half my Druid lvl (round up).",
			]),
			usages : [0, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, "\u221E\xD7 per "],
			recovery : "long rest",
			additional : levels.map(function (n) {
				if (n < 2) return "";
				var frms = 2 + Math.ceil(n/2);
				var cr = Math.max(1, Math.floor(n/3));
				var hr = Math.floor(n/2);
				var restr = n < 8 ? ", no Fly" : "";
				var temphp = Math.floor(n*3);
				return frms + " forms known; CR " + cr + restr + "; " + hr + (restr.length ? " h" : " hours") + "; " + temphp + " Temp HP";
			}),
			limfeaname : "Wild Shape",
			action : ["bonus action", " (start/end)"],
			eval : function() {
				processActions(false, "Druid: Wild Shape", ClassList.druid_ua23pt8.features["subclassfeature2.wild shape"].action, "Wild Shape");
			},
		},
		"subclassfeature3" : {
			name : "Circle Forms",
			source : [["UA23PT8", 12], ["P", 69], ["MJ:HB", 0]],
			minlevel : 3,
			description : "\n   " + "I am able to transform into more dangerous animal forms when using Wild Shape."
		},
		"subclassfeature6" : {
			name : "Improved Circle Forms", //This completely replaces "Primal Strike"
			source : [["UA23PT8", 12], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"While in Wild Shape, my attacks can deal either their normal damage type or Radiant damage;",
				"  This choice is made each time I hit.",
				"While in Wild Shape, I can add my Wisdom modifier to my Constitution saving throws.",
			]),
		},
		"subclassfeature10" : {
			name : "Moonlight Step", //This completely replaces "Elemental Wild Shape"
			source : [["UA23PT8", 12], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"As a Bonus Action, I can teleport myself up to 30 ft to an unoccupied space I can see.",
				"Doing so grants me Adv. on my next attack roll before the end of this turn.",
				"I can do this Wis mod number of times per Long Rest; I can also expend a 2nd-lvl or higher",
				"  spell slot to regain a use of this feature.",
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			altResource : "SS 2+",
			action : ["bonus action", ""],
		},
		"subclassfeature14" : {
			name : "Lunar Form", //This completely replaces "Thousand Forms"
			source : [["UA23PT8", 12], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"Each of my attacks in Wild Shape form deal an extra 1d10 Radiant damage.",
				"When I use Moonlight Step, I can also teleport 1 willing creature; This creature must be within",
				"  10 ft of me, and they will arrive within 10 ft of my destination.",
			]),
		},
	},
});

////// Add UA23PT6 Circle of the Sea Druid subclass; Introduced as a part of the One D&D/5.1E Playtests
AddSubClass("druid_ua23pt8", "circle of the sea_ua23pt6", {
	regExpSearch : /^(?=.*druid)(?=.*\b(sea|ocean|water)\b).*$/i,
	subname : "Circle of the Sea",
	source : [["UA23PT6", 24], ["MJ:HB", 0]],
	spellcastingExtra : ["fog cloud", "gust of wind", "ray of frost", "shatter", "thunderwave", "sleet storm", "lightning bolt", "control water", "ice storm", "conjure elemental", "conjure elemental ua23pt8", "hold monster"],
	features : {
		"subclassfeature3" : {
			name : "Wrath of the Sea",
			source : [["UA23PT6", 24], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I can expend a use of Wild Shape to manifest an aura of ocean spray around me.",
				"The aura lasts for 10 min, \u0026 ends early if I become Incapacitated, dismiss it, or manifest it again.",
				"At the end of each of my turns, I can force creatures of my choice within 10 ft of me to make a",
				"  Con save or take Thunder damage \u0026, if it is Large or smaller, be pushed up to 15 ft away from me.",
				"The damage taken is my Wis mod number of d6s (minimum of 1).",
			]),
		},
		"subclassfeature6" : {
			name : "Aquatic Affinity",
			source : [["UA23PT6", 24], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"I always have the Water Breathing spell prepared, \u0026 I gain a Swim Speed equal to my Speed.",
				"Wild Shape forms that normally don't have a Swim Speed now gain my Swim Speed.",
			]),
			speed : { swim : { spd : "walk", enc : "walk" } },
		},
		"subclassfeature10" : {
			name : "Stormborn",
			source : [["UA23PT6", 24], ["MJ:HB", 0]],
			minlevel : 10,
			description : desc([
				"I gain a Fly Speed equal to my Speed, and I gain Resistance to Cold, Lightning, /u0026 Thunder dmg.",
			]),
			speed : { fly : { spd : "walk", enc : "walk" } },
			dmgres : [["Cold"], ["Lightning"], ["Thunder"]],
		},
		"subclassfeature14" : {
			name : "Oceanic Gift",
			source : [["UA23PT6", 24], ["MJ:HB", 0]],
			minlevel : 14,
			description : desc([
				"When I use Wrath of the Sea, I can manifest the aura around 1 willing creature within 60 ft of",
				"  of me rather than manifesting it around myself.",
				"The creature gains all the benefits of the aura, uses my Spell Save DC, \u0026 my Wis mod for the aura.",
				"I can manifest the aura around both myself \u0026 the creature by expending 2 Wild Shape uses.",
			]),
		},
	},
});

// Add UA23PT8 Monk class; code by user @Nod; altered to conform to MasterJedi2014's source referencing scheme, but otherwise left unaltered
ClassList.monkua = {
	regExpSearch : /^((?=.*monk)|(((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior)))).*$/i,
	name : "Monk (UA:PT-viii)",
	source : [["UA23PT8", 13], ["UAM"]],
	primaryAbility : "Dexterity and Wisdom",
	abilitySave : 5,
	prereqs : "Dexterity 13 and Wisdom 13",
	die : 8,
	improvements : [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
	saves : ["Str", "Dex"],
	toolProfs : { primary : [["Artisan's tool or musical instrument", 1]] },
	skillstxt : { primary : "Choose two from Acrobatics, Athletics, History, Insight, Religion, and Stealth" },
	armorProfs : { primary : [false, false, false, false] },
	weaponProfs : {
		primary : [true, false, ["hand crossbow","scimitar","shortsword"]],
		secondary : [true, false, ["hand crossbow","scimitar","shortsword"]]
	},
	equipment : "Monk starting equipment:" +
		"\n \u2022 Artisan's Tools" +
		"\n \u2022 Musical Instrument" +
		"\n \u2022 5 daggers" +
		"\n \u2022 A spear" +
		"\n \u2022 An explorer's pack" +
		"\n\nAlternatively, choose 65 gp worth of starting equipment instead of both the class' and the background's starting equipment.",
	subclasses : ["Monastic Tradition", []],
	attacks : [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	features : {
	"unarmored defense" : {
		name : "Unarmored Defense",
		source : [["UA23PT8", 15], ["UAM"]],
		minlevel : 1,
		description : desc("Without armor and no shield, my AC is 10 + Dexterity modifier + Wisdom modifier"),
		armorOptions : [{
			regExpSearch : /justToAddToDropDown/,
			name : "Unarmored Defense (Wis)",
			source : [["UAM"]],
			ac : "10+Wis",
			affectsWildShape : true
		}],
		armorAdd : "Unarmored Defense (Wis)"
	},
	"martial arts" : {
		name : "Martial Arts",
		source : [["UA23PT8", 14], ["UAM"]],
		minlevel : 1,
		description : desc([
			"Monk weapons are any simple melee and Light property martial weapons. With unarmed",
			"strikes and monk weapons, I can use Dex instead of Str and use the Martial Arts damage die",
			"In addition, when I Grapple or Shove, I can use my Dex modifier to determine the save DC"
		]),
		additional : levels.map(function (n) {
			return "1d" + (n < 5 ? 6 : n < 11 ? 8 : n < 17 ? 10 : 12);
		}),
		action : [["bonus action", "Unarmed Strike"]],
		eval : function() {
			AddString('Extra.Notes', 'Monk features:\n\u25C6 If I wear armor/shield, I lose Unarmored Defense, Martial Arts, and Unarmored Movement');
			show3rdPageNotes();
		},
		removeeval : function() {
			RemoveString('Extra.Notes', 'Monk features:\n\u25C6 If I wear armor/shield, I lose Unarmored Defense, Martial Arts, and Unarmored Movement');
		},
		calcChanges : {
		atkAdd : [ function (fields, v) {
				if (classes.known.monkua && classes.known.monkua.level && (v.theWea.monkweapon || v.baseWeaponName == "unarmed strike" || (/hand crossbow|scimitar|shortsword/i).test(v.baseWeaponName) || (v.isMeleeWeapon && (/simple/i).test(v.theWea.type) ))) {
					v.theWea.monkweapon = true;
					var aMonkDie = function (n) { return n < 5 ? 6 : n < 11 ? 8 : n < 17 ? 10 : 12; }(classes.known.monkua.level);
					try {
						var curDie = eval_ish(fields.Damage_Die.replace('d', '*'));
					} catch (e) {
						var curDie = 'x';
					};
					if (isNaN(curDie) || curDie < aMonkDie) {
						fields.Damage_Die = '1d' + aMonkDie;
					};
					if (fields.Mod == 1 || fields.Mod == 2 || What(AbilityScores.abbreviations[fields.Mod - 1] + " Mod") < What(AbilityScores.abbreviations[v.StrDex - 1] + " Mod")) {
						fields.Mod = v.StrDex;
					}
				};
			},
			"I can use either Strength or Dexterity and my Martial Arts damage die in place of the normal damage die for any 'Monk Weapons', which include any simple melee, unarmed strike, and martial weapons with Light property",
			]
		}
	},
	"monk's discipline" : {
		name : "Monk's Discipline",
		source : [["UA23PT8", 15], ["UAM"]],
		minlevel : 2,
		description : desc(["I can spend discipline points to fuel special actions (see third page)"]),
		limfeaname : "Discipline Points",
		usages : levels.map(function (n) { return n < 2 ? "" : n }),
		recovery : "short rest",
	"flurry of blows" : {
		name : "Flurry of Blows",
		extraname : "Discipline Feature",
		source : [["UA23PT8", 15], ["UAM"]],
		description : levels.map(function (n) {
			return desc("I can make " + (n < 10 ? 2 : 3) + " unarmed strikes as a bonus action");
		}),
		additional : ["1 discipline point"],
		action : ["bonus action", ""]
	},
	"patient defense" : {
		name : "Patient Defense",
		extraname : "Discipline Feature",
		source : [["UA23PT8", 15], ["UAM"]],
		description : levels.map(function (n) {
		return n < 2 ? "" : "\n   As a bonus action, I can take the Disengage action. Alternatively, I can spend 1 discipline \n   point to take both the Disengage and Dodge actions" + (n < 6 ? "" : "\n   When I spend a discipline point, I gain 2 martial arts die rolls of temp HP");
		}),
		additional : [ "", "optional-1 discipline point", "optional-1 discipline point", "optional-1 discipline point", "optional-1 discipline point", "optional-1 discipline point", "optional-1 discipline point", "optional-1 discipline point", "optional-1 discipline point", "optional-1 discipline point; +2 martial arts die THP", "optional-1 discipline point; +2 martial arts die THP", "optional-1 discipline point; +2 martial arts die THP", "optional-1 discipline point; +2 martial arts die THP", "optional-1 discipline point; +2 martial arts die THP", "optional-1 discipline point; +2 martial arts die THP", "optional-1 discipline point; +2 martial arts die THP", "optional-1 discipline point; +2 martial arts die THP", "optional-1 discipline point; +2 martial arts die THP", "optional-1 discipline point; +2 martial arts die THP", "optional-1 discipline point; +2 martial arts die THP"],
		action : ["bonus action", ""]
	},
	"step of the wind" : {
		name : "Step of the Wind",
		extraname : "Discipline Feature",
		source : [["UA23PT8", 15], ["UAM"]],
		description : levels.map(function (n) {
			return n < 2 ? "" : "\n   As a bonus action, I can take the Dash action. Alternatively, I can spend 1 discipline point to\n   take both the Dash and Disengage actions and my jump distance doubles for the turn" + (n < 6 ? "" : "\n   When I spend a discipline point, I can bring a willing Large or smaller creature within 5 feet\n   of me. The creature’s move doesn’t provoke Opportunity Attacks");
		}),
		additional : ["optional-1 discipline point"],
		action : ["bonus action", ""],
	},
	autoSelectExtrachoices : [{
		extrachoice : "flurry of blows"
	}, {
		extrachoice : "patient defense"
	}, {
		extrachoice : "step of the wind"
	}]
	},
	"unarmored movement" : {
		name : "Unarmored Movement",
		source : [["UA23PT8", 15], ["UAM"]],
		minlevel : 2,
		description : desc("Speed increases and eventually lets me traverse some surfaces without falling as I move"),
		additional : levels.map(function (n) {
			if (n < 2) return "";
			var spd = "+" + (n < 6 ? 10 : n < 10 ? 15 : n < 14 ? 20 : n < 18 ? 25 : 30) + " ft";
			var xtr = n < 9 ? "" : "; Vertical surfaces and liquids";
			return spd + xtr;
		}),
		changeeval : function (v) {
			var monkSpd = '+' + (v[1] < 2 ? 0 : v[1] < 6 ? 10 : v[1] < 10 ? 15 : v[1] < 14 ? 20 : v[1] < 18 ? 25 : 30);
			SetProf('speed', monkSpd !== '+0', {allModes : monkSpd}, "Monk: Unarmored Movement");
		}
	},
	"uncanny metabolism" : {
		name : "Uncanny Metabolism",
		source : [["UA23PT8", 15], ["UAM"]],
		minlevel : 2,
		description : desc(["When I roll Initiative, I can regain all expended discipline points. When I do so, I regain a",
		"number of Hit Points equal to my Monk level plus a roll of my Martial Arts die" ]),
		usages : 1,
		recovery : "long rest",
	},
	"subclassfeature3" : {
		name : "Monk Subclass",
		source : [["UA23PT8", 15], ["UAM"]],
		minlevel : 3,
		description : desc('Choose a Monk Subclass to commit to and put it in the "Class" field ')
	},
	"deflect attacks" : {
		name : "Deflect Attacks",
		source : [["UA23PT8", 15], ["UAM"]],
		minlevel : 3,
		description : levels.map(function (n) { return desc([ 
		"As a reaction, I can reduce melee/ranged attacks that deal me " + (n < 13 ? 'Bludg/Pierc/Slash' : 'non-Force') + " dmg",
		"If dmg negated, I can spend 1 discipline point to choose a creature within 5 ft if melee attack",
		"or 60 ft not behind Total Cover if ranged attack. Creature must pass Dex save or take two",
		"rolls of my Martial Arts die + my Dex mod dmg of same type dealt by original attack" ]);
		}),
		additional : levels.map(function (n) { return n < 3 ? "" : "1d10 + " + n + " + Dex mod; 1 discipline point to redirect"; }),
		action : ["reaction", ""],
	},
	"slow fall" : {
		name : "Slow Fall",
		source : [["UA23PT8", 16], ["UAM"]],
		minlevel : 4,
		description : desc("As a reaction, I can reduce any falling damage I take by five times my monk level"),
		additional : levels.map(function (n) { return n < 4 ? "" : (n*5) + " less falling damage" }),
		action : ["reaction", ""],
	"stunning strike" : {
		name : "Stunning Strike",
		extraname : "Monk 5",
		source : [["UA23PT8", 16], ["UAM"]],
		description : " [1/turn, 1 discipline point]" + desc([
			"I can spend a discipline point after I hit a creature with a monk weapon or unarmed strike to",
			"try to stun it. It has to succeed on a Con save or be stunned until the start of my next turn.",
			"On a successful save, the target takes my Wis mod + a roll of my Martial Arts die force dmg" ])
		},
		autoSelectExtrachoices : [{
			extrachoice : "stunning strike",
			minlevel : 5
		}]
	},
	"empowered strikes" : {
		name : "Empowered Strikes",
		source : [["UA23PT8", 16], ["UAM"]],
		minlevel : 6,
		description : desc("My unarmed strikes can deal force damage instead of their regular type"),
		calcChanges : {
		atkAdd : [
			function (fields, v) {
				if (v.baseWeaponName == "unarmed strike" && !v.thisWeapon[1] && !v.theWea.isMagicWeapon && !(/counts as( a)? magical/i).test(fields.Description)) {
					fields.Description += (fields.Description ? '; ' : '') + 'Can deal force dmg; ';
				};
			},
			"My unarmed strikes can deal force damage instead of their regular type"
		]}
	},
	"evasion" : {
		name : "Evasion",
		source : [["UA23PT8", 16], ["UAM"]],
		minlevel : 7,
		description : desc("My Dexterity saves vs. areas of effect negate damage on success and halve it on failure"),
		savetxt : { text : ["Dex save vs. area effects: fail \u2015 half dmg, success \u2015 no dmg"] }
	},
	"heightened discipline" : {
		name : "Heightened Discipline",
		source : [["UA23PT8", 16], ["UAM"]],
		minlevel : 10,
		description : desc("My Flurry of Blows, Patient Defense, and Step of the Wind gain additional benefits"),
	},
	"self-restoration" : {
		name : "Self-Restoration",
		source : [["UA23PT8", 16], ["UAM"]],
		minlevel : 10,
		description : desc([
			"At the end of my turn, I can end one charmed, frightened, or poisoned condition on me",
			"In addition, forgoing food and drink doesn’t give me levels of Exhaustion." ]),
	},
	"deflect energy" : {
		name : "Deflect Energy",
		source : [["UA23PT8", 16], ["UAM"]],
		minlevel : 13,
		description : desc("I can use my Deflect Attacks feature against attacks that deal any damage type.")
	},
	"disciplined survivor" : {
		name : "Disciplined Survivor",
		source : [["UA23PT8", 16], ["UAM"]],
		minlevel : 14,
		description : desc("I am proficient with all saves; I can re-roll a failed save once by spending 1 discipline point"),
		additional : "1 discipline point to re-roll failed saving throw",
		saves : ["Str", "Dex", "Con", "Int", "Wis", "Cha"]
	},
	"perfect discipline" : {
		name : "Perfect Discipline",
		source : [["UA23PT8", 16], ["UAM"]],
		minlevel : 15,
		description : desc("When I roll Initiative with less than 4 discipline points, I gain discipline points until I have 4")
	},
	"superior defense" : {
		name : "Superior Defense",
		source : [["UA23PT8", 16], ["UAM"]],
		minlevel : 18,
		description : " [1 minute or until I am Incapacitated]" + desc("I can spend 3 discipline points at the start of my turn for resistance to all non-Force damage"),
	},
	"body and mind" : {
		name : "Body and Mind",
		source : [["UA23PT8", 16], ["UAM"]],
		minlevel : 20,
		description : desc("I add +4 to both my Dexterity and Wisdom, and their maximums increase to 26"),
		scores : [0,4,0,0,4,0],
		scoresMaximum : [0,26,0,0,26,0]
	}}
};

//// Add Monk optional choices; code by user @Nod
AddFeatureChoice(ClassList.monkua.features["monk's discipline"], true, "Dedicated Weapon", {
	name : "Dedicated Weapon",
	extraname : "Optional Monk 2",
	source : [["UAM"]],
	description : desc([
		"When I finish a short or long rest, I can focus and touch one simple or martial weapon",
		"From then on, until I use this feature again, this weapon counts as a monk weapon for me",
		"I have to be proficient with the weapon and it can't have the heavy or special property"
	]),
	calcChanges : {
		atkAdd : [
			function (fields, v) {
				if (!v.theWea.monkweapon && !v.theWea.special && classes.known.monkua && classes.known.monkua.level && (/dedicated/i).test(v.WeaponTextName) && fields.Proficiency && (/simple|martial/i).test(v.theWea.type) && !(/\b(heavy|special)\b/i).test(fields.Description)) {
					v.theWea.monkweapon = true;
				};
			},
			'If I include the word "Dedicated" in the name of a simple or martial weapon that I\'m proficient with and that doesn\'t have the heavy or special property, it will be treated as a monk weapon.',
			1
		]
	}
}, "Optional 2nd-level monk features");
AddFeatureChoice(ClassList.monkua.features["unarmored movement"], true, "Discipline-Fueled Attack", {
	name : "Discipline-Fueled Attack",
	extraname : "Optional Monk 3",
	source : [["UAM"]],
	description : desc([
		"If I use any discipline points during my action on my turn, I can make an unarmed strike or",
		"monk weapon attack as a bonus action in the same turn" ]),
	action : [["bonus action", ""]],
	prereqeval : function (v) { return classes.known.monkua.level >= 3 ? true : "skip"; }
}, "Optional 3rd-level monk features");
AddFeatureChoice(ClassList.monkua.features["deflect attacks"], true, "Quickened Healing (2 discipline points)", {
	name : "Quickened Healing",
	extraname : "Optional Monk 4",
	source : [["UAM"]],
	description : " [2 discipline points]\n   As an action, I can regain HP equal to the roll of my martial arts die + Proficiency Bonus",
	action : [["action", ""]],
	prereqeval : function (v) { return classes.known.monkua.level >= 4 ? true : "skip"; }
}, "Optional 4th-level monk features");
AddFeatureChoice(ClassList.monkua.features["slow fall"], true, "Focused Aim (1-3 discipline points)", {
	name : "Focused Aim",
	extraname : "Optional Monk 5",
	source : [["UAM"]],
	description : " [1-3 discipline points]\n   When I miss an attack roll, I can increase the roll by +2 per discipline point (max +6)",
	prereqeval : function (v) { return classes.known.monkua.level >= 5 ? true : "skip"; }
}, "Optional 5th-level monk features");

////// Add UA23PT6 Warrior of Shadow Monk subclass
AddSubClass("monkua", "warrior of shadow_ua23pt6", { //Ripped directly from "all_WotC_pub+UA.js" and then altered
	regExpSearch : /^(?=.*shadow)((?=.*monk)|(((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior)))).*$/i,
	subname : "Warrior of Shadow",
	source : [["UA23PT6", 29], ["P", 80], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Shadow Arts",
			source : [["UA23PT6", 29], ["P", 80], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I know the Minor Illusion cantrip and can cast Darkness by using 1 discipline point.",
				"I don't require spell components to cast Darkness, just discipline points.",
				"I can see within the spell's area when I cast it with this feature, \u0026 while the spell persists,",
				"  at the start of each of my turns, I can move its area of darkness to a space within 60 ft of me.",
				"I gain 60 ft of Darkvision; If I already have Darkvision, its range increases by 60 ft.",
			]),
			additional : "[1 discipline point]",
			vision : [
				["Darkvision", "+60"],
			],
			spellcastingBonus : {
				name : "Shadow Arts",
				spells : ["minor illusion"],
				selection : ["minor illusion"],
				firstCol : "atwill",
			},
			spellFirstColTitle : "Discipline Points",
			"shadow spells" : {
				name : "Shadow Arts",
				source : [["UA23PT6", 29], ["P", 80], ["MJ:HB", 0]],
				description : " [1 discipline point]" + "\n   " + "As an action, I can cast Darkness without spell components, just 1 discipline point",
				action : ["action", ""],
				spellcastingBonus : {
					name : "Shadow Arts",
					spells : ["darkness"],
					selection : ["darkness"],
					firstCol : 1,
				},
			},
			spellChanges : {
				"darkness" : {
					components : "",
					compMaterial : "",
					changes : "Spell cast with my Shadow Arts don't require spell components."
				},
			},
		},
		"subclassfeature6" : {
			name : "Shadow Step",
			source : [["UA23PT6", 29], ["P", 80]],
			minlevel : 6,
			description : desc([
				"As a Bonus Action, I can teleport from and into Dim Light or Darkness within 60 ft.",
				"After I do this, I have Adv. on the next melee attack I make before the end of my turn.",
			]),
			action : ["bonus action", ""],
		},
		"subclassfeature11" : {
			name : "Improved Shadow Step",
			source : [["UA23PT6", 29], ["P", 80], ["MJ:HB", 0]],
			minlevel : 11,
			description : desc([
				"When I use Shadow Step, I can spend 1 Disciple Point to remove the requirement that I must start",
				"  end in Dim Light or Darkness for the use of that feature.",
				"As part of this Bonus Action, I can make an Unarmed Strike immediately after the teleportation.",
			]),
			additional : "[1 discipline point]",
		},
		"subclassfeature17" : {
			name : "Cloak of Shadows",
			source : [["UA23PT6", 29], ["P", 80], ["MJ:HB", 0]],
			minlevel : 17,
			description : desc([
				"As a Bonus Action while entirely within Dim Light or Darkness, I can spend 3 Discipline Points to",
				"  shroud myself with magical darkness for 1 min, until I become Incapacitated, or until I end my",
				"  turn in Bright Light. While shrouded in darkness, I gain the following benefits:",
				" \u2022 I have the Invisible condition.",
				" \u2022 I can move through creatures/objects as if they were Difficult Terrain, but I take 1d10",
				"  Force damage if I end my turn inside a creature or an object.",
				" \u2022 I can use my Flurry of Blows without spending any Discipline Points.",
			]),
			action : ["bonus action", ""]
		},
	},
});

////// Add UA23PT6 Warrior of the Elements Monk subclass
AddSubClass("monkua", "warrior of the elements_ua23pt6", { //Ripped directly from "all_WotC_pub+UA.js" and then heavily altered
	regExpSearch : /^(?=.*\b(four|4)\b)((?=.*elements?)|((?=.*earth)|(?=.*(wind|air))|(?=.*fire)|(?=.*water)))((?=.*(monk|monastic))|(((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior)))).*$/i,
	subname : "Warrior of the Elements",
	source : [["UA23PT6", 30], ["P", 80], ["MJ:HB", 0]],
	spellcastingExtra : ["elementalism ua23pt6"],
	features : {
		"subclassfeature3" : {
			name : "Elemental Attunement (Formerly 'Disciple of the Elements')",
			source : [["UA23PT6", 30], ["P", 80], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I know the Elementalism cantrip. At the start of my turn, I can spend 1 Discipline Point to",
				"  imbue myself with elemental energy that lasts for 10 minutes or until I become Incapacitated.",
				"While imbued with elemental energy, I gain the following benefits:",
				" \u2022 My Unarmed Strikes can deal Acid, Cold, Fire, or Lightning dmg instead of Bludg.",
				"  I can also force the target to make a Str save or be moved 10 ft toward or away from me.",
				" \u2022 My Unarmed Strikes now have a reach of 15 ft instead of 5 ft.",
				"Adding the word 'Acid', 'Cold', 'Fire', or 'Lightning' in the name of an Unarmed Strike applies",
				"  the above effects to that Unarmed Strike.",
			]),
			additional : "[1 discipline point]",
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.baseWeaponName == "unarmed strike" && (/^(?=.*acid).*$/i).test(v.WeaponTextName)) {
							fields.Description += (fields.Description ? '; ' : '') + 'While Elemental Attunment is running, I deal Acid dmg, and if target fails Str save, can move target up to 10 ft';
							fields.Range = 'Melee (15 ft reach)';
							fields.Damage_Type = 'acid';
						}
						if (v.baseWeaponName == "unarmed strike" && (/^(?=.*cold).*$/i).test(v.WeaponTextName)) {
							fields.Description += (fields.Description ? '; ' : '') + 'While Elemental Attunment is running, I can deal Cold dmg, and if target fails Str save, can move target up to 10 ft';
							fields.Range = 'Melee (15 ft reach)';
							fields.Damage_Type = 'cold';
						}
						if (v.baseWeaponName == "unarmed strike" && (/^(?=.*fire).*$/i).test(v.WeaponTextName)) {
							fields.Description += (fields.Description ? '; ' : '') + 'While Elemental Attunment is running, I can deal Fire dmg, and if target fails Str save, can move target up to 10 ft';
							fields.Range = 'Melee (15 ft reach)';
							fields.Damage_Type = 'fire';
						}
						if (v.baseWeaponName == "unarmed strike" && (/^(?=.*lightning).*$/i).test(v.WeaponTextName)) {
							fields.Description += (fields.Description ? '; ' : '') + 'While Elemental Attunment is running, I can deal Lightning dmg, and if target fails Str save, can move target up to 10 ft';
							fields.Range = 'Melee (15 ft reach)';
							fields.Damage_Type = 'lightning';
						}
					},
					"If I include the word 'Acid', 'Cold', 'Fire', or 'Lightning' in the name of an Unarmed Strike, it gets +10 ft reach, and does the corresponding damage.",
				]
			},
		},
		"subclassfeature6" : {
			name : "Environmental Burst",
			source : [["UA23PT6", 30], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc([
				"As a Magic action, I can spend 2 Discipline Points to cause a burst of elemental energy.",
				"This burst is a 20 ft rad sphere that can be centered on a point within 120 ft of myself.",
				"Each creature in the sphere must make a Dex save. On a fail, they take damage equal to 3 rolls",
				"  of my Martial Arts die. On a success, they take half as much damage.",
				"All creatures within the sphere take my choice of Acid, Cold, Fire, or Lightning damage.",
				"Before or after I take this action, I can use my Bonus Action to make one Unarmed Strike.",
			]),
			additional : "[2 discipline points]",
			action : ["action", ""]
		},
		"subclassfeature11" : {
			name : "Stride of the Elements",
			source : [["UA23PT6", 30], ["MJ:HB", 0]],
			minlevel : 11,
			description : desc([
				"When I use my Step of the Wind, I gain a Fly Speed \u0026 Swim Speed equal to my Speed for 10 min.",
			]),
		},
		"subclassfeature17" : {
			name : "Elemental Epitome",
			source : [["UA23PT6", 30], ["MJ:HB", 0]],
			minlevel : 17,
			description : desc([
				"When I use my Elemental Attunment feature, I also gain the following benefits for the duration:",
				" \u2022 I gain Resistance to one of the following damage types, and can change which I have at",
				"  the start of each of my turns: Acid, Cold, Fire, or Lightning.",
				" \u2022 When I use my Step of the Wind, my Speed increases by 20 ft until the end of the turn;",
				"  For that duration, any creature of my choice that I enter within 5 ft of takes 1 of my Martial",
				"  Arts die in damage of the type that I have chosen to have Resistance for with this feature.",
				" \u2022 Once per turn, I can deal extra damage to a target equal to 1 roll of my Martial Arts",
				"  die when I hit with an Unarmed Strike. The damage is the same type you chose for this feature’s",
				"  damage Resistance.",
			]),
		},
	},
});

////// Add UA23PT8 Warrior of the Hand Monk subclass
AddSubClass("monkua", "warrior of the hand_ua23pt8", { //Ripped directly from "ListsClasses.js" and then altered
	regExpSearch : /^(?=.*\bopen\b)(?=.*\bhand\b)((?=.*monk)|(((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior)))).*$/i,
	subname : "Warrior of the Open Hand",
	source : [["UA23PT8", 17], ["SRD", 28], ["P", 79], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Open Hand Technique",
			source : [["UA23PT8", 17], ["SRD", 28], ["P", 79], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"Whenever I hit a creature with a Flurry of Blows attack I can do one of the following:",
				" \u2022 Have it make a Dexterity save or be knocked Prone.",
				" \u2022 Have it make a Strength save or be pushed up to 15 ft away from me.",
				" \u2022 Stop it from taking Opportunity Attacks until the start of its next turn.",
			]),
		},
		"subclassfeature6" : {
			name : "Wholeness of Body",
			source : [["UA23PT8", 17], ["SRD", 28], ["P", 79], ["MJ:HB", 0]],
			minlevel : 6,
			description : desc("As a Bonus Action, I regain HP equal my Martial Arts die + my Wis mod (min 1 HP regained)."),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			action : ["bonus action", ""],
		},
		"subclassfeature11" : {
			name : "Fleet Step",
			source : [["UA23PT8", 17], ["MJ:HB", 0]],
			minlevel : 11,
			description : desc([
				"I use Step of the Wind when I take any other Bonus Action.",
			]),
		},
		"subclassfeature17" : {
			name : "Quivering Palm",
			source : [["UA23PT8", 17], ["SRD", 29], ["P", 80], ["MJ:HB", 0]],
			minlevel : 17,
			description : desc([
				"When I hit a creature with an Unarmed Strike, I can start imperceptible vibrations at the listed cost.",
				"Within my Monk level in days, I can use an action to have the creature make a Con save.",
				"If it fails, it takes 10d12 Force damage; If it succeeds, it takes half that.",
				"I can only cause this damage if myself \u0026 the target are on the same plane of existence.",
				"I can only have 1 creature under this effect at a time.",
				"I can end the vibrations harmlessly without using an action.",
			]),
			additional : "[4 discipline point]",
		},
	},
});

// Add UA23PT8 Spells
SpellsList["conjure animals ua23pt8"] = {
	name : "Conjure Animals (UA23PT8)",
	source : [["UA23PT8", 18], ["P", 225], ["MJ:HB", 0]],
	classes : ["druid", "druid_ua23pt8", "ranger", "ranger_ua23pt6"],
	level : 3,
	school : "Conj",
	time : "1 a",
	range : "60 ft",
	rangeMetric : "18 m",
	components : "V,S",
	duration : "Conc, 10 m",
	description : "Summon Large swarm of spectral animals; atk those enter within 10 ft of swarm for 2d10+spellcasting ability modifier Rad dmg; See bk",
	descriptionFull : "You summon nature spirits that take the form of a Large swarm of spectral animals in an unoccupied space that you can see within range. The swarm lasts for the duration, and you choose the animal form of the spirits, such as wolves, serpents, or birds." + "\n   " + "When a creature hostile to you enters a space within 10 feet of the swarm for the first time on a turn or starts its turn there, you can make a melee spell attack against that creature. On a hit, the target takes Radiant damage equal to 2d10 plus your spellcasting ability modifier." + "\n   " + "You have Advantage on Strength saving throws while you’re within 10 feet of the swarm, and when you Move on your turn, you can also move the swarm up to 30 feet to an unoccupied space you can see." + AtHigherLevels + "When you cast this spell using a spell slot of level 4 or higher, the damage increases by 1d10 for each slot level above 3.",
};
SpellsList["conjure celestial ua23pt8"] = {
	name : "Conjure Celestial (UA23PT8)",
	source : [["UA23PT8", 18], ["P", 225], ["MJ:HB", 0]],
	classes : ["cleric", "cleric_ua23pt6"],
	level : 7,
	school : "Conj",
	time : "1 a",
	range : "90 ft",
	rangeMetric : "27 m",
	components : "V,S",
	duration : "Conc, 10 m",
	save : "Dex",
	description : "10 ft rad, 40 ft high cylinder; move when I move; heal 4d12+spellcasting ability modifier; 8d12 Rad dmg on fail, half on success; See bk",
	descriptionFull : "You summon the protective presence of a Celestial spirit, which manifests as a pillar of divine light that shines in a 10-foot-radius, 40- foot-high Cylinder centered on a point within range. Until the spell ends, Bright Light fills the Cylinder, and when you Move on your turn, you can also move the Cylinder up to 30 feet." + "\n   " + "When a creature enters the Cylinder for the first time on a turn or starts its turn there, you can bathe that creature in one of the following lights:" + "\n   " + "Healing Light. The creature that isn’t an Undead or a Construct regains Hit Points equal to 4d12 plus your spellcasting modifier. A creature can be healed by this light only once per casting of this spell." + "\n   " + "Searing Radiance. The creature must make a Dexterity saving throw, taking 8d12 Radiant damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "When you cast this spell using a spell slot of level 8 or higher, the healing and damage increase by 1d12 for each slot level above 7.",
};
SpellsList["conjure elemental ua23pt8"] = {
	name : "Conjure Elemental (UA23PT8)",
	source : [["UA23PT8", 19], ["P", 225], ["MJ:HB", 0]],
	classes : ["druid", "druid_ua23pt8", "wizard", "wizard_ua23pt7"],
	level : 5,
	school : "Conj",
	time : "1 a",
	range : "60 ft",
	rangeMetric : "18 m",
	components : "V,S",
	duration : "Conc, 10 m",
	save : "Str",
	description : "Elemental spirit fill 10 ft cube; atk those that come within 5 ft of the spirit for 8d8 dmg; See bk",
	descriptionFull : "You summon an Elemental spirit that fills a 10- foot Cube within range. The spirit lasts for the duration and is composed of air, earth, fire, or water (your choice) when you cast this spell." + "\n   " + "When a creature hostile to you Moves within 5 feet of the spirit, you can make a melee spell attack against that creature. On a hit, the target takes 8d8 damage of a type determined by the spirit’s element: Bludgeoning (earth), Cold (water), Fire (fire), or Lightning (air). If the target is a Large or smaller creature, it is also pulled into the Cube and has the Restrained condition. At the start of each of its turns, the target must make a Strength saving throw against your spell save DC. On a success, the target frees itself. On a failure, the target takes 4d8 damage of the same type as the spell attack. The spirit can have only one creature restrained at a time." + AtHigherLevels + "When you cast this spell using a spell slot of level 6 or higher, the damage increases by 2d8 for each slot level above 5.",
};
SpellsList["conjure fey ua23pt8"] = {
	name : "Conjure Fey (UA23PT8)",
	source : [["UA23PT8", 19], ["P", 226], ["MJ:HB", 0]],
	classes : ["druid", "druid_ua23pt8"],
	level : 6,
	school : "Conj",
	time : "1 a",
	range : "60 ft",
	rangeMetric : "18 m",
	components : "V,S",
	duration : "Conc, 10 m",
	save : "Wis",
	description : "Medium Fey spirit; spell atks for 3d12+spellcasting ability modifier Psychic; save or Frightened until start of my next turn; See bk",
	descriptionFull : "You summon the awesome presence of a Medium Fey spirit in an unoccupied space you can see within range. The spirit lasts for the duration, and it looks like a Fey creature of your choice. When the spirit appears, you can immediately make one melee spell attack against a creature within 5 feet of the spirit. On a hit, the target takes Psychic damage equal to 3d12 plus your spellcasting ability modifier, and the target must succeed on a Wisdom saving throw or have the Frightened condition until the start of your next turn." + "\n   " + "As a Bonus Action on your later turns, you can teleport the spirit to an unoccupied space you can see within 30 feet of the space it left and repeat the attack against a creature within 5 feet of it." + AtHigherLevels + "When you cast this spell using a spell slot of level 7 or higher, the damage increases by 2d12 for each slot level above 6.",
};
SpellsList["conjure minor elementals ua23pt8"] = {
	name : "Conjure Minor Elementals (UA23PT8)",
	source : [["UA23PT8", 19], ["P", 226], ["MJ:HB", 0]],
	classes : ["druid", "druid_ua23pt8", "wizard", "wizard_ua23pt7"],
	level : 4,
	school : "Conj",
	time : "1 a",
	range : "S:15" + (typePF ? "-" : "") + "ft rad",
	rangeMetric : "S:4.5m rad",
	components : "V,S",
	duration : "Conc, 10 m",
	description : "Atks within 15 ft deal +2d8+2d8/SL Bludg/Cold/Fire/Lghtng dmg; Ground within 15 ft Difficult Terrain",
	descriptionFull : "You summon elemental spirits that a flit around you for the duration. Until the spell ends, any attack you make deals an extra 2d8 damage when you hit a creature within 15 feet of you. This damage is Bludgeoning, Cold, Fire, or Lightning (your choice when you make the attack)." + "\n   " + "In addition, the ground within 15 feet of you is Difficult Terrain for your enemies." + AtHigherLevels + "When you cast this spell using a spell slot of level 5 or higher, the damage increases by 2d8 and the range of Difficult Terrain increases by 5 feet for each slot level above 4.",
};
SpellsList["conjure woodland beings ua23pt8"] = {
	name : "Conjure Woodland Beings (UA23PT8)",
	source : [["UA23PT8", 19], ["P", 226], ["MJ:HB", 0]],
	classes : ["druid", "druid_ua23pt8", "ranger", "ranger_ua23pt6"],
	level : 5,
	school : "Conj",
	time : "1 a",
	range : "S:10" + (typePF ? "-" : "") + "ft rad",
	rangeMetric : "S:3m rad",
	components : "V,S",
	duration : "Conc, 10 m",
	save : "Wis",
	description : "Creatures I chose that enter save or take 5d8 Force, half on success; I can Disengage as Bonus Action",
	descriptionFull : "You summon nature spirits that flit about you for the duration. Until the spell ends, each creature you choose that enters a space within 10 feet of you for the first time on a turn or starts its turn there must make a Wisdom saving throw, taking 5d8 Force damage on a failed save or half as much damage on a successful one." + "\n   " + "In addition, you can take the Disengage action as a Bonus Action for the spell’s duration." + AtHigherLevels + "When you cast this spell using a spell slot of level 6 or higher, the damage increases by 1d8 for each slot level above 5.",
};
SpellsList["cure wounds ua23pt8"] = {
	name : "Cure Wounds (UA23PT8)",
	source : [["UA23PT8", 19], ["SRD", 132], ["P", 230], ["MJ:HB", 0]],
	classes : ["artificer", "bard", "cleric", "cleric_ua23pt6", "druid", "druid_ua23pt8", "paladin", "paladin_ua23pt6", "ranger", "ranger_ua23pt6"],
	level : 1,
	school : "Abjur",
	time : "1 a",
	range : "Touch",
	components : "V,S",
	duration : "Instantaneous",
	description : "1 living creature heals 2d8+2d8/SL+spellcasting ability modifier HP", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "A creature you touch regains a number of Hit Points equal to 2d8 plus your spellcasting ability modifier. This spell has no effect on Constructs and Undead." + AtHigherLevels + "When you cast this spell using a spell slot of level 2 or higher, the healing increases by 2d8 for each slot level above 1.",
};
SpellsList["fount of moonlight ua23pt8"] = {
	name : "Fount of Moonlight (UA23PT8)",
	source : [["UA23PT8", 20], ["MJ:HB", 0]],
	classes : ["bard", "druid", "druid_ua23pt8"],
	level : 4,
	school : "Evoc",
	time : "1 a",
	range : "S",
	components : "V,S",
	duration : "Conc, 10 m",
	save : "Con",
	description : "Melee atks +2d6 Rad dmg; Resistance to Rad; Rea to force crea save or be Blinded; emit light; See bk",
	descriptionFull : "A cool light wreathes your body for the duration, emitting Bright Light in a 20-foot radius and Dim Light for an additional 20 feet." + "\n   " + "Until the spell ends, you have Resistance to Radiant damage, and your melee attacks deal an extra 2d6 Radiant damage on a hit." + "\n   " + "In addition, immediately after you take damage from a creature you can see within 60 feet of yourself, you can use your Reaction to force the creature to make a Constitution saving throw. On a failed save, the creature has the Blinded condition until the end of your next turn.",
};
SpellsList["healing word ua23pt8"] = {
	name : "Healing Word (UA23PT8)",
	source : [["UA23PT8", 20], ["SRD", 153], ["P", 250], ["MJ:HB", 0]],
	classes : ["bard", "cleric", "cleric_ua23pt6", "druid", "druid_ua23pt8"],
	level : 1,
	school : "Abjur",
	time : "1 bns",
	range : "60 ft",
	rangeMetric : "18 m",
	components : "V",
	duration : "Instantaneous",
	description : "1 living creature heals 2d4+2d4/SL+spellcasting ability modifier HP", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "A creature of your choice that you can see within range regains Hit Points equal to 2d4 plus your spellcasting ability modifier. This spell has no effect on Constructs or Undead." + AtHigherLevels + "When you cast this spell using a spell slot of level 2 or higher, the healing increases by 2d4 for each slot level above 1.",
};
SpellsList["mass cure wounds ua23pt8"] = {
	name : "Mass Cure Wounds (UA23PT8)",
	source : [["UA23PT8", 20], ["SRD", 162], ["P", 258], ["MJ:HB", 0]],
	classes : ["bard", "cleric", "cleric_ua23pt6", "druid", "druid_ua23pt8"],
	level : 5,
	school : "Abjur",
	time : "1 a",
	range : "60 ft",
	rangeMetric : "18 m",
	components : "V,S",
	duration : "Instantaneous",
	description : "Up to 6 living crea within 30-ft rad sphere heal 5d8+1d8/SL+spellcasting ability modifier HP", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "A wave of healing energy emanates from a point you can see within range. Choose up to six creatures in a 30-foot-radius Sphere centered on that point. Each target regains Hit Points equal to 5d8 plus your spellcasting ability modifier. This spell has no effect on Constructs or Undead." + AtHigherLevels + "When you cast this spell using a spell slot of level 6 or higher, the healing increases by 1d8 for each slot level above 5.",
};
SpellsList["mass healing word ua23pt8"] = {
	name : "Mass Healing Word (UA23PT8)",
	source : [["UA23PT8", 20], ["SRD", 163], ["P", 258], ["MJ:HB", 0]],
	classes : ["bard", "cleric", "cleric_ua23pt6"],
	level : 3,
	school : "Abjur",
	time : "1 bns",
	range : "60 ft",
	rangeMetric : "18 m",
	components : "V",
	duration : "Instantaneous",
	description : "6 living creatures heal 2d4+1d4/SL+spellcasting ability modifier HP", //Ripped directly from "ListsSpells.js" and then altered
	descriptionFull : "As you call out words of restoration, up to six creatures of your choice that you can see within range regain Hit Points equal to 2d4 plus your spellcasting ability modifier. This spell has no effect on Constructs or Undead." + AtHigherLevels + "When you cast this spell using a spell slot of level 4 or higher, the healing increases by 1d4 for each slot level above 3.",
};
SpellsList["power word fortify ua23pt8"] = {
	name : "Power Word Fortify (UA23PT8)",
	source : [["UA23PT8", 20], ["MJ:HB", 0]],
	classes : ["bard", "cleric", "cleric_ua23pt6"],
	level : 7,
	school : "Ench",
	time : "1 a",
	range : "60 ft",
	rangeMetric : "18 m",
	components : "V",
	duration : "Instantaneous",
	description : "120 Temp HP divided equally among up to 6 creatures",
	descriptionFull : "You speak a word of power that fortifies up to six creatures you can see within range. The spell bestows 120 Temporary Hit Points, which are divided equally among the spell’s recipients.",
};
SpellsList["starry wisp ua23pt8"] = {
	name : "Starry Wisp (UA23PT8)",
	source : [["UA23PT8", 20], ["MJ:HB", 0]],
	classes : ["bard", "cleric", "cleric_ua23pt6"],
	level : 0,
	school : "Evoc",
	time : "1 a",
	range : "60 ft",
	rangeMetric : "18 m",
	components : "V,S",
	duration : "Instantaneous",
	description : "Spell atk at crea/object in range, Radiant dmg; target emits Dim Light \u0026 no Invisible benefits; see book.",
	descriptionCantripDie : "Spell atk at crea/object in range, `CD`d8 Radiant dmg; target emits Dim Light \u0026 no Invisible benefits; see book.",
	descriptionFull : "You launch a mote of light at one creature or object within range. Make a ranged spell attack against the target. On a hit, the target takes 1d8 Radiant damage, and until the end of your next turn, it emits Dim Light in a 10-foot radius and can’t benefit from the Invisible condition." + "\n   " + "Cantrip Upgrade. This spell’s damage increases by 1d8 when you reach levels 5 (2d8), 11 (3d8), and 17 (4d8).",
};

//// >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ////
//// >>> WotC Subclasses for UA Classes >>> ////
//// >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ////

// Add Bard subclasses (modified to be in compliance with the subclass formatting of the version of the Bard that appeared in UA22XC, not the version that appeared in UA23PT6)
AddSubClass("bard_ua22xc", "college of valor", {
	regExpSearch : /^(?=.*(college|bard|minstrel|troubadour))(?=.*valor).*$/i,
	subname : "College of Valor",
	source : [["P", 55]],
	attacks : [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiencies",
			source : [["P", 55]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with medium armor, shields, and martial weapons",
			armorProfs : [false, true, false, true],
			weaponProfs : [false, true]
		},
		"subclassfeature3.1" : {
			name : "Combat Inspiration",
			source : [["P", 55]],
			minlevel : 3,
			description : "\n   " + "My Bardic Inspiration can also be used to add the die to a weapon damage roll" + "\n   " + "Alternatively, it can be used as a reaction to add the die to AC against one attack"
		},
		"subclassfeature14" : {
			name : "Battle Magic",
			source : [["P", 55]],
			minlevel : 14,
			description : "\n   " + "As a bonus action when I use my action to cast a bard spell, I can make a weapon attack",
			action : ["bonus action", " (with Bard spell)"]
		}
	}
});
AddSubClass("bard_ua22xc", "college of glamour", {
	regExpSearch : /^(?=.*(college|bard|minstrel|troubadour))(?=.*glamour).*$/i,
	subname : "College of Glamour",
	source : [["X", 14]],
	features : {
		"subclassfeature3" : {
			name : "Mantle of Inspiration",
			source : [["X", 14]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I expend one Bardic Inspiration die to aid those within 60 ft of me",
				"My Cha mod (min 1) of creatures that I can see and can see me gain temporary HP",
				"They can immediately use a reaction to move their speed, without opportunity attacks"
			]),
			additional : levels.map(function (n) { return n < 3 ? "" : "1 inspiration die; " + (n < 5 ? 5 : n < 10 ? 8 : n < 15 ? 11 : 14) + " temp HP"; }),
			action : ["bonus action", ""]
		},
		"subclassfeature3.1" : {
			name : "Enthralling Performance",
			source : [["X", 14]],
			minlevel : 3,
			recovery : "short rest",
			usages : 1,
			description : desc([
				"By performing for at least 1 minute, I can charm humanoids within 60 ft of me",
				"After the performance, my Cha mod (min 1) number of targets must make a Wis save",
				"On a fail, a target is charmed for 1 hour; If success, it doesn't knows I tried to charm it",
				"While charmed, the target idolizes me, hinders those opposing me, and avoids violence",
				"This lasts until a target takes damage, I attack it, or if it sees me attacking its allies"
			])
		},
		"subclassfeature6" : {
			name : "Mantle of Majesty",
			source : [["X", 14]],
			minlevel : 6,
			recovery : "long rest",
			usages : 1,
			action : ["bonus action", ""],
			description : desc([
				"As a bonus action, I appear unearthly beautiful while I concentrate, up to 1 minute",
				"At the same time, and as a bonus action during, I can cast Command without a spell slot",
				"Creatures charmed by me automatically fail their saves against these Command spells"
			]),
			spellcastingBonus : [{
				name : "Mantle of Majesty",
				spells : ["command"],
				selection : ["command"],
				firstCol : 'oncelr'
			}],
			spellChanges : {
				"command" : {
					time : "1 bns",
					description : "1 crea save or follow one word command, e.g. approach, drop, flee, halt",
					changes : "Using my Mantle of Majesty class feature, I can cast Command as a bonus action once per long rest without using a spell slot, thus only affect a single target."
				}
			}
		},
		"subclassfeature14" : {
			name : "Unbreakable Majesty",
			source : [["X", 14]],
			minlevel : 14,
			recovery : "short rest",
			usages : 1,
			action : ["bonus action", ""],
			description : desc([
				"As a bonus action, I gain a magically majestic presence for 1 min or until incapacitated",
				"During this, the first time a creature attacks me each turn they must make a Cha save",
				"If failed, it can't attack me this turn and must choose another target or lose its attack",
				"If successful, it can attack, but has disadv. on all saves against my spells on my next turn"
			])
		}
	}
});
AddSubClass("bard_ua22xc", "college of swords", {
	regExpSearch : /^(?=.*(college|bard|minstrel|troubadour))(?=.*\bswords?\b).*$/i,
	subname : "College of Swords",
	source : [["X", 15]],
	attacks : [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiencies",
			source : [["X", 15]],
			minlevel : 3,
			description : desc([
				"I gain proficiency with medium armor and scimitars",
				"My bardic spellcasting focus can be any simple or martial weapon I'm proficient with"
			]),
			armorProfs : [false, true, false, false],
			weaponProfs : [false, false, ["scimitar"]]
		},
		"subclassfeature3.1" : {
			name : "Fighting Style",
			source : [["X", 15]],
			minlevel : 3,
			description : "\n   " + 'Select a Fighting Style for the college of swords using the "Choose Feature" button above',
			choices : ["Dueling", "Two-Weapon Fighting"],
			"dueling" : FightingStyles.dueling,
			"two-weapon fighting" : FightingStyles.two_weapon
		},
		"subclassfeature3.2" : {
			name : "Blade Flourish",
			source : [["X", 15]],
			minlevel : 3,
			description : desc([
				"When I take the Attack action on my turn, I gain bonus speed and special attack options",
				"I gain +10 ft to my walking speed until the end of the current turn",
				"Once per turn when I hit with a weapon attack, I can expend a Bardic Inspiration die",
				"The roll of that die is added to the weapon's damage, in addition to one of the following:",
				"\u2022 Defensive Flourish: the result is also added to my AC until the start of my next turn",
				"\u2022 Slashing Flourish: the extra damage is also dealt to any of my choosing in 5 ft of me",
				"\u2022 Mobile Flourish: the target is also pushed 5 plus the die result in feet away from me",
				"  As a reaction after this push, I can move my speed to a space within 5 ft of the target"
			])
		},
		"subclassfeature14" : {
			name : "Master Flourish",
			source : [["X", 16]],
			minlevel : 14,
			description : "\n   " + "When I do a Blade Flourish, I can use a d6 instead of expending a Bardic Inspiration die"
		}
	}
});
AddSubClass("bard_ua22xc", "college of whispers", {
	regExpSearch : /^(?=.*(college|bard|minstrel|troubadour))(?=.*whispers).*$/i,
	subname : "College of Whispers",
	source : [["X", 16]],
	features : {
		"subclassfeature3" : {
			name : "Psychic Blades",
			source : [["X", 16]],
			minlevel : 3,
			description : desc([
				"When I hit a creature with a weapon attack, I can expend one use of Bardic Inspiration",
				"If so, the attack does extra psychic damage; I can do so only once per round, on my turn"
			]),
			additional : levels.map(function (n) { return n < 3 ? "" : "1 Bardic Inspiration for +" + (n < 5 ? 2 : n < 10 ? 3 : n < 15 ? 5 : 8) + "d6 damage"; })
		},
		"subclassfeature3.1" : {
			name : "Words of Terror",
			source : [["X", 16]],
			minlevel : 3,
			recovery : "short rest",
			usages : 1,
			description : desc([
				"By speaking privately with a humanoid for at least 1 minute, I can try to inspire terror",
				"After the talk, it must make a Wis save or be frightened of me or someone of my choice",
				"If the save is successful, the target doesn't know I tried to frighten it",
				"This lasts for 1 hour, or until it sees its allies or itself being attacked or damaged"
			])
		},
		"subclassfeature6" : {
			name : "Mantle of Whispers",
			source : [["X", 16]],
			minlevel : 6,
			recovery : "short rest",
			usages : 1,
			action : ["reaction", ""],
			description : desc([
				"As a reaction when a humanoid dies within 30 ft of me, I can capture its shadow",
				"As an action, I can use it to make me look just like the dead person did while it was alive",
				"While disguised, I know general information about it and its memories, but not its secrets",
				"Others can see through the disguise with a Wis (Insight) check vs. my Cha (Deception) +5",
				"A shadow lasts until used or next long rest; The disguise ends as a bonus action or 1 hour"
			]),
			action : [['action', 'Shadow Disguise (start)'], ['bonus action', 'Shadow Disguise (end)']]
		},
		"subclassfeature14" : {
			name : "Shadow Lore",
			source : [["X", 16]],
			minlevel : 14,
			recovery : "long rest",
			usages : 1,
			action : ["action", ""],
			description : desc([
				"As an action, I whisper to a creature within 30 ft that can hear and understand me",
				"Only the target can hear me; It must make a Wis save or be charmed by me for 8 hours",
				"If failed, it thinks I know its most mortifying secret, otherwise it only hears mumbling",
				"While charmed, the target obeys my commands, but won't fight or risk its life for me",
				"This lasts for 8 hours, or until I or my allies attack it, damage it, or have it make a save"
				//"When the effect ends, the target has no idea why it was so afraid of me"
			])
		}
	}
});
AddSubClass("bard_ua22xc", "college of eloquence", { // includes contributions by /u/Holynight6
	regExpSearch : /^(?=.*(college|bard|minstrel|troubadour))(?=.*eloquence).*$/i,
	subname : "College of Eloquence",
	source : [["T", 29], ["MOT", 28]],
	features : {
		"subclassfeature3" : {
			name : "Silver Tongue",
			source : [["T", 30], ["MOT", 28]],
			minlevel : 3,
			description : "\n   When I make a Persuasion or Deception check, I can treat a roll of 9 or lower as a 10"
		},
		"subclassfeature3.1" : {
			name : "Unsettling Words",
			source : [["T", 30], ["MOT", 28]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I expend a Bardic Inspiration use & choose a target I can see in 60 ft",
				"It subtracts my inspiration die from the next save it makes before my next turn starts"
			]),
			action : [["bonus action", ""]]
		},
		"subclassfeature6" : {
			name : "Unfailing Inspiration",
			source : [["T", 30], ["MOT", 28]],
			minlevel : 6,
			description : "\n   When a creature adds my Bardic Inspiration die to a roll but fails, they can keep the die"
		},
		"subclassfeature6.1" : {
			name : "Universal Speech",
			source : [["T", 30], ["MOT", 28]],
			minlevel : 6,
			description : desc([
				"As an action, I can choose up to my Charisma modifier (min 1) creatures within 60 ft",
				"Those creatures magically understand any language I speak for an hour",
				"I can do this once per long rest, or by expending a 1st-level or higher spell slot (SS 1+)"
			]),
			recovery : "long rest",
			usages : 1,
			altResource : "SS 1+",
			action : [["action", ""]]
		},
		"subclassfeature14" : {
			name : "Infectious Inspiration",
			source : [["T", 30], ["MOT", 28]],
			minlevel : 14,
			description : desc([
				"As a reaction when a creature uses my inspiration die and succeeds, I can inspire another",
				"I give a creature within 60 ft that can hear me an inspiration die without expending any"
			]),
			action : [["reaction", ""]],
			usages : "Charisma mod per ",
			usagescalc : "event.value = Math.max(1, What('Cha Mod'));",
			recovery : "long rest"
		}
	}
});
AddSubClass("bard_ua22xc", "college of creation", {
	regExpSearch : /^(?=.*(college|bard|minstrel|troubadour))(?=.*creation).*$/i,
	subname : "College of Creation",
	source : [["T", 28]],
	features : {
		"subclassfeature3" : {
			name : "Mote of Potential",
			source : [["T", 28]],
			minlevel : 3,
			description : desc([
				"Those who use my Bardic Inspiration die gain an extra bonus depending how they use it:",
				"\u2022 Ability check: Roll the die twice and choose which result to use",
				"\u2022 Attack roll: the target and others of my choice I can see in 5 ft must make a Con save",
				"  If failed, they take the die roll in thunder damage; This uses my spell save DC",
				"\u2022 Saving throw: Grants temporary HP equal to the roll + my Cha mod (min 1 temp HP)"
			])
		},
		"subclassfeature3.1" : {
			name : "Performance of Creation",
			source : [["T", 28]],
			minlevel : 3,
			description : levels.map(function (n) {
				if (n < 14) {
					var descr = [
						"As an action, I create " + (n < 6 ? "a Medium" : "one Large") + " or smaller nonmagical item in an empty space in 10 ft",
						"It can't be worth more than " + (20 * n) + " gp; It lasts for my Proficiency Bonus in hours",
						"I can't have multiple, creating more makes the first one vanish",
						"I can do this once per long rest, or by expending a 2nd-level or higher spell slot (SS 2+)"
					];
				} else {
					var descr = [
						"As an action, I create my Charisma mod of nonmagical items in an empty space in 10 ft",
						"One can be Huge, the rest Small or smaller; They last for my Proficiency Bonus in hours",
						"I can't have more than my Cha mod; If I create more, I get to choose which vanish",
						"I can do this once per long rest, or by expending a 2nd-level or higher spell slot (SS 2+)"
					];
				}
				return desc(descr);
			}),
			action : [["action", ""]],
			usages : 1,
			recovery : "long rest",
			altResource : "SS 2+"
		},
		"subclassfeature6" : {
			name : "Animating Performance",
			source : [["T", 29]],
			minlevel : 6,
			description : desc([
				"As an action, I can animate a Large or smaller nonmagical item I can see within 30 ft",
				"It is friendly and obeys my commands; It lasts for 1 hour, until it has 0 HP, or I die",
				"Unless I use a bonus action to command it, it only takes the Dodge action on its turn",
				"It can take reactions and move on its turn without commands; I can't have multiple",
				"When I use bardic inspiration, I can command the item as part of the same bonus action",
				'It acts on my initiative, after me; See "Dancing Item" on a companion page for its stats',
				"I can do this once per long rest, or by expending a 3rd-level or higher spell slot (SS 3+)"
			]),
			action : [["action", ""], ["bonus action", "Command Dancing Item"]],
			usages : 1,
			recovery : "long rest",
			altResource : "SS 3+",
			creaturesAdd : [["Dancing Item"]],
			creatureOptions : [{
				name : "Dancing Item",
				source : [["T", 29]],
				size : 4,
				type : "Construct",
				alignment : "",
				ac : 16,
				hp : 25,
				hd : [],
				speed : "fly 30 ft (hover)",
				scores : [18, 14, 16, 4, 10, 6],
				damage_immunities : "poison, psychic",
				condition_immunities : "charmed, exhaustion, poisoned, frightened",
				passivePerception : 10,
				senses : "Darkvision 60 ft",
				languages : "understands the languages of its creator but can't speak",
				challengeRating : "1/2",
				proficiencyBonus : 2,
				proficiencyBonusLinked : true,
				attacksAction : 1,
				attacks : [{
					name : "Force-Empowered Slam",
					ability : 6,
					damage : [1, 10, "force"],
					range : "Melee (5 ft)",
					modifiers : ["", "Prof"],
					abilitytodamage : false,
					useSpellMod : "bard_ua22xc"
				}],
				features : [{
					name : "Variable Size",
					description : "The item animated can be Large or smaller."
				}, {
					name : "Creator",
					description : "The item obeys the commands of its creator and has the same proficiency bonus. It takes its turn immediately after its creator, on the same initiative count. It can move and take reactions on its own, but only takes the Dodge action on its turn unless its creator takes a bonus action to command it to take another action. If its creator is incapacitated, it can take any action, not just Dodge."
				}],
				actions : [{
					name : "Immutable Form",
					description : "The item is immune to any spell or effect that would alter its form."
				}, {
					name : "Irrepressible Dance",
					description : "When any creature starts its turn within 10 ft of the item, the item can increase or decrease (its creator's choice) the walking speed of that creature by 10 ft until the end of the turn, provided the item isn't incapacitated."
				}],
				header : 'Animated',
				calcChanges : {
					hp : function (totalHD, HDobj, prefix) {
						if (!classes.known.bard) return;
						var brdLvl = classes.known.bard.level;
						var brdLvl5 = 5 * brdLvl;
						HDobj.alt.push(10 + brdLvl5);
						HDobj.altStr.push(" = 10 as a base\n + 5 \xD7 " + brdLvl + " from five times its creator's bard level (" + brdLvl5 + ")");
					},
					setAltHp : true
				}
			}]
		},
		"subclassfeature14" : {
			name : "Creative Crescendo",
			source : [["T", 29]],
			minlevel : 14,
			description : " [enhances Performance of Creation]"
		}
	}
});
AddSubClass("bard_ua22xc", "college of spirits",{
	regExpSearch : /^(?=.*(college|bard|minstrel|troubadour))(?=.*spirits?).*$/i,
	subname : "College of Spirits",
	source : [["VRGtR", 28]],
	features : {
		"subclassfeature3" : {
			name : "Guiding Whispers",
			source : [["VRGtR", 28]],
			minlevel : 3,
			description : desc([
				"I learn the Guidance cantrip and can cast it with a range of 60 ft"
			]),
			spellcastingBonus : {
				name : "Guiding Whispers",
				spells : ["guidance"],
				selection : ["guidance"],
				firstCol : "atwill"
			},
			spellChanges : {
				"guidance" : {
					range : "60 ft",
					changes : "I can cast Guidance with a range of 60 ft."
				}
			},
			spellcastingBonus : {
				name : "Guiding Whispers",
				spells : ["guidance ua22cs"],
				selection : ["guidance ua22cs"],
				firstCol : "atwill"
			},
			spellChanges : {
				"guidance ua22cs" : {
					range : "60 ft",
					changes : "I can cast Guidance with a range of 60 ft."
				}
			},
		},
		"subclassfeature3.1" : {
			name : "Spiritual Focus",
			source : [["VRGtR", 28]],
			minlevel : 3,
			description : " [only for bard spells]" + desc([
				"I can use a candle, crystal ball, skull, spirit board, or tarokka deck as a spellcasting focus"
			])
		},
		"subclassfeature3.2" : {
			name : "Tales from Beyond",
			source : [["VRGtR", 28]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can expend a bardic inspiration die to roll on the Spirit Tales table",
				"I retain the rolled tale in my mind until I bestow its effects or finish a short or long rest",
				"I can only retain one tale at a time; I need to hold a spiritual focus to roll on the table",
				"As an action, I can choose a creature I see in 30 ft or myself to bestow the tale's effect",
				"The tales use my spell save DC; See the Notes page for the Spirit Tales table"
			]),
			action : [["bonus action", " (roll on table)"], ["action", " (use effect)"]],
			toNotesPage : [{
				name : "Spirit Tales Table",
				note : desc([
					"As a bonus action while I'm holding my spiritual focus, I can reach out to spirits who tell their tales through me. I expend one use of my Bardic Inspiration and roll on the table below using my Bardic Inspiration die to determine the tale. I retain the tale in mind until I bestow the tale's effect or finish a short or long rest.",
					"I can retain only one of these tales in mind at a time, and rolling on the table immediately ends the effect of the previous tale.",
					"As an action, I can choose myself or one creature I can see within 30 ft to be the target of the tale's effect. If the tale requires a saving throw, the DC equals my spell save DC.",
					"\nRoll " + (typePF ? "" : " ") + "Tale"
				])+
				 desc([
					"  1    Tale of the Clever Animal: For the next 10 minutes, whenever the target makes an Intelligence, a Wisdom, or a Charisma check, the target can roll my Bardic Inspiration die immediately after rolling the d20 and add it to the check.",
					"  2    Tale of the Renowned Duelist: I make a melee spell attack against the target. On a hit, the target takes force damage equal to two rolls of my Bardic Inspiration die + my Charisma modifier.",
					"  3    Tale of the Beloved Friends: The target and another creature of its choice it can see within 5 ft of it gains temporary hit points equal to a roll of my Bardic Inspiration die + my Charisma modifier.",
					"  4    Tale of the Runaway: The target can immediately use its reaction to teleport up to 30 ft to an unoccupied space it can see. When the target teleports, it can choose a number of creatures it can see within 30 ft of it up to my Charisma modifier (minimum of 0) to immediately use the same reaction.",
					"  5    Tale of the Avenger: For 1 minute, any creature that hits the target with a melee attack takes force damage equal to a roll of my Bardic Inspiration die.",
					"  6    Tale of the Traveler: The target gains temporary hit points equal to a roll of my Bardic Inspiration die + my bard level. While it has these temporary hit points, the target's walking speed increases by 10 ft and it gains a +1 bonus to its AC.",
					"  7    Tale of the Beguiler: The target must succeed on a Wisdom saving throw or take psychic damage equal to two rolls of my Bardic Inspiration die, and the target is incapacitated until the end of its next turn.",
					"  8    Tale of the Phantom: The target becomes invisible until the end of its next turn or until it hits a creature with an attack. If the target hits a creature with an attack during this invisibility, the creature it hits takes necrotic damage equal to a roll of my Bardic Inspiration die and is frightened of the target until the end of the frightened creature's next turn.",
					"  9    Tale of the Brute: Each creature of the target's choice it can see within 30 ft of it must make a Strength saving throw. On a failed save, a creature takes thunder damage equal to three rolls of my Bardic Inspiration die and is knocked prone. A creature that succeeds on its saving throw takes half as much damage and isn't knocked prone.",
					" 10    Tale of the Dragon: The target spews fire from the mouth in a 30-ft cone. Each creature in that area must make a Dexterity saving throw, taking fire damage equal to four rolls of my Bardic Inspiration die on a failed save, or half as much damage on a successful one.",
					" 11    Tale of the Angel: The target regains hit points equal to two rolls of my Bardic Inspiration die + my Charisma modifier, and I end one condition from the following list affecting the target: blinded, deafened, paralyzed, petrified, or poisoned.",
					" 12    Tale of the Mind-Bender: I evoke an incomprehensible fable from an otherworldly being. The target must succeed on an Intelligence saving throw or take psychic damage equal to three rolls of my Bardic Inspiration die and be stunned until the end of its next turn."
				], "\n")
			}]
		},
		"subclassfeature6" : {
			name : "Spiritual Focus: Improve spells",
			source : [["VRGtR", 28]],
			minlevel : 6,
			description : desc([
				"While holding a spiritual focus, I can add 1d6 to one damage or healing roll of bard spells"
			]),
			calcChanges : {
				atkCalc : [
					function (fields, v, output) {
						if (v.thisWeapon[3] && SpellsList[v.thisWeapon[3]] && v.thisWeapon[4].indexOf("bard") !== -1) {
							// If RAW is selected, first test if this spell is eligible to use with a spellcasting focus
							var isRAW = GetFeatureChoice("classes", "bard", "subclassfeature6") === "raw: only +1d6 for spells with non-costly material components";
							var spellObj = SpellsList[v.thisWeapon[3]];
							if (isRAW && (!spellObj.components || !/\bM\b/.test(spellObj.components) || /M\u0192|M\u2020/.test(spellObj.components))) return;
							fields.Damage_Die = fields.Damage_Die.replace(/D/g, 'd');
							var d6Regex = /(\d+)d6/;
							if (fields.Damage_Die.indexOf('Bd6') != -1) {
								fields.Damage_Die = fields.Damage_Die.replace('Bd6', 'Cd6');
							} else if (fields.Damage_Die.indexOf('Cd6') != -1) {
								fields.Damage_Die = fields.Damage_Die.replace('Cd6', 'Qd6');
							} else if (d6Regex.test(fields.Damage_Die)) {
								fields.Damage_Die = fields.Damage_Die.replace(d6Regex, Number(fields.Damage_Die.replace(d6Regex, '$1')) + 1 + 'd6');
							} else if (v.thisWeapon[3] == "eldritch blast") {
								fields.Description += (fields.Description ? '; ' : '') + "One ray +1d6 dmg";
							} else {
								fields.Damage_Die += '+1d6';
							}
						}
					},
					'When I cast a bard spell, I can use my spiritual focus to add 1d6 to one damage roll or roll to restore hit points.\n   Going by rules as written (RAW), the spiritual focus has to be used as a spellcasting focus for this bonus to be added. This means that it can only be used on spells with a non-costly material component. Most DMs will forgo this technicality and that is why this sheet will add the 1d6 to any damage/healing spell by default. You can enable to use the stricter rules as written with the "Choose Feature" button on the second page.',
					1
				],
				spellAdd : [
					function (spellKey, spellObj, spName) {
						// Do not process if a psionic, not a bard spell, or, if RAW is selected, not eligible to use with a spellcasting focus
						var isRAW = GetFeatureChoice("classes", "bard", "subclassfeature6") === "raw: only +1d6 for spells with non-costly material components";
						if (spellObj.psionic || spName !== "bard" || (isRAW && (!spellObj.components || !/\bM\b/.test(spellObj.components) || /M\u0192|M\u2020/.test(spellObj.components)))) return;
						if (genericSpellDmgEdit(spellKey, spellObj, "\\w+\\.?", "1d6", true, true) || genericSpellDmgEdit(spellKey, spellObj, "heal", "1d6", true, true)) {
							return true;
						}
					},
					'When I cast a bard spell, I can use my spiritual focus to add 1d6 to one damage roll or roll to restore hit points.\n   Going by rules as written (RAW), the spiritual focus has to be used as a spellcasting focus for this bonus to be added. This means that it can only be used on spells with a non-costly material component. Most DMs will forgo this technicality and that is why this sheet will add the 1d6 to any damage/healing spell by default. You can enable to use the stricter rules as written with the "Choose Feature" button on the second page.'
				]
			},
			choices : ["RAW: only +1d6 for spells with non-costly material components", "Allow +1d6 for any bard spell"],
			"raw: only +1d6 for spells with non-costly material components" : {
				name : "Spiritual Focus: Improve spells",
				description : desc([
					"If I use a spiritual focus to cast a bard spell, I can add 1d6 to one damage or healing roll"
				])
			},
			"allow +1d6 for any bard spell" : {
				name : "Spiritual Focus: Improve spells",
				description : desc([
					"While holding a spiritual focus, I can add 1d6 to one damage or healing roll of bard spells"
				])
			},
			defaultChoice : "allow +1d6 for any bard spell"
		},
		"subclassfeature6.1" : {
			name : "Spirit Session",
			source : [["VRGtR", 29]],
			minlevel : 6,
			description : desc([
				"Using my spiritual focus, I can conduct a hour-long ritual to channel spirit during a rest",
				"The number of willing participants, me included, can be up to my Proficiency Bonus",
				"At the end, I learn a divination or necromancy spell of my choice until I start a long rest",
				"The spell can't be higher level than the number of participants and of a level I can cast"
			]),
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				name : "Spirit Session",
				school : ["Div", "Necro"],
				firstCol : "SS"
			}
		},
		"subclassfeature14" : {
			name : "Mystical Connection",
			source : [["VRGtR", 29]],
			minlevel : 14,
			description : desc([
				"For Tales from Beyond, I now roll my bardic inspiration die twice and " + (typePF ? "choose" : "select") + " which to use",
				"If I roll the same number on both dice, I can instead choose any effect on the table"
			])
		}
	}
});
AddSubClass("bard_ua22xc", "college of satire-ua", { // Still valid 2021-09-21
	regExpSearch : /^(?=.*(college|bard|minstrel|troubadour))(?=.*satire).*$/i,
	subname : "College of Satire",
	source : [["UA:KoO", 2]],
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiencies",
			source : [["UA:KoO", 2]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with thieves' tools, sleight of hand, and one other skill of my choice",
			skills : ["Sleight of Hand"],
			skillstxt : "Thieves' Tools, Sleight of Hand, and any one other skill",
			toolProfs : [["Thieves' tools", "Dex"]]
		},
		"subclassfeature3.1" : {
			name : "Tumbling Fool",
			source : [["UA:KoO", 2]],
			minlevel : 3,
			description : "\n   " + "As a bonus action, I tumble which gives the benefits of the Dash and Disengage actions" + "\n   " + "I also gain a climbing speed at my current speed and half damage from falling",
			action : ["bonus action", ""],
			speed : { climb : { spd : "walk", enc : "walk" } }
		},
		"subclassfeature6" : {
			name : "Fool's Insight",
			source : [["UA:KoO", 2]],
			minlevel : 6,
			description : "\n   " + "I can cast Detect Thoughts, but on a save the target suffers an embarrassing social gaffe",
			usages : "Charisma modifier per ",
			usagescalc : "event.value = Math.max(1, What('Cha Mod'));",
			recovery : "long rest",
			spellcastingBonus : {
				name : "Fool's Insight",
				spells : ["detect thoughts"],
				selection : ["detect thoughts"],
				firstCol : "(S)"
			},
			spellChanges : {
				"detect thoughts" : {
					description : "1 a read thoughts of visible Int>3 crea or detect invisible in 30 ft; save for probing, social gaffe on save",
					changes : "I can cast this spell a number of times equal to my Charisma modifier per long rest and when I do so and the target makes its save, it suffers an embarrassing social gaffe."
				}
			}
		},
		"subclassfeature14" : {
			name : "Fool's Luck",
			source : [["UA:KoO", 3]],
			minlevel : 14,
			description : " [one bardic inspiration die]" + "\n   " + "When I fail an ability check, saving throw, or attack roll, I can add one inspiration die" + "\n   " + "If this turns the roll into a success, I have to note down the number rolled" + "\n   " + "I can't use this ability again until the DM subtracts the amount from a check or attack",
			usages : 1,
			recovery : "reset"
		}
	}
});

// Add Barbarian subclasses
AddSubClass("barbarian_ua23pt8", "ancestral guardian", {
	regExpSearch : /^(?=.*ancestral)(?=.*guardian).*$/i,
	subname : "Path of the Ancestral Guardian",
	source : [["X", 9]],
	fullname : "Ancestral Guardian (UA:PT-viii)",
	features : {
		"subclassfeature3" : {
			name : "Ancestral Protectors",
			source : [["X", 10]],
			minlevel : 3,
			description : desc([
				"While raging, the first creature I hit with an attack on my turn becomes distracted",
				"While distracted, it has disadvantage on attack rolls that don't target me",
				"In addition, everybody but me counts as having resistance to all of the target's attacks",
				"This lasts until the start of my next turn, or until my rage ends"
			])
		},
		"subclassfeature6" : {
			name : "Spirit Shield",
			source : [["X", 10]],
			minlevel : 6,
			description : desc([
				"As a reaction while raging when an ally I see within 30 ft is damaged, I can reduce it",
				"My guardian spirits reduce the damage by an amount equal to the roll of the dice"
			]),
			additional : levels.map(function (n) { return n < 6 ? "" : (n < 10 ? 2 : n < 14 ? 3 : 4) + "d6 damage reduced"; }),
			action : ["reaction", " (in Rage)"]
		},
		"subclassfeature10" : {
			name : "Consult the Spirits",
			source : [["X", 10]],
			minlevel : 10,
			description : desc([
				"I can cast either Clairvoyance or Augury, without a spell slot or material components",
				"Augury consults ancestral spirits; Clairvoyance summons an invisible ancestral spirit",
				"Wisdom is my spellcasting ability for these spells"
			]),
			spellcastingAbility : 5,
			spellcastingBonus : [{
				name : "Consult the Spirits",
				spells : ["augury"],
				selection : ["augury"],
				firstCol : 'oncesr'
			}, {
				name : "Consult the Spirits",
				spells : ["clairvoyance"],
				selection : ["clairvoyance"],
				firstCol : 'oncesr'
			}],
			usages : 1,
			recovery : "short rest",
			spellChanges : {
				"augury" : {
					components : "V,S",
					compMaterial : "",
					description : "Omen about specific course of action I plan to take in the next 30 min",
					changes : "My casting of Augury is a practice of consulting my ancestral spirits, thus requiring no material components."
				},
				"clairvoyance" : {
					components : "V,S",
					compMaterial : "",
					changes : "My casting of Clairvoyance is a practice of consulting my an ancestral spirit of mine, thus requiring no material components."
				}
			}
		},
		"subclassfeature14" : {
			name : "Vengeful Ancestors",
			source : [["X", 10]],
			minlevel : 14,
			description : "\n   " + "When using Spirit Shield, the attacker takes the reduced amount as force damage"
		}
	}
});
AddSubClass("barbarian_ua23pt8", "battlerager", {
	regExpSearch : /battlerager/i,
	subname : "Path of the Battlerager",
	fullname : "Battlerager (UA:PT-viii)",
	source : [["S", 121]],
	abilitySave : 6,
	features : {
		"subclassfeature3" : {
			name : "Battlerager Armor",
			source : [["S", 121]],
			minlevel : 3,
			description : desc([
				"I gain proficiency with spiked armor both as an armor and as a weapon",
				"As a bonus action while raging, I can attack once with my armor spikes",
				"With my spiked armor I do 3 piercing damage when I use my Attack action to grapple"
			]),
			action : ["bonus action", "Armor Spikes attack (in rage)"],
			armorOptions : [{
				regExpSearch : /^(?!.*(dragon|draconic|beast))(?=.*spike(d|s))(?=.*armou?r).*$/i,
				name : "Spiked armor",
				source : [["S", 121]],
				type : "medium",
				ac : 14,
				stealthdis : true,
				weight : 45
			}],
			weaponOptions : {
				regExpSearch : /^(?=.*armou?r)(?=.*spike).*$/i,
				name : "Armor spikes",
				source : [["S", 121]],
				ability : 1,
				type : "armor spikes",
				damage : [1, 4, "piercing"],
				range : "Melee",
				description : "Does 3 piercing damage when grappling during my Attack action",
				abilitytodamage : true
			},
			weaponProfs : [false, false, ["armor spikes"]],
			weaponsAdd : ['Armor Spikes'],
			eval : function() {
				AddString('Proficiency Armor Other Description', 'Spiked Armor', ', ');
			},
			removeeval : function () {
				RemoveString('Proficiency Armor Other Description', 'Spiked Armor');
			}
		},
		"subclassfeature6" : {
			name : "Reckless Abandon",
			source : [["S", 121]],
			minlevel : 6,
			description : "\n   " + "If I use Reckless Attack during rage, I also gain temporary HP equal to my Con mod"
		},
		"subclassfeature10" : {
			name : "Battlerager Charge",
			source : [["S", 121]],
			minlevel : 10,
			description : "\n   " + "As a bonus action while raging, I can use the Dash action",
			action : ["bonus action", " (in rage)"]
		},
		"subclassfeature14" : {
			name : "Spiked Retribution",
			source : [["S", 121]],
			minlevel : 14,
			description : "\n   " + "When I'm hit in melee by an attacker within 5 ft, it takes 3 piercing damage" + "\n   " + "This only works while I'm wearing spiked armor, in rage, and I'm not incapacitated"
		}
	}
});
AddSubClass("barbarian_ua23pt8", "giant", {
	regExpSearch : /^((?=.*(barbarian|viking|(norse|tribes?|clans?)(wo)?m(a|e)n))|((?=.*(warrior|fighter))(?=.*(feral|tribal))))(?=.*giant).*$/i,
	subname : "Path of the Giant",
	source : [["GotG", 11]],
	abilitySave : 1,
	spellcastingAbility : 5,
	features : {
		"subclassfeature3" : {
			name : "Giant Power",
			source : [["GotG", 11]],
			minlevel : 3,
			description : desc("I learn Giant, and the Druidcraft or Thaumaturgy cantrip with Wis as spellcasting ability"),
			languageProfs : ["Giant"],
			spellcastingBonus : [{
				name : "Giant Power",
				spells : ["druidcraft", "thaumaturgy"],
				firstCol : "atwill"
			}]
		},
		"subclassfeature3.1" : {
			name : "Giant's Havoc",
			source : [["GotG", 11]],
			minlevel : 3,
			description : levels.map(function (n) {
				return desc([
					"While raging, I add the bonus damage to ranged thrown weapon attacks that use Str,",
					"I gain +" + (n < 14 ? 5 : 10) + " ft reach, and I can become " + (n < 14 ? 'Large' : 'Huge') + " along with what I'm wearing, if there is room"
				]);
			})
		},
		"subclassfeature6" : {
			name : "Elemental Cleaver",
			source : [["GotG", 11]],
			minlevel : 6,
			description : levels.map(function (n) {
				return desc([
					"When I rage, I can infuse a weapon I'm holding with acid, cold, fire, thunder, or lightning",
					"While raging, its damage type changes to the chosen type and it deals +" + (n < 14 ? 1 : 2) + "d6 damage,",
					"it gains the thrown (20/60 ft) property, and reappears instantly after a thrown attack",
					"As a bonus action, I can change the chosen type; The bonuses only function for me"
				]);
			}),
			action : [["bonus action", " (change type)"]],
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if ((v.isMeleeWeapon || v.isRangedWeapon) && classes.known.barbarian_ua23pt8 && classes.known.barbarian_ua23pt8.level && /^(?=.*elemental)(?=.*cleaver).*$/i.test(v.WeaponTextName)) {
							fields.Damage_Type = "Varies";
							var isThrownWeapon = /\bthrown\b/i.test(v.WeaponText);
							var extraDmg = classes.known.barbarian_ua23pt8.level < 14 ? '+1d6 damage' : '+2d6 damage';
							var extraProp = v.isRangedWeapon && !isThrownWeapon ? 'Thrown (20/60 ft), returning; ' : isThrownWeapon ? 'Returning; ' : 'Thrown, returning; ';
							var hasRange = /\d+ ?(f.{0,2}t|m)/i.test(fields.Range);
							if (!hasRange) {
								fields.Range += ', 20/60 ft';
							} else if ((!v.isRangedWeapon || isThrownWeapon) && hasRange) {
								var rangeNmbr = fields.Range.match(/\d+([.,]\d+)?/g);
								if (rangeNmbr.length === 1) {
									var longRange = Number(rangeNmbr[0].replace(',', '.'));
									if (longRange < 60) tempRange = fields.Range.replace(longRange,"long_range");
								} else {
									var shortRange = Number(rangeNmbr[0].replace(',', '.'));
									var longRange = Number(rangeNmbr[1].replace(',', '.'));
									tempRange = fields.Range;
									if (shortRange < 20) tempRange = tempRange.replace(shortRange,"short_range");
									if (longRange < 60) tempRange = tempRange.replace(longRange,"long_range");
								}
								fields.Range = tempRange.replace("short_range", 20).replace("long_range", 60);
							}
							fields.Description += (fields.Description ? '; ' : '') + extraProp + extraDmg;
						}
					},
					"If I include the words 'Elemental Cleaver' in a weapon's name, the Elemental Cleaver infused weapon properties will be added to it and its damage type will be set to 'Varies'. Also, my Rage's bonus damage will be added to it if it is a melee weapon that uses Strength."
				],
				atkCalc : [
					function (fields, v, output) {
						if (v.isMeleeWeapon && fields.Mod === 1 && classes.known.barbarian_ua23pt8 && classes.known.barbarian_ua23pt8.level && /^(?!.*\brage\b)(?=.*elemental)(?=.*cleaver).*$/i.test(v.WeaponTextName)) {
							output.extraDmg += classes.known.barbarian_ua23pt8.level < 9 ? 2 : classes.known.barbarian_ua23pt8.level < 16 ? 3 : 4;
						}
					},
					""
				]
			}
		},
		"subclassfeature10" : {
			name : "Mighty Impel",
			source : [["GotG", 12]],
			minlevel : 10,
			description : levels.map(function (n) {
				return " [DC 8 + Prof Bonus + Str mod]" + desc([
					"As a bonus action while raging, I can hurl a " + (n < 14 ? 'Medium' : 'Large') + " or smaller creature within my reach",
					"I move it to an empty space I can see within 30 ft; Unwilling can save to avoid this",
					"If it doesn't end this movement on a surface that can support it, it falls and lands prone"
				]);
			}),
			action : [["bonus action", " (in rage)"]]
		},
		"subclassfeature14" : {
			name : "Demiurgic Colossus",
			source : [["GotG", 12]],
			minlevel : 14,
			description : desc([
				"While raging, my reach increases by 10 ft, and my size can increase to Huge",
				"Mighty Impel works on Large creatures; Elemental Cleaver increases to +2d6 damage",
			])
		}
	}
});
AddSubClass("barbarian_ua23pt8", "path of the beast", {
	regExpSearch : /^(?=.*\bbeast\b)(?=.*(warrior|barbarian|viking|(norse|tribes?|clans?)(wo)?m(a|e)n)).*$/i,
	subname : "Path of the Beast",
	source : [["T", 24]],
	abilitySave : 3,
	features : {
		"subclassfeature3" : {
			name : "Form of the Beast",
			source : [["T", 24]],
			minlevel : 3,
			description : desc([
				"When I enter my rage, I can transform to gain a bite, tail, or claws attack for that rage",
				"On a hit with the bite attack once on each of my turns, I can heal my Prof Bonus in HP",
				"This only works if I have less than half my hit points when I hit with this bite attack",
				"With the claws I can make one extra attack when I attack with it in my Attack action",
				"As a reaction with the tail when I'm hit, I can add 1d8 to my AC for that attack",
				"This only works if the hit is from an attack roll made a creature I can see within 30 ft"
			]),
			weaponOptions : [{
				regExpSearch : /^(?=.*(bestial|beast))(?=.*bite).*$/i,
				name : "Bestial Bite",
				source : [["T", 24]],
				ability : 1,
				type : "Natural",
				damage : [1, 8, "piercing"],
				range : "Melee",
				description : "Only in rage; On a hit once on my turn, regain Prof Bonus in HP (if below 1/2 HP)",
				abilitytodamage : true,
				bestialNaturalWeapon : true
			}, {
				regExpSearch : /^(?=.*(bestial|beast))(?=.*claws?).*$/i,
				name : "Bestial Claws",
				source : [["T", 24]],
				ability : 1,
				type : "Natural",
				damage : [1, 6, "slashing"],
				range : "Melee",
				description : "Only in rage; Extra attack if used as part of Attack action",
				abilitytodamage : true,
				bestialNaturalWeapon : true
			}, {
				regExpSearch : /^(?=.*(bestial|beast))(?=.*tail).*$/i,
				name : "Bestial Tail",
				source : [["T", 25]],
				ability : 1,
				type : "Natural",
				damage : [1, 8, "piercing"],
				range : "Melee",
				description : "Reach; Only in rage",
				abilitytodamage : true,
				bestialNaturalWeapon : true
			}],
			weaponsAdd : ["Bestial Bite", "Bestial Claws", "Bestial Tail"],
			additional : levels.map(function(n) {
				return n < 6 ? "" : "chosen weapon counts as magical";
			}),
			action : [["reaction", "Bestial Tail"]]
		},
		"subclassfeature6" : {
			name : "Bestial Soul",
			source : [["T", 25]],
			minlevel : 6,
			description : desc([
				"When I finish a short rest, I can choose one of the following benefits until my next rest:",
				" \u2022 Swimming speed equal to my walking speed and I can breathe underwater",
				" \u2022 Climb speed (same as walking) and no check to climb difficult surfaces or upside down",
				" \u2022 Once per turn when I jump, I can extend it by the result of an Athletics check in feet"
			]),
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.theWea.bestialNaturalWeapon && !v.thisWeapon[1] && !v.theWea.isMagicWeapon && !(/counts as( a)? magical/i).test(fields.Description)) {
							fields.Description += (fields.Description ? '; ' : '') + 'Counts as magical';
						};
					},
					"The natural melee weapon that I gain from Form of the Beast count as magical for the purpose of overcoming resistance and immunity to nonmagical attacks and damage."
				]
			}
		},
		"subclassfeature10" : {
			name : "Infectious Fury",
			source : [["T", 25]],
			minlevel : 10,
			description : desc([
				"In rage, when I hit a creature with my natural weapon, I can have it make a Wis save",
				"If it fails (DC 8 + my Prof Bonus + my Con mod) it suffers one effect of my choice:",
				" \u2022 It uses its reaction to make a melee attack against one creature I can see of my choice",
				" \u2022 It takes 2d12 psychic damage"
			]),
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature14" : {
			name : "Call the Hunt",
			source : [["T", 25]],
			minlevel : 14,
			description : desc([
				"When I enter rage, I can choose my Con mod of willing creatures I can see within 30 ft",
				"Once on each of their turns, if they hit an attack, they can have it deal +1d6 damage",
				"This lasts as long as I rage; I gain 5 temporary HP per creature that accepts this benefit"
			]),
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		}
	}
});
AddSubClass("barbarian_ua23pt8", "path of wild magic", {
	regExpSearch : /^(?=.*\bwild\b)(?=.*\bmagic\b).*$/i,
	subname : "Path of Wild Magic",
	source : [["T", 25]],
	abilitySave : 3,
	features : {
		"subclassfeature3" : {
			name : "Magic Awareness",
			source : [["T", 25]],
			minlevel : 3,
			description : desc([
				"As an action, I can open my awareness to the presence of concentrated magic",
				"Until my next turn ends, I know the location of any spell or magic item within 60 ft",
				"I also learn the school of magic of a spell; This doesn't reveal anything behind total cover"
			]),
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus')",
			recovery : "long rest",
			action : [["action", ""]]
		},
		"subclassfeature3.1" : {
			name : "Wild Surge",
			source : [["T", 25]],
			minlevel : 3,
			description : "\n   Whenever I enter my rage, I roll on the Wild Magic table (see Notes page)",
			toNotesPage : [{
				name : "Wild Magic Table",
				source : [["T", 26]],
				note : [
					"The magical energy roiling inside me sometimes erupts from me. Whenever I enter my rage, I have to roll on the table below to see what happens.",
					"If the effect calls for a saving throw, the DC is equal to 8 + my proficiency bonus + my Constitution modifier.\n",
					"d8\tEFFECT",
					" 1\tShadowy tendrils lash around me. Each creature of my choice that I can see within 30 ft of me must succeed on a Constitution saving throw or take 1d12 necrotic damage. I also gain 1d12 temporary hit points.",
					" 2\tI teleport up to 30 ft to an unoccupied space I can see. Until my rage ends, I can use this effect again on each of my turns as a bonus action.",
					" 3\tAn intangible spirit, which looks like a flumph or a pixie (my choice), appears within 5 ft of one creature of my choice that I can see within 30 ft of me. At the end of the current turn, the spirit explodes, and each creature within 5 ft of it must succeed on a Dexterity saving throw or take 1d6 force damage. Until my rage ends, I can use this effect again, summoning another spirit, on each of my turns as a bonus action.",
					" 4\tMagic infuses one weapon of my choice that I am holding. Until my rage ends, the weapon's damage type changes to force, and it gains the light and thrown properties, with a normal range of 20 ft and a long range of 60 ft. If the weapon leaves my hand, the weapon reappears in my hand at the end of the current turn.",
					" 5\tWhenever a creature hits me with an attack roll before my rage ends, that creature takes 1d6 force damage, as magic lashes out in retribution.",
					" 6\tUntil my rage ends, I am surrounded by multicolored, protective lights; I gain a +1 bonus to AC, and while within 10 ft of me, my allies gain the same bonus.",
					" 7\tFlowers and vines temporarily grow around me; until my rage ends, the ground within 15 ft of me is difficult terrain for my enemies.",
					" 8\tA bolt of light shoots from my chest. Another creature of my choice that I can see within 30 ft of me must succeed on a Constitution saving throw or take 1d6 radiant damage and be blinded until the start of my next turn. Until my rage ends, I can use this effect again on each of my turns as a bonus action."
				]
			}]
		},
		"subclassfeature6" : {
			name : "Bolstering Magic",
			source : [["T", 26]],
			minlevel : 6,
			description : desc([
				"As an action, I can touch a creature or myself and confer one of the following benefits:",
				" \u2022 For 10 minutes, they can add 1d3 to any attack roll and ability check",
				" \u2022 Roll 1d3. They regain an expended spell slot of a level equal to or lower than the roll",
				"A creature that receives the second benefit can't receive it again until after a long rest"
			]),
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus')",
			recovery : "long rest",
			action : [["action", ""]]
		},
		"subclassfeature10" : {
			name : "Unstable Backlash",
			source : [["T", 26]],
			minlevel : 10,
			description : desc([
				"As a reaction in rage when taking damage or failing a save, I can lash out with magic",
				"I roll on the Wild Magic table and immediately apply the roll, replacing my current effect"
			]),
			action : [["reaction", " (in rage on damage/save fail)"]]
		},
		"subclassfeature14" : {
			name : "Controlled Surge",
			source : [["T", 26]],
			minlevel : 14,
			description : desc([
				"Whenever I roll on the Wild Magic table, I can roll two dice and choose which to use",
				"If I roll the same on both dice, I can instead choose any effect on the Wild Magic table"
			])
		}
	}
});
AddSubClass("barbarian_ua23pt8", "storm herald", {
	regExpSearch : /^(?=.*storm)(?=.*herald).*$/i,
	subname : "Path of the Storm Herald",
	source : [["X", 10]],
	fullname : "Storm Herald (UA:PT-viii)",
	abilitySave : 3,
	features : {
		"subclassfeature3" : {
			name : "Storm Aura",
			source : [["X", 10]],
			minlevel : 3,
			description : desc([
				"While raging, I emanate a 10-ft radius aura, but not through total cover",
				"The aura's features activate when I enter my rage or as a bonus action while raging",
				'Use the "Choose Feature" button above to select the type of aura'
			]),
			choices : ["Desert", "Sea", "Tundra"],
			action : ["bonus action", " (reactivate)"],
			"desert" : {
				name : "Storm Aura: Desert",
				description : desc([
					"While raging, I emanate a 10-ft radius aura, but not through total cover",
					"The aura's features activate when I enter my rage or as a bonus action while raging",
					"Whenever I active my aura, anybody in my aura other than me takes fire damage"
				]),
				additional : levels.map(function (n) { return n < 3 ? "" : (n < 5 ? 2 : n < 10 ? 3 : n < 15 ? 4 : n < 20 ? 5 : 6) + " fire damage"; })
			},
			"sea" : {
				name : "Storm Aura: Sea",
				description : desc([
					"While raging, I emanate a 10-ft radius aura, but not through total cover",
					"The aura's features activate when I enter my rage or as a bonus action while raging",
					"Whenever I active my aura, I can choose one creature in my aura other than me",
					"It takes lightning damage, or half as much on a successful Dexterity saving throw",
					"My Storm Herald features have DC 8 + my Proficiency Bonus + my Constitution modifier"
				]),
				additional : levels.map(function (n) { return n < 3 ? "" : (n < 10 ? 1 : n < 15 ? 2 : n < 20 ? 3 : 4) + "d6 lightning damage"; })
			},
			"tundra" : {
				name : "Storm Aura: Tundra",
				description : desc([
					"While raging, I emanate a 10-ft radius aura, but not through total cover",
					"The aura's features activate when I enter my rage or as a bonus action while raging",
					"Whenever I active my aura, all creatures of my choice in my aura gain temporary HP"
				]),
				additional : levels.map(function (n) { return n < 3 ? "" : (n < 5 ? 2 : n < 10 ? 3 : n < 15 ? 4 : n < 20 ? 5 : 6) + " temporary hit points"; })
			},
			choiceDependencies : [{
				feature : "subclassfeature6"
			}, {
				feature : "subclassfeature10"
			}, {
				feature : "subclassfeature14"
			}]
		},
		"subclassfeature6" : {
			name : "Storm Soul",
			source : [["X", 10]],
			minlevel : 6,
			description : "\n   " + 'Use the "Choose Feature" button above to select the effect',
			choices : ["desert", "sea", "tundra"],
			choicesNotInMenu : true,
			"desert" : {
				name : "Storm Soul: Desert",
				description : desc([
					"I have resistance to fire damage and don't suffer the effects of extreme heat",
					"As an action, I can set fire to an unattended flammable object I touch"
				]),
				action : ["action", " (ignite)"],
				dmgres : ["Fire"],
				savetxt : { immune : ["effects of extreme heat"] }
			},
			"sea" : {
				name : "Storm Soul: Sea",
				description : desc([
					"I can breathe underwater and I have 30 ft swim speed",
					"In addition, I have resistance to lightning damage"
				]),
				dmgres : ["Lightning"],
				speed : { swim : { spd : 30, enc : 20 } }
			},
			"tundra" : {
				name : "Storm Soul: Tundra",
				description : desc([
					"I have resistance to cold damage and don't suffer the effects of extreme cold",
					"As an action, I can turn a 5-ft cube of water to ice, which melts after 1 minute",
					"This action fails if there are any creatures within the cube of water"
				]),
				action : ["action", " (freeze)"],
				dmgres : ["Cold"],
				savetxt : { immune : ["effects of extreme cold"] }
			}
		},
		"subclassfeature10" : {
			name : "Shielding Storm",
			source : [["X", 10]],
			minlevel : 10,
			description : "\n   " + "In rage, creatures of my choice within my Storm Aura also gain Storm Soul resistance",
			choices : ["desert", "sea", "tundra"],
			choicesNotInMenu : true,
			"desert" : {
				name : "Shielding Storm: Desert",
				description : "\n   " + "While raging, creatures of my choice within my Storm Aura also gain resistance to fire"
			},
			"sea" : {
				name : "Shielding Storm: Sea",
				description : "\n   " + "In rage, creatures of my choice within my Storm Aura also gain resistance to lightning"
			},
			"tundra" : {
				name : "Shielding Storm: Tundra",
				description : "\n   " + "While raging, creatures of my choice within my Storm Aura also gain resistance to cold"
			}
		},
		"subclassfeature14" : {
			name : "Raging Storm",
			source : [["X", 11]],
			minlevel : 14,
			description : "\n   " + 'Use the "Choose Feature" button above to select the effect',
			choices : ["desert", "sea", "tundra"],
			choicesNotInMenu : true,
			"desert" : {
				name : "Raging Storm: Desert",
				description : desc([
					"As a reaction when hit by a creature in my Storm Aura, I can have it make a Dex save",
					"On a failed save, the attacker takes fire damage equal to half my barbarian level",
					"My Storm Herald features have DC 8 + my Proficiency Bonus + my Constitution modifier"
				]),
				action : ["reaction", " (if hit)"],
				additional : levels.map(function (n) { return n < 14 ? "" : Math.floor(n/2) + " fire damage"; })
			},
			"sea" : {
				name : "Raging Storm: Sea",
				description : desc([
					"As a reaction when I hit a creature in my Storm Aura, I can have it make a Str save",
					"On a failed save, the creature is knocked prone, as if struck by a wave"
				]),
				action : ["reaction", " (with attack)"]
			},
			"tundra" : {
				name : "Raging Storm: Tundra",
				description : desc([
					"Whenever I activate my Storm Aura, I can choose a creature in my aura that I can see",
					"It must make a Str save or have its speed reduced to 0 until the start of my next turn",
					"My Storm Herald features have DC 8 + my Proficiency Bonus + my Constitution modifier"
				])
			}
		}
	}
});

// Add Cleric subclasses
AddSubClass("cleric_ua23pt6", "knowledge domain", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*(knowledge|wisdom)).*$/i,
	subname : "Knowledge Domain",
	source : [["P", 59]],
	spellcastingExtra : ["command", "identify", "augury", "suggestion", "nondetection", "speak with dead", "arcane eye", "confusion", "legend lore", "scrying"],
	features : {
		"subclassfeature3" : {
			name : "Blessings of Knowledge",
			source : [["P", 59]],
			minlevel : 3,
			description : "\n   " + "I learn two languages and gain proficiency and expertise with two skills" + "\n   " + "I can choose from the following: Arcana, History, Nature, or Religion",
			skillstxt : "Choose two from Arcana, History, Nature, and Religion. You also gain expertise with these skills",
			languageProfs : [2]
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Knowledge of Ages",
			source : [["P", 59]],
			minlevel : 3,
			description : "\n   " + "As an action, I gain proficiency with a chosen skill or tool for 10 minutes",
			action : ["action", ""]
		},
		"subclassfeature6" : {
			name : "Channel Divinity: Read Thoughts",
			source : [["P", 59]],
			minlevel : 6,
			description : "\n   " + "As an action, one creature within 60 ft I can see must make a Wisdom save" + "\n   " + "If it fails, I can read its surface thoughts for 1 min, as long as it's within 60 ft of me" + "\n   " + "As an action, I can end this and cast Suggestion on it (it fails its save automatically)" + "\n   " + "If it succeeded on its save, I can't use this feature again on it until I finish a long rest",
			action : ["action", ""]
		},
		"subclassfeature17" : {
			name : "Visions of the Past",
			source : [["P", 60]],
			minlevel : 17,
			description : desc([
				"I can see recent events of an object or area by concentrating and praying for 1 min",
				"I can meditate this way for up to a number of minutes equal to my Wisdom score",
				"\u2022 Object Reading (after meditating for 1 minute per owner):",
				"   If an owner owned it in the last Wis score in days, I learn how that owner got/lost it",
				"   I also learn the most recent significant event involving the object and the owner",
				"\u2022 Area Reading (my immediate surroundings, up to a 50-foot cube):",
				"   Going back my Wisdom score in days, per minute I meditate, I learn about one event",
				"   This starts with the most recent event; It can be significant or just important to me"
			]),
			usages : 1,
			recovery : "short rest"
		}
	}
});
AddSubClass("cleric_ua23pt6", "nature domain", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*\b(nature|natural|animal)\b).*$/i,
	subname : "Nature Domain",
	source : [["P", 62]],
	spellcastingExtra : ["animal friendship", "speak with animals", "barkskin", "spike growth", "plant growth", "wind wall", "dominate beast", "grasping vine", "insect plague", "tree stride"],
	features : {
		"subclassfeature3" : {
			name : "Acolyte of Nature",
			source : [["P", 62]],
			minlevel : 3,
			description : "\n   " + "I learn a druid cantrip and proficiency with a skill: Animal Handling, Nature, Survival",
			skillstxt : "Choose one from Animal Handling, Nature, or Survival",
			spellcastingBonus : {
				name : "Acolyte of Nature",
				"class" : "druid",
				level : [0, 0]
			}
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Charm Animals and Plants",
			source : [["P", 62]],
			minlevel : 3,
			description : "\n   " + "As an action, all beasts and plants within 30 ft that I can see must make a Wis save" + "\n   " + "If failed, each is charmed and friendly to allies and me for 1 min or until damaged",
			action : ["action", ""]
		},
		"subclassfeature6" : {
			name : "Dampen Elements",
			source : [["P", 62]],
			minlevel : 6,
			description : "\n   " + "As a reaction, if an ally in 30 ft or I takes acid/cold/fire/lightning/thunder damage," + "\n   " + "I can grant resistance against that instance of damage",
			action : ["reaction", ""]
		},
		"subclassfeature17" : {
			name : "Master of Nature",
			source : [["P", 62]],
			minlevel : 17,
			description : "\n   " + "As a bonus action, I can command creatures that are charmed by my Channel Divinity",
			action : ["bonus action", ""]
		}
	}
});
AddSubClass("cleric_ua23pt6", "tempest domain", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*\b(tempest|destruction)\b).*$/i,
	subname : "Tempest Domain",
	source : [["P", 62]],
	spellcastingExtra : ["fog cloud", "thunderwave", "gust of wind", "shatter", "call lightning", "sleet storm", "control water", "ice storm", "destructive wave", "insect plague"],
	features : {
		"subclassfeature3" : {
			name : "Wrath of the Storm",
			source : [["P", 62]],
			minlevel : 3,
			description : "\n   " + "As a reaction, when a creature I can see within 5 ft hits me, I can thunderously rebuke" + "\n   " + "It takes 2d8 lightning or thunder damage (my choice) that a Dex save can halve",
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			action : ["reaction", ""]
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Destructive Wrath",
			source : [["P", 62]],
			minlevel : 3,
			description : "\n   " + "Instead of rolling, I can do maximum damage when I do lightning or thunder damage"
		},
		"subclassfeature6" : {
			name : "Thunderbolt Strike",
			source : [["P", 62]],
			minlevel : 6,
			description : "\n   " + "When I deal lightning damage to a Large or smaller foe, I can push it up to 10 ft away"
		},
		"subclassfeature17" : {
			name : "Stormborn",
			source : [["P", 62]],
			minlevel : 17,
			description : "\n   " + "Whenever I'm not underground or indoors, I have a fly speed equal to my current speed",
			speed : { fly : { spd : "walk", enc : "walk" } }
		}
	}
});
AddSubClass("cleric_ua23pt6", "death domain", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*(death|dead)).*$/i,
	subname : "Death Domain",
	source : [["D", 96]],
	spellcastingExtra : ["false life", "ray of sickness", "blindness/deafness", "ray of enfeeblement", "animate dead", "vampiric touch", "blight", "death ward", "antilife shell", "cloudkill"],
	features : {
		"subclassfeature3" : {
			name : "Reaper",
			source : [["D", 96]],
			minlevel : 3,
			description : "\n   " + "I learn one necromancy cantrip of my choice from any spell list" + "\n   " + "My necromancy, single-target cantrips can affect two targets within 5 ft of each other",
			spellcastingBonus : {
				name : "Reaper",
				"class" : "any",
				school : ["Necro"],
				level : [0, 0]
			},
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (spellObj.school == "Necro" && spellObj.level === 0) {
							var startDescr = spellObj.description;
							switch (spellKey) {
								case "chill touch" :
									spellObj.description = spellObj.description.replace("Spell attack", "2 crea in 5 ft spell atk").replace("Necrotic", "Necro.").replace("at CL 5, 11, and 17", "CL 5/11/17");
									break;
								case "spare the dying" :
									spellObj.description = spellObj.description.replace("1 living creature", "1 living creature (or 2 within 5 ft of each other)");
									break;
								case "toll the dead" :
								default :
									spellObj.description = spellObj.description.replace(/1 crea(ture)?/i, "2 crea in 5 ft").replace("disadvantage", "disadv.").replace("save halves", "save half");
							}
							return startDescr !== spellObj.description;
						};
					},
					"My necromancy, single-target cantrips can affect two targets within 5 ft of each other."
				]
			}
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Touch of Death",
			source : [["D", 97]],
			minlevel : 3,
			description : "\n   " + "When I hit a creature with a melee attack, I can deal extra necrotic damage",
			additional : ["", "+9 damage", "+11 damage", "+13 damage", "+15 damage", "+17 damage", "+19 damage", "+21 damage", "+23 damage", "+25 damage", "+27 damage", "+29 damage", "+31 damage", "+33 damage", "+35 damage", "+37 damage", "+39 damage", "+41 damage", "+43 damage", "+45 damage"]
		},
		"subclassfeature6" : {
			name : "Inescapable Destruction",
			source : [["D", 97]],
			minlevel : 6,
			description : "\n   " + "When I deal necrotic damage with spells or Channel Divinity, I ignore resistance to it"
		},
		"subclassfeature17" : {
			name : "Improved Reaper",
			source : [["D", 97]],
			minlevel : 17,
			description : "\n   " + "If I cast a 5th-level or lower necromancy spell that has one target, I can target two" + "\n   " + "They need to be within 5 ft of each other; I have to provide material comp. for both",
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (spellObj.school == "Necro" && spellObj.level && spellObj.level < 6) {
							var startDescr = spellObj.description;
							switch (spellKey) {
								case "blindness/deafness" :
									// only 2 target if not cast at higher SL
									spellObj.description = "2 crea in 5 ft or " + spellObj.description;
									break;
								case "contagion" :
								case "inflict wounds" :
								case "ray of enfeeblement" :
									spellObj.description = spellObj.description.replace(/(Melee )?spell attack/i, "2 " + "$1".toLowerCase() + "spell atk in 5 ft").replace("spell ends", "ends");
									break;
								case "cause fear" :
									spellObj.description = "2 crea in 5 ft or 1+1/SL crea max 30 ft apart (no constr/undead), save or frightened; save end of turn";
									break;
								case "feign death" :
									spellObj.description = "2 willing crea in 5 ft appear dead; Are blinded, incapacitated, dmg resist. all but Psychic, speed 0";
									break;
								case "gentle repose" :
									spellObj.description = spellObj.description.replace("1 corpse protected from", "2 corpses in 5 ft suffer no");
									break;
								case "raise dead" :
								case "revivify" :
									spellObj.description = spellObj.description.replace("a creature's body that has", "body of 2 crea in 5 ft that").replace("cons.)", "cons. \xD72)");
									spellObj.compMaterial += " (once for each target)";
									break;
								case "speak with dead" :
									spellObj.description = spellObj.description.replace("1 corpse with mouth answers 5 questions", "2 corpses in 5 ft answer 5 questions each");
									break;
								case "enervation" :
									spellObj.description = spellObj.description.replace("action", "1 a").replace("see book", "see B");
								case "bestow curse" :
								case "blight" :
								case "cause fear-uass" :
								case "life transference" :
								case "negative energy flood" :
								default :
									spellObj.description = spellObj.description.replace(/1 crea(ture)?/i, "2 crea in 5 ft").replace("disadvantage", "disadv.").replace("save halves", "save half");
							}
							return startDescr !== spellObj.description;
						};
					},
					"My necromancy, single-target 5th-level or lower spells can affect two targets within 5 ft of each other if both are within range of the spell. The spells still require material components for each target separately."
				]
			}
		}
	}
});
AddSubClass("cleric_ua23pt6", "arcana domain", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*(arcana|magic)).*$/i,
	subname : "Arcana Domain",
	source : [["S", 125]],
	spellcastingExtra : ["detect magic", "magic missile", "magic weapon", "nystul's magic aura", "dispel magic", "magic circle", "arcane eye", "leomund's secret chest", "planar binding", "teleportation circle"],
	features : {
		"subclassfeature3" : {
			name : "Arcane Initiate",
			source : [["S", 125]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with Arcana and two wizard cantrips that count as cleric cantrips",
			skills : ["Arcana"],
			spellcastingBonus : {
				name : "Arcane Initiate",
				"class" : "wizard",
				level : [0, 0],
				times : 2
			}
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Arcane Abjuration",
			source : [["S", 125]],
			minlevel : 3,
			description : "\n   " + "As an action, one celestial, elemental, fey, or fiend within 30 ft must make a Wis save" + "\n   " + "If it fails and is able to see/hear me, it is turned for 1 min or until it takes damage" + "\n   " + "Turned: move away, never within 30 ft of me, no reactions or actions other than Dash" + "\n   " + "Turned: may Dodge instead of Dash when nowhere to move and unable to escape bonds" + "\n   " + "If its CR is low enough and it is not on its home plane, it is banished for 1 min instead" + "\n   " + "Banished: sent to home plane, reappearing where it was if the effect ends before 1 min",
			additional : ["", "", "", "", "CR 1/2 or lower", "CR 1/2 or lower", "CR 1/2 or lower", "CR 1 or lower", "CR 1 or lower", "CR 1 or lower", "CR 2 or lower", "CR 2 or lower", "CR 2 or lower", "CR 3 or lower", "CR 3 or lower", "CR 3 or lower", "CR 4 or lower", "CR 4 or lower", "CR 4 or lower", "CR 4 or lower"],
			action : ["action", ""]
		},
		"subclassfeature6" : {
			name : "Spell Breaker",
			source : [["S", 126]],
			minlevel : 6,
			description : "\n   " + "When I restore HP to an ally with a 1st-level or higher spell, I can also end one spell" + "\n   " + "The chosen spell on the ally ends if it is equal or lower level to the spell slot level used",
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {							
						var startDescr = spellObj.description;
						switch (spellKey) {
							case "mass heal" :
								spellObj.description = "Heal 700 hp, split over crea in range; also cures blindness, deafness, and all diseases; spell breaker";
								break;
							case "power word heal" :
								spellObj.description = spellObj.description.replace(/heals all.*/i, "full hp; no longer charmed, frightened, paralyzed, stunned; can stand up as rea; spell breaker");
								break;
							case "goodberry" :
								spellObj.description = spellObj.description.replace("Create ", "").replace("lose potency after ", "remain");
							case "regenerate" :
								spellObj.description = spellObj.description.replace(" for rest of duration", "");
							case "heal" :
								spellObj.description = spellObj.description.replace("all diseases", "diseases");
							case "cure wounds" :
							case "healing word" :
							case "life transference" :
							case "mass cure wounds" :
							case "mass healing word" :
							case "prayer of healing" :
								spellObj.description = spellObj.description.replace(/creatures?/i, "crea").replace("within", "in").replace("spellcasting ability modifier", "spellcasting ability mod") + "; spell breaker";
						}
						return startDescr !== spellObj.description;
					},
					"When I cast a spell that restores hit points to another creature than myself, I can also end a spell affecting the target. This spell can be of the same level of the spell slot used to cast the healing spell, or lower."
				]
			}
		},
		"subclassfeature17" : {
			name : "Arcane Mastery",
			source : [["S", 126]],
			minlevel : 17,
			description : "\n   " + "I add four wizards spells, a 6th, 7th, 8th, and 9th-level spell, to my domain spells" + "\n   " + "As any domain spell, these spells are automatically prepared and count as cleric spells",
			spellcastingBonus : [{
				name : "Arcane Mastery (6)",
				"class" : "wizard",
				level : [6, 6],
				firstCol : 'markedbox'
			}, {
				name : "Arcane Mastery (7)",
				"class" : "wizard",
				level : [7, 7],
				firstCol : 'markedbox'
			}, {
				name : "Arcane Mastery (8)",
				"class" : "wizard",
				level : [8, 8],
				firstCol : 'markedbox'
			}, {
				name : "Arcane Mastery (9)",
				"class" : "wizard",
				level : [9, 9],
				firstCol : 'markedbox'
			}]
		}
	}
});
AddSubClass("cleric_ua23pt6", "forge domain", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*(forge|forgery)).*$/i,
	subname : "Forge Domain",
	source : [["X", 18]],
	spellcastingExtra : ["identify", "searing smite", "searing smite ua23pt6", "heat metal", "magic weapon", "elemental weapon", "protection from energy", "fabricate", "wall of fire", "animate objects", "creation"],
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiency",
			source : [["X", 19]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with smith's tools",
			toolProfs : ["Smith's tools"]
		},
		"subclassfeature3.1" : {
			name : "Blessing of the Forge",
			source : [["X", 19]],
			minlevel : 1,
			action : ["action", ""],
			usages : 3,
			recovery : "long rest",
			description : desc([
				"At the end of a long rest, I can imbue magic into a nonmagical weapon or armor",
				"It becomes magical: +1 AC if armor, or +1 to attack and damage rolls if a weapon",
				"This lasts until the end of my next long rest or until I die"
			])
		},
		"subclassfeature3.2" : {
			name : "Channel Divinity: Artisan's Blessing",
			source : [["X", 19]],
			minlevel : 3,
			description : desc([
				"With an hour-long ritual, I can craft a nonmagical item that is at least part metal",
				"Including: suit of armor, simple or martial weapon, set of tools, 10 pieces of ammunition",
				"The creation can be worth up to 100 gp, and I must expend metals of equal value to it",
				"The metals irretrievably coalesce into the new item, forming even nonmetal parts of it",
				"The item can be an exact duplicate of a nonmagical item if I possess the original",
				"The item comes into existence at the end of the hour in an unoccupied space within 5 ft"
			])
		},
		"subclassfeature6" : {
			name : "Soul of the Forge",
			source : [["X", 19]],
			minlevel : 6,
			description : "\n   " + "I gain resistance to fire damage and +1 to AC while wearing medium or heavy armor",
			dmgres : ["Fire"],
			extraAC : {
				mod : 1,
				text : "I gain a +1 bonus to AC while wearing Medium or Heavy armor.",
				stopeval : function (v) { return !v.mediumArmor && !v.heavyArmor; }
			}
		},
		"subclassfeature17" : {
			name : "Saint of Forge and Fire",
			source : [["X", 19]],
			minlevel : 17,
			description : desc([
				"I gain immunity to fire damage",
				"When wearing heavy armor, I'm resistant to nonmagical bludg./piercing/slashing damage"
			]),
			savetxt : { immune : ["fire"] },
			dmgres : [["Bludgeoning", "Bludg. (nonmagical)"], ["Piercing", "Pierc. (nonmagical)"], ["Slashing", "Slash. (nonmagical)"]]
		}
	}
});
AddSubClass("cleric_ua23pt6", "grave domain", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*grave).*$/i,
	subname : "Grave Domain",
	source : [["X", 19]],
	spellcastingExtra : ["bane", "false life", "gentle repose", "ray of enfeeblement", "revivify", "vampiric touch", "blight", "death ward", "antilife shell", "raise dead"],
	features : {
		"subclassfeature3" : {
			name : "Circle of Mortality",
			source : [["X", 20]],
			minlevel : 3,
			action : ["bonus action", ""],
			description : desc([
				"Spells I cast to heal a living creature at 0 HP have their dice count as their max result",
				"I learn Spare the Dying, which I can cast as a bonus action with a range of 30 ft"
			]),
			spellcastingBonus : {
				name : "Circle of Mortality",
				spells : ["spare the dying"],
				selection : ["spare the dying"],
				firstCol : 'atwill'
			},
			spellChanges : {
				"spare the dying" : {
					time : "1 bns",
					range : "30 ft",
					changes : "I can cast Spare the Dying as a bonus action instead of an action, and it has a range of 30 ft instead of touch."
				}
			}
		},
		"subclassfeature3.1" : {
			name : "Eyes of the Grave",
			source : [["X", 20]],
			minlevel : 3,
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			description : desc([
				"As an action, I sense undead within 60 ft that aren't protected from divination magic",
				"Until the end of my next turn, I sense the location of any undead not behind total cover"
			])
		},
		"subclassfeature3.2" : {
			name : "Channel Divinity: Path to the Grave",
			source : [["X", 20]],
			minlevel : 3,
			action : ["action", ""],
			description : desc([
				"As an action, I can curse a creature within 30 ft until the end of my next turn",
				"It is vulnerable to all the damage from the next attack by me or my allies that hits it"
			])
		},
		"subclassfeature6" : {
			name : "Sentinel at Death's Door",
			source : [["X", 20]],
			minlevel : 6,
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			action : ["reaction", ""],
			description : "\n   " + "As a reaction, I turn a critical hit to me or an ally I see within 30 ft to a normal hit"
		},
		"subclassfeature17" : {
			name : "Keeper of Souls",
			source : [["X", 20]],
			minlevel : 17,
			description : desc([
				"Once per round, if I'm not incapacitated, I can manipulate the energy of the dying",
				"When an enemy I can see dies within 60 ft of me, I or an ally within 60 ft regain HP",
				"The HP regained is equal to the enemy's number of Hit Dice"
			])
		}
	}
});
AddSubClass("cleric_ua23pt6", "order domain", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*order).*$/i,
	subname : "Order Domain",
	source : [["T", 31], ["G", 25]],
	spellcastingExtra : ["command", "heroism", "hold person", "zone of truth", "mass healing word", "mass healing word uapt8", "slow", "compulsion", "locate creature", "commune", "dominate person"],
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiency",
			source : [["T", 32], ["G", 26]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with either the Intimidation or Persuasion skill",
			skillstxt : "Choose one from Intimidation or Persuasion"
		},
		"subclassfeature3.1" : {
			name : "Voice of Authority",
			source : [["T", 32], ["G", 26]],
			minlevel : 3,
			description : desc([
				"Whenever I use a spell slot to cast a spell on an ally, it can use its reaction to attack",
				"The ally makes one weapon attack against a target of my choice that I can see",
				"If the spell targets multiple allies, I can choose which one can make the attack"
			])
		},
		"subclassfeature3.2" : {
			name : "Channel Divinity: Order's Demand",
			source : [["T", 32], ["G", 26]],
			minlevel : 3,
			description : desc([
				"As an action, all chosen targets in 30 ft that can see or hear me must make a Wis save",
				"If failed, it is charmed by me until the end of my next turn or it takes any damage",
				"Also, I can choose to have a charmed target drop what its holding when it fails its save"
			]),
			action : [["action", ""]]
		},
		"subclassfeature6" : {
			name : "Embodiment of the Law",
			source : [["T", 32], ["G", 26]],
			minlevel : 6,
			description : desc([
				"When I cast an enchantment spell using a spell slot, I can reduce its casting time",
				"If the spell normally has a casting time of an action, I can now cast it as a bonus action"
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (CurrentSpells[spName].refType == "class" && spellObj.school == "Ench" && spellObj.time == "1 a") {
							spellObj.time = "1a/bns"
							return true;
						};
					},
					"When I cast an enchantment spell using a spell slot that normally requires 1 action to cast, I can reduce its casting time to a bonus action."
				]
			}
		},
		"subclassfeature17" : {
			name : "Order's Wrath",
			source : [["T", 32], ["G", 26]],
			minlevel : 17,
			description : desc([
				"If I deal my Divine Strike damage to a creature, it is cursed until my next turn starts",
				"The next time it is hit by a weapon attack from my allies, it takes +2d8 psychic damage"
			])
		}
	}
});
AddSubClass("cleric_ua23pt6", "peace domain", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*peace).*$/i,
	subname : "Peace Domain",
	source : [["T", 32]],
	spellcastingExtra : ["heroism", "sanctuary", "aid", "aid ua22cs", "warding bond", "beacon of hope", "sending", "aura of purity", "otiluke's resilient sphere", "greater restoration", "rary's telepathic bond"],
	features : {
		"subclassfeature3" : {
			name : "Emboldening Bond",
			source : [["T", 33]],
			minlevel : 3,
			description : levels.map(function (n) {
				return desc([
					"As an action, I can magically bond my Prof Bonus of willing creatures I can see in 30 ft",
					"I can be one of the bonded creatures; The bond lasts for 10 min or until I use this again",
					"While within " + (n < 17 ? 30 : 60) + " ft of another, a bonded target can add +1d4 to a save, attack, or check",
					"Each creature can add the +1d4 only once per turn"
				]);
			}),
			action : [["action", ""]],
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature3.1" : {
			name : "Implement of Peace",
			minlevel : 3,
			description : "\n   " + "I gain proficiency in the Insight, Performance, or Persuasion skill (my choice)",
			skillstxt : "Choose one from: Insight, Performance, or Persuasion"
		},
		"subclassfeature3.2" : {
			name : "Channel Divinity: Balm of Peace",
			source : [["T", 33]],
			minlevel : 3,
			description : desc([
				"As an action, I can move up to my speed without provoking opportunity attacks",
				"During this move, I can heal each creature that I come within 5 ft of once",
				"I restore a number of hit points equal to 2d6 + my Wisdom modifier (minimum 1 HP)"
			]),
			action : [["action", ""]]
		},
		"subclassfeature6" : {
			name : "Protective Bond",
			source : [["T", 33]],
			minlevel : 6,
			description : desc([
				"My Emboldening Bond now also helps those bonded to protect each other if within range",
				"When one is about to take damage, another bonded can use its reaction to teleport closer",
				"They teleport to an empty space within 5 ft of the first and take all the damage instead",
				"From 17th-level, they count as having resistance for this damage, thus take only half"
			]),
			additional : levels.map(function (n) {
				return n < 6 ? "" : "the bonded must be within " + (n < 17 ? 30 : 60) + " ft";
			})
		},
		"subclassfeature17" : {
			name : "Expansive Bond",
			source : [["T", 33]],
			minlevel : 17,
			description : desc([
				"Emboldening and Protective Bond work when the bonded are within 60 ft of each other",
				"Protective Bond now also grants resistance when used to take damage for another"
			])
		}
	}
});
AddSubClass("cleric_ua23pt6", "twilight domain", {
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*(twilight)).*$/i,
	subname : "Twilight Domain",
	source : [["T", 34]],
	spellcastingExtra : ["faerie fire", "sleep", "moonbeam", "see invisibility", "aura of vitality", "leomund's tiny hut", "aura of life", "greater invisibility", "circle of power", "mislead"],
	features : {
		"subclassfeature3" : {
			name : "Eyes of Night",
			source : [["T", 34]],
			minlevel : 3,
			description : desc([
				"I gain darkvision out to a range of 300 ft; As an action, I can grant others this as well",
				"I can grant it for 1 hour to my Wis mod (min 1) of willing targets I can see within 10 ft",
				"I can do this once per long rest, or by expending a spell slot (SS 1+)"
			]),
			action : [["action", " (grant others)"]],
			vision : [["Darkvision", 300]],
			additional : "grant others",
			usages : 1,
			recovery : "long rest",
			altResource : "SS 1+"
		},
		"subclassfeature3.1" : {
			name : "Vigilant Blessing",
			source : [["T", 35]],
			minlevel : 3,
			description : desc([
				"As an action, I can grant myself or a creature I touch adv. on the next initiative roll",
				"This benefit ends immediately after the roll or when I use this feature again"
			]),
			action : [["action", ""]]
		},
		"subclassfeature3.2" : {
			name : "Channel Divinity: Twilight Sanctuary",
			source : [["T", 35]],
			minlevel : 3,
			description : desc([
				"As an action, I can use my holy symbol to create a 30-ft radius sphere around myself",
				"It moves with me, is filled with dim light, and lasts for 1 min or until I'm incapacitated",
				"When a creature, including me, ends its turn inside the sphere, I can grant it a benefit:",
				" \u2022 I grant it temporary hit points equal to 1d6 + my cleric level",
				" \u2022 I end one effect on it causing it to be charmed or frightened",
				"From 17th-level onwards, me and my allies have half cover while inside the sphere"
			]),
			action : [["action", ""]],
			additional : levels.map(function(n) {
				return n < 3 ? "" : "1d6 + " + n + " temp HP";
			}),
		},
		"subclassfeature6" : {
			name : "Steps of Night",
			source : [["T", 35]],
			minlevel : 6,
			description : desc([
				"As a bonus action when I'm in dim light or darkness, I can magically grant myself flight",
				"I gain a flying speed equal to my walking speed for 1 minute"
			]),
			action : [["bonus action", ""]],
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature17" : {
			name : "Twilight Shroud",
			source : [["T", 35]],
			minlevel : 17,
			description : desc([
				"Me and my allies have half cover while in the sphere created by my Twilight Sanctuary"
			])
		}
	}
});
AddSubClass("cleric_ua23pt6", "city domain-ua", { // Still valid 2021-09-21
	regExpSearch : /^(?=.*(cleric|priest|clergy))(?=.*(city)).*$/i,
	subname : "City Domain",
	source : [["UA:MM", 1]],
	spellcastingExtra : ["comprehend languages", "remote access-ua", "find vehicle-ua", "heat metal", "lightning bolt", "protection from ballistics-ua", "locate creature", "synchronicity-ua", "commune with city-ua", "shutdown-ua"],
	features : {
		"subclassfeature3" : {
			name : "Bonus Cantrip",
			source : [["UA:MM", 1]],
			minlevel : 3,
			description : "\n   " + "I learn the On/Off cantrip if I didn't already know it",
			spellcastingBonus : {
				name : "Bonus Cantrip (On/Off)",
				spells : ["on/off-ua"],
				selection : ["on/off-ua"]
			}
		},
		"subclassfeature3.1" : {
			name : "Bonus Proficiency",
			source : [["UA:MM", 1]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with sidearms and land vehicles",
			weaponProfs : [false, false, ["Sidearms"]],
			toolProfs : ["Vehicles (land)"]
		},
		"subclassfeature3.2" : {
			name : "Heart of the City",
			source : [["UA:MM", 1]],
			minlevel : 3,
			description : desc([
				"While I'm in a city, I can gain adv. on a Cha (Deception, Intimidation, Persuasion) check",
				"I'm considered proficient with the appropriate skill for that one check"
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest"
		},
		"subclassfeature3.3" : {
			name : "Channel Divinity: Spirits of the City",
			source : [["UA:MM", 1]],
			minlevel : 3.3,
			description : desc([
				"As an action, I make all city utilities in 30 ft either stop or work perfectly for 1 min",
				"Additionally, all hostiles within 30 ft must make a Cha save at the time of use",
				"If failed, it is either knocked prone or restrained (my choice) by city hazards",
				"A restrained target can escape with an Athletics or Acrobatics check vs. my spell DC"
			]),
			action : ["action", ""]
		},
		"subclassfeature6" : {
			name : "Block Watch",
			source : [["UA:MM", 2]],
			minlevel : 6,
			description : "\n   " + "While in an urban environment, I'm proficient and expertise in Insight and Perception"
		},
		"subclassfeature17" : {
			name : "Express Transit",
			source : [["UA:MM", 2]],
			minlevel : 17,
			description : desc([
				"As an action, I can teleport from one mass transit site to another in the same city",
				"This works just like a Teleport spell; Mass transits sites include bus/train/subway stops"
			]),
			usages : 1,
			recovery : "short rest",
			action : ["action", ""]
		}
	}
});

// Add Druid subclasses
AddSubClass("druid_ua23pt8", "circle of dreams", {
	regExpSearch : /^(?=.*druid)(?=.*\bdreams\b).*$/i,
	subname : "Circle of Dreams",
	source : [["X", 22]],
	features : {
		"subclassfeature3" : {
			name : "Balm of the Summer Court",
			source : [["X", 22]],
			minlevel : 3,
			description : desc([
				"I have a pool of fey energy represented by a number of d6s equal to my druid level",
				"As a bonus action, I can spend dice to heal an ally within 120 ft of me that I can see",
				"I can spend up to half my druid level worth of dice from the pool at once",
				"The ally heals an amount equal to the total rolled and gains 1 temp HP per die spent"
			]),
			usages : levels.map(function (n) { return n < 2 ? "" : n + "d6 per "; }),
			recovery : "long rest",
			action : ["bonus action", ""]
		},
		"subclassfeature6" : {
			name : "Hearth of Moonlight and Shadow",
			source : [["X", 22]],
			minlevel : 6,
			description : desc([
				"At the start of a rest, I can create a 30-ft radius invisible magical sphere",
				"The sphere extends from a point in space I touch, but doesn't extend through total cover",
				"Within this area, my allies and I gain +5 on Wis (Perception) and Dex (Stealth) checks",
				"Also, any light from open flames that are in the sphere is invisible from outside the area",
				"This effect lasts until the end of the rest or when I leave the sphere"
			])
		},
		"subclassfeature10" : {
			name : "Hidden Paths",
			source : [["X", 22]],
			minlevel : 10,
			description : desc([
				"As a bonus action, I can teleport myself up to 60 ft to a spot I can see",
				"As an action, I can teleport a willing ally I touch up to 30 ft to a spot I can see"
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			action : [["bonus action", ""], ['action', ' (on ally)']]
		},
		"subclassfeature14" : {
			name : "Walker in Dreams",
			source : [["X", 23]],
			minlevel : 14,
			usages : 1,
			recovery : "long rest",
			description : desc([
				"When I finish a short rest, I can cast either Dream, Scrying, or Teleportation Circle",
				"This doesn't require a spell slot or material components; Dream uses me as the messenger",
				"Teleportation Circle connects to the last place I finished a long rest, if on the same plane"
			]),
			spellcastingBonus : [{
				name : "Walker in Dreams",
				spells : ["dream"],
				selection : ["dream"],
				firstCol : 'oncelr'
			}, {
				name : "Walker in Dreams",
				spells : ["scrying"],
				selection : ["scrying"],
				firstCol : 'oncelr'
			}, {
				name : "Walker in Dreams",
				spells : ["teleportation circle"],
				selection : ["teleportation circle"],
				firstCol : 'oncelr'
			}],
			spellChanges : {
				"dream" : {
					components : "V,S",
					compMaterial : "",
					changes : "Using Walker in Dreams, I can cast either Dream, Scrying, or Teleportation Circle once per long rest without requiring material components."
				},
				"scrying" : {
					components : "V,S",
					compMaterial : "",
					description : "1 crea save or sensor follows it around; or create sensor in familiar location; see book",
					changes : "Using Walker in Dreams, I can cast either Dream, Scrying, or Teleportation Circle once per long rest without requiring material components."
				},
				"teleportation circle" : {
					components : "V",
					compMaterial : "",
					description : "Create a circle to teleport to the place where I finished my last long rest, if on the same plane; see book",
					changes : "Using Walker in Dreams, I can cast either Dream, Scrying, or Teleportation Circle once per long rest without requiring material components.\n \u2022 The teleportation circle brings me back to the place where I finished my last long rest."
				}
			}
		}
	}
});
AddSubClass("druid_ua23pt8", "circle of spores", {
	regExpSearch : /^(?=.*druid)(?=.*spores).*$/i,
	subname : "Circle of Spores",
	source : [["T", 36], ["G", 26]],
	features : {
		"subclassfeature3" : {
			name : "Circle Spells",
			source : [["T", 36], ["G", 27]],
			minlevel : 3,
			description : desc([
				"I learn the Chill Touch cantrip and gain the ability to cast certain spells",
				"These are always prepared, but don't count against the number of spells I can prepare"
			]),
			spellcastingBonus : {
				name : "Circle Spells",
				spells : ["chill touch", "chill touch ua23bc"],
				selection : ["chill touch", "chill touch ua23bc"],
				times : 2,
			},
			spellcastingExtra : ["blindness/deafness", "gentle repose", "animate dead", "gaseous form", "blight", "confusion", "cloudkill", "contagion"]
		},
		"subclassfeature3.1" : {
			name : "Halo of Spores",
			source : [["T", 36], ["G", 27]],
			minlevel : 3,
 			description : desc([
				"As a reaction when someone I can see in 10 ft starts its turn or moves, I can have it save",
				"It must succeed on a Constitution save or take necrotic damage from my cloud of spores"
			]),
			additional : levels.map(function (n) { return n < 2 ? "" : 'Con save or 1d' + (n < 6 ? 4 : n < 10 ? 6 : n < 14 ? 8 : 10) + " necrotic damage"; }),
			action : ["reaction", ""]
		},
		"subclassfeature3.2" : { // changed from poison to necrotic damage in TCoE
			name : "Symbiotic Entity",
			source : [["T", 37], ["G", 27]],
			minlevel : 3,
			description : desc([
				"As an action, I can expend a Wild Shape use to boost my spores instead of transforming",
				"I gain 4 temporary hit points per druid level and my Halo of Spores damage increases",
				"Also, my melee weapon attacks do +1d6 necrotic damage with every hit",
				"This lasts for 10 min, until these temporary HP run out, or until I use Wild Shape again"
			]),
			additional : levels.map(function (n) {
				return n < 2 ? "" : Math.floor(n*4) + " temp HP; Halo of Spores: 2d" + (n < 6 ? 4 : n < 10 ? 6 : n < 14 ? 8 : 10);
			}),
			action : ["action", ""],
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.isMeleeWeapon && (/\b(spore|symbiotic)\b/i).test(v.WeaponTextName)) {
							fields.Description += (fields.Description ? '; ' : '') + '+1d6 necrotic damage';
						};
					},
					"If I include the word 'Spore' or 'Symbiotic' in a melee weapon's name, it gets treated as a weapon that is infused by my Symbiotic Entity feature, adding +1d6 necrotic damage in the description."
				]
			}
		},
		"subclassfeature6" : {
			name : "Fungal Infestation",
			source : [["T", 37], ["G", 27]],
			minlevel : 6,
			description : desc([
				"As a reaction when a Small/Medium beast/humanoid dies in 10 ft, I can animate it",
				"It rises as a zombie with 1 HP that follows my mental commands and dies after 1 hour",
				"It can only take the attack action for one melee attack; It takes its turns after mine"
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			action : ["reaction", ""]
		},
		"subclassfeature10" : {
			name : "Spreading Spores",
			source : [["T", 37], ["G", 27]],
			minlevel : 10,
			description : " [only while Symbiotic Entity is active]" + desc([
				"As a bonus action, I create a 10-ft cube of fungal spores within 30 ft, lasting for 1 min",
				"Any creature moving into or starting its turn in it must save against my Halo of Spores",
				"The cube ends if I use this feature again; While it persists, I can't use my Halo of Spores"
			]),
			action : ["bonus action", " (start/end)"]
		},
		"subclassfeature14" : {
			name : "Fungal Body",
			source : [["T", 38], ["G", 27]],
			minlevel : 14,
			description : desc([
				"I'm immune to being blinded, deafened, frightened, poisoned, and critical hits"
			]),
			savetxt : { immune : ["blinded", "deafened", "frightened", "poisoned", "critical hits (unless incapacitated)"] }
		}
	}
});
AddSubClass("druid_ua23pt8", "circle of the primeval-ua", {
	regExpSearch : /^(?=.*druid)(?=.*(primeval|behemoth)).*$/i,
	subname : "Circle of the Primeval",
	source : [["UA:GO", 2]],
	features : {
		"subclassfeature3" : {
			name : "Keeper of Old",
			source : [["UA:GO", 2]],
			minlevel : 3,
			description : desc("I gain proficiency in History; I can add d4 to my Intelligence (History) checks"),
			skills : ["History"]
		},
		"subclassfeature3.1" : {
			name : "Primeval Companion",
			source : [["UA:GO", 2]],
			minlevel : 3,
			description : desc([
				"As an action, I can expend a use of wild shape to summon a primeval companion",
				"The companion appears in an empty spot within 30 ft with the appearance of my choice",
				"It vanishes when reduced to 0 hit points, when I die, and when I summon another one"
			]),
			action : [
				["action", "Summon Primeval Companion"],
				["bonus action", "Command Primeval Companion"]
			],
			creaturesAdd : [["Primeval Companion", true]],
			creatureOptions : [{
				name : "Primeval Companion",
				source : [["UA:GO", 2]],
				size : 3,
				type : "Beast",
				alignment : "Neutral",
				ac : "11+Dex+Prof",
				hp : 20,
				hd : [2, 10],
				hdLinked : ["druid"],
				minlevelLinked : ["druid"],
				speed : "30 ft",
				scores : [15, 15, 17, 6, 12, 8],
				saves : ["", 4, 5, "", "", ""],
				senses : "Darkvision 60 ft",
				passivePerception : 11,
				languages : "Understands the languages of its summoner",
				challengeRating : "0",
				proficiencyBonus : 2,
				proficiencyBonusLinked : true,
				attacksAction : 1,
				attacks : [{
					name : "Strike",
					ability : 1,
					damage : [1, 8, "bludgeoning"],
					modifiers : ["", "Prof"],
					range : "Melee (5 ft)",
					description : "My choice of bludgeoning, piercing, or slashing damage",
					abilitytodamage : false
				}],
				features : [{
					name : "Primeval Companion",
					description : "The primeval companion obeys the commands of its summoner and shares its proficiency bonus. It takes its turn immediately after that of its summoner, on the same initiative. It can move and take reactions on its own, but only takes the Dodge action on its turn unless its summoner takes a bonus action to command it to take another action. If its summoner is incapacitated, the companion can take any action, not just Dodge. The companion vanishes when it is reduced to 0 hit points, when its summoner summons another companion, or when its summoner dies."
				}],
				traits : [{
					name : "Intercept attack",
					description : "As a reaction when a creature the companion can see hits a target within 5 ft of the companion with an attack, the target instead takes half the damage. The companion takes the remainder of the damage"
				}, {
					name : "Prehistoric Conduit (Circle of the Primeval 6)",
					minlevel : 6,
					description : "Spells cast by the companion's summoner with a range other than self can originate from the companion instead. Also, the companion has advantage on saving throws against spells cast by its summoner. If the companion would normally take half damage on a successful save against these spells, instead, it takes no damage on a success and half and no other effects on a fail."
				}, {
					name : "Titanic Bond (Circle of the Primeval 10)",
					minlevel : 10,
					description : "The companion's size is now Large and it gains either a swimming or climbing speed equal to its walking speed.",
					eval : function(prefix, lvl) {
						PickDropdown(prefix + "Comp.Desc.Size", 2); // Large
						var sMoveStr = (typePF ? ",\n" : ", ") + "swim/climb 30 ft";
						if (What("Unit System") === "metric") sMoveStr = ConvertToMetric(sMoveStr, 0.5);
						tDoc.getField(prefix + "Comp.Use.Speed").value += sMoveStr;
					},
					removeeval : function(prefix, lvl) {
						PickDropdown(prefix + "Comp.Desc.Size", 3); // Medium
						var sMoveStr = (typePF ? ",\n" : ", ") + "swim or climb 30 ft";
						if (What("Unit System") === "metric") sMoveStr = ConvertToMetric(sMoveStr, 0.5);
						Value(prefix + "Comp.Use.Speed", What(prefix + "Comp.Use.Speed").replace(sMoveStr, ""));
					}
				}],
				calcChanges : {
					hp : function (totalHD, HDobj, prefix) {
						if (!classes.known.druid_ua23pt8) return;
						var drdLvl = classes.known.druid_ua23pt8.level;
						var drdLvlM = 5 * drdLvl;
						HDobj.alt.push(10 + drdLvlM);
						HDobj.altStr.push(" = 10 as a base\n + 5 \xD7 " + drdLvl + " from five times its summoner's druid level (" + drdLvlM + ")");
					},
					setAltHp : true
				}
			}]
		},
		"subclassfeature6" : {
			name : "Prehistoric Conduit",
			source : [["UA:GO", 2]],
			minlevel : 6,
			description : desc([
				"Spells I cast with the range of touch can originate from my primeval companion",
				"The primeval companion has advantage on saving throws against my spells",
				"If the companion would take half damage on a successful save against a spell I cast,",
				"it instead takes no damage on a success and half damage and no other effects on a fail"
			])
		},
		"subclassfeature10" : {
			name : "Titanic Bond",
			source : [["UA:GO", 2]],
			minlevel : 10,
			description : desc([
				"My companion grows to Large; it gains a climb or swim speed equal to its walking speed",
				"When I hit an attack or spell damage a creature I can see, I can have it make a Wis save",
				"If failed, the target is frightened of me until the end of my next turn",
				"I can do this only while my primeval companion is summoned, and only once per turn"
			])
		},
		"subclassfeature14" : {
			name : "Scourge of the Ancients",
			source : [["UA:GO", 3]],
			minlevel : 14,
			description : desc([
				"When I use a bonus action to command my companion, I can expend a spell slot so that:",
				" \u2022 It becomes Huge if there is room, and gains 10 times the spell slot level in temp HP",
				" \u2022 On a hit, the companion's Strike deals an extra 1d8 + the spell slot level damage",
				" \u2022 Its walking (and climbing or swimming) speed increases with 5 ft per spell slot level",
				"These benefits last for 1 hour, until the companion vanishes, or until I use this again"
			])
		}
	}
});
AddSubClass("druid_ua23pt8", "circle of the shepherd", {
	regExpSearch : /^(?=.*druid)(?=.*shepherd).*$/i,
	subname : "Circle of the Shepherd",
	source : [["X", 23]],
	features : {
		"subclassfeature3" : {
			name : "Speech of the Woods",
			source : [["X", 23]],
			minlevel : 3,
			description : desc([
				"I can talk with beasts, they understand me and I them, to the limit of their intelligence",
				"This doesn't automatically make me friends with all beasts; Additionally, I learn Sylvan"
			]),
			languageProfs : ["Sylvan"]
		},
		"subclassfeature3.1" : {
			name : "Spirit Totem",
			source : [["X", 23]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can summon, or move, a spirit to a point I can see within 60 ft",
				"It is a spectral form of a Bear, Hawk, or Unicorn (my choice), with a 30-ft radius aura",
				"It is incorporeal, immobile, doesn't counts as a creature or object, and persists for 1 min",
				"The spirit persists for 1 minute or until I'm incapacitated",
				"\u2022 Bear: my allies and I, if in the aura, immediately gain 5 + my druid level in temp HP",
				"  While in the aura, my allies and I gain advantage on Strength checks and saves",
				"\u2022 Hawk: As a reaction, I can grant advantage on an attack vs. a target in the aura",
				"  While in the aura, my allies and I gain advantage on Wisdom (Perception) checks",
				"\u2022 Unicorn: my allies and I gain advantage on ability checks to detect targets in the aura",
				"  When I cast a healing spell with a spell slot, allies in the aura heal my druid level in HP"
			]),
			usages : 1,
			recovery : "short rest",
			action : ["bonus action", ""]
		},
		"subclassfeature6" : {
			name : "Mighty Summoner",
			source : [["X", 24]],
			minlevel : 6,
			description : "\n   " + "Beasts or Fey I summon with spells get +2 HP per HD and their attacks count as magical",
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						switch (spellKey) {
							case "conjure animals" :
							case "conjure fey" :
								spellObj.description += "; each +2 HP/HD, magical natural attacks";
								return true;
							case "conjure woodland beings" :
								spellObj.description = spellObj.description.replace(/fey.*/, "fey; obeys commands if its align. agrees; breaks free if break conc.; +2 HP/HD, magic atks");
								return true;
						}
					},
					"When I use a spell that summons beast or fey creatures, those summons have +2 HP per HD and their attacks count as magical."
				]
			}
		},
		"subclassfeature10" : {
			name : "Guardian Spirit",
			source : [["X", 24]],
			minlevel : 10,
			description : "\n   " + "When a Beast or Fey that I summoned ends its turn in my Spirit Totem aura, it heals",
			additional : levels.map(function (n) { return n < 10 ? "" : "heals " + Math.floor(n / 2) + " HP"; })
		},
		"subclassfeature14" : {
			name : "Faithful Summons",
			source : [["X", 24]],
			minlevel : 14,
			description : desc([
				"When I am reduced to 0 HP or incapacitated against my will, I can cast Conjure Animals",
				"This is done as if using a 9th-level spell slot to summon 4 beast of my choice up to CR 2",
				"They appear within 20 ft of me, last 1 hour, and protect me from harm and attack foes"
			]),
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				name : "Faithful Summons",
				spells : ["conjure animals", "conjure animals ua23pt8"],
				selection : ["conjure animals", "conjure animals ua23pt8"],
				firstCol : "oncelr",
				times : 2,
			},
			spellChanges : {
				"conjure animals" : {
					nameShort : "Conjure Animals (level 9)",
					range : "20 ft",
					duration : "1 h",
					description : "Summon 4 CR 2 beasts; protect me from harm and attack foes",
					changes : "Using my Faithful Summons class feature when I'm reduced to 0 HP, I can cast Conjure Animals as if using a 9th-level spell slot. This then summons 4 beast of my choice up to CR 2 within 20 ft of me without needing concentration."
				},
				"conjure animals ua23pt8" : {
					nameShort : "Conjure Animals (UA23PT8/lvl 9)",
					range : "20 ft",
					rangeMetric : "6 m",
					duration : "1 h",
					description : "Summon Large swarm of spectral animals; atk those enter within 10 ft of swarm for 8d10+spellcasting ability modifier Rad dmg; See bk",
					changes : "Using my Faithful Summons class feature when I'm reduced to 0 HP, I can cast Conjure Animals (UA23PT8) as if using a 9th-level spell slot. This conjures a swarm of spectral animals tht deal 8d10 + spellcasting ability modifier to targets. This swarm appears within 20 ft of me without needing concentration."
				},
			},
		},
	},
});
AddSubClass("druid_ua23pt8", "circle of the stars", {
	regExpSearch : /^(?=.*druid)(?=.*circle)(?=.*stars).*$/i,
	subname : "Circle of the Stars",
	source : [["T", 38]],
	features : {
		"subclassfeature3" : {
			name : "Star Map",
			source : [["T", 38]],
			minlevel : 3,
			description : desc([
				"I've created a star map, a Tiny object which I can use as my spellcasting focus",
				"If I lose it, I can perform a 1-hour ceremony during a rest to create a replacement",
				"While holding it, I know the Guidance cantrip and always have Guiding Bolt prepared",
				"These count as druid spells, but do not count against the number of spells I can prepare",
				"I can cast Guiding Bolt without expending a spell slot my Proficiency Bonus per long rest"
			]),
			spellcastingBonus : [{
				name : "Star Map",
				spells : ["guidance", "guidance ua22cs"],
				selection : ["guidance", "guidance ua22cs"],
				firstCol : "atwill",
				times : 2,
			}, {
				name : "Star Map",
				spells : ["guiding bolt"],
				selection : ["guiding bolt"],
				firstCol : "Sp"
			}],
			additional : "Guiding Bolt",
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature3.1" : {
			name : "Starry Form",
			source : [["T", 38]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can expend a use of wild shape to take on a starry form for 10 min",
				"In that form I shed bright light in a 10-ft radius and dim light for an extra 10-ft radius",
				"When I do so, I choose one constellation that glimmers on my body, granting me benefits",
				"See the 3rd page's \"Notes\" section for the benefits of the possible constellations"
			]),
			weaponOptions : {
				regExpSearch : /^(?=.*luminous)(?=.*arrow).*$/i,
				name : "Luminous Arrow",
				source : [["T", 38]],
				ability : 5,
				type : "Spell",
				damage : [1, 8, "radiant"],
				range : "60 ft",
				description : "Use as bonus action",
				abilitytodamage : true,
				useSpellMod : "druid",
				luminousarrow : true
			},
			weaponsAdd : ['Luminous Arrow'],
			extraname : "Starry Form",
			"archer constellation" : {
				name : "Archer Constellation",
				source : [["T", 38]],
				description : desc([
					"As a bonus action, I can make a ranged spell attack to hurl a luminous arrow 60 ft",
					"I can also do this as part of the bonus action I use to assume the starry form"
				]),
				additional : levels.map(function (n) {
					return n < 2 ? "" : (n < 10 ? 1 : 2) + "d8 + Wisdom modifier radiant damage";
				}),
				action : [["bonus action", " (Luminous Arrow)"]]
			},
			"chalice constellation" : {
				name : "Chalice Constellation",
				source : [["T", 39]],
				description : desc([
					"When I cast a healing spell with a spell slot, I can heal myself or another within 30 ft of me"
				]),
				additional : levels.map(function (n) {
					return n < 2 ? "" : (n < 10 ? 1 : 2) + "d8 + Wisdom modifier hit points restored";
				})
			},
			"dragon constellation" : {
				name : "Dragon Constellation",
				source : [["T", 39]],
				description : desc([
					"I can treat a roll below 10 as a 10 for Int/Wis checks and saves to maintain concentration",
					"From 10th-level onwards, I also gain a flying speed of 20 ft and can hover"
				])
			},
			autoSelectExtrachoices : [{
				extrachoice : "archer constellation"
			}, {
				extrachoice : "chalice constellation"
			}, {
				extrachoice : "dragon constellation"
			}]
		},
		"subclassfeature6" : {
			name : "Cosmic Omen",
			source : [["T", 39]],
			minlevel : 6,
			description : desc([
				"When I finish a long rest, I roll a die to gain an omen based on the result (odd/even)",
				"As a reaction when a creature I can see in 30 ft makes an attack, check, or save, I can:",
				" \u2022 Weal (even): add 1d6 to the number rolled for the attack, check, or save",
				" \u2022 Woe (odd): subtract 1d6 from the number rolled for the attack, check, or save"
			]),
			action : [["reaction", ""]],
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature10" : {
			name : "Twinkling Constellations",
			source : [["T", 39]],
			minlevel : 10,
			description : desc([
				"While in my starry form, I can change the constellation at the start of each of my turns",
				"The benefit of my constellations improve, see the 3rd page's \"Notes\" section"
			]),
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.theWea.luminousarrow && fields.Damage_Die.indexOf('1d8') !== -1) {
							fields.Damage_Die = fields.Damage_Die.replace('1d8', '2d8');
						};
					},
					'',
					1
				]
			}
		},
		"subclassfeature14" : {
			name : "Full of Stars",
			source : [["T", 39]],
			minlevel : 14,
			description : "\n   While in my starry form, I have resistance to bludgeoning, piercing, and slashing damage",
			dmgres : [
				["Bludgeoning", "Bludgeon. (in form)"],
				["Piercing", "Piercing (in form)"],
				["Slashing", "Slashing (in form)"]
			]
		}
	}
});
AddSubClass("druid_ua23pt8", "circle of twilight-ua", { // Still valid 2021-09-21
	regExpSearch : /^(?=.*druid)(?=.*twilight).*$/i,
	subname : "Circle of Twilight",
	source : [["UA:DC", 2]],
	features : {
		"subclassfeature3" : {
			name : "Harvest's Scythe",
			source : [["UA:DC", 3]],
			minlevel : 3,
			description : "\n   " + "I have a pool of energy represented by a number of d10s equal to my druid level" + "\n   " + "When I roll damage for a spell, I can do extra necrotic damage with dice from the pool" + "\n   " + "I can spend up to half my druid level worth of dice from the pool at once" + "\n   " + "If I any hostiles die from an augmented spell, I can heal one ally I can see within 30 ft" + "\n   " + "The ally regains 2 HP per die spent; or 5 HP per die if one of the slain was undead",
			usages : ["", "2d10 per ", "3d10 per ", "4d10 per ", "5d10 per ", "6d10 per ", "7d10 per ", "8d10 per ", "9d10 per ", "10d10 per ", "11d10 per ", "12d10 per ", "13d10 per ", "14d10 per ", "15d10 per ", "16d10 per ", "17d10 per ", "18d10 per ", "19d10 per ", "20d10 per "],
			recovery : "long rest"
		},
		"subclassfeature6" : {
			name : "Speech Beyond the Grave",
			source : [["UA:DC", 3]],
			minlevel : 6,
			description : "\n   " + "Once per short rest, I can cast Speak with Dead without spell slots or material comp." + "\n   " + "The target and I can understand each other, regardless of language or intelligence",
			usages : 1,
			recovery : "short rest",
			spellcastingBonus : {
				name : "Speech Beyond the Grave",
				spells : ["speak with dead"],
				selection : ["speak with dead"],
				firstCol : 'oncesr'
			},
			spellChanges : {
				"speak with dead" : {
					components : "V,S",
					compMaterial : "",
					changes : "I can cast this spell once per short rest without requiring material components."
				}
			}
		},
		"subclassfeature10" : {
			name : "Watcher at the Threshold",
			source : [["UA:DC", 3]],
			minlevel : 10,
			description : "\n   " + "I gain resistance to necrotic and radiant damage" + "\n   " + "While I'm not incapacitated, allies within 30 ft of me gain adv. on their death saves",
			dmgres : ["Necrotic", "Radiant"]
		},
		"subclassfeature14" : {
			name : "Paths of the Dead",
			source : [["UA:DC", 3]],
			minlevel : 14,
			description : "\n   " + "Once per short rest, I can cast Etherealness without needing a spell slot",
			usages : 1,
			recovery : "short rest",
			spellcastingBonus : {
				name : "Paths of the Dead",
				spells : ["etherealness"],
				selection : ["etherealness"],
				firstCol : 'oncesr'
			},
			spellChanges : {
				"etherealness" : {
					description : "I go to Ethereal Plane; move there, but able to perceive 60 ft into the normal plane",
					changes : "Using my Paths of the Dead class feature I can cast Etherealness once per short rest without needing a spell slot, thus can only target 1 creature."
				}
			}
		}
	}
});
AddSubClass("druid_ua23pt8", "circle of wildfire", {
	regExpSearch : /^(?=.*druid)(?=.*wild.{0,1}fire).*$/i,
	subname : "Circle of Wildfire",
	source : [["T", 39]],
	features : {
		"subclassfeature3" : {
			name : "Circle Spells",
			source : [["T", 39]],
			minlevel : 3,
			description : desc([
				"My link to a wildfire spirit grants me access to spells, which count as druid spells to me",
				"These are always prepared, but don't count against the number of spells I can prepare"
			]),
			spellcastingExtra : ["burning hands", "cure wounds", "cure wounds ua23pt8", "flaming sphere", "scorching ray", "plant growth", "revivify", "aura of life", "fire shield", "flame strike", "mass cure wounds", "mass cure wounds ua23pt8"]
		},
		"subclassfeature3.1" : {
			name : "Summon Wildfire Spirit",
			source : [["T", 40]],
			minlevel : 3,
			description : desc([
				"As an action, I can expend a use of wild shape to summon a wildfire spirit within 30 ft",
				"All within 10 ft of where it manifests must make a Dex save or take 2d10 fire damage",
				"It is friendly and obeys my commands; It lasts for 1 hour, until it has 0 HP, or I die",
				"Unless I use a bonus action to command it, it only takes the Dodge action on its turn",
				"It can always take reactions and move on its turn; It acts on my initiative, after me",
				'It disappears if I summon another; See "Wildfire Spirit" on a companion page for its stats',
			]),
			action : [["action", ""], ["bonus action", "Command Wildfire Spirit"]],
			creaturesAdd : [["Wildfire Spirit", true]],
			creatureOptions : [{
				name : "Wildfire Spirit",
				source : [["T", 40]],
				size : 4,
				type : "Elemental",
				alignment : "",
				ac : 13,
				hp : 20,
				hd : [],
				speed : "30 ft, fly 30 ft (hover)",
				scores : [10, 14, 14, 13, 15, 11],
				damage_immunities : "fire",
				condition_immunities : "charmed, frightened, grappled, prone, restrained",
				senses : "Darkvision 60 ft",
				passivePerception : 12,
				languages : "understands the languages of its creator",
				challengeRating : "1/2",
				proficiencyBonus : 2,
				proficiencyBonusLinked : true,
				attacksAction : 1,
				attacks : [{
					name : "Flame Seed",
					ability : 5,
					damage : [1, 6, "fire"],
					range : "60 ft",
					description : "Ranged weapon attack",
					modifiers : ["", "Prof"],
					abilitytodamage : false,
					useSpellMod : "druid_ua23pt8"
				}, {
					name : "Fiery Teleportation",
					ability : 5,
					damage : [1, 6, "fire"],
					range : "5-ft radius",
					description : "Dex save for all within 5 ft of teleportation origin, success - no damage; See traits",
					dc : true,
					modifiers : ["", "Prof"],
					abilitytodamage : false,
					useSpellMod : "druid_ua23pt8"
				}, {
					name : "Fiery Manifestation",
					ability : 5,
					damage : [2, 6, "fire"],
					range : "10-ft radius",
					description : "Dex save for all within 10 ft where spirit is summoned, success - no damage",
					dc : true,
					abilitytodamage : false,
					useSpellMod : "druid_ua23pt8"
				}],
				features : [{
					name : "Creator",
					description : "The spirit obeys the commands of its creator and has the same proficiency bonus. It takes its turn immediately after its creator, on the same initiative count. It can move and take reactions on its own, but only takes the Dodge action on its turn unless its creator takes a bonus action to command it to take another action. If its creator is incapacitated, it can take any action, not just Dodge."
				}],
				actions : [{
					name : "Fiery Teleportation",
					description : "The spirit and each willing creature of its creator's choice within 5 ft of it teleport up to 15 ft to unoccupied spaces its creator can see. Then each creature within 5 ft of the space that the spirit left must succeed on a Dexterity saving throw against its creator's spell save DC or take fire damage equal to 1d6 + its proficiency bonus."
				}],
				traits : [{
					name : "Fiery Manifestation",
					description : "The spirit appears in an unoccupied space of its creator's choice that its creator can see within 30 ft. Each creature within 10 ft of the spirit (other than its creator) when it appears must succeed on a Dexterity saving throw against its creator's spell save DC or take 2d6 fire damage."
				}],
				header : "Wildfire",
				calcChanges : {
					hp : function (totalHD, HDobj, prefix) {
						if (!classes.known.druid_ua23pt8) return;
						var drdLvl = classes.known.druid_ua23pt8.level;
						var drdLvl5 = 5 * drdLvl;
						HDobj.alt.push(5 + drdLvl5);
						HDobj.altStr.push(" = 10 as a base\n + 5 \xD7 " + drdLvl + " from five times its creator's druid level (" + drdLvl5 + ")");
					},
					setAltHp : true
				}
			}]
		},
		"subclassfeature6" : {
			name : "Enhanced Bond",
			source : [["T", 40]],
			minlevel : 6,
			description : desc([
				"While my wildfire spirit is present, I can have my spells originate from it (no range 'self')",
				"Also, I can then add 1d8 to a single roll of my spells that restore HP or deal fire damage"
			])
		},
		"subclassfeature10" : {
			name : "Cauterizing Flames",
			source : [["T", 40]],
			minlevel : 10,
			description : desc([
				"As a reaction when a Small or larger creature dies within 30 ft of me or wildfire spirit,",
				"I can have a spectral flame erupt in its space that lasts for 1 minute",
				"As a reaction when I see a creature enter the flame's space, I can extinguish the flame",
				"This heals or deals fire damage to the creature (my choice) equal to 2d10 + my Wis mod"
			]),
			action : [["reaction", ""]],
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature14" : {
			name : "Blazing Revival",
			source : [["T", 40]],
			minlevel : 14,
			description : desc([
				"If I drop to 0 HP and don't die, and my wildfire spirit is within 120 ft, it can save me",
				"I can have it drop to 0 HP; I then regain half my HP and immediately rise to my feet"
			]),
			usages : 1,
			recovery : "long rest"
		}
	}
});

// Add Fighter subclasses
AddSubClass("fighter_ua23pt7", "purple dragon knight", {
	regExpSearch : /^(((?=.*purple)(?=.*dragon)(?=.*knight))|(?=.*banneret)).*$/i,
	subname : "Purple Dragon Knight",
	fullname : "Purple Dragon Knight (UA:PT-vii)",
	source : [["S", 128]],
	features : {
		"subclassfeature3" : {
			name : "Rallying Cry",
			source : [["S", 128]],
			minlevel : 3,
			description : "\n   " + "When I use Second Wind, I also heal three allies within 60 ft that can see or hear me",
			additional : levels.map(function (n) {
				return n < 3 ? "" : n + " HP";
			}),
			action : [["bonus action", "Second Wind (+Rallying Cry)", "Second Wind"]]
		},
		"subclassfeature7" : {
			name : "Royal Envoy",
			source : [["S", 128]],
			minlevel : 7,
			description : "\n   " + "I gain proficiency with the Persuasion skill and I gain expertise with the Persuasion skill" + "\n   " + "If already proficient, I can choose Animal Handling, Insight, Intimidation, or Performance",
			skillstxt : "Persuasion proficiency and expertise; If already proficient, choose one from Animal Handling, Insight, Intimidation, or Performance",
			skills : ["Persuasion", "full"]
		},
		"subclassfeature10" : {
			name : "Inspiring Surge",
			source : [["S", 128]],
			minlevel : 10,
			description : "\n   " + "When I use my Action Surge, I can inspire an ally within 60 ft that can see or hear me" + "\n   " + "The ally can then use its reaction to make one melee or ranged weapon attack",
			additional : levels.map(function (n) {
				return n < 10 ? "" : n < 18 ? "1 ally" : "2 allies"; // level 18 per errata
			})
		},
		"subclassfeature15" : {
			name : "Bulwark",
			source : [["S", 128]],
			minlevel : 15,
			description : "\n   " + "When I use Indomitable to reroll a Int, Wis, or Cha save, I can extend it to an ally" + "\n   " + "The ally can reroll its failed saving throw against the same effect and take the result" + "\n   " + "It only works if not incapacitated and the ally is within 60 ft and can see or hear me"
		}
	}
});
AddSubClass("fighter_ua23pt7", "arcane archer", {
	regExpSearch : /^(?=.*arcane)(?=.*archer).*$/i,
	subname : "Arcane Archer",
	source : [["X", 28]],
	fullname : "Arcane Archer (UA:PT-vii)",
	abilitySave : 4,
	features : {
		"subclassfeature3" : {
			name : "Arcane Archer's Lore",
			source : [["X", 28]],
			minlevel : 3,
			description : desc([
				"I gain proficiency with either the Arcana or Nature skill",
				"I also learn either the Prestidigitation or the Druidcraft cantrip"
			]),
			skillstxt : "Arcana or Nature",
			spellcastingBonus : {
				name : "Arcane Archer's Lore",
				spells : ["druidcraft", "prestidigitation"]
			},
		},
		"subclassfeature3.1" : {
			name : "Arcane Shot",
			source : [["X", 28]],
			minlevel : 3,
			description : desc([
				"I can unleash magical effects when I fire an arrow from a short- or longbow",
				"I can use this once per turn as part of the Attack action, after an attack hits",
				"I know a number of Arcane Shot Options and learn additional at certain levels",
				'Use the "Choose Feature" button above to add Arcane Shots Options to the third page'
			]),
			usages : 2,
			recovery : "short rest",
			additional : levels.map( function(n) { return n < 3 ? "" : (n < 7 ? 2 : n < 10 ? 3 : n < 15 ? 4 : n < 18 ? 5 : 6) + " options known"; }),
			extraname : "Arcane Shot Option",
			extrachoices : ["Banishing Arrow [Abjuration]", "Beguiling Arrow [Enchantment]", "Bursting Arrow [Evocation]", "Enfeebling Arrow [Necromancy]", "Grasping Arrow [Conjuration]", "Piercing Arrow [Transmutation]", "Seeking Arrow [Divination]", "Shadow Arrow [Illusion]"],
			extraTimes : levels.map(function (n) {
				return n < 3 ? 0 : n < 7 ? 2 : n < 10 ? 3 : n < 15 ? 4 : n < 18 ? 5 : 6;
			}),
			"banishing arrow [abjuration]" : {
				name : "Banishing Arrow [Abjuration]",
				source : [["X", 29]],
				description : desc([
					"The target makes a Cha save or is banished to the Feywild until the end of its next turn",
					"While banished, its speed is 0 and is incapacitated; It re-appearing in the same spot",
					"When I reach 18th level, this Arcane Shot Option also does an extra 2d6 force damage"
				]),
				additional : levels.map( function(n) { return n < 18 ? "" : "+2d6 force damage"; })
			},
			"beguiling arrow [enchantment]" : {
				name : "Beguiling Arrow [Enchantment]",
				source : [["X", 29]],
				description : desc([
					"The target takes extra psychic damage and must succeed on a Wisdom save",
					"If failed, it is charmed by one of my allies within 30 ft of it that I choose",
					"This lasts until my next turn starts or until the chosen ally attacks the target in any way"
				]),
				additional : levels.map( function(n) { return n < 3 ? "" : "+" + (n < 18 ? 2 : 4) + "d6 damage"; })
			},
			"bursting arrow [evocation]" : {
				name : "Bursting Arrow [Evocation]",
				source : [["X", 29]],
				description : "\n   " + "The target, in addition to the shot, and all creatures within 10 ft of it take damage",
				additional : levels.map( function(n) { return n < 3 ? "" : "+" + (n < 18 ? 2 : 4) + "d6 force damage"; })
			},
			"enfeebling arrow [necromancy]" : {
				name : "Enfeebling Arrow [Necromancy]",
				source : [["X", 29]],
				description : desc([
					"The target takes extra necrotic damage and must make a Constitution save",
					"If failed, the damage of the target's attacks are halved until the start of my next turn"
				]),
				additional : levels.map( function(n) { return n < 3 ? "" : "+" + (n < 18 ? 2 : 4) + "d6 necrotic damage"; })
			},
			"grasping arrow [conjuration]" : {
				name : "Grasping Arrow [Conjuration]",
				source : [["X", 29]],
				description : desc([
					"The target takes extra poison damage as brambles wrap around it for 1 minute",
					"The brambles give it -10 ft speed and do it slashing damage every round it moves",
					"These can be removed by it or another as an action with Strength (Athletics) vs. my DC"
				]),
				additional : levels.map( function(n) { return n < 3 ? "" : (n < 18 ? 2 : 4) + "d6 poison/slash. damage"; })
			},
			"piercing arrow [transmutation]" : {
				name : "Piercing Arrow [Transmutation]",
				source : [["X", 29]],
				description : desc([
					"With this I don't roll for the attack, but shoot the arrow in a 30-ft long, 1-ft wide line",
					"It passes through objects, ignoring cover, but all creatures in the area take damage",
					"The damage is the same as a normal hit from my attack, plus extra piercing damage",
					"A creature can make a Dexterity save to reduce the damage by half"
				]),
				additional : levels.map( function(n) { return n < 3 ? "" : "+" + (n < 18 ? 1 : 2) + "d6 piercing damage"; })
			},
			"seeking arrow [divination]" : {
				name : "Seeking Arrow [Divination]",
				source : [["X", 30]],
				description : desc([
					"With this I don't roll for the attack, but I choose a target I have seen in the last minute",
					"The seeking arrow moves around corners, obstacles, and ignores cover to hit the target",
					"It is hit if it is within the weapon's range and there is a path for the arrow to get to it",
					"The target takes the full damage of the attack plus extra force damage",
					"It can make a Dexterity save to reduce the damage by half; If failed, I know its location"
				]),
				additional : levels.map( function(n) { return n < 3 ? "" : "+" + (n < 18 ? 1 : 2) + "d6 force damage"; })
			},
			"shadow arrow [illusion]" : {
				name : "Shadow Arrow [Illusion]",
				source : [["X", 30]],
				description : desc([
					"The target takes extra psychic damage and must succeed on a Wisdom save",
					"If failed, the target can't see anything beyond 5 ft until the end of my next turn"
				]),
				additional : levels.map( function(n) { return n < 3 ? "" : "+" + (n < 18 ? 2 : 4) + "d6 psychic damage"; })
			}
		},
		"subclassfeature7" : {
			name : "Magic Arrow",
			source : [["X", 28]],
			minlevel : 7,
			description : "\n   " + "Whenever I fire a nonmagical arrow from a short- or longbow, I can make it magical"
		},
		"subclassfeature7.1" : {
			name : "Curving Shot",
			source : [["X", 28]],
			minlevel : 7,
			description : desc([
				"Once per turn when I miss with a magic arrow, I can use a bonus action to redirect it",
				"I reroll the attack against a different target within 60 ft of the original target"
			]),
			action : ["bonus action", ""]
		},
		"subclassfeature15" : {
			name : "Ever-Ready Shot",
			source : [["X", 28]],
			minlevel : 15,
			description : "\n   " + "I regain one use of Arcane Shot if I have no more remaining when I roll initiative"
		}
	}
});
AddSubClass("fighter_ua23pt7", "cavalier", {
	regExpSearch : /cavalier/i,
	subname : "Cavalier",
	source : [["X", 30]],
	fullname : "Cavalier (UA:PT-vii)",
	abilitySave : 1,
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiency",
			source : [["X", 30]],
			minlevel : 3,
			description : desc([
				"I gain proficiency with Animal Handling, History, Insight, Performance, or Persuasion",
				'Alternatively, I learn one language; Use the "Choose Feature" button above for this'
			]),
			choices : ["Language proficiency", "Skill proficiency: Animal Handling, History, Insight, Performance, or Persuasion"],
			"language proficiency" : {
				name : "Bonus Proficiency",
				description : "\n   " + "I learn one language of my choice",
				languageProfs : [1]
			},
			"skill proficiency: animal handling, history, insight, performance, or persuasion" : {
				name : "Bonus Proficiency",
				description : "\n   " + "I gain proficiency with Animal Handling, History, Insight, Performance, or Persuasion",
				skillstxt : "Choose one from: Animal Handling, History, Insight, Performance, or Persuasion"
			}
		},
		"subclassfeature3.1" : {
			name : "Born in the Saddle",
			source : [["X", 30]],
			minlevel : 3,
			description : desc([
				"I have advantage on saves to avoid falling off my mount, and land on my feet if I fail",
				"Mounting or dismounting a creature costs me only 5 ft of movement instead of half"
			]),
			savetxt : { adv_vs : ["falling off my mount"] }
		},
		"subclassfeature3.2" : {
			name : "Unwavering Mark",
			source : [["X", 30]],
			minlevel : 3,
			description : desc([
				"If I hit a creature with a melee weapon attack, I mark it until the end of my next turn",
				"While it is within 5 ft of me, a marked target has disadv. on attacks not directed at me",
				"If it damages anybody but me, I can make a special melee attack vs. it in my next turn",
				"This takes a bonus action, but has adv. and adds half my fighter level to the damage",
				"A mark ends early if I'm incapacitated, die, or somebody else marks the target"
			]),
			usages : "Strength modifier per ",
			usagescalc : "event.value = Math.max(1, What('Str Mod'));",
			recovery : "long rest",
			additional : levels.map(function (n) {
				return n < 3 ? "" : "+" + Math.floor(n/2) + " damage";
			}),
			calcChanges : {
				atkCalc : [
					function (fields, v, output) {
						if (v.isMeleeWeapon && classes.known.fighter && classes.known.fighter.level > 2 && (/\b(unwavering.?mark|marked)\b/i).test(v.WeaponTextName)) {
							output.extraDmg += Math.floor(classes.known.fighter.level / 2);
						};
					},
					"If I include the words 'Unwavering Mark' or 'Marked' in the name of a melee weapon, it gets half my fighter level added to its Damage."
				]
			}
		},
		"subclassfeature7" : {
			name : "Warding Maneuver",
			source : [["X", 30]],
			minlevel : 7,
			description : desc([
				"As a reaction when I or a creature within 5 ft is hit, I can try to fend off the strike",
				"I add 1d8 to the target's AC; If the attack still hits, the target has resistance against it",
				"I can only do this while wielding a melee weapon or a shield"
			]),
			usages : "Constitution modifier per ",
			usagescalc : "event.value = Math.max(1, What('Con Mod'));",
			recovery : "long rest",
			action : ["reaction", ""],
		},
		"subclassfeature10" : {
			name : "Hold the Line",
			source : [["X", 30]],
			minlevel : 10,
			description : desc([
				"Creatures provoke opportunity attacks when moving 5 ft or more while within my reach",
				"If I hit an opportunity attack, the target's speed is reduced to 0 until the end of the turn"
			])
		},
		"subclassfeature15" : {
			name : "Ferocious Charger",
			source : [["X", 31]],
			minlevel : 15,
			description : desc([
				"If I hit a creature after moving 10 ft in a straight line, it must make a Strength save",
				"If failed, the target is knocked prone; I can do this only once per turn"
			])
		},
		"subclassfeature18" : {
			name : "Vigilant Defender",
			source : [["X", 31]],
			minlevel : 18,
			description : desc([
				"I can make opportunity attacks without using my reaction",
				"I can do this only once on every creature's turn, except on my own turn",
				"I can't do this on the same turn that I use my normal reaction"
			])
		}
	}
});
AddSubClass("fighter_ua23pt7", "samurai", {
	regExpSearch : /samurai/i,
	subname : "Samurai",
	source : [["X", 31]],
	fullname : "Samurai (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiency",
			source : [["X", 31]],
			minlevel : 3,
			description : desc([
				"I gain proficiency with History, Insight, Performance, or Persuasion",
				'Alternatively, I learn one language; Use the "Choose Feature" button above for this'
			]),
			choices : ["Language proficiency", "Skill proficiency: History, Insight, Performance, or Persuasion"],
			"language proficiency" : {
				name : "Bonus Proficiency",
				description : "\n   " + "I learn one language of my choice",
				languageProfs : [1]
			},
			"skill proficiency: history, insight, performance, or persuasion" : {
				name : "Bonus Proficiency",
				description : "\n   " + "I gain proficiency with History, Insight, Performance, or Persuasion",
				skillstxt : "Choose one from: History, Insight, Performance, or Persuasion"
			}
		},
		"subclassfeature3.1" : {
			name : "Fighting Spirit",
			source : [["X", 31]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can give myself advantage on weapon attacks and temporary HP",
				"This advantage on weapon attack rolls lasts until the end of my current turn"
			]),
			recovery : "long rest",
			usages : 3,
			additional : levels.map(function (n) { return n < 3 ? "" : (n < 10 ? 5 : n < 15 ? 10 : 15) + " temporary HP"; }),
			action : ["bonus action", ""]
		},
		"subclassfeature7" : {
			name : "Elegant Courtier",
			source : [["X", 31]],
			minlevel : 7,
			description : desc([
				"I can add my Wisdom modifier to any Charisma (Persuasion) checks I make",
				"I gain proficiency with Wis saves, or if I'm already proficient, either Int or Cha saves"
			]),
			saves : ["Wis"],
			addMod : { type : "skill", field : "Pers", mod : "max(Wis|0)", text : "I can add my Wisdom modifier to any Charisma (Persuasion) checks I make." }
		},
		"subclassfeature10" : {
			name : "Tireless Spirit",
			source : [["X", 31]],
			minlevel : 10,
			description : "\n   " + "I regain one use of Fighting Spirit if I have no more remaining when I roll initiative"
		},
		"subclassfeature15" : {
			name : "Rapid Strike",
			source : [["X", 31]],
			minlevel : 15,
			description : desc([
				"With the Attack action, I can forgo advantage on one attack to make one extra attack",
				"This extra attack is part of the same action; I can do this only once per turn"
			])
		},
		"subclassfeature18" : {
			name : "Strength Before Death",
			source : [["X", 31]],
			minlevel : 18,
			description : desc([
				"If I'm reduced to 0 HP but not killed outright, I can delay falling unconscious",
				"I then immediately take a bonus turn, interrupting the current turn",
				"While I'm at 0 HP, I suffer damage normally and die if I have 3 failed death saves",
				"If I'm still at 0 HP at the end of this bonus turn, I fall unconscious"
			]),
			recovery : "long rest",
			usages : 1
		}
	}
});
AddSubClass("fighter_ua23pt7", "echo knight", { // contains contributions by Smashman, @Nod_Hero#2046 (Discord), BraabHimself, and TysonJouglet
	regExpSearch : /^(?!.*(exalted|sacred|holy|divine|nature|natural|purple.*dragon|green))(?=.*(knight|fighter|warrior|militant|warlord|phalanx|gladiator|trooper))(?=.*(echo|mirror|mirage|reflection)).*$/i,
	subname : "Echo Knight",
	source : [["W", 183]],
	fullname : "Echo Knight (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Manifest Echo",
			source : [["W", 183]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can magically manifest a translucent image of myself within 15 ft",
				"My echo lasts until I dismiss it as a bonus action, I manifest another, or I'm incapacitated",
				"It is also destroyed if it is more than 30 ft away from me at the end of my turn",
				"It has 1 HP, immunity to all conditions, uses my save bonuses, and AC 14 + Prof Bonus",
				"On my turn as a free action, I can command it to move up to 30 ft in any direction",
				"As a bonus action, I can teleport to swap places with it, at a cost of 15 ft movement",
				"When I use the Attack action on my turn, I can have any attack originate from my echo",
				"I can also make opportunity attacks from the echo's location as if I were in its space"
			]),
			action : [["bonus action", " (summon/dismiss)"], ["bonus action", "Swap Location with Echo"]],
			creaturesAdd : [["Echo"]],
			creatureOptions : [{
				name : "Echo",
				source : [["W", 183]],
				size : 3,
				type : "Echo",
				alignment : "",
				ac : "14+oProf",
				hp : 1,
				hd : [],
				speed : "fly 30 ft (hover)",
				scores : ["", "", "", "", "", ""],
				savesLinked : true,
				condition_immunities : "all conditions",
				passivePerception : 0,
				languages : "",
				senses : "",
				challengeRating : "0",
				proficiencyBonus : 0,
				attacksAction : 0,
				attacks : [],
				features : [{
					name : "Echo",
					description : "The echo is a magical, translucent, gray image of its creator that doesn't act and has no turn in combat. It lasts until it is destroyed, dismissed, another is manifested, or its creator is incapacitated. The echo is also destroyed if it is ever more than 30 ft away from its creator at the end of its creator's turn."
				}],
				traits : [{
					name : "Swap Place",
					description : "The echo's creator can, as a bonus action, teleport, magically swapping places with the echo at a cost of 15 feet of the creator's movement, regardless of the distance between the two."
				}, {
					name : "Attack Origin",
					description : "When the echo's creator takes the Attack action on their turn, any attack they make with that action can originate from the echo's space. This choice is made for each attack separately.\n   In addition, when a creature that the echo's creator can see within 5 ft of the echo moves at least 5 ft away from it, its creator can use their reaction to make an opportunity attack against that creature as if its creator was in the echo's space."
				}],
				header : "Echo",
				eval : function(prefix, lvl) {
					// Same size as character
					PickDropdown(prefix + "Comp.Desc.Size", tDoc.getField("Size Category").currentValueIndices);
					Value(prefix + "Comp.Desc.Age", What("Age"));
					Value(prefix + "Comp.Desc.Sex", What("Sex"));
					Value(prefix + "Comp.Desc.Height", What("Height"));
					Value(prefix + "Comp.Desc.Alignment", What("Alignment"));
				}
			}]
		},
		"subclassfeature3.1" : {
			name : "Unleash Incarnation",
			source : [["W", 183]],
			minlevel : 3,
			description : desc([
				"When I use the Attack action, I can make one extra melee attack from my echo's position"
			]),
			usages : "Constitution modifier per ",
			usagescalc : "event.value = Math.max(1, What('Con Mod'));",
			recovery : "long rest"
		},
		"subclassfeature7" : {
			name : "Echo Avatar",
			source : [["W", 183]],
			minlevel : 7,
			description : desc([
				"As an action, I can temporarily transfer my consciousness to my echo for up to 10 min",
				"During this time, I see and hear through its eyes and ears, but not my own eyes and ears",
				"While I use my echo this way, it can be up to 1000 ft away from me without issue",
				"I can end this at any time, requiring no action"
			]),
			action : [["action", ""]]
		},
		"subclassfeature10" : {
			name : "Shadow Martyr",
			source : [["W", 183]],
			minlevel : 10,
			description : desc([
				"As a reaction when a creature I can see is attacked, I can make my echo the target",
				"Before the attack roll, the echo teleports to an empty space within 5 ft of the creature",
				"The attack roll of the triggering attack is then made against the echo instead"
			]),
			action : [["reaction", ""]],
			usages : 1,
			recovery : "short rest"
		},
		"subclassfeature15" : {
			name : "Reclaim Potential",
			source : [["W", 184]],
			minlevel : 15,
			description : desc([
				"When my echo is destroyed by taking damage, I gain 2d6 + my Con mod in temp HP",
				"I can only gain these temporary hit points if I don't already have temporary hit points"
			]),
			usages : "Constitution modifier per ",
			usagescalc : "event.value = Math.max(1, What('Con Mod'));",
			recovery : "long rest"
		},
		"subclassfeature18" : {
			name : "Legion of One",
			source : [["W", 184]],
			minlevel : 18,
			description : desc([
				"I can now manifest two echoes instead of one with the same bonus action",
				"These two can coexist, but if I manifest a third, the previous two are destroyed",
				"Anything I can do from one echo's position can be done from the other's instead",
				"I regain one use of Unleash Incarnation if I have no more remaining when I roll initiative"
			])
		}
	}
});
AddSubClass("fighter_ua23pt7", "psi warrior", {
	regExpSearch : /^(?=.*\bpsi(onic)?s?\b)(?=.*warrior).*$/i,
	subname : "Psi Warrior",
	source : [["T", 42]],
	fullname : "Psi Warrior (UA:PT-vii)",
	abilitySave : 4,
	features : {
		"subclassfeature3" : {
			name : "Psionic Energy Dice",
			source : [["T", 43]],
			minlevel : 3,
			description : desc([
				"I gain twice my proficiency bonus of psionic energy dice (PsiD) that fuel my psionics",
				"I regain all expended psionic energy dice after a long rest",
				"As a bonus action once per short rest, I can regain one expended psionic energy die"
			]),
			additional : levels.map(function(n) {
				return n < 3 ? "" : n < 5 ? "d6" : n < 11 ? "d8" : n < 17 ? "d10" : "d12";
			}),
			action : [["bonus action", "Regain 1 Psionic Energy Die"]],
			usages : "Proficiency Bonus \xD7 2 per ",
			usagescalc : "event.value = Number(How('Proficiency Bonus'))*2",
			recovery : "long rest",
			extraLimitedFeatures : [{
				name : "Regain 1 Psionic Energy die",
				usages : 1,
				recovery : "short rest"
			}]
		},
		"subclassfeature3.1" : {
			name : "Psionic Power: Protective Field",
			source : [["T", 43]],
			minlevel : 3,
			description : " [1 psionic energy die]" + desc([
				"As a reaction when I or a creature I can see within 30 ft takes damage, I can reduce it",
				"I reduce the damage by the roll of the one psionic energy die I expend + my Int mod"
			]),
			action : [["reaction", "Protective Field"]]
		},
		"subclassfeature3.2" : {
			name : "Psionic Power: Psionic Strike",
			source : [["T", 43]],
			minlevel : 3,
			description : " [1 psionic energy die]" + desc([
				"Once on each of my turns after I hit a target in 30 ft and damage it with a weapon,",
				"I can expend a psionic energy die to deal it the die roll + my Int mod in force damage"
			])
		},
		"subclassfeature3.3" : {
			name : "Psionic Power: Telekinetic Movement",
			source : [["T", 43]],
			minlevel : 3,
			description : desc([
				"As an action, I can move a Large or smaller loose object or one willing creature in 30 ft",
				"I must be able to see the target and can move it up to 30 ft to an empty space I can see",
				"If it is a Tiny object, I can also move it to or from my hand; I can't move myself this way",
				"I can do this once per short rest, or by expending a psionic energy die (PsiD)"
			]),
			limfeaname : "Telekinetic Movement",
			action : [["action", ""]],
			usages : 1,
			recovery : "short rest",
			altResource : "PsiD"
		},
		"subclassfeature7.1" : {
			name : "Telekinetic Adept: Psi-Powered Leap",
			source : [["T", 43]],
			minlevel : 7,
			description : desc([
				"As a bonus action, I gain a flying speed of twice my walking speed until the turn ends",
				"I can do this once per short rest, or by expending a psionic energy die (PsiD)"
			]),
			limfeaname : "Psi-Powered Leap",
			action : [["bonus action", ""]],
			usages : 1,
			recovery : "short rest",
			altResource : "PsiD"
		},
		"subclassfeature7.2" : {
			name : "Telekinetic Adept: Telekinetic Thrust",
			source : [["T", 43]],
			minlevel : 7,
			description : " [DC 8 + Prof B. + Int mod]" + desc([
				"When I deal damage with my Psionic Strike, I can have the target make a Strength save",
				"If failed, I knock the target prone or move it up to 10 ft in any direction horizontally"
			]),
		},
		"subclassfeature10" : {
			name : "Guarded Mind",
			source : [["T", 43]],
			minlevel : 10,
			description : desc([
				"I can expend a psionic energy die to end all effects on me causing charmed or frightened",
				"I can do this if at the start of my turn; I also gain resistance to psychic damage"
			]),
			dmgres : ["Psychic"]
		},
		"subclassfeature15" : {
			name : "Bulwark of Force",
			source : [["T", 44]],
			minlevel : 15,
			description : desc([
				"As a bonus action, I can choose up to my Int mod of creatures (min 1) I can see in 30 ft",
				"This can include me; Each chosen gains half cover for 1 minute or until I'm incapacitated",
				"I can do this once per long rest, or by expending a psionic energy die (PsiD)"
			]),
			action : [["bonus action", ""]],
			usages : 1,
			recovery : "long rest",
			altResource : "PsiD"
		},
		"subclassfeature18" : {
			name : "Telekinetic Master",
			source : [["T", 44]],
			minlevel : 18,
			description : desc([
				"I can cast Telekinesis, requiring no spell slot or components, with Int spellcasting ability",
				"As a bonus action while concentrating on this spell, I can make one weapon attack",
				"I can cast Telekinesis once per long rest, or by expending a psionic energy die (PsiD)"
			]),
			spellcastingBonus : {
				name : "Telekinetic Master",
				spells : ["telekinesis"],
				selection : ["telekinesis"],
				firstCol : "Sp"
			},
			spellChanges : {
				"telekinesis" : {
					components : "",
					changes : "Using Telekinetic Master, I can cast Telekinesis without requiring components or spell slots."
				}
			},
			action : [["bonus action", "Weapon Attack while Telekinesis conc."]],
			usages : 1,
			recovery : "long rest",
			altResource : "PsiD"
		}
	}
});
AddSubClass("fighter_ua23pt7", "rune knight", {
	regExpSearch : /^(?=.*rune)(?=.*knight).*$/i,
	subname : "Rune Knight",
	source : [["T", 44]],
	fullname : "Rune Knight (UA:PT-vii)",
	abilitySave : 3,
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiencies",
			source : [["T", 44]],
			minlevel : 3,
			description : "\n   I gain proficiency with smith's tools and I learn to speak, read, and write Giant",
			toolProfs : ["Smith's tools"],
			languageProfs : ["Giant"]
		},
		"subclassfeature3.1" : {
			name : "Rune Carver",
			source : [["T", 44]],
			minlevel : 3,
			description : desc([
				"I learn how to use magic runes to enhance my gear that I can wear or hold in my hand",
				'Use the "Choose Feature" button above to select a rune and add it to the third page',
				"When I finish a long rest, I can inscribe each rune I know upon a different item I touch",
				"Each item can hold only one rune and remains there until I finish a long rest",
				"Runes inscribed on a carried object grant both a passive and a limited-use active effect",
				"Whenever I gain a fighter level, I can swap a rune I know for another",
				"The DC for a rune's abilities is 8 + my Proficiency bonus + my Constitution modifier"
			]),
			additional : levels.map(function (n){
				return n < 3 ? "" : (n < 7 ? 2 : n < 10 ? 3 : n < 15 ? 4 : 5) + " runes known"
			}),
			extraTimes : levels.map(function (n) {
				return n < 3 ? 0 : n < 7 ? 2 : n < 10 ? 3 : n < 15 ? 4 : 5;
			}),
			extraname : "Rune Knight 3",
			extrachoices : ["Cloud Rune", "Fire Rune", "Frost Rune", "Stone Rune", "Hill Rune (prereq: level 7 fighter)", "Storm Rune (prereq: level 7 fighter)"],
			"cloud rune" : {
				name : "Cloud Rune",
				source : [["T", 44]],
				description : desc([
					"While I wear an object inscribed with this, I gain a deceptiveness reminiscent of cloud giants",
					"I always gain advantage on Dexterity (Sleight of Hand) and Charisma (Deception) checks",
					"As a reaction when I or another I can see within 30 ft is hit by an attack, I can invoke this",
					"I select another target for the attack within 30 ft of me, using the same roll (ignore range)"
				]),
				action : [["reaction", " (invoke)"]],
				additional : "invoke",
				usages : ["", "", 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
				recovery : "short rest",
				advantages : [ ["Sleight of Hand", true], ["Deception", true] ]
			},
			"fire rune" : {
				name : "Fire Rune",
				source : [["T", 44]],
				description : desc([
					"While I wear an object inscribed with this, I gain craftsmanship reminiscent of great smiths",
					"I always double my proficiency bonus when making an ability check with a tool",
					"When I hit a creature with a weapon attack, I can invoke it to summon fiery shackles",
					"It takes an extra 2d6 fire damage and must make a Str save or be restrained for 1 min",
					"While restrained, the creature takes 2d6 fire damage at the start of each of its turns",
					"It can repeat the save at the end of each of its turns, banishing the shackles on a success"
				]),
				additional : "invoke",
				usages : ["", "", 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
				recovery : "short rest",
				skillstxt : "expertise with all tools I am proficient with",
				eval : function () { Checkbox('Too Exp', true); },
				removeeval : function () { Checkbox('Too Exp', false); }
			},
			"frost rune" : {
				name : "Frost Rune",
				source : [["T", 45]],
				description : desc([
					"While I wear an object inscribed with this, I gain might of those surviving wintry wilderness",
					"I always gain advantage on Wisdom (Animal Handling) and Charisma (Intimidation) checks",
					"As a bonus action, I can invoke this to gain +2 on Str and Con checks and saves for 10 min"
				]),
				action : [["bonus action", " (invoke)"]],
				additional : "invoke",
				usages : ["", "", 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
				recovery : "short rest",
				advantages : [ ["Animal Handling", true], ["Intimidation", true] ]
			},
			"stone rune" : {
				name : "Stone Rune",
				source : [["T", 45]],
				description : desc([
					"While I wear an object inscribed with this, I gain judiciousness reminiscent of stone giants",
					"I always gain advantage on Wisdom (Insight) checks and I gain darkvision out to 120 ft",
					"As a reaction when a creature I can see ends it turn within 30 ft, I can invoke this rune",
					"This causes the creature to make a Wisdom save or be charmed by me for 1 minute",
					"While charmed, it descends into a dreamy stupor, becoming incapacitated and has speed 0",
					"It can repeat the save at the end of each of its turns, ending the effect on a success"
				]),
				action : [["reaction", " (invoke)"]],
				additional : "invoke",
				usages : ["", "", 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
				recovery : "short rest",
				vision : [["Darkvision", 120]],
				advantages : [ ["Insight", true] ]
			},
			"hill rune (prereq: level 7 fighter)" : {
				name : "Hill Rune",
				source : [["T", 45]],
				description : desc([
					"While I wear an object inscribed with this rune, I gain a resilience reminiscent of hill giants",
					"I always gain advantage on saves against being poisoned and resistance to poison damage",
					"As a bonus action, I can invoke it to gain resistance to bludg/slash/pierc damage for 1 min"
				]),
				prereqeval : function(v) { return classes.known.fighter.level >= 7; },
				action : [["bonus action", " (invoke)"]],
				additional : "invoke",
				usages : ["", "", 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
				recovery : "short rest",
				dmgres : ["Poison"],
				savetxt : { adv_vs : ["poison"] }
			},
			"storm rune (prereq: level 7 fighter)" : {
				name : "Storm Rune",
				source : [["T", 45]],
				description : desc([
					"While I wear an object inscribed with this rune, I can glimpse the future like storm giants",
					"I always gain adv. on Int (Arcana) checks and I can't be surprised while not incapacitated",
					"As a bonus action, I can invoke it to enter a prophetic state for 1 min or till incapacitated",
					"While in this state, I can use a reaction to cause a roll to gain advantage or disadvantage",
					"I can do this for attacks, saves, and checks of myself or others I can see within 60 ft of me"
				]),
				prereqeval : function(v) { return classes.known.fighter.level >= 7; },
				action : [["bonus action", " (invoke)"]],
				additional : "invoke",
				usages : ["", "", 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
				recovery : "short rest",
				advantages : [ ["Arcana", true] ],
				savetxt : { immune : ["surprised"] },
			}
		},
		"subclassfeature3.2" : {
			name : "Giant's Might",
			source : [["T", 45]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can imbue myself with giant magic for 1 minute and gain benefits:",
				" \u2022 Space permitted, I grow to a larger size category along with everything I'm wearing",
				" \u2022 I have advantage on my Strength check and saves",
				" \u2022 My weapon and unarmed strike attacks deal extra damage"
			]),
			additional : levels.map(function (n) {
				return n < 3 ? "" : (n < 18 ? "Large" : "Huge") + ", +1d" + (n < 10 ? 6 : n < 18 ? 8 : 10) + " damage"
			}),
			action : [["bonus action", ""]],
			savetxt : { text : ["Adv. on Str saves in Giant's Might"] },
			usages : "Prof Bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (classes.known.fighter && classes.known.fighter.level >= 3 && v.isWeapon && (/giant('s)? might/i).test(v.WeaponTextName)) {
							var GMdmgDie = classes.known.fighter.level < 10 ? 'd6' : classes.known.fighter.level < 18 ? 'd8' : 'd10';
							var dmgDieRx = RegExp('(\\d+)' + GMdmgDie, 'i');
							if (dmgDieRx.test(fields.Damage_Die)) {
								var dmgDieMatch = fields.Damage_Die.match(dmgDieRx);
								fields.Damage_Die = fields.Damage_Die.replace(dmgDieRx, Number(dmgDieMatch[1]) + 1 + GMdmgDie);
								fields.Description = fields.Description.replace(/Versatile \((\d+d\d+)\)/i, 'Versatile ($1+1' + GMdmgDie + ')');
							} else if (!isNaN(fields.Damage_Die)) {
								fields.Damage_Die = 1 + GMdmgDie + "+" + fields.Damage_Die;
							} else {
								fields.Description += (fields.Description ? '; ' : '') + '+1' + GMdmgDie + ' damage';
							}
							if (classes.known.fighter.level >= 18 && v.isMeleeWeapon) fields.Description += (fields.Description ? '; ' : '') + '+5 ft reach';
						};
					},
					"If I include the words \"Giant Might\" in the name of a weapon or unarmed strike, it gets treated as a weapon that I use while imbued by my Giant's Might feature. It adds +1d6 weapon damage. From 10th-level onwards, this increases to +1d8 damage. From 18th-level onwards, this increases to +1d10 damage and my reach increases by 5 ft (for melee weapons).",
					8
				]
			}
		},
		"subclassfeature7" : {
			name : "Runic Shield",
			source : [["T", 45]],
			minlevel : 7,
			description : desc([
				"As a reaction when I see a creature within 60 ft get hit by an attack, I can protect it",
				"The attacker must reroll its attack roll and use the new roll"
			]),
			action : [["reaction", ""]]
		},
		"subclassfeature10" : {
			name : "Great Stature",
			source : [["T", 46]],
			minlevel : 10,
			description : desc([
				"My runes permanently make me grow; I add 3d4 inches to my length",
				"In addition, the extra weapon damage I deal with Giant Might increases to 1d8"
			])
		},
		"subclassfeature15" : {
			name : "Master of Runes",
			source : [["T", 46]],
			minlevel : 15,
			description : "\n   I can now invoke each of my runes twice per short rest instead of once"
		},
		"subclassfeature18" : {
			name : "Runic Juggernaut",
			source : [["T", 46]],
			minlevel : 18,
			description : desc([
				"Giant's Might now adds +1d10 weapon damage, and can make me grow up to Huge",
				"While I'm Huge, my reach increases by 5 ft"
			])
		}
	}
});
AddSubClass("fighter_ua23pt7", "scout-ua", { // Still valid 2021-09-21
	regExpSearch : /scout/i,
	subname : "Scout",
	source : [["UA:KoO", 4]],
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiencies",
			source : [["UA:KoO", 4]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with three skills or two skills and Thieves' Tools; For skills choose from:" + "\n   " + "Acrobatics, Athletics, Investigation, Medicine, Nature, Perception, Stealth, and Survival",
			choices : ["2 Skill proficiencies and Thieves' Tools proficiency", "3 Skill proficiencies"],
			"2 skill proficiencies and thieves' tools proficiency" : {
				name : "Bonus Proficiencies",
				description : desc([
					"I gain proficiency with two skills and Thieves' Tools; For skills choose from:",
					"Acrobatics, Athletics, Investigation, Medicine, Nature, Perception, Stealth, and Survival"
				]),
				skillstxt : "Choose two from: Acrobatics, Athletics, Investigation, Medicine, Nature, Perception, Stealth, or Survival",
				toolProfs : [["Thieves' tools", "Dex"]]
			},
			"3 skill proficiencies" : {
				name : "Bonus Proficiencies",
				description : desc([
					"I gain proficiency with three skills, chosen from:",
					"Acrobatics, Athletics, Investigation, Medicine, Nature, Perception, Stealth, and Survival"
				]),
				skillstxt : "Choose three from: Acrobatics, Athletics, Investigation, Medicine, Nature, Perception, Stealth, or Survival"
			}
		},
		"subclassfeature3.1" : {
			name : "Combat Superiority",
			source : [["UA:KoO", 4]],
			minlevel : 3,
			description : "\n   " + "I gain a number of superiority dice that I can use to fuel special maneuvers (see below)" + "\n   " + "I can use only one maneuver per attack; I regain all superiority dice after a short rest" + "\n    - " + "Use after rolling an Athletics, Nature, Perception, Stealth, or Survival check" + "\n       " + "I add half the superiority die to the roll (rounding up)" + "\n    - " + "Use after rolling to hit; I add the superiority die to my attack roll" + "\n    - " + "As a reaction when I'm hit while wearing light/medium armor, I add the die to AC" + "\n       " + "If the attack still hits, I only take half damage from it",
			additional : ["", "", "d8", "d8", "d8", "d8", "d8", "d8", "d8", "d10", "d10", "d10", "d10", "d10", "d10", "d10", "d10", "d12", "d12", "d12"],
			usages : [0, 0, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6],
			recovery : "short rest",
			action : ["reaction", " (if hit)"]
		},
		"subclassfeature3.2" : function () {
			var NEfea = newObj(ClassList.ranger.features["natural explorer"]);
			NEfea.source = ["UA:KoO", 4];
			NEfea.minlevel = 3;
			NEfea.additional = ["", "", "1 favored terrain", "1 favored terrain", "1 favored terrain", "1 favored terrains", "2 favored terrains", "2 favored terrains", "2 favored terrains", "2 favored terrains", "2 favored terrains", "2 favored terrains", "2 favored terrains", "2 favored terrains", "3 favored terrains", "3 favored terrains", "3 favored terrains", "3 favored terrains", "3 favored terrains", "3 favored terrains"];
			return NEfea;
		}(),
		"subclassfeature10" : {
			name : "Improved Combat Superiority",
			source : [["UA:KoO", 4]],
			minlevel : 10,
			description : "\n   " + "My superiority dice turn into d10s at 10th level and into d12s at 18th level"
		},
		"subclassfeature15" : {
			name : "Relentless",
			source : [["UA:KoO", 4]],
			minlevel : 15,
			description : "\n   " + "I regain one superiority die if I have no more remaining when I roll initiative"
		}
	}
});
AddSubClass("fighter_ua23pt7", "monster hunter-ua", { // Still valid 2021-09-21
	regExpSearch : /^(?=.*monster)(?=.*hunter).*$/i,
	subname : "Monster Hunter",
	source : [["UA:GH", 2]],
	fullname : "Monster Hunter (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiencies",
			source : [["UA:GH", 2]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with two skills or one skill and any one tool" + "\n   " + "For skills I can choose Arcana, History, Insight, Investigation, Nature, or Perception",
			choices : ["1 Skill and 1 Tool proficiencies", "2 Skill proficiencies"],
			"1 skill and 1 tool proficiencies" : {
				name : "Bonus Proficiencies",
				description : "\n   " + "I gain proficiency with one skill and any one tool of my choice" + "\n   " + "For the skill, I can choose Arcana, History, Insight, Investigation, Nature, or Perception",
				skillstxt : "Choose one from: Arcana, History, Insight, Investigation, Nature, or Perception",
				toolProfs : [["Any tool", 1]]
			},
			"2 skill proficiencies" : {
				name : "Bonus Proficiencies",
				description : "\n   " + "I gain 2 skill proficiencies: Arcana, History, Insight, Investigation, Nature, or Perception",
				skillstxt : "Choose two from: Arcana, History, Insight, Investigation, Nature, and Perception"
			}
		},
		"subclassfeature3.1" : {
			name : "Combat Superiority",
			source : [["UA:GH", 2]],
			minlevel : 3,
			description : "\n   " + "I gain a number of superiority dice that I can use to fuel special maneuvers (see below)" + "\n   " + "I can use only one maneuver per attack; I regain all superiority dice after a short rest" + "\n    - " + "Use after rolling to hit; I add the superiority die to my attack roll" + "\n    - " + "Use after damaging a creature; I add the superiority die to the damage roll" + "\n       " + "Also, the attack imposes disadvantage on any concentration save resulting from it" + "\n    - " + "Use after Int/Wis/Cha save, before knowing success/fail; add the die to the save total" + "\n    - " + "Use with Wis (Perception) to detect hidden or Wis (Insight) to see if lying to me" + "\n       " + "After rolling but before knowing if success/fail; I add the superiority die to the check",
			additional : ["", "", "d8", "d8", "d8", "d8", "d8", "d8", "d8", "d10", "d10", "d10", "d10", "d10", "d10", "d10", "d10", "d12", "d12", "d12"],
			usages : [0, 0, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6],
			recovery : "short rest"
		},
		"subclassfeature3.2" : {
			name : "Hunter's Mysticism",
			source : [["UA:GH", 2]],
			minlevel : 3,
			usages : 1,
			recovery : "long rest",			
			description : "\n   " + "I can cast Detect Magic as a ritual and Protection from Evil & Good once per long rest" + "\n   " + "I gain the ability to speak one of the following languages: Abyssal, Celestial, or Infernal",
			action : ["action", " (Prot vs. Evil/Good)"],
			languageProfs : [["Abyssal, Celestial, or Infernal", 1]],
			spellcastingBonus : [{
				name : "Spirit Seeker",
				spells : ["detect magic"],
				selection : ["detect magic"],
				firstCol : "(R)",
				spellcastingAbility : 5
			}, {
				name : "Spirit Seeker",
				spells : ["protection from evil and good"],
				selection : ["protection from evil and good"],
				firstCol : "oncelr"
			}],
			spellChanges : {
				"detect magic" : {
					time : "10 min",
					changes : "I can cast this spell only as a ritual, thus its casting time is 10 minutes longer."
				}
			}
		},
		"subclassfeature7" : {
			name : "Monster Slayer",
			source : [["UA:GH", 2]],
			minlevel : 7,
			usages : 1,
			recovery : "long rest",
			description : "\n   " + "Whenever I use a superiority die, I can choose to expend two, adding both to the roll" + "\n   " + "If the target is an aberration, fey, fiend, or undead, both dice deal maximum damage",
			action : ["action", ""]
		},
		"subclassfeature10" : {
			name : "Improved Combat Superiority",
			source : [["UA:GH", 2]],
			minlevel : 10,
			description : "\n   " + "My superiority dice turn into d10s at 10th level and into d12s at 18th level"
		},
		"subclassfeature15" : {
			name : "Relentless",
			source : [["UA:GH", 2]],
			minlevel : 15,
			description : "\n   " + "I regain one superiority die if I have no more remaining when I roll initiative"
		}
	}
});
AddSubClass("fighter_ua23pt7", "sharpshooter-ua", { // Still valid 2021-09-21
	regExpSearch : /sharpshooter/i,
	subname : "Sharpshooter",
	source : [["UA:FMA", 3]],
	fullname : "Sharpshooter (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Steady Aim",
			source : [["UA:FMA", 3]],
			minlevel : 3,
			description : "\n   " + "As a bonus action, I can carefully aim my ranged weapon on a target I can see in range" + "\n   " + "Until the end of my turn, my attacks with this weapon on that target get to:" + "\n   " + "Ignore half and three-quarter cover; Add 2 + half fighter level damage per hit",
			recovery : "short rest",
			usages : 3,
			additional : levels.map(function (n) {
				return n < 3 ? "" : "+" + (2 + Math.floor(n / 2)) + " damage";
			}),
			action : ["bonus action", ""],
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.isRangedWeapon && classes.known.fighter && classes.known.fighter.level > 2 && (/steady.{0,3}aim/i).test(v.WeaponTextName)) {
							fields.Description += (fields.Description ? '; ' : '') + 'Ignores 1/2 and 3/4 cover';
						};
					},
					"If I include the words 'Steady Aim' in the name of a ranged weapon, it gets 2 + half my fighter level added to its Damage, and the fact that it ignores half and three-quarter cover added to its description."
				],
				atkCalc : [
					function (fields, v, output) {
						if (v.isRangedWeapon && classes.known.fighter && classes.known.fighter.level > 2 && (/steady.{0,3}aim/i).test(v.WeaponTextName)) { output.extraDmg += 2 + Math.floor(classes.known.fighter.level / 2); };
					}, ""]
			}
		},
		"subclassfeature7" : {
			name : "Careful Eyes",
			source : [["UA:FMA", 4]],
			minlevel : 7,
			description : "\n   " + "As a bonus action, I can take the Search action" + "\n   " + "I gain proficiency with one skill, Perception, Investigation, or Survival",
			skillstxt : "Choose one from: Perception, Investigation, or Survival",
			action : ["bonus action", ""]
		},
		"subclassfeature10" : {
			name : "Close-Quarters Shooting",
			source : [["UA:FMA", 4]],
			minlevel : 10,
			description : "\n   " + "I don't have disadvantage when making a ranged attack while within 5 ft of a hostile" + "\n   " + "A hostile within 5 ft that I hit with a ranged attack on my turn, can't take reactions" + "\n   " + "This lasts until the end of my turn"
		},
		"subclassfeature15" : {
			name : "Rapid Strike",
			source : [["UA:FMA", 4]],
			minlevel : 15,
			description : "\n   " + "If I have adv. on an attack, I can forgo it to make an extra attack as a bonus action" + "\n   " + "This attack has to be with the same weapon against the same target",
			action : ["bonus action", ""]
		},
		"subclassfeature18" : {
			name : "Snap Shot",
			source : [["UA:FMA", 4]],
			minlevel : 18,
			description : "\n   " + "I can make one more ranged attack with my Attack action on my first turn of combat"
		}
	}
});
AddSubClass("fighter_ua23pt7", "brute-ua", {
	regExpSearch : /brute/i,
	subname : "Brute",
	source : [["UA:TS", 2]],
	fullname : "Brute (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Brute Force",
			source : [["UA:TS", 2]],
			minlevel : 3,
			description : "\n   " + "I do additional damage with weapons that I'm proficient with",
			additional : levels.map(function (n) { 
				return n < 3 ? "" : "+1d" + (n < 10 ? 4 : n < 16 ? 6 : n < 20 ? 8 : 10) + " weapon damage";
			}),
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (classes.known.fighter && classes.known.fighter.level > 2 && !v.isSpell && !v.isNaturalWeapon && fields.Proficiency) {
							fields.Description += (fields.Description ? '; ' : '') + '+1d' + (classes.known.fighter.level < 10 ? 4 : classes.known.fighter.level < 16 ? 6 : classes.known.fighter.level < 20 ? 8 : 10) + ' damage';
						};
					},
					"I do +1d4 damage with weapons that I'm proficient with. This increases to 1d6 at 10th level, 1d8 at 16th level, and 1d10 at 20th level."
				]
			}
		},
		"subclassfeature7" : {
			name : "Brutish Durability",
			source : [["UA:TS", 2]],
			minlevel : 7,
			description : desc([
				"I add +1d6 to all my saving throws, including death saves",
				"If the total of a death save is 20 or more, it counts as rolling a 20"
			]),
			savetxt : { text : ["Add 1d6 to all saves"] }
		},
		"subclassfeature15" : {
			name : "Devastating Critical",
			source : [["UA:TS", 2]],
			minlevel : 15,
			description : "\n   " + "Whenever I score a critical hit with a weapon, I add my fighter level to the damage",
			additional : levels.map(function (n) { return n < 15 ? "" : "+" + n + " damage on crit"; })
		},
		"subclassfeature18" : {
			name : "Survivor",
			source : [["UA:TS", 2]],
			minlevel : 18,
			description : desc([
				"If I have less than half my max HP at the start of my turn, I heal myself",
				"I regain HP equal to 5 + Constitution modifier (min 1); This doesn't work if I'm at 0 HP"
			])
		}
	}
});

// Add Monk subclasses
AddSubClass("monkua", "warrior of mercy", {
	regExpSearch : /^(?=.*mercy)((?=.*monk)|((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior))).*$/i,
	subname : "Warrior of Mercy",
	source : [["T", 49]],
	features : {
		"subclassfeature3" : {
			name : "Implements of Mercy",
			source : [["T", 49]],
			minlevel : 3,
			description : desc([
				"I gain proficiency with Insight, Medicine, and herbalism kit; I have a special Merciful Mask"
			]),
			skills : ["Insight", "Medicine"],
			toolProfs : ["Herbalism kit"],
			"hands of healing" : {
				name : "Hands of Healing",
				extraname : "Warrior of Mercy 3",
				source : [["T", 49]],
				description : levels.map(function (n) {
					var a = "As an action, I can spend 1 Discipline Point to touch a creature and restore a number of its HP";
					var b6 = "It also recovers from one disease or being blinded, deafened, paralyzed, poisoned or stunned";
					var c = "When I use Flurry of Blows, I can do this instead of one unarmed strike (no extra ki cost)";
					return desc( n < 6 ? [a, c] :
						[a, b6, n < 11 ? c : c.replace("one", "each")]
					);
				}),
				action : [["action", ""]],
				additional : levels.map(function (n) {
					return n < 3 ? "" : "1 Discipline Point; heal 1d" + (n < 5 ? 4 : n < 11 ? 6 : n < 17 ? 8 : 10) + " + Wisdom modifier";
				})
			},
			"hands of harm" : {
				name : "Hands of Harm",
				extraname : "Warrior of Mercy 3",
				source : [["T", 50]],
				description : levels.map(function (n) {
					var a = "When I hit a creature with an unarmed strike, I can spend 1 Discipline Point to deal extra damage";
					var b6 = "I can also subject the target to the poisoned condition until the end of my next turn";
					var c11 = "When I use Flurry of Blows, I can do this with one unarmed strike (no extra ki cost)";
					var d = "I can use this feature only once per turn";
					return desc( n < 6 ? [a, d] :
						n < 11 ? [a, b6, d] :
						[a, b6, c11, d]
					);
				}),
				additional : levels.map(function (n) {
					return n < 3 ? "" : "1 Discipline Point; 1d" + (n < 5 ? 4 : n < 11 ? 6 : n < 17 ? 8 : 10) + " + Wis mod necrotic damage";
				})
			},
			autoSelectExtrachoices : [{
				extrachoice : "hands of healing"
			}, {
				extrachoice : "hands of harm"
			}]
		},
		"subclassfeature6" : {
			name : "Physician's touch",
			source : [["T", 50]],
			minlevel : 6,
			description : desc([
				"Hand of Healing also ends 1 disease, blinded, deafened, paralyzed, poisoned or stunned",
				"Hand of Harm also causes target to be poisoned until the end of my next turn"
			])
		},
		"subclassfeature11" : {
			name : "Flurry of Healing and Harm",
			source : [["T", 50]],
			minlevel : 11,
			description : desc([
				"I can use Hand of Healing instead of each Flurry of Blows unarmed strike without ki cost",
				"I can use Hand of Harm on one Flurry of Blows unarmed strike without ki cost"
			]),
			"hand of ultimate mercy" : {
				name : "Hand of Ultimate Mercy",
				extraname : "Way of Mercy 17",
				source : [["T", 50]],
				description : desc([
					"As an action, I can spend 5 Discipline Points and touch a creature that died in the last 24 hours",
					"The creature returns to life and regains 4d10 + my Wisdom modifier in hit points",
					"It is also cured of all these conditions: blinded, deafened, paralyzed, poisoned, and stunned"
				]),
				action : [["action", ""]],
				additional : "5 Discipline Points",
				usages : 1,
				recovery : "long rest"
			},
			autoSelectExtrachoices : [{
				extrachoice : "hand of ultimate mercy",
				minlevel : 17
			}]
		}
	}
});
AddSubClass("monkua", "ascendant dragon", {
	regExpSearch : /^(?=.*ascendant)(?=.*(dragon|draconic))((?=.*monk)|((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior))).*$/i,
	subname : "Warrior of the Ascendant Dragon",
	source : [["FToD", 13]],
	features : {
		"subclassfeature3" : {
			name : "Draconic Disciple",
			source : [["FToD", 13]],
			minlevel : 3,
			description : desc([
				"I learn to speak, read, and write Draconic or one other language of my choice",
				"I can change the damage type of my unarmed strikes to acid, cold, fire, lightning, poison",
				"As a reaction when I fail an Intimidation or Persuasion check, I can reroll the check",
				"If this reroll turns the check into a success, I can't do so again until I finish a long rest"
			]),
			languageProfs : [["Draconic or other", 1]],
			action : [["reaction", " (reroll check)"]],
			usages : 1,
			recovery : "long rest",
			additional : "reroll",
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.baseWeaponName === "unarmed strike") {
							fields.Description += (fields.Description ? '; ' : '') + "Change type to acid/cold/fire/lightning/poison";
						};
					},
					"When I damage a target with an unarmed strike, I can change the damage type to acid, cold, fire, lightning or poison."
				]
			},
			"breath of the dragon" : {
				name : "Breath of the Dragon",
				extraname : "Ascendant Dragon 3",
				source : [["FToD", 13]],
				description : levels.map(function (n) {
					var iMonkDie = n < 5 ? 4 : n < 11 ? 6 : n < 17 ? 8 : 10;;
					var aDesc = [
						"When I take the Attack action on my turn, I can replace one attack with a breath weapon",
						"This deals " + (n < 11 ? 2 : 3) + "d" + iMonkDie + " acid, cold, fire, lightning, or poison (my choice) damage to all in the area",
						"The area can be a 20-ft cone or a 5-ft wide, 30-ft line; Dex save to halve the damage",
						"I can do this my Proficiency Bonus times per long rest, or by expending 2 Discipline Points"
					];
					if (n < 17) return desc(aDesc);
					var aDesc17 = [
						"From 17th-level, I can expend 1 (extra) Discipline Point when I use this feature to augment it",
						"The damage increases to 4d" + iMonkDie + " and the area to a 60-ft cone or a 5-ft wide, 90-ft line"
					];
					return desc(aDesc.concat(aDesc17));
				}),
				usages : "Prof B. per ",
				usagescalc : "event.value = How('Proficiency Bonus');",
				recovery : "long rest",
				altResource : "2 ki",
				additional : levels.map(function (n) {
					return n < 3 ? "" : (n < 11 ? 2 : 3) + "d" + (n < 5 ? 4 : n < 11 ? 6 : n < 17 ? 8 : 10);
				}),
				weaponsAdd : ["Breath of the Dragon"],
				weaponOptions : {
					regExpSearch : /^(?=.*breath)(?=.*dragon).*$/i,
					name : "Breath of the Dragon",
					source : [["FToD", 13]],
					ability : 5,
					type : "Natural",
					damage : [2, 4, "My choice"],
					range : "5-ft \xD7 30-ft line",
					description : "All in area; Dex save for half damage; Alt: 20-ft cone; Type: acid/cold/fire/lightning/poison",
					dc : true,
					monkweapon : false,
					abilitytodamage : false,
					WotAD_BreathWeapon : true
				},
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (classes.known.monkua && classes.known.monkua.level && v.theWea.WotAD_BreathWeapon) {
								var n = classes.known.monkua.level;
								var aMonkDie = n < 5 ? 4 : n < 11 ? 6 : n < 17 ? 8 : 10;;
								fields.Damage_Die = (v.theWea.WotAD_BreathWeaponAugmented ? 4 : n < 11 ? 2 : 3) + "d" + aMonkDie;
							};
						},
						"My Breath of the Dragon deals damage equal to two rolls of my Martials Arts die. At 11th level, this increases to three rolls of my Martial Arts die. At 17th level, I can expend 1 Discipline Point to augment the breath to increase the damage to four rolls of my Martial Arts die."
					]
				}
			},
			autoSelectExtrachoices : [{ extrachoice : "breath of the dragon" }]
		},
		"subclassfeature6" : {
			name : "Wings Unfurled",
			source : [["FToD", 13]],
			minlevel : 6,
			description : desc([
				"When I use Step of the Wind, I can gain a flying speed equal to my walking speed"
			]),
			usages : "Prof Bonus per ",
			recovery : "long rest",
			usagescalc : "event.value = How('Proficiency Bonus');",
			"aspect of the wyrm" : {
				name : "Aspect of the Wyrm",
				extraname : "Ascendant Dragon 11",
				source : [["FToD", 13]],
				description : levels.map(function (n) {
					var aDesc = [
						"As a bonus action, I can activate a 10 ft aura for 1 minute that grants me one benefit:",
						" \u2022 My allies in the aura and I gain resistance to acid, cold, fire, lightning, or poison damage",
						" \u2022 When I create this aura and as a bonus action while it is active, I can frighten a creature",
						"      One creature must make a Wisdom save or become frightened of me for 1 minute",
						"      It can repeat the save at the end of each of its turns, ending the effect on a success",
						"I can activate this aura once per long rest, or by expending 3 Discipline Points"
					];
					if (n < 17) return desc(aDesc);
					var aDesc17 = [
						"From 17th-level, when I active this, I can choose any creatures I can see in the aura",
						"Each must then make a Dex save or take 3d10 acid, cold, fire, lightning, or poison damage"
					];
					return desc(aDesc.concat(aDesc17));
				}),
				usages : 1,
				recovery : "long rest",
				altResource : "3 ki",
				action : [["bonus action", ""]]
			},
			autoSelectExtrachoices : [{
				extrachoice : "aspect of the wyrm",
				minlevel : 11
			}]
		},
		"subclassfeature17" : {
			name : "Ascendant Aspect",
			source : [["FToD", 13]],
			minlevel : 17,
			description : "\n   I gain 10 ft blindsight and both Breath of the Dragon and Aspect of the Wyrm improve",
			vision : [["blindsight", 10]],
			weaponsAdd : ["Breath of the Dragon (Augmented)"],
			weaponOptions : {
				regExpSearch : /^(?=.*breath)(?=.*dragon)(?=.*augment).*$/i,
				name : "Breath of the Dragon (Augmented)",
				source : [["FToD", 13]],
				ability : 5,
				type : "Natural",
				damage : [4, 10, "My choice"],
				range : "5-ft \xD7 90-ft line",
				description : "[1 ki] All in area; Dex save for half damage; Alt: 60-ft cone; Type: acid/cold/fire/lightning/poison",
				dc : true,
				monkweapon : false,
				abilitytodamage : false,
				WotAD_BreathWeapon : true,
				WotAD_BreathWeaponAugmented : true
			}
		}
	}
});
AddSubClass("monkua", "warrior of the astral self", {
	regExpSearch : /^(?=.*astral)(?=.*(self|projection|travel))((?=.*monk)|((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior))).*$/i,
	subname : "Way of the Astral Self",
	source : [["T", 50]],
	features : {
		"subclassfeature3" : {
			name : "Arms of the Astral Self",
			source : [["T", 50]],
			minlevel : 3,
			description : ' [1 ki; see 3rd page "Notes"]' + desc([
				"As a bonus action, I can use my ki to summon the arms of my astral self for 10 minutes"
			]),
			action : [["bonus action", "Summon Astral Arms"]],
			weaponsAdd : ["Astral Arms"],
			weaponOptions : {
				baseWeapon : "unarmed strike",
				regExpSearch : /^(?=.*\bastral\b)(?=.*\barms?\b).*$/i,
				name : "Astral Arms",
				source : [["T", 50]],
				ability : 5,
				range : "Melee (+5 ft)",
				damage : [1, "", "Force"],
				description : "+5 ft reach; Uses Str, Dex, or Wis",
				isAstralArms : true
			},
			"astral arms" : {
				name : "Astral Arms",
				extraname : "Warrior of the Astral Self 3",
				source : [["T", 50]],
				description : desc([
					"As a bonus action, I can summon my astral arms to hover next to or over my own arms",
					"When I summon them, all creatures of my choice I can see in 10 ft must make a Dex save",
					"If failed, they take twice my martial arts die in force damage",
					"I can use the arms to make unarmed strikes, using Wisdom instead of Strength/Dexterity",
					"I have +5 ft reach on attacks made with my astral arms and they deal force damage",
					"They last for 10 minutes or until I'm incapacitated or die; I choose their appearance"
				]),
				additional : levels.map(function (n) {
					return n < 3 ? "" : "1 Discipline Point; 2d" + (n < 5 ? 4 : n < 11 ? 6 : n < 17 ? 8 : 10) + " force damage on summon";
				})
			},
			autoSelectExtrachoices : [{ extrachoice : "astral arms" }]
		},
		"subclassfeature6" : {
			name : "Visage of the Astral Self",
			source : [["T", 50]],
			minlevel : 6,
			description : ' [1 ki; see 3rd page "Notes"]' + desc([
				"As a bonus action, I can use my ki to summon the visage of my astral self for 10 minutes"
			]),
			action : [["bonus action", "Summon Astral Arms and/or Visage", "Summon Astral Arms"]],
			"astral visage" : {
				name : "Astral Visage",
				extraname : "Warrior of the Astral Self 6",
				source : [["T", 50]],
				description : " [1 Discipline Point]" + desc([
					"As a bonus action (or when summoning my astral arms), I can summon my astral visage",
					"It lasts for 10 minutes or until I'm incapacitated or die; I choose its appearance",
					"My astral visage covers my face like a helmet or mask and grants me the following benefits:",
					" \u2022 Astral Sight: I can see normally in normal and magical darkness to a distance of 120 ft",
					" \u2022 Wisdom of the Spirit: I have advantage on Wisdom (Insight) and Charisma (Intimidation)",
					" \u2022 Word of the Spirit: I can have only one target I can see in 60 ft hear me, or all in 300 ft"
				])
			},
			autoSelectExtrachoices : [{ extrachoice : "astral visage" }]
		},
		"subclassfeature11" : {
			name : "Body of the Astral Self",
			source : [["T", 51]],
			minlevel : 11,
			description : ' [see 3rd page "Notes"]' + desc([
				"When I have both my astral arms and visage summoned, my astral body appears as well",
				"This spectral body covers me like an armor, connecting my astral arms and astral visage"
			]),
			action : [["reaction", "Deflect Energy"]],
			"astral body" : {
				name : "Astral Body",
				extraname : "Warrior of the Astral Self 11",
				source : [["T", 51]],
				description : " [if both astral arms \u0026 visage are present]" + desc([
					" \u2022 Deflect Energy: As a reaction when I take damage, I can reduce it by 1d10 + Wis mod",
					"   I can only do this if the damage I take is acid, cold, fire, force, lightning, or thunder",
					" \u2022 Empowered Arms: Once per my turn, I can add martial art die to astral arms damage"
				])
			},
			autoSelectExtrachoices : [{ extrachoice : "astral body" }],
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.theWea.isAstralArms && classes.known.monkua && classes.known.monkua.level) {
							var aMonkDie = function (n) { return n < 5 ? 4 : n < 11 ? 6 : n < 17 ? 8 : 10; }(classes.known.monkua.level);
							fields.Description += (fields.Description ? '; ' : '') + 'Once on each of my turns +1d' + aMonkDie + ' damage';
						}
					},
					"Once on each of my turns when I hit a target with my astral arms, I can add my martial arts die to the damage dealt."
				]
			}
		},
		"subclassfeature17" : {
			name : "Awakened Astral Self",
			source : [["T", 51]],
			minlevel : 17,
			description : ' [5 ki; see 3rd page "Notes"]' + desc([
				"As a bonus action, I can use 5 Discipline Points to summon astral arms and visage with benefits"
			]),
			action : [["bonus action", ""]],
			"astral body" : {
				name : "Awakened Astral Self",
				extraname : "Way of the Astral Self 17",
				source : [["T", 50]],
				description : " [5 Discipline Points]" + desc([
					"As a bonus action, I can summon my astral arms and astral visage, with extra benefits:",
					" \u2022 Armor of the Spirit: I gain a +2 bonus to my armor class",
					" \u2022 Astral Barrage: I can do three attacks with the Attack action, if all are with astral arms",
					"This lasts for 10 minutes or until I'm incapacitated or die"
				])
			},
			autoSelectExtrachoices : [{ extrachoice : "astral body" }]
		}
	}
});
AddSubClass("monkua", "warrior of the drunken master", { //Note from MasterJedi2014: Altered "Intoxicated Frenzy" to allow for 4 strikes instead of 3 since the base Monk class gets 3 strikes at lvl 10 now.
	regExpSearch : /^((?=.*drunken)(?=.*master))|((?=.*drunk)((?=.*monk)|((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior)))).*$/i,
	subname : "Warrior of the Drunken Master",
	source : [["X", 33]],
	fullname : "Drunken Master (UA:PT-viii)",
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiencies",
			source : [["X", 34]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with the Performance skill and brewer's supplies",
			skills : ["Performance"],
			toolProfs : ["Brewer's supplies"]
		},
		"subclassfeature3.1" : {
			name : "Drunken Technique",
			source : [["X", 34]],
			minlevel : 3,
			description : "\n   " + "When using Flurry of Blows, I gain the benefits of a Disengage and +10 ft speed this turn"
		},
		"subclassfeature6" : {
			name : "Tipsy Sway",
			source : [["X", 34]],
			minlevel : 6,
			description : "\n   " + "1 Discipline Point: as a reaction if missed in melee, attacker instead hits other I see within 5 ft",
			additional : "Standing up from prone costs only 5 ft",
			action : ["reaction", ""]
		},
		"subclassfeature11" : {
			name : "Drunkard's Luck",
			source : [["X", 34]],
			minlevel : 11,
			description : "\n   " + "By spending 2 Discipline Points, I can remove Disadv. from an ability check, attack roll, or save",
			additional : "2 Discipline Points"
		},
		"subclassfeature17" : {
			name : "Intoxicated Frenzy",
			source : [["X", 34]],
			minlevel : 17,
			description : "\n   " + "I can make 4 extra attacks with Flurry of Blows if each is used on a different target"
		}
	}
});
AddSubClass("monkua", "warrior of the long death", {
	regExpSearch : /^(?=.*\blong)(?=.*\b(death|dead))((?=.*monk)|(((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior)))).*$/i,
	subname : "Warrior of the Long Death",
	source : [["S", 130]],
	features : {
		"subclassfeature3" : {
			name : "Touch of Death",
			source : [["S", 130]],
			minlevel : 3,
			description : "\n   " + "If I reduce someone within 5 ft to 0 HP, I gain Wis mod + monk level temporary HP"
		},
		"subclassfeature6" : {
			name : "Hour of Reaping",
			source : [["S", 130]],
			minlevel : 6,
			description : "\n   " + "As an action, all creatures within 30 feet of me must make a Wisdom saving throw" + "\n   " + "On a failed save the creature is frightened until the end of my next turn",
			action : ["action", ""]
		},
		"subclassfeature11" : {
			name : "Mastery of Death",
			source : [["S", 131]],
			minlevel : 11,
			additional : "1 Discipline Point",
			description : "\n   " + "When I'm reduced to 0 HP, I can expend 1 Discipline Point to have 1 HP instead",
			"touch of the long death" : {
				name : "Touch of the Long Death",
				extraname : "Way of the Long Death 17",
				source : [["S", 131]],
				description : " [1-10 Discipline Points]" + "\n   " + "As an action, a target within 5 ft takes 2d10 necrotic damage per Discipline Point I spent" + "\n   " + "It can make a Constitution saving throw to half the damage",
				action : ["action", ""]
			},
			autoSelectExtrachoices : [{
				extrachoice : "touch of the long death",
				minlevel : 17
			}]
		}
	}
});
AddSubClass("monkua", "warrior of the sun soul", {
	regExpSearch : /^(?=.*\bsun)(?=.*\b(soul|spirit))((?=.*(warrior|monk))|(((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior)))).*$/i,
	subname : "Warrior of the Sun Soul",
	source : [["S", 131], ["X", 35]],
	features : {
		"subclassfeature3" : {
			name : "Radiant Sun Bolt",
			source : [["S", 131], ["X", 35]],
			minlevel : 3,
			additional : "1 Discipline Point for 2 extra attacks",
			description : desc([
				"I gain a ranged spell attack that I can use as an attack in the Attack action",
				"If I do this and spend 1 Discipline Point, I can make 2 of these attacks as a Bonus Action"
			]),
			action : ["bonus action", " (2\xD7 with Attack action)"],
			weaponOptions : {
				regExpSearch : /^(?=.*radiant)(?=.*(sun|light))(?=.*bolt).*$/i,
				name : "Radiant Sun Bolt",
				source : [["S", 131], ["X", 35]],
				ability : 2,
				type : "Spell",
				damage : [1, 4, "radiant"],
				range : "30 ft",
				description : "If used in an Attack action, spend 1 Discipline Point to use it twice as a Bonus Action",
				monkweapon : true,
				abilitytodamage : true
			},
			weaponsAdd : ['Radiant Sun Bolt'],
			"searing arc strike" : {
				name : "Searing Arc Strike",
				extraname : "Way of the Sun Soul 6",
				source : [["S", 131], ["X", 35]],
				description : desc([
					"After taking the Attack action, I can cast Burning Hands as a bonus action [PHB 220]",
					"For every additional Discipline Point I spend, Burning hands is cast at 1 higher spell level",
					"The maximum total Discipline Points I can spend for this (including the 2) is half my Monk level"
				]),
				additional : levels.map(function (n) {
					if (n < 3) return "";
					var xtrKi = Math.max(0,Math.floor(n/2) - 2);
					return "2 Discipline Points + max " + xtrKi + " Discipline Point" + (xtrKi == 1 ? "" : "s");
				}),
				action : ["bonus action", " (after Attack action)"],
				spellcastingBonus : {
					name : "Searing Arc Strike",
					spells : ["burning hands"],
					selection : ["burning hands"],
					firstCol : 2
				},
				spellFirstColTitle : "Discipline Point",
				spellChanges : {
					"burning hands" : {
						time : "1 bns",
						description : "3d6+1d6/extra Discipline Point Fire dmg; save halves; unattended flammable objects ignite (Discipline Point max 1/2 monk lvl)",
						changes : "After I use the Attack action, I can cast Burning Hands as a bonus action by spending 2 Discipline Points. I can even spend additional Discipline Points to increase its spell level. The total amount of Discipline Points I can spend on it is half my monk level."
					}
				}
			},
			autoSelectExtrachoices : [{
				extrachoice : "searing arc strike",
				minlevel : 6
			}]
		},
		"subclassfeature11" : {
			name : "Searing Sunburst",
			source : [["S", 131], ["X", 35]],
			minlevel : 11,
			description : desc([
				"As an action, anyone in a 20-ft radius light on a point within 150 ft makes a Con save",
				"If failed and not behind opaque total cover, take 2d6 (+ 2d6/Discipline Point) radiant damage"
			]),
			action : ["action", ""],
			additional : "0 Discipline Points + max 3 Discipline Points",
			weaponsAdd : ['Searing Sunburst'],
			weaponOptions : {
				regExpSearch : /^(?=.*searing)(?=.*sunburst).*$/i,
				name : "Searing Sunburst",
				source : [["S", 131], ["X", 35]],
				ability : 5,
				type : "Spell",
				damage : [2, 6, "radiant"],
				range : "150 ft",
				description : "All in 20-ft radius; Con save - success no damage; +2d6 damage per Discipline Point (max 3 ki)",
				abilitytodamage : false,
				dc : true,
				useSpellMod : "monk"
			}
		},
		"subclassfeature17" : {
			name : "Sun Shield",
			source : [["S", 131], ["X", 35]],
			minlevel : 17,
			description : desc([
				"As a reaction, when I'm hit by a melee attack, I can deal 5 + Wis mod radiant damage",
				"I can only do this while my light aura is on; I can turn it on/off as a bonus action"
			]),
			action : [["bonus action", " (start/stop)"], ["reaction", " (hit in melee)"]],
			additional : "30-ft rad bright + 30-ft dim light"
		}
	}
});
AddSubClass("monkua", "warrior of tranquility-ua", { // Still valid 2021-09-21
	regExpSearch : /^(?=.*tranquility|tranquil|calm|diplomatic|diplomat)((?=.*monk)|((?=.*martial)(?=.*(artist|arts)))|((?=.*spiritual)(?=.*warrior))).*$/i,
	subname : "Warrior of Tranquility",
	source : [["UA:MMT", 2]],
	features : {
		"subclassfeature3" : {
			name : "Path of Tranquility",
			source : [["UA:MMT", 2]],
			minlevel : 3,
			description : "\n   " + "I cast Sanctuary on me, no material comp., lasts 8 hours, hostiles must save every hour",
			usages : 1,
			recovery : "1 min",
			spellcastingBonus : {
				name : "Way of Tranquility",
				spells : ["sanctuary"],
				selection : ["sanctuary"]
			},
			spellChanges : {
				"sanctuary" : {
					components : "V,S",
					compMaterial : "",
					time : "8 h",
					description : "I'm warded; any who want to attack/target must first make save; doesn't protect vs. area spells",
					changes : "Using my Path of Tranquility class feature I can cast Sanctuary without requiring material components and lasting for 8 hours, but it only affects myself and hostiles can attempt a new save every hour."
				}
			}
		},
		"subclassfeature3.1" : {
			name : "Healing Hands",
			source : [["UA:MMT", 2]],
			minlevel : 3,
			description : "\n   " + "As an action, I use points to heal living creature; or 5 points to cure one poison/disease" + "\n   " + "With Flurry of Blows, I can replace one unarmed strike with a use of this feature",
			usages : [0, 0, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
			recovery : "long rest",
			action : ["action", ""]
		},
		"subclassfeature6" : {
			name : "Emissary of Peace",
			source : [["UA:MMT", 2]],
			minlevel : 6,
			description : " [Performance or Persuasion prof]" + "\n   " + "I get adv. on Cha checks to calm or counsel peace; not with Deception or Intimidation",
			skillstxt : "Choose one from: Performance or Persuasion",
			"douse the flames of war" : {
				name : "Douse the Flames of War",
				extraname : "Way of Tranquility 11",
				source : [["UA:MMT", 1]],
				description : "\n   " + "As an action, a creature I touch must make a Wisdom save or have no violent impulses" + "\n   " + "If the target is missing any HP it succeeds on the save; The effect lasts for 1 minute" + "\n   " + "During this time, it can't attack or cast spells that deal damage or force a saving throw" + "\n   " + "This effect ends if the target is attacked, takes damage, or is forced to make a saving throw" + "\n   " + "It also ends if the target witnesses any of those things happening to its allies",
				action : ["action", ""]
			},
			autoSelectExtrachoices : [{
				extrachoice : "douse the flames of war",
				minlevel : 11
			}]
		},
		"subclassfeature17" : {
			name : "Anger of a Gentle Soul",
			source : [["UA:MMT", 2]],
			minlevel : 17,
			description : "\n   " + "As a reaction if another I see goes to 0 HP, I get bonus damage until my next turn ends",
			usages : 1,
			recovery : "short rest",
			additional : ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "+17", "+18", "+19", "+20"],
			action : ["reaction", ""]
		}
	}
});
//// Create the Kensei and its weapon options last, so we benefit of all possible weapons that were added
RunFunctionAtEnd(function () {
	var theKenseiSubclassName = AddSubClass("monkua", "warrior of the kensei", {
		regExpSearch : /kensei/i,
		subname : "Warrior of the Kensei",
		source : [["X", 34]],
		fullname : "Kensei (UA:PT-viii)",
		features : {
			"subclassfeature3" : {
				name : "Path of the Kensei",
				source : [["X", 34]],
				minlevel : 3,
				description : desc([
					"I gain proficiency with either calligrapher's supplies or painter's supplies",
					"Some weapons, that don't have the heavy or special property, are kensei weapons for me",
					"At least one ranged and one melee weapon, more at higher levels (longbow does qualify)",
					"With these: proficient, count as a monk weapons, special bonuses depending on type held:",
					"\u2022 Melee: if I do unarmed strike during an Attack action, +2 AC until my next turn starts",
					"\u2022 Ranged: as a bonus action, ranged weapon attacks deal +1d4 damage in current turn"
				]),
				action : ["bonus action", " (with ranged)"],
				additional : levels.map( function(n) { return n < 3 ? "" : (n < 6 ? 2 : n < 11 ? 3 : n < 17 ? 4 : 5) + " kensei weapons"; }),
				toolProfs : ["calligrapher's or painter's supplies"],
				extraname : "Kensei Weapon",
				extrachoices : [], // add these dynamically, see below
				extraTimes : levels.map( function(n) { return n < 3 ? 0 : n < 6 ? 2 : n < 11 ? 3 : n < 17 ? 4 : 5; }),
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							var theKenseiWeapons = GetFeatureChoice("class", "monkua", "subclassfeature3", true);
							if (theKenseiWeapons.indexOf(v.baseWeaponName) != -1 || ((/kensei/i).test(v.WeaponTextName) && !v.theWea.special && (!(/heavy|special/i).test(fields.Description) || v.baseWeaponName === 'longbow'))) {
								v.theWea.monkweapon = true;
								v.theWea.kenseiweapon = true;
								if (v.isRangedWeapon) {
									fields.Description += (fields.Description ? '; ' : '') + 'As bonus action with Attack action, +1d4 damage';
								};
								fields.Proficiency = true;
							};
						},
						"For the weapons that I select using the \"Choose Feature\" button on the second page or when I include the word 'Kensei' in the name of a weapon that doesn't have the Heavy or Special attribute, or that is a longbow, that weapon gains the same benefits as any other 'Monk Weapon'.\nIn addition, with ranged 'Kensei Weapons', I can take a bonus action to have that hit, and any other hit after that as part of the same action, do +1d4 damage.",
						1
					]
				}
			},
			"ki-empowered strikes" : {
				name : "One with the Blade",
				source : [["X", 34]],
				minlevel : 6,
				description : "\n   " + "My unarmed strikes and kensei weapon attacks count as magical",
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (!v.isSpell && !v.thisWeapon[1] && !v.theWea.isMagicWeapon && !(/counts as( a)? magical/i).test(fields.Description) && (v.baseWeaponName === "unarmed strike" || v.theWea.kenseiweapon)) {
								fields.Description += (fields.Description ? '; ' : '') + 'Counts as magical';
							};
						},
						"My unarmed strikes and any Kensei Weapons count as magical for overcoming resistances and immunities."
					]
				},
				"deft strike" : {
					name : "Deft Strike",
					extraname : "Warrior of the Kensei 6",
					source : [["X", 35]],
					description : "\n   " + "Once per turn when I hit with a kensei weapon, I can do a martial arts die extra damage",
					additional : "1 Discipline Point"
				},
				"sharpen the blade" : {
					name : "Sharpen the Blade",
					extraname : "Warrior of the Kensei 11",
					source : [["X", 35]],
					description : desc([
						"As a bonus action, I can grant my kensei weapon a bonus to attack and damage rolls",
						"This bonus is equal to the number of Discipline Points I spend and doesn't stack with magic",
						"This lasts for 1 minute or until I use this feature again"
					]),
					additional : "1 to 3 Discipline Points",
					action : ["bonus action", ""]
				},
				autoSelectExtrachoices : [{
					extrachoice : "deft strike"
				}, {
					extrachoice : "sharpen the blade",
					minlevel : 11
				}]
			},
			"subclassfeature17" : {
				name : "Unerring Accuracy",
				source : [["X", 35]],
				minlevel : 17,
				description : "\n   " + "Once per turn, if I miss a monk weapon attack on my turn, I can reroll the attack roll"
			}
		}
	});
	var itsFea = ClassSubList[theKenseiSubclassName].features.subclassfeature3;
	for (var weapon in WeaponsList) {
		var aWea = WeaponsList[weapon];
		// skip attacks that are not simple or martial weapons, that have the heavy or special property, are magic weapons, or those that are spells or cantrips
		if (weapon !== "longbow" && (aWea.isMagicWeapon || !(/simple|martial/i).test(aWea.type) || (/heavy|special/i).test(aWea.description) || aWea.special || (/spell|cantrip/i).test(aWea.list))) continue;
		itsFea.extrachoices.push(aWea.name);
		itsFea[aWea.name.toLowerCase()] = {
			name : aWea.name,
			description : "",
			source : aWea.source,
			weaponProfs : [false, false, [weapon]],
			weaponsAdd : [aWea.name],
			submenu : ((/simple/i).test(aWea.type) ? "\x1BSimple weapon, " : "Martial weapon, ") + ((/^(?!.*melee).*\d+.*$/i).test(aWea.range) ? "ranged" : "melee"),
			prereqeval : 'testSource("' + weapon + '", WeaponsList["' + weapon + '"], "weapExcl") ? "skip" : true;'
		}
	}
});

// Add Paladin subclasses
AddSubClass("paladin_ua23pt6", "oathbreaker", {
	regExpSearch : /^((?=.*blackguard)|((?=.*(oath.*breaker|breaker.*oath))((?=.*paladin)|((?=.*(exalted|sacred|holy))(?=.*(knight|fighter|warrior|warlord)))))).*$/i,
	subname : "Oathbreaker",
	source : [["D", 97]],
	features : {
		"subclassfeature3" : {
			name : "Channel Divinity: Control Undead",
			source : [["D", 97]],
			minlevel : 3,
			description : "\n   " + "As an action, one undead (CR < paladin level) I can see in 30 ft must make a Wis save" + "\n   " + "If failed, it must obey my commands for 24 hours or until I use this on another",
			action : ["action", ""],
			spellcastingExtra : ["hellish rebuke", "inflict wounds", "crown of madness", "darkness", "animate dead", "bestow curse", "blight", "confusion", "contagion", "dominate person"]
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Dreadful Aspect",
			source : [["D", 97]],
			minlevel : 3,
			description : "\n   " + "As an action, anyone I choose within 30 ft that can see me must make a Wisdom save" + "\n   " + "If failed, it is frightened for 1 min or until it succeeds a save at the end of its turns" + "\n   " + "It can't save at the end of its turn if it's still within 30 ft of me",
			action : ["action", ""]
		},
		"subclassfeature7" : {
			name : "Aura of Hate",
			source : [["D", 97]],
			minlevel : 7,
			description : "\n   " + "Fiends/undead within range and I add my Cha mod as bonus on melee weapon damage" + "\n   " + "Multiple Auras of Hate don't stack; only the strongest applies",
			additional : ["", "", "", "", "", "", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "10-foot aura", "30-foot aura", "30-foot aura", "30-foot aura"],
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.isMeleeWeapon) {
							fields.Description += (fields.Description ? '; ' : '') + 'Cha mod added to damage';
						}
					},
					"I add my Charisma modifier to my melee weapon damage."
				],
				atkCalc : [
					function (fields, v, output) {
						if (v.isMeleeWeapon) {
							output.extraDmg += Number(What("Cha Mod"));
						};
					}
				]
			}
		},
		"subclassfeature15" : {
			name : "Supernatural Resistance",
			source : [["D", 97]],
			minlevel : 15,
			description : "\n   " + "I have resistance to bludgeoning/piercing/slashing damage from nonmagical weapons",
			dmgres : [["Bludgeoning", "Bludg. (nonmagical)"], ["Piercing", "Pierc. (nonmagical)"], ["Slashing", "Slash. (nonmagical)"]]
		},
		"subclassfeature20" : {
			name : "Dread Lord",
			source : [["D", 97]],
			minlevel : 20,
			description : "\n   " + "As a Bonus Action, I gain a 30-ft aura of gloom that reduces bright light to dim for 1 min" + "\n   " + "If frightened of me, foes starting their turn in the aura take 4d10 psychic damage" + "\n   " + "Attacks vs. my allies and me inside the aura have disadvantage if attackers need sight" + "\n   " + "As a bonus action, I can make a melee spell attack vs. a target inside the aura" + "\n   " + "If this attack hits, it does 3d10 + Charisma modifier necrotic damage" + "\n   " + "I can do this once per long rest, or by expending a 5th-level or higher spell slot (SS 5+)",
			recovery : "long rest",
			usages : 1,
			altResource : "SS 5+",
			action : ["bonus action", ""]
		}
	}
});
AddSubClass("paladin_ua23pt6", "oath of the crown", {
	regExpSearch : /^(?=.*(crown|king))(((?=.*paladin)|((?=.*(exalted|sacred|holy))(?=.*(knight|fighter|warrior|warlord))))).*$/i,
	subname : "Oath of the Crown",
	source : [["S", 133]],
	features : {
		"subclassfeature3" : {
			name : "Channel Divinity: Champion Challenge",
			source : [["S", 133]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can have any chosen creatures within 30 ft of me make a Wis save",
				"If failed, a target is unable to willingly move more than 30 ft away from me",
				"The effect ends if I'm incapacitated, die, or it is moved more than 30 ft away from me"
			]),
			action : [["bonus action", ""]], // changed to bonus action per errata (v1.0, 2017)
			spellcastingExtra : ["command", "compelled duel", "warding bond", "zone of truth", "aura of vitality", "spirit guardians", "banishment", "banishment ua22cs", "guardian of faith", "circle of power", "geas"]
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Turn the Tide",
			source : [["S", 133]],
			minlevel : 3,
			description : "\n   " + "As a bonus action, any chosen creatures within 30 ft that can hear me regains HP" + "\n   " + "Each regain 1d6 + my Charisma modifier HP, up to half of its total HP",
			action : ["bonus action", ""]
		},
		"subclassfeature7" : {
			name : "Divine Allegiance",
			source : [["S", 133]],
			minlevel : 7,
			description : "\n   " + "When a creature within 5 feet of me takes damage, I can substitute my HP for it" + "\n   " + "The creature takes no damage and I take all of it; this damage can't be prevented",
			action : ["reaction", ""]
		},
		"subclassfeature15" : {
			name : "Unyielding Spirit",
			source : [["S", 133]],
			minlevel : 15,
			description : "\n   " + "I have advantage on saving throws against effects that paralyze or stun",
			savetxt : { adv_vs : ["paralyzed", "stunned"] }
		},
		"subclassfeature20" : {
			name : "Exalted Champion",
			source : [["S", 133]],
			minlevel : 20,
			description : desc([
				"As a Bonus Action, I gain the following benefits for 1 hour or until I'm incapacitated:",
				" \u2022 " + "Resistance to bludgeoning, piercing, and slashing damage from nonmagical weapons",
				" \u2022 " + "My allies within 30 ft of me and I have advantage on Wisdom and Death saves",
				"I can do this once per long rest, or by expending a 5th-level or higher spell slot (SS 5+)",
			]),
			recovery : "long rest",
			usages : 1,
			altResource : "SS 5+",
			action : ["bonus action", ""]
		}
	}
});
AddSubClass("paladin_ua23pt6", "oath of conquest", {
	regExpSearch : /^((?=.*(knight tyrant|iron mongers))|((?=.*(conquest|tyrant))(((?=.*paladin)|((?=.*(exalted|sacred|holy))(?=.*(knight|fighter|warrior|warlord))))))).*$/i,
	subname : "Oath of Conquest",
	source : [["X", 37]],
	features : {
		"subclassfeature3" : {
			name : "Channel Divinity: Conquering Presence",
			source : [["X", 38]],
			minlevel : 3,
			description : desc([
				"As an action, all creatures of my choice within a 30-ft radius must make a Wisdom save",
				"If failed, a target is frightened for 1 minute; It can save again at the end of each turn"
			]),
			action : ["action", ""],
			spellcastingExtra : ["armor of agathys", "command", "hold person", "spiritual weapon", "spiritual weapon ua22cs", "bestow curse", "fear", "dominate beast", "stoneskin", "cloudkill", "dominate person"]
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Guided Strike",
			source : [["X", 38]],
			minlevel : 3,
			description : "\n   " + "When I make an attack roll, I can add a +10 bonus to the roll after seeing the d20 roll"
		},
		"subclassfeature7" : {
			name : "Aura of Conquest",
			source : [["X", 38]],
			minlevel : 7,
			description : desc([
				"Creatures that are frightened of me have their speed reduced to 0 while in my aura",
				"They also take psychic damage whenever they start theirs turn within my aura"
			]),
			additional : levels.map(function (n) {
				if (n < 7) return "";
				return (n < 18 ? 10 : 30) + "-foot aura; " + Math.floor(n / 2) + " psychic damage";
			})
		},
		"subclassfeature15" : {
			name : "Scornful Rebuke",
			source : [["X", 38]],
			minlevel : 15,
			description : desc([
				"Whenever I'm hit with an attack while I'm not incapacitated, the attacker takes damage",
				"This is psychic damage equal to my Charisma modifier (minimum of 1)"
			])
		},
		"subclassfeature20" : {
			name : "Invincible Conqueror",
			source : [["X", 38]],
			minlevel : 20,
			description : desc([
				"As a Bonus Action, I can gain the following benefits for 1 minute:",
				" - I have resistance to all damage",
				" - I can make an additional attack as part of my Attack action",
				" - My melee weapons score critical hits on a roll of 19 or 20",
				"I can do this once per long rest, or by expending a 5th-level or higher spell slot (SS 5+)",
			]),
			recovery : "long rest",
			usages : 1,
			altResource : "SS 5+",
			action : ["action", ""]
		}
	}
});
AddSubClass("paladin_ua23pt6", "oath of redemption", {
	regExpSearch : /^((?=.*redeemer)|((?=.*redemption)(((?=.*paladin)|((?=.*(exalted|sacred|holy))(?=.*(knight|fighter|warrior|warlord))))))).*$/i,
	subname : "Oath of Redemption",
	source : [["X", 38]],
	features : {
		"subclassfeature3" : {
			name : "Channel Divinity: Emissary of Peace",
			source : [["X", 39]],
			minlevel : 3,
			description : "\n   " + "As a bonus action, I grant myself +5 on Charisma (Persuasion) checks for 10 minutes",
			action : ["bonus action", ""],
			spellcastingExtra : ["sanctuary", "sleep", "calm emotions", "hold person", "counterspell", "hypnotic pattern", "otiluke's resilient sphere", "stoneskin", "hold monster", "wall of force"]
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Rebuke the Violent",
			source : [["X", 39]],
			minlevel : 3,
			description : desc([
				"As a reaction after a creature within 30 ft attacks and damages another, I can rebuke it",
				"It takes the same damage as it dealt but as radiant damage, with a Wis save to halve it"
			]),
			action : ["reaction", ""]
		},
		"subclassfeature7" : {
			name : "Aura of the Guardian",
			source : [["X", 39]],
			minlevel : 7,
			description : desc([
				"As a reaction when an ally within my aura takes damage, I instead take the damage",
				"This damage can't be reduced in any way; Other effects might still apply to my ally"
			]),
			additional : levels.map(function (n) { return n < 7 ? "" : (n < 18 ? 10 : 30) + "-foot aura"; }),
			action : ["reaction", ""]
		},
		"subclassfeature15" : {
			name : "Protective Spirit",
			source : [["X", 39]],
			minlevel : 15,
			description : "\n   " + "At the end of my turn when I'm below half HP and not incapacitated, I regain HP",
			additional : levels.map(function (n) { return n < 15 ? "" : "1d6+" + Math.floor(n/2) + " HP"; })
		},
		"subclassfeature20" : {
			name : "Emissary of Redemption",
			source : [["X", 39]],
			minlevel : 20,
			description : desc([
				"When taking damage from a creature, I take only half and it takes the other half",
				"This stops working on any that I attack or force to make a save, until I have a long rest"
			]),
			dmgres : ["All from creatures"]
		}
	}
});
AddSubClass("paladin_ua23pt6", "oath of the watchers", {
	regExpSearch : /^(?=.*watchers)((?=.*paladin)|((?=.*(exalted|sacred|holy))(?=.*(knight|fighter|warrior|warlord)))).*$/i,
	subname : "Oath of the Watchers",
	source : [["T", 54]],
	features : {
		"subclassfeature3" : {
			name : "Channel Divinity: Watcher's Will",
			source : [["T", 55]],
			minlevel : 3,
			description : "\n   As an action, Cha mod of creatures I see in 30 ft adv. on Int/Wis/Cha saves for 1 min",
			action : [["action", ""]],
			spellcastingExtra : ["alarm", "detect magic", "moonbeam", "see invisibility", "counterspell", "nondetection", "aura of purity", "banishment", "banishment ua22cs", "hold monster", "scrying"]
		},
		"subclassfeature3.1" : {
			name : "Channel Divinity: Abjure the Extraplanar",
			source : [["T", 55]],
			minlevel : 3,
			description : desc([
				"As an action, all aberration, celestial, elemental, fey, fiend in 30 ft must make Wis save",
				"Succeeds if it can't hear me; On fail, turned for 1 minute or until it takes any damage",
				"Turned: move away, never within 30 ft of me, no reactions or actions other than Dash",
				"Turned: may Dodge instead of Dash when nowhere to move and unable to escape bonds"
			]),
			action : [["action", ""]]
		},
		"subclassfeature7" : {
			name : "Aura of the Sentinel",
			source : [["T", 55]],
			minlevel : 7,
			description : "\n   If I'm not incapacitated, chosen creatures in range and I add my Prof Bonus to Initiative",
			additional : levels.map(function (n) { return n < 7 ? "" : (n < 18 ? 10 : 30) + "-foot aura"; }),
			addMod : [{ type : "skill", field : "Init", mod : "prof", text : "I can add my Proficiency Bonus to initiative rolls." }]
		},
		"subclassfeature15" : {
			name : "Vigilant Rebuke",
			source : [["T", 55]],
			minlevel : 15,
			description : desc([
				"As a reaction when I or another I can see succeeds a Int, Wis, or Cha save, I can rebuke",
				"The creature that forced the saving throw takes 2d8 + my Charisma mod force damage"
			]),
			action : [["reaction", ""]]
		},
		"subclassfeature20" : {
			name : "Mortal Bulwark",
			source : [["T", 55]],
			minlevel : 20,
			description : desc([
				"As a Bonus Action, I can gain the following benefits for 1 minute:",
				" \u2022 Truesight 120 ft; Adv. on attacks vs. aberrations, celestials, elementals, fey, and fiends",
				" \u2022 When I hit and damage a creature with an attack, I can banish it if it fails a Cha save",
				"   It's banished to its native plane if not there now; It's immune for 24 hours on a success",
				"I can do this once per long rest, or by expending a 5th-level or higher spell slot (SS 5+)"
			]),
			recovery : "long rest",
			usages : 1,
			altResource : "SS 5+",
			action : [["bonus action", ""]]
		}
	}
});

// Add Ranger subclasses
AddSubClass("ranger_ua23pt6", "horizon walker", {
	regExpSearch : /^(?=.*horizon)(?=.*walker).*$/i,
	subname : "Horizon Walker",
	source : [["X", 42]],
	fullname : "Horizon Walker (UA:PT-vi)",
	features : {
		"subclassfeature3" : {
			name : "Detect Portal",
			source : [["X", 42]],
			minlevel : 3,
			description : "\n   " + "As an action, I sense the distance and direction to the closest planar portal within 1 mile",
			usages : 1,
			recovery : "short rest",
			action : ["action", ""]
		},
		"subclassfeature3.1" : {
			name : "Horizon Walker Magic",
			source : [["X", 42]],
			minlevel : 3,
			description : desc([
				"I add a spell to my known spells at level 3, 5, 9, 13, and 17",
				"These count as ranger spells, but do not count against the number of spells I can know"
			]),
			spellcastingExtra : ["protection from evil and good", "misty step", "haste", "banishment", "banishment ua22cs", "teleportation circle"],
			spellcastingExtraApplyNonconform : true
		},
		"subclassfeature3.2" : {
			name : "Planar Warrior",
			source : [["X", 42]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I choose one creature that I can see within 30 ft of me",
				"All damage from my first weapon attack that hits it on this turn becomes force damage",
				"In addition, that first hit does extra damage"
			]),
			additional : levels.map(function (n) { return n < 3 ? "" : "+" + (n < 11 ? 1 : 2) + "d8 force damage"; }),
			action : ["bonus action", ""]
		},
		"subclassfeature7" : {
			name : "Ethereal Step",
			source : [["X", 43]],
			minlevel : 7,
			description : "\n   " + "As a bonus action, I can cast the Etherealness spell, which lasts until the end of my turn",
			usages : 1,
			recovery : "short rest",
			spellcastingBonus : {
				name : "Ethereal Step",
				spells : ["etherealness"],
				selection : ["etherealness"],
				firstCol : 'oncesr'
			},
			spellChanges : {
				"etherealness" : {
					time : "1 bns",
					duration : "1 rnd",
					description : "I go to Ethereal Plane; move there, but able to perceive 60 ft into the normal plane",
					changes : "Using my Ethereal Step class feature I can cast Etherealness as a bonus action once per short rest, but it only affects myself and lasts until the end of my turn."
				}
			}
		},
		"subclassfeature11" : {
			name : "Distant Strike",
			source : [["X", 43]],
			minlevel : 11,
			description : desc([
				"With the Attack action, I can teleport 10 ft before each attack, to a place I can see",
				"If I attack two different creatures with this action, I get an extra attack against a third"
			])
		},
		"subclassfeature15" : {
			name : "Spectral Defense",
			source : [["X", 43]],
			minlevel : 15,
			description : "\n   " + "As a reaction when an attack damages me, I can give myself resistance vs. that attack",
			action : ["reaction", ""]
		}
	}
});
AddSubClass("ranger_ua23pt6", "monster slayer", {
	regExpSearch : /^(?=.*monster)(?=.*slayer).*$/i,
	subname : "Monster Slayer",
	source : [["X", 43]],
	fullname : "Monster Slayer (UA:PT-vi)",
	features : {
		"subclassfeature3" : {
			name : "Hunter's Sense",
			source : [["X", 43]],
			minlevel : 3,
			description : desc([
				"As an action, I learn vulnerabilities/immunities/resistances of a target I see within 60 ft",
				"If it is protected from divination magic, I sense it has none of these"
			]),
			action : ["action", ""],
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest"
		},
		"subclassfeature3.1" : {
			name : "Monster Slayer Magic",
			source : [["X", 43]],
			minlevel : 3,
			description : "\n   " + "I get bonus spells known, which do not count against the number of spells I can know",
			spellcastingExtra : ["protection from evil and good", "zone of truth", "magic circle", "banishment", "banishment ua22cs", "hold monster"],
			spellcastingExtraApplyNonconform : true
		},
		"subclassfeature3.2" : {
			name : "Slayer's Prey",
			source : [["X", 43]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I designate a creature I see within 60 ft; This lasts until I do this again",
				"My first hit to the target with a weapon attack on each of my turns does +1d6 damage"
			]),
			action : ["bonus action", ""]
		},
		"subclassfeature7" : {
			name : "Supernatural Defense",
			source : [["X", 43]],
			minlevel : 7,
			description : desc([
				"I add 1d6 to saving throws the current target of my Slayer's Prey forces me to make",
				"In addition, I also add 1d6 to checks to escape that target's grapple"
			])
		},
		"subclassfeature11" : {
			name : "Magic-User's Nemesis",
			source : [["X", 43]],
			minlevel : 11,
			description : desc([
				"As a reaction when I see someone within 60 ft casting a spell or teleporting, I can foil it",
				"The target must make a Wisdom save or have its spell or teleport fail and be wasted"
			]),
			action : ["reaction", ""],
			usages : 1,
			recovery : "short rest"
		},
		"subclassfeature15" : {
			name : "Slayer's Counter",
			source : [["X", 43]],
			minlevel : 15,
			description : desc([
				"As a reaction when the target of my Slayer's Prey has me make a save, I can attack it",
				"I can make one weapon attack; If this hits, I automatically succeed on the saving throw"
			]),
			action : ["reaction", ""]
		}
	}
});
AddSubClass("ranger_ua23pt6", "fey wanderer", {
	regExpSearch : /^(?=.*fey)(?=.*wanderer).*$/i,
	subname : "Fey Wanderer",
	source : [["T", 58]],
	fullname : "Fey Wanderer (UA:PT-vi)",
	features : {
		"subclassfeature3" : {
			name : "Dreadful Strikes",
			source : [["T", 58]],
			minlevel : 3,
			description : desc([
				"My weapons deal extra psychic damage, but only once per turn per creature"
			]),
			additional : levels.map(function (n) {
				return n < 3 ? "" : "+1d" + (n < 11 ? 4 : 6) + " psychic damage";
			}),
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.isWeapon && (classes.known.ranger || classes.known.rangerua)) {
							var rngrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.rangerua.level;
							fields.Description += (fields.Description ? '; ' : '') + 'Once per turn per target +1d' + (rngrLvl < 11 ? 4 : 6) + ' psychic damage';
						};
					},
					"When I hit a creature with a weapon, I can deal an extra 1d4 psychic damage to the target, which can take this extra damage only once per turn. From 11th-level, this damage increases to 1d6."
				]
			}
		},
		"subclassfeature3.1" : {
			name : "Fey Wanderer Magic",
			source : [["T", 58]],
			minlevel : 3,
			description : "\n   I get bonus spells known, which do not count against the number of spells I can know",
			spellcastingExtra : ["charm person", "misty step", "dispel magic", "dimension door", "mislead"],
			spellcastingExtraApplyNonconform : true
		},
		"subclassfeature3.2" : {
			name : "Otherworldly Glamour",
			source : [["T", 59]],
			minlevel : 3,
			description : desc([
				"I can add my Wisdom modifier to any Charisma check I make (minimum of +1)",
				'I gain proficiency in Deception, Performance, or Persuasion; Use "Choose Feature" button'
			]),
			addMod : ["Deception", "Intimidation", "Performance", "Persuasion"].map(function(skill){return { type : "skill", field : skill, mod : "max(Wis|1)", text : "I can add my Wisdom modifier to any Charisma check I make (minimum of +1)." };}),
			choices : ["Deception proficiency", "Performance proficiency", "Persuasion proficiency"],
			"deception proficiency" : {
				name : "Otherworldly Glamour",
				description : " [Deception proficiency]\n   I can add my Wisdom modifier to any Charisma check I make (minimum of +1)",
				skills : ["Deception"]
			},
			"performance proficiency" : {
				name : "Otherworldly Glamour",
				description : " [Performance proficiency]\n   I can add my Wisdom modifier to any Charisma check I make (minimum of +1)",
				skills : ["Performance"]
			},
			"persuasion proficiency" : {
				name : "Otherworldly Glamour",
				description : " [Persuasion proficiency]\n   I can add my Wisdom modifier to any Charisma check I make (minimum of +1)",
				skills : ["Persuasion"]
			}
		},
		"subclassfeature7" : {
			name : "Beguiling Twist",
			source : [["T", 59]],
			minlevel : 7,
			description : desc([
				"I have advantage on saves against being charmed or frightened; Below uses my save DC",
				"As a reaction when a creature I see in 120 ft succeeds its save vs. charmed or frightened,",
				"I can have another I see in 120 ft make a Wis save or be charmed/frightened (I choose)",
				"This lasts for 1 minute and the target can repeat the save at the end of each of its turns"
			]),
			action : [["reaction", ""]],
			savetxt : { adv_vs : ["charmed", "frightened"] }
		},
		"subclassfeature11" : {
			name : "Fey Reinforcements",
			source : [["T", 59]],
			minlevel : 11,
			description : desc([
				"I learn Summon Fey; It needs no material component, nor counts against spells known",
				"Once per long rest, I can cast it without expending a spell slot",
				"When I cast it, I can have it not require concentration, but than its duration is 1 minute"
			]),
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				name : "Fey Reinforcements",
				spells : ["summon fey"],
				selection : ["summon fey"],
				firstCol : 'oncelr'
			},
			spellChanges : {
				"summon fey" : {
					components : "V,S",
					compMaterial : "",
					duration : "Conc,1h/1min",
					changes : "Using my Fey Reinforcements class feature, I can cast Summon Fey without requiring material components and I can cast it once per long rest without requiring a spell slot. Whenever I start casting the spell, I can modify it so that it doesn't require concentration. If I do so, the spell's duration becomes 1 minute for that casting."
				}
			}
		},
		"subclassfeature15" : {
			name : "Misty Wanderer",
			source : [["T", 59]],
			minlevel : 15,
			description : desc([
				"I can cast Misty Step without a spell slot and can bring a willing creature in 5 ft along"
			]),
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest",
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (spellKey === "misty step") {
							spellObj.firstCol = "Sp";
							spellObj.description = "I and one willing creature I can see within 5 ft of me teleport 30 ft to a unoccupied space I can see";
							return true;
						}
						return false;
					},
					"Whenever I cast misty step, I can bring along one willing creature I can see within 5 ft of me. That creature teleports to an unoccupied space of my choice within 5 ft of my destination space.\nI can cast Misty Step without expending a spell slot a number of times per long rest equal to my Wisdom modifier (minimum of once)."
				]
			}
		}
	}
});
AddSubClass("ranger_ua23pt6", "swarmkeeper", {
	regExpSearch : /swarmkeeper/i,
	subname : "Swarmkeeper",
	source : [["T", 59]],
	fullname : "Swarmkeeper (UA:PT-vi)",
	features : {
		"subclassfeature3" : {
			name : "Gathered Swarm",
			source : [["T", 60]],
			minlevel : 3,
			description : levels.map(function (n) {
				var a = [
					"I'm bonded to a swarm of nature spirits crawling in my space; I choose their appearance",
					"Once on each of my turns, I can have it assist me after I hit a creature with an attack:",
					" \u2022 The target takes an extra 1d" + (n < 11 ? 6 : 8) + " piercing damage from the swarm",
					" \u2022 The target must make a Strength save or be moved 15 ft horizontally by the swarm",
					" \u2022 The swarm moves me 5 ft horizontally" + (n < 11 ? "" : " and I have half cover until my next turn starts"),
					"I get to choose the direction whenever the target or I'm moved by the swarm"
				];
				if (n >= 11) a.splice(4, 0, "   Additionally, on a failed save, I can also have the target be knocked prone");
				if (n >= 20) a.pop();
				return desc(a);
			})
		},
		"subclassfeature3.1" : {
			name : "Swarmkeeper Magic",
			source : [["T", 60]],
			minlevel : 3,
			description : desc([
				"I learn Mage Hand; When cast, its hand takes the form of my swarming nature spirits",
				"I get bonus spells known, which do not count against the number of spells I can know"
			]),
			spellcastingBonus : {
				name : "Swarmkeeper Magic",
				spells : ["mage hand"],
				selection : ["mage hand"],
				firstCol : "atwill"
			},
			spellcastingExtra : ["faerie fire", "web", "gaseous form", "arcane eye", "insect plague"],
			spellcastingExtraApplyNonconform : true
		},
		"subclassfeature7" : {
			name : "Writhing Tide",
			source : [["T", 60]],
			minlevel : 7,
			description : desc([
				"As a bonus action, I can fly on my swarm for 1 minute: 10 ft flying speed and can hover"
			]),
			action : [["bonus action", ""]],
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature11" : {
			name : "Mighty Swarm",
			source : [["T", 60]],
			minlevel : 11,
			description : " [improves Gathered Swarm, see above]\n   Now 1d8 damage, knocks prone on failed save, or grants me half cover until next turn"
		},
		"subclassfeature15" : {
			name : "Swarming Dispersal",
			source : [["T", 60]],
			minlevel : 15,
			description : desc([
				"As a reaction when I take damage, I can gain resistance to that damage and teleport",
				"I vanish into my swarm and teleport to an unoccupied space within 30 ft that I can see"
			]),
			action : [["reaction", ""]],
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		}
	}
});
AddSubClass("ranger_ua23pt6", "drakewarden", {
	regExpSearch : /^(?=.*(drake|dragon|draconic))(?=.*(warden|ranger|trainer)).*$/i,
	subname : "Drakewarden",
	source : [["FToD", 15]],
	fullname : "Drakewarden (UA:PT-vi)",
	features : {
		"subclassfeature3" : {
			name : "Draconic Gift",
			source : [["FToD", 15]],
			minlevel : 3,
			description : desc([
				"I learn the Draconic language and the Thaumaturgy cantrip"
			]),
			languageProfs : ["Draconic"],
			spellcastingBonus : [{
				name : "Draconic Gift",
				spells : ["thaumaturgy"],
				selection : ["thaumaturgy"],
				firstCol : "atwill"
			}]
		},
		"subclassfeature3.1" : {
			name : "Drake Companion",
			source : [["FToD", 15]],
			minlevel : 3,
			description : desc([
				"As an action, I can summon my drake to appear in an empty space within 30 ft",
				'Select a "Drake Companion" on the companion page for its stats and rules',
				"I can do this once per long rest, or by expending a 1st-level or higher spell slot (SS 1+)"
			]),
			usages : 1,
			recovery : "long rest",
			altResource : "SS 1+",
			action : [["action", " (summon)"], ["bonus action", " (command)"]],
			creaturesAdd : [["Drake Companion", true]],
			creatureOptions : [{
				name : "Drake Companion",
				source : [["FToD", 15]],
				size : 4,
				type : "Dragon",
				alignment : "Unaligned",
				ac : "14+Prof",
				hp : 20,
				hd : [3, 10],
				hdLinked : ["ranger", "rangerua", "ranger_ua23pt6"],
				minlevelLinked : ["ranger", "rangerua", "ranger_ua23pt6"],
				speed : "40 ft",
				scores : [16, 12, 15, 8, 14, 8],
				saves : ["", 3, "", "", 4, ""],
				damage_immunities : "the chosen Draconic Essence damage type",
				senses : "Darkvision 40 ft",
				passivePerception : 12,
				languages : "Draconic",
				challengeRating : "0",
				proficiencyBonus : 2,
				proficiencyBonusLinked : true,
				attacksAction : 1,
				attacks : [{
					name : "Bite",
					ability : 1,
					damage : [1, 6, "piercing"],
					modifiers : ["", "Prof"],
					range : "Melee (5 ft)",
					description : "", //+1d6 damage of the chosen Draconic Essense type
					abilitytodamage : false
				}],
				features : [{
					name : "Warden",
					description : "The drake obeys the commands of its warden and shares its proficiency bonus. It takes its turn immediately after that of its warden, on the same initiative. It can move and take reactions on its own, but only takes the Dodge action on its turn unless its warden takes a bonus action to command it to take another action. If its warden is incapacitated, the drake can take any action, not just Dodge. The drake vanishes when it is reduced to 0 hit points, when its warden summons another drake, or when its warden dies."
				}],
				traits : [{
					name : "Draconic Essence",
					description : "Chosen when summoned: acid, cold, fire, lightning, or poison damage."
				}, {
					name : "Infused Strikes",
					description : "As a reaction when another creature within 30 ft of the drake that it can see hits with a weapon attack, the drake can infuse the strike with its essence, causing the attack to deal an extra 1d6 damage of its chosen Draconic Essence damage type"
				}, {
					name : "Bond of Fang and Scale (Drakewarden 7)",
					minlevel : 7,
					description : "The drake is now Medium and can be ridden as a mount. It has a flying speed equal to its walking speed, but can't fly with a rider on its back. The drake's bite deals an extra 1d6 damage of its chosen Draconic Essence type.",
					eval : function(prefix, lvl) {
						var sMoveStr = (typePF ? ",\n" : ", ") + "fly 40 ft";
						if (What("Unit System") === "metric") sMoveStr = ConvertToMetric(sMoveStr, 0.5);
						tDoc.getField(prefix + "Comp.Use.Speed").value += sMoveStr;
						AddString(prefix + "Comp.Use.Attack.1.Description", "+1d6 damage of the chosen Draconic Essense type");
						PickDropdown(prefix + "Comp.Desc.Size", 3); // Medium
					},
					removeeval : function(prefix, lvl) {
						var sMoveStr = (typePF ? ",\n" : ", ") + "fly 40 ft";
						if (What("Unit System") === "metric") sMoveStr = ConvertToMetric(sMoveStr, 0.5);
						Value(prefix + "Comp.Use.Speed", What(prefix + "Comp.Use.Speed").replace(sMoveStr, ""));
						var sAtkFld = prefix + "Comp.Use.Attack.1.Description";
						Value(sAtkFld, What(sAtkFld).replace(/\+\d+d6 damage of the chosen Draconic Essense type/i, ''));
						PickDropdown(prefix + "Comp.Desc.Size", 4); // Small
					}
				}, {
					name : "Perfected Bond (Drakewarden 15)",
					minlevel : 15,
					description : "The drake is now Large and can fly while its being ridden. Its bite attack deals an extra 1d6 damage (for a total of +2d6) of its chosen Draconic Essence type.",
					eval : function(prefix, lvl) {
						var sAtkFld = prefix + "Comp.Use.Attack.1.Description";
						Value(sAtkFld, What(sAtkFld).replace(/\+\d+d6 damage of the chosen Draconic Essense type/i, '+2d6 damage of the chosen Draconic Essense type'));
						PickDropdown(prefix + "Comp.Desc.Size", 2); // Large
					},
					removeeval : function(prefix, lvl) {
						var sAtkFld = prefix + "Comp.Use.Attack.1.Description";
						Value(sAtkFld, What(sAtkFld).replace(/\+\d+d6 damage of the chosen Draconic Essense type/i, '+1d6 damage of the chosen Draconic Essense type'));
						PickDropdown(prefix + "Comp.Desc.Size", 3); // Medium
					}
				}],
				calcChanges : {
					hp : function (totalHD, HDobj, prefix) {
						if (!classes.known.ranger_ua23pt6 && !classes.known.rangerua) return;
						var rngrLvl = classes.known.ranger_ua23pt6 ? classes.known.ranger_ua23pt6.level : classes.known.rangerua.level;
						var rngrLvlM = 5 * rngrLvl;
						HDobj.alt.push(5 + rngrLvlM);
						HDobj.altStr.push(" = 5 as a base\n + 5 \xD7 " + rngrLvl + " from five times its warden's ranger level (" + rngrLvlM + ")");
					},
					setAltHp : true
				}
			}]
		},
		"subclassfeature7" : {
			name : "Bond of Fang and Scale",
			source : [["FToD", 15]],
			minlevel : 7,
			description : desc([
				"My drake is now Medium, has a 40 ft fly speed, and can be ridden, but not while flying",
				"The drake's bite attack deals an extra 1d6 damage chosen by its Draconic Essense",
				"While it is summoned, I gain resistance to the damage type of its Draconic Essense"
			]),
			dmgres : ["(See Drake)"]
		},
		"subclassfeature11" : {
			name : "Drake's Breath",
			source : [["FToD", 15]],
			minlevel : 11,
			description : desc([
				"As an action, I can cause my drake or myself to exhale a 30-ft cone breath weapon",
				"Its damage type is acid, cold, fire, lightning, or poison; Dex save to halve the damage",
				"I can do this once per long rest, or by expending a 3rd-level or higher spell slot (SS 3+)"
			]),
			additional : levels.map(function (n) {
				return n < 11 ? "" : (n < 15 ? 8 : 10) + "d6 damage";
			}),
			action : [["action", ""]],
			usages : 1,
			recovery : "long rest",
			altResource : "SS 3+",
			weaponsAdd : ["Drake's Breath"],
			weaponOptions : {
				regExpSearch : /^(?=.*drake)(?=.*breath).*$/i,
				name : "Drake's Breath",
				source : [["FToD", 15]],
				ability : 5,
				type : "Natural",
				damage : [8, 6, "My choice"],
				range : "30-ft cone",
				description : "Hits all in area; Dex save for half damage; Damage type: acid, cold, fire, lightning, or poison",
				abilitytodamage : false,
				dc : true,
				useSpellMod : "ranger_ua23pt6",
				DrakewardenDrakeBreath : true
			},
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.theWea.DrakewardenDrakeBreath && (classes.known.rangerua || classes.known.ranger_ua23pt6)) {
							var rngrLvl = classes.known.ranger_ua23pt6 ? classes.known.ranger_ua23pt6.level : classes.known.rangerua.level;
							fields.Damage_Die = (rngrLvl < 15 ? 8 : 10) + 'd6';
						};
					},
					"",
					1
				],
				atkCalc : [
					function (fields, v, output) {
						if (v.theWea.DrakewardenDrakeBreath && classes.known.rangerua) {
							v.theWea.useSpellMod = "rangerua";
						}
					}
				]
			}
		},
		"subclassfeature15" : {
			name : "Perfected Bond",
			source : [["FToD", 15]],
			minlevel : 15,
			description : desc([
				"My drake is now Large, can serve as a mount, and adds another +1d6 damage to its bite",
				"As a reaction when the drake or I take damage while within 30 ft of each other,",
				"I can give myself or the drake resistance to that instance of damage",
			]),
			action : [["reaction", ""]],
			usages : "proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
			additional : "reaction"
		}
	}
});
AddSubClass("ranger_ua23pt6", "deep stalker-ua", {
	regExpSearch : /^(?=.*deep)(?=.*stalker).*$/i,
	subname : "Deep Stalker",
	source : [["UA:LDU", 1]],
	fullname : "Deep Stalker (UA:PT-vi)",
	features : {
		"subclassfeature3" : {
			name : "Underdark Scout",
			source : [["UA:LDU", 1]],
			minlevel : 3,
			description : "\n   " + "In the first turn of combat I have +10 ft speed and +1 attack with the Attack action" + "\n   " + "All turns after that, I can take the Hide action as a bonus action at the end of my turn",
			action : ["bonus action", " (Hide at end of turn)"]
		},
		"subclassfeature3.1" : {
			name : "Deep Stalker Magic",
			source : [["UA:LDU", 2]],
			minlevel : 3,
			description : "\n   " + "I have 90 ft darkvision and add a spell to my known spells at level 3, 5, 9, 13, and 17" + "\n   " + "These count as ranger spells, but do not count against the number of spells I can know",
			spellcastingExtra : ["disguise self", "rope trick", "glyph of warding", "greater invisibility", "seeming"],
			spellcastingExtraApplyNonconform : true,
			vision : [["Darkvision", 90]]
		},
		"subclassfeature7" : {
			name : "Iron Mind",
			source : [["UA:LDU", 2]],
			minlevel : 7,
			description : "\n   " + "I am proficient with Wisdom saving throws",
			saves : ["Wis"]
		},
		"subclassfeature11" : {
			name : "Stalker's Flurry",
			source : [["UA:LDU", 2]],
			minlevel : 11,
			description : "\n   " + "Once during my turn when I miss an attack, I can immediately make an extra attack"
		},
		"subclassfeature15" : {
			name : "Stalker's Dodge",
			source : [["UA:LDU", 2]],
			minlevel : 15,
			description : "\n   " + "As a reaction when I'm attacked without adv., I can impose disadv. on the attack roll",
			action : ["reaction", " (when attacked)"]
		}
	}
});

// Add Rogue subclasses
AddSubClass("rogue_ua23pt6", "mastermind", {
	regExpSearch : /^(?=.*(rogue|miscreant))(?=.*(mastermind)).*$/i,
	subname : "Mastermind",
	fullname : "Mastermind (UA:PT-vi)",
	source : [["S", 135], ["X", 46]],
	features : {
		"subclassfeature3" : {
			name : "Master of Intrigue",
			source : [["S", 135], ["X", 46]],
			minlevel : 3,
			description : desc([
				"I gain proficiency with disguise kits, forgery kits, one gaming set, and two languages",
				"I can mimic speech patterns and accents if I've heard them for at least 1 minute"
			]),
			languageProfs : [2],
			toolProfs : ["Disguise kit", "Forgery kit", ["Gaming set", 1]]
		},
		"subclassfeature3.1" : {
			name : "Master of Tactics",
			source : [["S", 135], ["X", 46]],
			minlevel : 3,
			description : desc([
				"I can use the Help action as a bonus action",
				"This even works if the ally attacks a target within 30 ft of me that can see or hear me"
			]),
			action : ["bonus action", ""]
		},
		"subclassfeature9" : {
			name : "Insightful Manipulator",
			source : [["S", 135], ["X", 46]],
			minlevel : 9,
			description : desc([
				"By spending 1 minute observing/interacting outside of combat I can learn capabilities",
				"The DM tells me if the target is my equal, superior, or inferior in regard to two things:",
				" - Intelligence score    - Wisdom score    - Charisma score    - Class levels (if any)"
			])
		},
		"subclassfeature13" : {
			name : "Misdirection",
			source : [["S", 135], ["X", 46]],
			minlevel : 13,
			description : desc([
				"As a reaction, I can redirect an attack meant for me to a creature within 5 ft of me",
				"This only works if the creature is providing me with cover against the attack"
			]),
			action : ["reaction", ""]
		},
		"subclassfeature17" : {
			name : "Soul of Deceit",
			source : [["S", 135], ["X", 46]],
			minlevel : 17,
			description : desc([
				"My thoughts can't be read by telepathy or similar means; I can project false thoughts",
				"For that, I must pass a Cha (Deception) vs. Wis (Insight) check to fool the mind reader",
				"Magic always determines I'm truthful; I can't be magically compelled to tell the truth"
			])
		}
	}
});
AddSubClass("rogue_ua23pt6", "inquisitive", {
	regExpSearch : /^(?=.*(rogue|miscreant))(?=.*inquisitive).*$/i,
	subname : "Inquisitive",
	source : [["X", 45]],
	features : {
		"subclassfeature3" : {
			name : "Ear for Deceit",
			source : [["X", 45]],
			minlevel : 3,
			description : "\n   " + "For Wis (Insight) to sense if another is lying, I can treat a die roll of 7 or lower as an 8"
		},
		"subclassfeature3.1" : {
			name : "Eye for Detail",
			source : [["X", 46]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can do either of the following:",
				"\u2022 Make a Wisdom (Perception) check to spot a hidden creature or object",
				"\u2022 Make an Intelligence (Investigation) check to uncover or decipher clues"
			]),
			action : ["bonus action", ""]
		},
		"subclassfeature3.2" : {
			name : "Insightful Fighting",
			source : [["X", 46]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can decipher the tactics of another I can see that's not incapacitated",
				"I have to make a Wisdom (Insight) check vs. the target's Charisma (Deception) check",
				"If I succeed, I can use my sneak attack on it even if I don't have adv. (but not if disadv.)",
				"This benefit lasts for 1 minute or until I successfully use Insightful Fighting again"
			]),
			action : ["bonus action", ""]
		},
		"subclassfeature9" : {
			name : "Steady Eye",
			source : [["X", 46]],
			minlevel : 9,
			description : desc([
				"I'm more perceptive when I don't move more than half my speed in the same turn",
				"If so, I gain adv. on Wis (Perception) and Int (Investigation) checks during that turn"
			])
		},
		"subclassfeature13" : {
			name : "Unerring Eye",
			source : [["X", 46]],
			minlevel : 13,
			description : desc([
				"As an action, I can sense magical deceptions within 30 feet of me, but not what it does",
				"I learn the presence of illusions, shapechanged creatures, or magic designed to deceive"
			]),
			action : ["action", ""],
			usages : "Wisdom modifier per ",
			usagescalc : "event.value = Math.max(1, What('Wis Mod'));",
			recovery : "long rest"
		},
		"subclassfeature17" : {
			name : "Eye for Weakness",
			source : [["X", 46]],
			minlevel : 17,
			description : "\n   " + "While my Insightful Fighting is active, I add 3d6 to sneak attacks against that target"
		}
	}
});
AddSubClass("rogue_ua23pt6", "scout", {
	regExpSearch : /scout/i,
	subname : "Scout",
	source : [["X", 47]],
	features : {
		"subclassfeature3" : {
			name : "Skirmisher",
			source : [["X", 47]],
			minlevel : 3,
			description : desc([
				"As a reaction when a hostile ends its turn within 5 ft of me, I can move half my speed",
				"This movement does not provoke attacks of opportunity"
			]),
			action : [["reaction", ""]]
		},
		"subclassfeature3.1" : {
			name : "Survivalist",
			source : [["X", 47]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency and expertise with the Nature and Survival skills",
			skills : [['Nature', 'full'], ['Survival', 'full']]
		},
		"subclassfeature9" : {
			name : "Superior Mobility",
			source : [["X", 47]],
			minlevel : 9,
			description : "\n   " + "I gain +10 ft to my walking speed (and swimming/climbing speed, if applicable)",
			speed : {
				walk : { spd : "+10", enc : "+10" },
				climb : { spd : "_10", enc : "_10" },
				swim : { spd : "_10", enc : "_10" }
			}
		},
		"subclassfeature13" : {
			name : "Ambush Master",
			source : [["X", 47]],
			minlevel : 13,
			description : desc([
				"I gain advantage on Initiative rolls",
				"The first creature I hit in the first round of combat becomes an easy target",
				"Until the start of my next turn, all attacks against the target have advantage"
			]),
			advantages : [["Initiative", true]]
		},
		"subclassfeature17" : {
			name : "Sudden Strike",
			source : [["X", 47]],
			minlevel : 17,
			description : desc([
				"With the Attack action, I can make one additional attack as a bonus action",
				"This attack can benefit from my Sneak Attack even if I already used it this turn",
				"However, I still can't use Sneak Attack on a single target more than once per turn"
			]),
			action : ["bonus action", " (with Attack action)"]
		}
	}
});
AddSubClass("rogue_ua23pt6", "phantom", {
	regExpSearch : /^(?=.*(rogue|miscreant))(?=.*phantom).*$/i,
	subname : "Phantom",
	source : [["T", 62]],
	fullname : "Phantom (UA:PT-vi)",
	features : {
		"subclassfeature3" : {
			name : "Whispers of the Dead",
			source : [["UA:SR", 1]],
			source : [["T", 62]],
			minlevel : 3,
			description : desc([
				"When I finish a rest, I gain a skill or tool proficiency of my choice until I change it again"
			]),
			skillstxt : "Choose one skill or tool; I can change the choice whenever I finish a short or long rest"
		},
		"subclassfeature3.1" : {
			name : "Wails from the Grave",
			source : [["T", 62]],
			minlevel : 3,
			description : levels.map(function (n) {
				var a = [
					"Directly after I deal sneak attack damage to a creature on my turn, I " + (n < 17 ? "can" : "also") + " harm another",
					n < 17 ? "I then deal half my sneak attack in necrotic damage to a creature I can see within 30 ft" : "I deal half my sneak attack in necrotic damage to both it and another I can see in 30 ft"
				];
				if (n >= 9) a.push("I can do this my Proficiency Bonus per long rest, or by destroying a soul trinket (ST)");
				return desc(a);
			}),
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
			additional : levels.map(function (n) {
				return Math.ceil(n / 4) + "d6";
			}),
			altResource : levels.map(function (n) {
				return n < 9 ? "" : "ST";
			})
		},
		"subclassfeature9" : {
			name : "Tokens of the Departed",
			source : [["T", 63]],
			minlevel : 9,
			description : " [max Proficiency Bonus of soul trinkets]" + desc([
				"As a reaction when I see a creature within 30 ft die, I can create a Tiny soul trinket",
				"The token of its life essence appears in my free hand; The DM determines its appearance",
				"While a soul trinket is on my person, I have advantage on death and Constitution saves",
				"As an action, I can destroy one of my soul trinkets and ask its associated spirit a question",
				"Its spirit appears and answers concisely in a language it knew; Trinket can be anywhere"
			]),
			action : [
				["reaction", "Create Soul Trinket"],
				["action", "Destroy Soul Trinket"]
			],
			extraLimitedFeatures : [{
				name : "Soul Trinkets (max Prof Bonus)",
				usages : "",
				recovery : "Special"
			}],
			savetxt : { text : ["While soul trinket is on me, Adv. on Con and death saves"] }
		},
		"subclassfeature13" : {
			name : "Ghost Walk",
			source : [["T", 63]],
			minlevel : 13,
			description : desc([
				"As a bonus action, I can assume a spectral form with 10 ft flying speed and can hover",
				"Attacks vs. me have disadv.; I can move through creatures and objects as difficult terrain",
				"This lasts 10 min; I take 1d10 force damage if I end my turn inside a creature or object",
				"I can assume this form once per long rest, or by destroying one of my soul trinkets (ST)"
			]),
			action : [["bonus action", " (start/end)"]],
			usages : 1,
			recovery : "long rest",
			altResource : "ST"
		},
		"subclassfeature17" : {
			name : "Death's Friend",
			source : [["T", 63]],
			minlevel : 17,
			description : desc([
				"Wails from the Grave now also deals damage to the target of the original sneak attack",
				"If I don't have any soul trinkets at the end of a long rest, one appears in my hand"
			])
		}
	}
});
AddSubClass("rogue_ua23pt6", "soulknife", {
	regExpSearch : /soulknife/i,
	subname : "Soulknife",
	source : [["T", 63]],
	fullname : "Soulknife (UA:PT-vi)",
	abilitySave : 2,
	features : {
		"subclassfeature3" : {
			name : "Psionic Energy Dice",
			source : [["T", 64]],
			minlevel : 3,
			description : desc([
				"I gain twice my proficiency bonus of psionic energy dice (PsiD) that fuel my psionics",
				"I regain all expended psionic energy dice after a long rest; See psionic powers on page 3",
				"As a bonus action once per short rest, I can regain one expended psionic energy die"
			]),
			additional : levels.map(function(n) {
				return n < 3 ? "" : n < 5 ? "d6" : n < 11 ? "d8" : n < 17 ? "d10" : "d12";
			}),
			action : [["bonus action", "Regain 1 Psionic Energy Die"]],
			usages : "Proficiency Bonus \xD7 2 per ",
			usagescalc : "event.value = Number(How('Proficiency Bonus'))*2",
			recovery : "long rest",
			extraLimitedFeatures : [{
				name : "Regain 1 Psionic Energy die",
				usages : 1,
				recovery : "short rest"
			}],
			extraname : "Soulknife 3",
			"psi-bolstered knack" : {
				name : "Psionic Power: Psi-Bolstered Knack",
				source : [["T", 64]],
				description : " [1 PsiD if successful]" + desc([
					"If I fail an check using a skill or tool I'm proficient with, I can add a psionic energy die to it",
					"The psionic energy die is only expended if this addition turns the failure into a success"
				])
			},
			"psychic whispers" : {
				name : "Psionic Power: Psychic Whispers",
				source : [["T", 64]],
				description : desc([
					"As an action, I can select my Prof Bonus of creatures I can see and roll a psionic energy die",
					"For the roll of hours, I can telepathically communicate with each and they with me",
					"To send or receive messages (no action), we must be within 1 mile of each other",
					"A creature must be able to speak a language to do this; It can end the link at any time",
					"The first time I do this after a long rest, I don't expend the psionic energy die (PsiD)"
				]),
				limfeaname : "Psychic Whispers",
				action : [["action", ""]],
				usages : 1,
				recovery : "long rest",
				altResource : "PsiD"
			},
			autoSelectExtrachoices : [{
				extrachoice : "psi-bolstered knack"
			}, {
				extrachoice : "psychic whispers"
			}]
		},
		"subclassfeature3.1" : {
			name : "Psychic Blades",
			source : [["T", 64]],
			minlevel : 3,
			description : desc([
				"As part of an Attack action, I can manifest a psychic blade from a free hand to attack",
				"It vanishes immediately after making the attack and leaves no mark on its target",
				"As a bonus action after this attack, I can manifest and attack with another psychic blade",
				"To do this, my other hand needs to be free as well and this blade does only 1d4 damage"
			]),
			action : [["bonus action", "Psychic Blade (after Attack action)"]],
			weaponsAdd : ["Psychic Blade"],
			weaponOptions : [{
				regExpSearch : /^(?=.*psychic)(?=.*blade).*$/i,
				name : "Psychic Blade",
				source : [["T", 64]],
				ability : 1,
				type : "Simple",
				damage : [1, 6, "psychic"],
				range : "Melee, 60 ft",
				description : "Finesse, thrown; Bonus action: 1d4 instead of 1d6",
				abilitytodamage : true
			}]
		},
		"subclassfeature9" : {
			name : "Soul Blades",
			source : [["T", 65]],
			minlevel : 9,
			description : desc([
				"My psi-suffused soul grants me more psionic powers, see the 3rd page's \"Notes\" section"
			]),
			extraname : "Soulknife 9",
			"homing strikes" : {
				name : "Homing Strikes",
				source : [["T", 65]],
				description : " [1 PsiD if successful]" + desc([
					"If I miss an attack with my psychic blades, I can add a psionic energy die to the attack roll",
					"The psionic energy die is only expended if this addition turns the miss into a hit"
				])
			},
			"psychic teleportation" : {
				name : "Psychic Teleportation",
				source : [["T", 65]],
				description : " [1 PsiD]" + desc([
					"As a bonus action, I can teleport up to 10 ft away times the roll of my psionic energy die",
					"I manifest a psychic blade and throw it to an empty space I can see before teleporting to it"
				]),
				action : [["bonus action", ""]]
			},
			autoSelectExtrachoices : [{
				extrachoice : "homing strikes"
			}, {
				extrachoice : "psychic teleportation"
			}]
		},
		"subclassfeature13" : {
			name : "Psychic Veil",
			source : [["T", 65]],
			minlevel : 13,
			description : desc([
				"As an action, I can become invisible along with what I'm wearing or carrying for 1 hour",
				"I can end it (no action); It also ends if I damage a creature or force one to make a save",
				"I can do this once per long rest, or by expending a psionic energy die (PsiD)"
			]),
			action : [["action", ""]],
			usages : 1,
			recovery : "long rest",
			altResource : "PsiD"
		},
		"subclassfeature17" : {
			name : "Rend Mind",
			source : [["T", 65]],
			minlevel : 17,
			description : desc([
				"When I use my psychic blade to deal sneak attack damage to a target, I can have it save",
				"It must make a Wisdom save (DC 8 + Prof Bonus + Dex mod) or be stunned for 1 min",
				"It can repeat the save at the end of each of its turns to end being stunned",
				"I can do this once per long rest, or by expending three psionic energy dice (3 PsiD)"
			]),
			action : [["action", ""]],
			usages : 1,
			recovery : "long rest",
			altResource : "3 PsiD"
		}
	}
});
AddSubClass("rogue_ua23pt6", "the revived-ua", {
	regExpSearch : /^(?=.*(rogue|miscreant))(?=.*revived).*$/i,
	subname : "the Revived",
	source : [["UA:FRnR", 4]],
	features : {
		"subclassfeature3" : {
			name : "Tokens of Past Lives",
			source : [["UA:FRnR", 4]],
			minlevel : 3,
			description : "\n   I gain a chosen skill or tool proficiency and can change it whenever I finish a long rest",
			skillstxt : "Choose one skill or tool; I can change the choice whenever I finish a long rest"
		},
		"subclassfeature3.1" : {
			name : "Revived Nature",
			source : [["UA:FRnR", 4]],
			minlevel : 3,
			description : desc([
				"I have resistance to poison damage and adv. on saves against disease and being poisoned",
				"I don't need to eat, drink, breathe, or sleep; I must spend 4 hours inactive for a long rest",
				"I'm motionless during this inactive state, remain semiconscious, and can hear as normal"
			]),
			dmgres : ["Poison"],
			savetxt : { adv_vs : ["disease", "poison"] }
		},
		"subclassfeature3.2" : {
			name : "Bolts from the Grave",
			source : [["UA:FRnR", 5]],
			minlevel : 3,
			description : desc([
				"Immediately after I use my cunning action, I can unleash bolts of necrotic energy",
				"This is a ranged spell attack with 30 ft range, which I'm proficient with, using Dexterity",
				"If it hits, it deals my sneak attack damage, provided I didn't use sneak attack this turn"
			]),
			weaponsAdd : ["Bolts from the Grave"],
			weaponOptions : [{
				regExpSearch : /^(?=.*bolts?)(?=.*grave).*$/i,
				name : "Bolts from the Grave",
				source : [["UA:FRnR", 5]],
				ability : 2,
				type : "Spell",
				damage : [1, 6, "necrotic"],
				range : "30 ft",
				description : "Immediately after using cunning action; Only if I not yet used sneak attack this turn",
				abilitytodamage : true,
				isBoltsFromTheGrave : true
			}],
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (classes.known.rogue && classes.known.rogue.level && v.theWea.isBoltsFromTheGrave) {
							fields.Damage_Die = Math.ceil(classes.known.rogue.level / 2) + 'd6';
						};
					}
				]
			}
		},
		"subclassfeature9" : {
			name : "Connect with the Dead",
			source : [["UA:FRnR", 5]],
			minlevel : 9,
			description : desc([
				"I can cast Speak with Dead without a spell slot or material components using Intelligence",
				"Doing this gives me a random proficiency (roll 1d3) that lasts until I finish my next rest:",
				"[1] language of my choice; [2] skill or tool of my choice; [3] saving throw of my choice"
			]),
			spellcastingBonus : {
				name : "Connect with the Dead",
				spells : ["speak with dead"],
				selection : ["speak with dead"],
				firstCol : "oncesr",
				spellcastingAbility : 4
			},
			spellChanges : {
				"speak with dead" : {
					components : "V,S",
					compMaterial : "",
					changes : "Using Connect with the Dead, I can cast Speak with Dead once per short rest without using a spell slot or material component."
				}
			},
			usages : 1,
			recovery : "short rest"
		},
		"subclassfeature13" : {
			name : "Audience with Death",
			source : [["UA:FRnR", 5]],
			minlevel : 13,
			description : desc([
				"I have adv. on death saves; Whenever I make one, I can ask a question to a death entity",
				'It answers truthfully with "yes", "no", or "unknown", using the knowledge of all that died',
				"When at 0 HP and healed or stabilized, I can change any of my traits/ideals/bonds/flaws"
			]),
			savetxt : { text : ["Adv. on death saves"] },
			autoSelectExtrachoices : [{
				extrachoice : "ethereal jaunt",
				minlevel : 17
			}],
			"ethereal jaunt" : {
				name : "Ethereal Jaunt",
				source : [["UA:FRnR", 5]],
				extraname : "the Revived 17",
				description : desc([
					"I can now use my cunning action to teleport to an unoccupied space within 30 ft",
					"I don't need to see where I'm going, but it fails if I'd go through a magical force effect",
					"I'm shunted if I appear in an occupied space and take force damage of 2\xD7 the ft moved"
				])
			}
		}
	}
});

// Add Sorcerer subclasses
AddSubClass("sorcerer_ua23pt7", "storm sorcery", {
	regExpSearch : /^(?=.*(sorcerer|witch))((?=.*(storm|tempest|hurricane))|((?=.*air)(?=.*element))).*$/i,
	subname : "Storm Sorcery",
	fullname : "Storm Sorcerer (UA:PT-vii)",
	source : [["S", 137], ["X", 51]],
	features : {
		"subclassfeature3" : {
			name : "Wind Speaker",
			source : [["S", 137], ["X", 52]],
			minlevel : 3,
			description : "\n   " + "I can speak, read, and write Primordial (and its dialects Aquan, Auran, Ignan, Terran).",
			languageProfs : ["Primordial"],
		},
		"subclassfeature3.1" : {
			name : "Tempestuous Magic",
			source : [["S", 137], ["X", 52]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, before or after casting a 1st-level or higher spell, I can fly 10 ft.",
				"This movement doesn't provoke opportunity attacks as whirling gust of air surround me."
			]),
			action : ["bonus action", " (with casting)"],
		},
		"subclassfeature6" : {
			name : "Heart of the Storm",
			source : [["S", 137], ["X", 52]],
			minlevel : 6,
			description : desc([
				"I have Resistance to Lightning and Thunder damage.",
				"When I start casting a 1st-level or higher spell that deals Lightning or Thunder damage,",
				"  I deal Lightning or Thunder damage to creatures of my choice that I can see within 10 ft."
			]),
			additional : levels.map(function (n) { return n < 6 ? "" : Math.floor(n/2) + " damage"; }),
			dmgres : ["Lightning", "Thunder"],
		},
		"subclassfeature6.1" : {
			name : "Storm Guide",
			source : [["S", 137], ["X", 52]],
			minlevel : 6,
			description : desc([
				"As an Action, I can stop rain around me in 20-ft radius; Bonus Action for it to resume.",
				"As a Bonus Action, I can choose the direction of wind around me in a 100-ft radius.",
				"This lasts until the end of my next turn and doesn't alter the wind's speed."
			]),
			action : ["bonus action", ""],
		},
		"subclassfeature14" : {
			name : "Storm's Fury",
			source : [["S", 137], ["X", 52]],
			minlevel : 14,
			description : desc([
				"As a Reaction when hit by a melee attack, I can deal Lightning damage to the attacker.",
				"The attacker must also make a Strength save or be pushed up to 20 ft away from me."
			]),
			action : ["reaction", ""],
			additional : levels.map(function (n) { return n < 14 ? "" : n + " Lightning damage"; }),
		},
		"subclassfeature18" : {
			name : "Wind Soul",
			source : [["S", 137], ["X", 52]],
			minlevel : 18,
			description : desc([
				"I have Immunity to Lightning and Thunder damage and gain magical 60 ft Fly Speed.",
				"As an Action, I reduce my fly speed to 30 ft and give allies 30 ft fly speed for 1 hour.",
				"I can do this once per Short Rest for up to 3 + my Charisma modifier allies within 30 ft."
			]),
			action : ["action", ""],
			savetxt : { immune : ["lightning", "thunder"] },
			speed : { fly : { spd : "fixed 60", enc : "fixed 60" } },
			usages : 1,
			recovery : "short rest",
		},
	},
});
AddSubClass("sorcerer_ua23pt7", "divine soul", { // this code includes contributions by SoilentBrad
	regExpSearch : /^(?=.*divine)(?=.*soul).*$/i,
	subname : "Divine Soul",
	source : [["X", 50], ["MJ:HB", 0]],
	fullname : "Divine Soul (UA:PT-vii)",
	spellcastingList : {
		"class" : ["cleric", "cleric_ua23pt6", "sorcerer", "sorcerer_ua23pt7"],
	},
	features : {
		"subclassfeature3" : {
			name : "Divine Magic",
			source : [["X", 50], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"When I change my prepared/known spells/cantrips, I can pick from the Cleric spell list.",
				"These Cleric spells count as Sorcerer spells for me.",
				'I also learn a spell based on my affinity, use the "Choose Feature" button above for this.'
			]),
			choices : ["Good", "Evil", "Law", "Chaos", "Neutrality"],
			"good" : {
				name : "Divine Magic: Good",
				description : desc([
					"When I change my prepared/known spells/cantrips, I can pick from the Cleric spell list.",
					"I also learn Cure Wounds, which doesn't count against my number of spells prepared.",
					"These count as Sorcerer spells for me; I can only replace the bonus spell with a Cleric spell."
				]),
				spellcastingBonus : {
					name : "Divine Magic (Good)",
					"class" : "cleric",
					level : [1,9],
					selection : ["cure wounds", "cure wounds ua23pt8"],
				},
				dependentChoices : "eagle",
			},
			"evil" : {
				name : "Divine Magic: Evil",
				description : desc([
					"When I change my prepared/known spells/cantrips, I can pick from the Cleric spell list.",
					"I also learn Inflict Wounds, which doesn't count against my number of spells prepared.",
					"These count as Sorcerer spells for me; I can only replace the bonus spell with a Cleric spell."
				]),
				spellcastingBonus : {
					name : "Divine Magic (Evil)",
					"class" : "cleric",
					level : [1,9],
					selection : ["inflict wounds"],
				},
				dependentChoices : "bat",
			},
			"law" : {
				name : "Divine Magic: Law",
				description : desc([
					"When I change my prepared/known spells/cantrips, I can pick from the Cleric spell list.",
					"I also learn Bless, which doesn't count against my number of spells prepared.",
					"These count as Sorcerer spells for me; I can only replace the bonus spell with a Cleric spell."
				]),
				spellcastingBonus : {
					name : "Divine Magic (Law)",
					"class" : "cleric",
					level : [1,9],
					selection : ["bless"],
				},
				dependentChoices : "eagle",
			},
			"chaos" : {
				name : "Divine Magic: Chaos",
				description : desc([
					"When I change my prepared/known spells/cantrips, I can pick from the Cleric spell list.",
					"I also learn Bane, which doesn't count against my number of spells prepared.",
					"These count as Sorcerer spells for me; I can only replace the bonus spell with a Cleric spell."
				]),
				spellcastingBonus : {
					name : "Divine Magic (Chaos)",
					"class" : "cleric",
					level : [1,9],
					selection : ["bane"],
				},
				dependentChoices : "bat",
			},
			"neutrality" : {
				name : "Divine Magic: Neutrality",
				description : desc([
					"When I change my prepared/known spells/cantrips, I can pick from the Cleric spell list.",
					"I learn Protection from Evil \xD7 Good; It doesn't count against my number of spells prepared.",
					"These count as Sorcerer spells for me; I can only replace the bonus spell with a Cleric spell."
				]),
				spellcastingBonus : {
					name : "Divine Magic (Neutrality)",
					"class" : "cleric",
					level : [1,9],
					selection : ["protection from evil and good"],
				},
				dependentChoices : "dragonfly",
			},
			choiceDependencies : [{
				feature : "subclassfeature14",
				choiceAttribute : true,
			}],
		},
		"subclassfeature3.1" : {
			name : "Favored by the Gods",
			source : [["X", 50]],
			minlevel : 3,
			description : "\n   " + "If I fail a saving throw or miss with an attack roll, I can add 2d4 to the total.",
			recovery : "short rest",
			usages : 1,
		},
		"subclassfeature6" : {
			name : "Empowered Healing",
			source : [["X", 50]],
			minlevel : 6,
			description : desc([
				"Once per turn, when I or an ally in 5 ft roll dice to healing with a spell, I can reroll dice.",
				"By spending 1 Sorcery Point; I can reroll any number of those dice for that spell once."
			]),
			additional : "1 Sorcery Point",
		},
		"subclassfeature14" : {
			name : "Otherworldy Wings",
			source : [["X", 50]],
			minlevel : 14,
			description : desc([
				"As a Bonus Action, I can manifest a pair of spectral wings that give me 30 ft Fly Speed.",
				"These wings last until I become Incapacitated or I dismiss them as a Bonus Action.",
			]),
			choices : ["eagle", "bat", "dragonfly"],
			choicesNotInMenu : true,
			"eagle" : {
				name : "Otherworldy Wings",
				description : desc([
					"As a Bonus Action, I manifest a pair of spectral eagle wings, giving me 30 ft Fly Speed.",
					"These wings last until I become Incapacitated or I dismiss them as a Bonus Action.",
				]),
			},
			"bat" : {
				name : "Otherworldy Wings",
				description : desc([
					"As a Bonus Action, I manifest a pair of spectral bat wings, giving me 30 ft Fly Speed.",
					"These wings last until I become Incapacitated or I dismiss them as a Bonus Action.",
				]),
			},
			"dragonfly" : {
				name : "Otherworldy Wings",
				description : desc([
					"As a Bonus Action, I create a pair of spectral dragonfly wings, giving me 30 ft Fly Speed.",
					"These wings last until I become Incapacitated or I dismiss them as a Bonus Action.",
				]),
			},
			action : ["bonus action", ""],
			speed : { fly : { spd : 30, enc : 20 } },
		},
		"subclassfeature18" : {
			name : "Unearthly Recovery",
			source : [["X", 50]],
			minlevel : 18,
			description : desc([
				"As a Bonus Action when I have less than half of my max HP remaining, I can heal myself.",
				"I regain a number of HP equal to half my hit point maximum."
			]),
			action : ["bonus action", ""],
			recovery : "long rest",
			usages : 1,
		},
	},
});
AddSubClass("sorcerer_ua23pt7", "shadow magic", {
	regExpSearch : /^(?=.*(sorcerer|witch))(?=.*shadow).*$/i,
	subname : "Shadow Magic",
	source : [["X", 50]],
	fullname : "Shadow Sorcerer (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Eyes of the Dark",
			source : [["X", 51]],
			minlevel : 3,
			description : "\n   " + "I gain 120 ft darkvision.",
			vision : [["Darkvision", 120]],
		},
		"subclassfeature3.1" : {
			name : "Strength of the Grave",
			source : [["X", 51]],
			minlevel : 3,
			description : desc([
				"When damage reduces me to 0 HP, that isn't Radiant damage or a Critical Hit,",
				"  I can make a Charisma save (DC 5 + damage taken) to drop to 1 HP instead.",
			]),
			usages : 1,
			recovery : "long rest",
		},
		"subclassfeature3" : {
			name : "Darkness",
			source : [["X", 51]],
			minlevel : 3,
			description : desc([
				"I learn Darkness, which doesn't count against my number of spells known.",
				"I can also cast it by spending 2 Sorcery Points and then I can see through it normally.",
			]),
			additional : "2 Sorcery Points",
			action : ["action", " (2 sorcery points)"],
			spellcastingBonus : {
				name : "Eyes of the Dark",
				spells : ["darkness"],
				selection : ["darkness"],
			},
		},
		"subclassfeature6" : {
			name : "Hound of Ill Omen",
			source : [["X", 51]],
			minlevel : 6,
			description : desc([
				"As a Bonus Action, I summon a hound within 30 ft of a creature I see within 120 ft.",
				"The hound has all the stats of a dire wolf with the following exceptions:",
				"\u2022 It is Medium size and counts as a Monstrosity not a beast",
				"\u2022 It starts with a number of Temporary Hit Points equal to half my Sorcerer level",
				"\u2022 At the start of its turn, it automatically knows where the (hidden) target is",
				"\u2022 It can only move towards and make (opportunity) attack against the target",
				"\u2022 It can move through other creatures and objects as if they were Difficult Terrain",
				"\u2022 It takes 5 Force damage if it ends its turn inside an object",
				"The target has Disadvantage on saves vs. my spells while the hound is within 5 ft of it",
				"It disappears if reduced to 0 HP, if the target is reduced to 0 HP, or after 5 minutes",
			]),
			additional : levels.map(function (n) { return n < 6 ? "" : "3 Sorcery Points; " + Math.floor(n/2) + " temporary HP"; }),
			action : [["bonus action", " (3 sorcery points)"]],
			creaturesAdd : [["Hound of Ill Omen", true]],
			creatureOptions : [{
				name : "Hound of Ill Omen",
				source : [["X", 51]],
				size : 3,
				type : "Monstrosity",
				alignment : "Unaligned",
				ac : 14,
				hp : 37,
				hd : [5, 10],
				speed : "50 ft",
				scores : [17, 15, 15, 3, 12, 7],
				skills : {
					"perception" : 3,
					"stealth" : 4
				},
				senses : "Adv. on Wis (Perception) checks using hearing/smell;\nAt the start of each turn, knows where the target is",
				passivePerception : 13,
				challengeRating : "1",
				proficiencyBonus : 2,
				attacksAction : 1,
				attacks : [{
					name : "Bite",
					ability : 1,
					damage : [2, 6, "piercing"],
					range : "Melee (5 ft)",
					description : "Target must succeed on a DC 13 Strength saving throw or be knocked prone"
				}],
				traits : [{
					name : "Keen Hearing and Smell",
					description : "The hound has advantage on Wisdom (Perception) checks that rely on hearing or smell."
				}, {
					name : "Pack Tactics",
					description : "The hound has advantage on an attack roll against a creature if at least one of the hound's allies is within 5 ft of the creature and the ally isn't incapacitated."
				}],
				features : [{
					name : "Actions",
					description : "The hound can only move towards its targets and make attacks or opportunity attacks against its target."
				}, {
					name : "Temporary Hit Points",
					description : "When the hound is summoned, it gains temporary HP equal to half my sorcerer level."
				}, {
					name : "Shadowy Form",
					description : "The hound can move through other creatures and objects as if they were difficult terrain. It takes 5 force damage if it ends its turn inside an object."
				}, {
					name : "Sign of Ill Omen",
					description : "While the hound is within 5 ft of its target, that target has disadvantage on saving throws versus my spells."
				}],
				header : "Summoned",
				eval : function(prefix, lvl) {
					AddTooltip(prefix + 'Comp.Use.HP.Temp', "The hound of ill omen gains half my sorcerer level as temporary HP when created.");
				},
				removeeval : function(prefix, lvl) {
					AddTooltip(prefix + 'Comp.Use.HP.Temp', "");
				},
				changeeval : function (prefix, lvl) {
					if (!classes.known.sorcerer) return;
					Value(prefix + 'Comp.Use.HP.Temp', Math.floor(classes.known.sorcerer.level / 2));
				},
			}],
		},
		"subclassfeature14" : {
			name : "Shadow Walk",
			source : [["X", 51]],
			minlevel : 14,
			description : desc([
				"As a Bonus Action when I'm in Dim Light or Darkness, I can teleport up to 120 ft.",
				"The destination has to be unoccupied, within line of sight, and in Dim Light or Darkness.",
			]),
			action : ["bonus action", ""],
		},
		"subclassfeature18" : {
			name : "Umbral Form",
			source : [["X", 51]],
			minlevel : 18,
			additional : "6 Sorcery Points",
			description : desc([
				"As a Bonus Action, I transform into a shadow form for 1 minute.",
				"While transformed, I have Resistance to all damage except Force and Radiant damage.",
				"Also, I can move through other creatures and objects as if they were Difficult Terrain.",
				"I take 5 Force damage if I end my turn inside an object.",
				"This ends early if I end it as a Bonus Action, I die, or I'm Incapacitated.",
			]),
			action : ["bonus action", " (6 Sorcery Points)"],
		},
	},
});
AddSubClass("sorcerer_ua23pt7", "aberrant mind", {
	regExpSearch : /^(?=.*aberrant)(?=.*mind).*$/i,
	subname : "Aberrant Mind (UA:PT-vii)",
	source : [["T", 67]],
	features : {
		"subclassfeature3" : {
			name : "Psionic Spells",
			source : [["T", 67]],
			minlevel : 3,
			description : desc([
				"I learn additional spells, which do not count towards the number of spell I can prepare.",
				"Whenever I gain a Sorcerer level, I can replace one of these with another of the same level.",
				"It must be a Divination or Enchantment spell on the Sorcerer, Wizard, or Warlock spell list.",
			]),
			spellcastingBonus : [{
				name : "Psionic Spells (cantrip)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Ench", "Div"],
				level : [0, 0],
				extraspells : ["mind sliver"],
				selection : ["mind sliver"],
			}, {
				name : "Psionic Spells (1st-level)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Ench", "Div"],
				level : [1, 1],
				firstCol : "PS",
				extraspells : ["arms of hadar", "dissonant whispers"],
				selection : ["arms of hadar", "dissonant whispers"],
				times : 2,
			}, {
				name : "Psionic Spells (2nd-level)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Ench", "Div"],
				level : [2, 2],
				firstCol : "PS",
				extraspells : ["calm emotions", "detect thoughts"],
				selection : ["calm emotions", "detect thoughts"],
				times : levels.map(function (n) { return n < 3 ? 0 : 2; }),
			}, {
				name : "Psionic Spells (3rd-level)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Ench", "Div"],
				level : [3, 3],
				firstCol : "PS",
				extraspells : ["hunger of hadar", "sending"],
				selection : ["hunger of hadar", "sending"],
				times : levels.map(function (n) { return n < 5 ? 0 : 2; }),
			}, {
				name : "Psionic Spells (4th-level)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Ench", "Div"],
				level : [4, 4],
				firstCol : "PS",
				extraspells : ["evard's black tentacles", "summon aberration"],
				selection : ["evard's black tentacles", "summon aberration"],
				times : levels.map(function (n) { return n < 7 ? 0 : 2; }),
			}, {
				name : "Psionic Spells (5th-level)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Ench", "Div"],
				level : [5, 5],
				firstCol : "PS",
				extraspells : ["rary's telepathic bond", "telekinesis"],
				selection : ["rary's telepathic bond", "telekinesis"],
				times : levels.map(function (n) { return n < 9 ? 0 : 2; }),
			}],
		},
		"subclassfeature3.1" : {
			name : "Telepathic Speech",
			source : [["T", 67]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I can telepathic link myself with a creature within 30 ft that I can see.",
				"If we share a language, we can talk telepathically while in my Cha mod of miles (min 1).",
				"This last for my level in minutes, until I'm Incapacitated, I die, or I use this feature again."
			]),
			action : [["bonus action", ""]],
			additional : levels.map(function (n) {
				return n + " minute" + (n > 1 ? "s" : "");
			}),
		},
		"subclassfeature6" : {
			name : "Psionic Sorcery",
			source : [["T", 68]],
			minlevel : 6,
			description : desc([
				"I can expend Sorcery Points instead of a spell slot to cast a spell from my Psionic Spells.",
				"This costs the spell's level in Sorcery Points, but in doing so requires no other components.",
				"However, I do need to provide a material component if it is consumed by the spell.",
			]),
		},
		"subclassfeature6.1" : {
			name : "Psychic Defenses",
			source : [["T", 68]],
			minlevel : 6,
			description : "\n   I gain Resistance to Psychic damage and Adv. on saves vs. being Charmed or Frightened.",
			dmgres : ["Psychic"],
			savetxt : { adv_vs : ["charmed", "frightened"] },
		},
		"subclassfeature14" : {
			name : "Revelation in Flesh",
			source : [["T", 68]],
			minlevel : 14,
			description : desc([
				"As a Bonus Action, I can expend 1 or more Sorcery Points to transform for 10 minutes.",
				"For each Sorcery Point used, I gain one of the following benefits of my choice:",
				" \u2022 I can see any Invisible creatures within 60 ft of me not behind Total Cover",
				" \u2022 I gain a Flying Speed equal to my Walking Speed and I can Hover",
				" \u2022 I gain a Swimming Speed equal to twice my Walking Speed \u0026 I can breathe underwater",
				" \u2022 I can move, with equipment, through any space as narrow as 1 inch without squeezing",
				"   Also, I can spend 5 ft of movement to escape form a Grapple or nonmagical restraints."
			]),
			action : [["bonus action", ""]],
			additional : "1+ Sorcery Points",
		},
		"subclassfeature18" : {
			name : "Warping Implosion",
			source : [["T", 68]],
			minlevel : 18,
			description : desc([
				"As an Action, I can teleport to an unoccupied space I can see within 120 ft.",
				"All within 30 ft of where I left take 3d10 Force damage and must make a Strength save.",
				"If failed, each is pulled towards the space I left, ending up in the nearest empty space.",
				"If successful, a creature takes only half damage and isn't pulled.",
				"I can do this once per Long Rest, or by expending 5 Sorcery Points (5 SP)."
			]),
			action : [["action", ""]],
			recovery : "long rest",
			usages : 1,
			altResource : "5 SP",
		},
	},
});
AddSubClass("sorcerer_ua23pt7", "clockwork soul", {
	regExpSearch : /^((?=.*(sorcerer|witch))(?=.*mechanus)|(?=.*clockwork)(?=.*soul)).*$/i,
	subname : "Clockwork Soul",
	source : [["T", 68], ["MJ:HB", 0]],
	fullname : "Clockwork Soul (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Clockwork Magic",
			source : [["T", 68], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I learn additional spells, which do not count towards the number of spell I can prepare.",
				"Whenever I gain a Sorcerer level, I can replace one of these with another of the same level.",
				"It must be an Abjuration or Transmutation spell on the Sorcerer, Wizard, or Warlock list.",
			]),
			spellcastingBonus : [{
				name : "Clockwork Magic (1st-level)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Abjur", "Trans"],
				level : [1, 1],
				extraspells : ["alarm", "protection from evil and good"],
				selection : ["alarm", "protection from evil and good"],
				times : 2
			}, {
				name : "Clockwork Magic (2nd-level)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Abjur", "Trans"],
				level : [2, 2],
				extraspells : ["aid", "aid ua22cs", "lesser restoration"],
				selection : ["aid", "aid ua22cs", "lesser restoration"],
				times : 2,
			}, {
				name : "Clockwork Magic (3rd-level)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Abjur", "Trans"],
				level : [3, 3],
				extraspells : ["dispel magic", "protection from energy"],
				selection : ["dispel magic", "protection from energy"],
				times : levels.map(function (n) { return n < 5 ? 0 : 2; }),
			}, {
				name : "Clockwork Magic (4th-level)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Abjur", "Trans"],
				level : [4, 4],
				extraspells : ["freedom of movement", "summon construct"],
				selection : ["freedom of movement", "summon construct"],
				times : levels.map(function (n) { return n < 7 ? 0 : 2; }),
			}, {
				name : "Clockwork Magic (5th-level)",
				"class" : ["sorcerer", "warlock", "wizard"],
				school : ["Abjur", "Trans"],
				level : [5, 5],
				extraspells : ["greater restoration", "wall of force"],
				selection : ["greater restoration", "wall of force"],
				times : levels.map(function (n) { return n < 9 ? 0 : 2; }),
			}],
		},
		"subclassfeature3.1" : {
			name : "Restore Balance",
			source : [["T", 69]],
			minlevel : 3,
			description : desc([
				"As a Reaction when a creature I can see in 60 ft is about to roll a d20 with Adv./Disadv.,",
				"  I can prevent that roll from being affected by Advantage and Disadvantage.",
			]),
			action : [["reaction", ""]],
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
		},
		"subclassfeature6" : {
			name : "Bulwark of Law",
			source : [["T", 69]],
			minlevel : 6,
			description : desc([
				"As an Action, I can imbue a creature I can see within 30 ft with a magical ward.",
				"The ward has a number of d8s equal to the number of Sorcery Points I expend to do this.",
				"As a Reaction when the creature takes damage, it can expend any number of those dice.",
				"The dice roll reduces the damage; The ward lasts until I finish a Long Rest or do this again.",
			]),
			additional : "1-5 Sorcery Points; 1d8 per Point",
			action : [["action", ""]],
		},
		"subclassfeature14" : {
			name : "Trance of Order",
			source : [["T", 69]],
			minlevel : 14,
			description : desc([
				"As a Bonus Action, I can enter a state of clockwork consciousness for 1 minute.",
				"While in this state, attack rolls against me can't benefit from Advantage.",
				"Also, I can then treat a d20 Test roll below 9 as if it had actually rolled a 10.",
				"I can do this once per Long Rest, or by expending 5 Sorcery Points (5 SP).",
			]),
			action : [["bonus action", ""]],
			usages : 1,
			recovery : "long rest",
			altResource : "5 SP",
		},
		"subclassfeature18" : {
			name : "Clockwork Cavalcade",
			source : [["T", 69]],
			minlevel : 18,
			description : desc([
				"As an Action, I can call spirits to bring balance in a 30-ft cube originating from me.",
				"Inside the cube, the intangible spirits do all the following before vanishing:",
				" \u2022 Restore up to 100 HP, divided among the creatures in the cube as I choose",
				" \u2022 Repair all damaged objects entirely in the cube instantly",
				" \u2022 End every spell of 6th-level or lower on objects or creatures of my choice in the cube",
				"I can do this once per Long Rest, or by expending 7 Sorcery Points (7 SP).",
			]),
			action : [["action", ""]],
			usages : 1,
			recovery : "long rest",
			altResource : "7 SP",
		},
	},
});
AddSubClass("sorcerer_ua23pt7", "lunar sorcery", { //Note from MasterJedi2014: This has too many small pieces of custom code that I don't want to break, so I have only changed the 1st lvl subclass features to be 3rd lvl subclass features.
	regExpSearch : /^(?=.*(sorcerer|sorcery|witch))(?=.*(lunar|moon)).*$/i,
	subname : "Lunar Sorcery",
	fullname : "Lunar Sorcerer (UA:PT-vii)",
	source : [["D:SotDQ", 0]],
	features : {
		"subclassfeature3" : {
			name : "Lunar Embodiment",
			source : [["D:SotDQ", 0]],
			minlevel : 3,
			additional : levels.map(function (n) { return (n < 3 ? 3 : n < 5 ? 6 : n < 7 ? 9 : n < 9 ? 12 : 15) + " additional spells known"}),
			spellcastingExtra : [
				// full moon
				"shield", "lesser restoration", "dispel magic", "death ward", "rary's telepathic bond",
				// new moon
				"ray of sickness", "blindness/deafness", "vampiric touch", "confusion", "hold monster",
				// crescent moon
				"color spray", "alter self", "phantom steed", "hallucinatory terrain", "mislead"
			],
			spellcastingExtraApplyNonconform : true,
			description : levels.map(function(n) {
				var phases = {
					"\u25CB Full: " : ["Shield", "Lesser Restoration", "Dispel Magic", "Death Ward", "Rary's Telepathic Bond"],
					"\u25CF New: " : ["Ray of Sickness", "Blindness/deafness", "Vampiric Touch", "Confusion", "Hold Monster"],
					"\u25D6 Crescent: " : ["Color Spray", "Alter Self", "Phantom Steed", "Hallucinatory Terrain", "Mislead"]
				};
				var aReturn = [
					"When I finish a long rest, I can choose a lunar phase: Full, New, or Crescent Moon",
					"I can cast the 1st-level spell of that lunar phase once per long rest without a spell slot"
				];
				var iSpellsAdd = n < 3 ? 1 : n < 5 ? 2 : n < 7 ? 3 : n < 9 ? 4 : 5;
				for (var phase in phases) {
					aReturn.push(phase + phases[phase].slice(0,iSpellsAdd).join(", "));
				}
				//aReturn.push("I know all " + (iSpellsAdd * 3) + " spells above; They don't count towards the number of spells I can know");
				return desc(aReturn);
			}),
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName, isDuplicate) {
						if (spName === "sorcerer" && !isDuplicate && CurrentSpells.sorcerer.extra.indexOf(spellKey) !== -1) {
							var phases = {
								"F" : ["shield", "lesser restoration", "dispel magic", "death ward", "rary's telepathic bond"],
								"N" :  ["ray of sickness", "blindness/deafness", "vampiric touch", "confusion", "hold monster"],
								"C" : ["color spray", "alter self", "phantom steed", "hallucinatory terrain", "mislead"]
							};
							for (var phase in phases) {
								if (phases[phase].indexOf(spellKey) !== -1) {
									spellObj.firstCol = phase;
									return true;
								}
							}
						}
					},
					'The letters "F", "N", or "C" in the first column are used to indicate that a spell belongs to either the Full Moon, New Moon, or Crescent Moon lunar phase.'
				]
			},
			spellFirstColTitle : "Ph",
			extraLimitedFeatures : [{
				name : "1st-level lunar phase spell",
				usages : 1,
				recovery : "long rest"
			}]
		},
		"subclassfeature3.1" : {
			name : "Moon Fire",
			source : [["D:SotDQ", 0]],
			minlevel : 3,
			description : desc("I know the Sacred Flame cantrip and can use it on 2 creatures within 5 ft of each other"),
			spellcastingBonus : {
				name : "Moon Fire",
				spells : ["sacred flame"],
				selection : ["sacred flame"]
			},
			weaponsAdd : ["Sacred Flame"],
			spellChanges : {
				"sacred flame" : {
					description : "Up to 2 creas I see, max 5 ft apart, save or 1d8 Radiant dmg; no cover bonus; +1d8 at CL 5, 11, and 17",
					descriptionShorter : "Up to 2 creas I see, max 5 ft apart, save or 1d8 Radiant dmg; no cover bonus; +1d8 CL 5/11/17",
					descriptionCantripDie : "Up to 2 creas I see, max 5 ft apart, save or `CD`d8 Radiant dmg; no bonus for cover on save",
					changes : "When I cast Sacred Flame, I can target one creature as normal or target two creatures within range that are within 5 feet of each other."
				}
			},
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.baseWeaponName == 'sacred flame') {
							fields.Description = fields.Description.replace("1 creature", "up to 2 creatures within 5 ft");
						}
					},
					"When I cast Sacred Flame, I can target one creature as normal or target two creatures within range that are within 5 feet of each other."
				]
			}
		},
		"subclassfeature6" : {
			name : "Lunar Boons",
			source : [["D:SotDQ", 0]],
			minlevel : 6,
			description : desc([
				"Each lunar phase is additionally associated with spells of the following schools of magic:",
				"\u25CB Full: Abjur \u0026 Div\t\t\u25CF New: Ench \u0026 Necro\t" + (typePF ? "\t" : Array(8).join(" ")) + "\u25D6 Crescent: Illus \u0026 Trans",
				"I can reduce the sorcery point needed for Metamagic of spells of my current phase by 1"
			]),
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature6.1" : {
			name : "Waxing and Waning",
			source : [["D:SotDQ", 0]],
			minlevel : 6,
			description : " [1 sorcery point]" + desc([
				"As a bonus action, I can spend 1 sorcery point to change my lunar phase",
				"I can cast each lunar phase's 1st-level spells once per long rest, if it is my current phase"
			]),
			action : [["bonus action", ""]],
			extraLimitedFeatures : [{
				name : "Shield (in Full lunar phase)",
				usages : 1,
				recovery : "long rest"
			}, {
				name : "Ray of Sickness (in New lunar phase)",
				usages : 1,
				recovery : "long rest"
			}, {
				name : "Color Spray (in Crescent lunar phase)",
				usages : 1,
				recovery : "long rest"
			}],
			eval : function () {
				RemoveFeature("1st-level lunar phase spell", 0, "", "", "Lunar Sorcerer: Lunar Embodiment");
			},
			removeeval : function () {
				AddFeature("1st-level lunar phase spell", 1, "", "long rest", "Lunar Sorcerer: Lunar Embodiment");
			}
		},
		"subclassfeature14" : {
			name : "Lunar Empowerment",
			source : [["D:SotDQ", 0]],
			minlevel : 14,
			description : " [passive benefits for current phase]" + desc([
				"\u25CB Full: I shed bright light in a 10-ft radius \u0026 dim light for extra 10 ft",
				"  Myself and creatures I choose in 10 ft have adv. on Investigation and Perception checks",
				"\u25CF New: I have adv. on Stealth checks; While I'm in darkness, attacks have disadv. vs me",
				"\u25D6 Crescent: I have resistance to Necrotic and Radiant damage"
			]),
			dmgres : [
				["Necrotic", "Necro. (in crescent)"],
				["Radiant", "Rad. (in crescent)"]
			]
		},
		"subclassfeature18" : {
			name : "Lunar Phenomenon",
			source : [["D:SotDQ", 0]],
			minlevel : 18,
			description : " [per phase: 1\xD7 per long rest or 5 SP]" + desc([
				"As a bonus action, or as part of changing phase, I can use a power of the (new) phase:",
				"\u25CB Full: Chosen creatures within 30 ft of me must make a Constitution save or be blinded",
				"  This lasts until their next turn ends; I also heal one creature within 30 ft for 3d8 HP",
				"\u25CF New: Chosen creatures within 30 ft of me must make a Dexterity save",
				"  If failed, they take 3d10 Necrotic damage and have 0 speed until their next turn ends",
				"  Also, I become invisible until the end of my next turn, or until I attack or cast a spell",
				"\u25D6 Crescent: I can magically teleport to an unoccupied space I can see within 60 ft",
				"  Both of us gain resistance to all damage until the start of my next turn",
				"I can use each phase's bonus action 1/LR, or by spending 5 sorcery points to use it again"
			]),
			action : [["bonus action", ""]],
			extraLimitedFeatures : [{
				name : "Lunar Phenomenon (Full)",
				usages : 1,
				recovery : "long rest",
				altResource : "5 SP"
			}, {
				name : "Lunar Phenomenon (New)",
				usages : 1,
				recovery : "long rest",
				altResource : "5 SP"
			}, {
				name : "Lunar Phenomenon (Crescent)",
				usages : 1,
				recovery : "long rest",
				altResource : "5 SP"
			}]
		}
	}
});
AddSubClass("sorcerer_ua23pt7", "favored soul-ua2", { //this code includes contributions by /u/SoilentBrad, as well as LamentingDemon on GitHub
	regExpSearch : /^(?=.*favou?red)(?=.*soul).*$/i,
	subname : "Favored Soul (UA:SO)",
	source : [["UA:SO", 1]],
	fullname : "Favored Soul (UA:PT-vii)",
	spellcastingList : {
		"class" : ["cleric", "cleric_ua23pt6", "sorcerer", "sorcerer_ua23pt7"],
	},
	features : {
		"subclassfeature3" : {
			name : "Divine Magic",
			source : [["UA:SO", 1]],
			minlevel : 3,
			description : "\n   " + "When I select my 1st level or higher spells, I can also pick spells from the Cleric spell list." + "\n   " + "These Cleric spells count as Sorcerer spells for me."
		},
		"subclassfeature3.1" : {
			name : "Supernatural Resilience",
			source : [["UA:SO", 1]],
			minlevel : 3,
			description : "\n   " + "My hit point maximum increases by an amount equal to my Sorcerer level.",
			calcChanges : {
				hp : function (totalHD) {
					if (classes.known.sorcerer) {
						return [classes.known.sorcerer.level, "Supernatural Resilience (sorcerer level)"];
					}
				}
			}
		},
		"subclassfeature3.2" : {
			name : "Favored by the Gods",
			source : [["UA:SO", 1]],
			minlevel : 3,
			description : "\n   " + "If I fail a saving throw or miss with an attack roll, I can add 2d4 to the total.",
			recovery : "short rest",
			usages : 1
		},
		"subclassfeature6" : {
			name : "Blessed Countenance",
			source : [["UA:SO", 1]],
			minlevel : 6,
			description : "\n   " + 'Choose an otherworldly quality using the "Choose Feature" button above.' + "\n   " + "When my Proficiency Bonus applies to a Charisma check, I double that bonus.",
			choices : ["Beautiful", "Youthful", "Kind", "Imposing"],
			"beautiful" : {
				name : "Beautiful",
				source : [["UA:SO", 1]],
				description : "\n   " + "My appearance takes on an otherworldly quality of beauty." + "\n   " + "When my Proficiency Bonus applies to a Charisma check, I double that bonus."
			},
			"youthful" : {
				name : "Youthful",
				source : [["UA:SO", 1]],
				description : "\n   " + "My appearance takes on an otherworldly quality of youthfulness." + "\n   " + "When my Proficiency Bonus applies to a Charisma check, I double that bonus."
			},
			"kind" : {
				name : "Kind",
				source : [["UA:SO", 1]],
				description : "\n   " + "My appearance takes on an otherworldly quality of kindness." + "\n   " + "When my Proficiency Bonus applies to a Charisma check, I double that bonus."
			},
			"imposing" : {
				name : "Imposing",
				source : [["UA:SO", 1]],
				description : "\n   " + "My appearance takes on an otherworldly quality of imposingness." + "\n   " + "When my Proficiency Bonus applies to a Charisma check, I double that bonus."
			},
			skillstxt : "I gain expertise in any Charisma-based skill I'm proficient with.",
			skills : [["Deception", "only"], ["Intimidation", "only"], ["Performance", "only"], ["Persuasion", "only"]]
		},
		"subclassfeature14" : {
			name : "Divine Purity",
			source : [["UA:SO", 1]],
			minlevel : 14,
			description : "\n   " + "I become Immune to Disease and Poison",
			savetxt : { immune : ["poison", "disease"] }
		},
		"subclassfeature18" : {
			name : "Unearthly Recovery",
			source : [["UA:SO", 1]],
			minlevel : 18,
			description : "\n   " + "As a Bonus Action when I have less than half of my max HP, I can heal myself." + "\n   " + "I regain a number of HP equal to half my maximum hit points.",
			action : ["bonus action", ""],
			recovery : "long rest",
			usages : 1
		}
	}
});
AddSubClass("sorcerer_ua23pt7", "phoenix sorcery-ua", { // Still valid 2021-09-21; this code includes contributions by /u/SoilentBrad, as well as Toby L.
	regExpSearch : /^(?=.*phoenix)(?=.*(sorcerer|sorcery|witch)).*$/i,
	subname : "Phoenix Sorcery",
	source : [["UA:SO", 1]],
	fullname : "Phoenix Sorcerer (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Ignite",
			source : [["UA:SO", 2]],
			minlevel : 3,
			description : "\n   " + "As an Action, I can magically ignite a flammable object by touching it with my hand.",
			action : ["action", ""]
		},
		"subclassfeature3.1" : {
			name : "Mantle of Flame",
			source : [["UA:SO", 2]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I can wreathe myself in fire for 1 minute, gaining these benefits:",
				" - I shed Bright Light in a 30-ft radius and Dim Light for an additional 30 ft",
				" - I deal my Charisma modifier in Fire damage to all that touch me",
				" - I also deal this damage to all that hit me with a melee attack from within 5 ft",
				" - When I roll for Fire damage on my turn, I add my Charisma damage to the result"
			]),
			action : ["bonus action", ""],
			recovery : "long rest",
			usages : 1
		},
		"subclassfeature6" : {
			name : "Phoenix Spark",
			source : [["UA:SO", 2]],
			minlevel : 6,
			description : desc([
				"As a Reaction when I am reduced to 0 HP, I can draw on the phoenix to stay at 1 HP",
				"All creatures within 10 ft of me take half my Sorcerer level + my Cha mod Fire damage",
				"If I have Mantle of Flame active, this damage is my Sorcerer level + twice my Cha mod",
				"If I use this feature, my Mantle of Flame immediately ends"
			]),
			additional : levels.map( function(n) {
				if (n < 6) return "";
				return Math.floor(n / 2) + "+Cha \u007Cor\u007C " + n + "+2\xD7Cha";
			}),
			action : ["reaction", ""],
			recovery : "long rest",
			usages : 1
		},
		"subclassfeature14" : {
			name : "Nourishing Fire",
			source : [["UA:SO", 2]],
			minlevel : 14,
			description : desc([
				"When I cast a spell using a spell slot that includes a Fire damage roll, I regain HP",
				"The HP regained is equal to the spell slot level + my Charisma modifier"
			])
		},
		"subclassfeature18" : {
			name : "Form of the Phoenix",
			source : [["UA:SO", 2]],
			minlevel : 18,
			description : desc([
				"While my Mantle of Flame is active, I gain the following additional benefits:",
				"- I have a Flying Speed of 40 ft and can Hover",
				"- I have Resistance to all damage",
				"- If I use my Phoenix Spark, it deals an extra 20 Fire damage to each creature"
			]),
			dmgres : [["All", "All (Mantle of Flame)"]]
		}
	}
});
AddSubClass("sorcerer_ua23pt7", "sea sorcery-ua", { // Still valid 2021-09-21; this code includes contributions by /u/SoilentBrad
	regExpSearch : /^(?=.*sea)(?=.*(sorcerer|sorcery|witch)).*$/i,
	subname : "Sea Sorcery",
	source : [["UA:SO", 2]],
	fullname : "Sea Sorcerer (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Soul of the Sea",
			source : [["UA:SO", 3]],
			minlevel : 3,
			description : "\n   " + "I can breathe underwater and I have a Swim Speed equal to my Walking Speed.",
			speed : { swim : { spd : "walk", enc : "walk" } }
		},
		"subclassfeature3.1" : {
			name : "Curse of the Sea",
			source : [["UA:SO", 3]],
			minlevel : 3,
			description : desc([
				"I can curse a target that I hit with a cantrip or that fails its save against my cantrip",
				"This lasts until the end of my next turn or until I curse another target like this",
				"Once per turn when I cast a spell, I can trigger an active curse, if a condition is met",
				" - If spell dealt Cold damage to it, its has -15 ft Speed until the end of my next turn",
				" - If the spell dealt Lightning damage to it, that damage is increased with my Cha mod",
				" - If the spell moved the target, it is moved an additional 15 ft",
				"Only one of these effects can be applied, even if the spell meets multiple conditions",
				"If the spell triggering the curse is a cantrip, the target stays cursed for another round"
			])
		},
		"subclassfeature6" : {
			name : "Watery Defense",
			source : [["UA:SO", 3]],
			minlevel : 6,
			description : desc([
				"I gain Resistance to Fire damage",
				"I can protect myself when an attack deals Bludgeoning, Piercing, or Slashing damage",
				"As a Reaction when that happens, I reduce the damage by my sorcerer level + Charisma",
				"I can then also move up to 30 ft without provoking opportunity attacks"
			]),
			additional : levels.map( function(n) {
				if (n < 6) return "";
				return n + " + Charisma score";
			}),
			action : ["reaction", ""],
			recovery : "short rest",
			usages : 1,
			dmgres : ["Fire"]
		},
		"subclassfeature14" : {
			name : "Shifting Form",
			source : [["UA:SO", 3]],
			minlevel : 14,
			description : desc([
				"I gain the ability to enter a liquid state while moving, squeezing through small spaces",
				"When I move on my turn, I take half damage from opportunity attacks",
				"I can move through any enemy's space, but can't willingly end my move in that space",
				"On my turn, I can move through any opening of at least 3 inches in diameter",
				"I can't end my move in a space smaller than one size category smaller than I am"
			])
		},
		"subclassfeature18" : {
			name : "Water Soul",
			source : [["UA:SO", 3]],
			minlevel : 18,
			description : desc([
				"I no longer need to eat, drink, or sleep; Critical hits against me become normal hits",
				"I gain Resistance to Bludgeoning, Piercing, and Slashing damage"
			]),
			dmgres : ["Bludgeoning", "Piercing", "Slashing"]
		}
	}
});
AddSubClass("sorcerer_ua23pt7", "stone sorcery-ua", { // Still valid 2021-09-21; this code includes contributions by /u/SoilentBrad
	regExpSearch : /^(?=.*stone)(?=.*(sorcerer|sorcery|witch)).*$/i,
	subname : "Stone Sorcery",
	source : [["UA:SO", 3]],
	fullname : "Stone Sorcerer (UA:PT-vii)",
	spellcastingExtra : ["compelled duel", "searing smite", "searing smite ua23pt6", "thunderous smite", "thunderous smite ua23pt6", "wrathful smite", "wrathful smite ua23pt6", "branding smite", "magic weapon", "blinding smite", "banishing smite ua23pt6", "elemental weapon", "staggering smite", "staggering smite ua23pt6"],
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiencies",
			source : [["UA:SO", 4]],
			minlevel : 3,
			description : "\n   " + "I gain Proficiency with Shields, Simple Weapons and Martial Weapons",
			armorProfs : [false, false, false, true],
			weaponProfs : [true, true]
		},
		"subclassfeature3.1" : {
			name : "Metal Magic",
			source : [["UA:SO", 4]],
			minlevel : 3,
			description : "\n   " + "My affinity for metal allows me to select from a broader range of spells"
		},
		"subclassfeature3.2" : {
			name : "Stone's Durability",
			source : [["UA:SO", 4]],
			minlevel : 3,
			description : desc([
				"My hit point maximum increases by an amount equal to my Sorcerer level",
				"As an Action, I can gain an AC of 13 + Constitution modifier + shield (not Shield spell)",
				"This AC lasts until I don armor, I'm Incapacitated, or use a Bonus Action to end it"
			]),
			action : [["action", " (start)"], ['bonus action', " (end)"]],
			calcChanges : {
				hp : function (totalHD) {
					if (classes.known.sorcerer) {
						return [classes.known.sorcerer.level, "Stone's Durability (sorcerer level)"];
					}
				}
			},
			armorOptions : [{
				regExpSearch : /^(?=.*stone)(?=.*durability).*$/i,
				name : "Stone's Durability",
				source : [["UA:SO", 4]],
				ac : "13+Con",
				dex : -10,
				affectsWildShape : true
			}],
			armorAdd : "Stone's Durability"
		},
		"subclassfeature6" : {
			name : "Stone Aegis",
			source : [["UA:SO", 4]],
			minlevel : 6,
			description : desc([
				"As a Bonus Action, I can grant an aegis to an ally I can see within 60 ft of me",
				"The aegis reduces any Bludgeoning, Piercing, or Slashing damage taken by the target",
				"This aegis lasts for 1 minute, until I use it again, or until I'm Incapacitated",
				"As a Reaction when the protected ally is attacked with a melee attack, I can teleport",
				"I can do this only if the attacker is within 60 ft of me and I can see it",
				"I teleport to an empty space next to it and make one melee weapon attack against it",
				"If this attack hits, the attack deals extra Force damage"
			]),
			additional : levels.map( function(n) {
				if (n < 6) return "";
				return (Math.floor(n / 4) + 2) + " damage reduction; +" + (n < 11 ? 1 : n < 17 ? 2 : 3) + "d10 Force damage";
			}),
			action : [["bonus action", ""], ['reaction', 'Aegis Teleport']]
		},
		"subclassfeature14" : {
			name : "Stone's Edge",
			source : [["UA:SO", 4]],
			minlevel : 14,
			description : desc([
				"Once per casting of a spell that deals damage, I can choose one creature damaged by it",
				"That creature takes extra Force damage equal to half my Sorcerer level"
			]),
			additional : levels.map( function(n) {
				return n < 14 ? "" : Math.floor(n / 2) + " Force damage";
			})
		},
		"subclassfeature18" : {
			name : "Earth Master's Aegis",
			source : [["UA:SO", 4]],
			minlevel : 18,
			description : "\n   " + "My Stone's Aegis can now affect up to three creatures"
		}
	}
});
AddSubClass("sorcerer_ua23pt7", "favoured soul-uars", {
	regExpSearch : /^(?=.*favou?red)(?=.*soul).*$/i,
	subname : "Favored Soul (UA:RS)",
	source : [["UA:RS", 5], ["MJ:HB", 0]],
	fullname : "Favored Soul (UA:PT-vii)",
	spellcastingList : {
		"class" : ["cleric", "cleric_ua23pt6", "sorcerer", "sorcerer_ua23pt7"],
	},
	features : {
		"subclassfeature3" : {
			name : "Divine Magic",
			source : [["UA:RS", 5], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"When I change my prepared/known spells/cantrips, I can pick from the Cleric spell list.",
				"These Cleric spells count as Sorcerer spells for me.",
				"I also learn Cure Wounds, which doesn't count against my number of spells prepared."
			]),
			spellcastingBonus : {
				name : "Divine Magic",
				spells : ["cure wounds", "cure wounds ua23pt8"],
				selection : ["cure wounds", "cure wounds ua23pt8"],
			}
		},
		"subclassfeature3.1" : {
			name : "Favored by the Gods",
			source : [["UA:RS", 5]],
			minlevel : 3,
			description : "\n   " + "If I fail a saving throw or miss with an attack roll, I can add 2d4 to the total",
			recovery : "short rest",
			usages : 1
		},
		"subclassfeature6" : {
			name : "Empowered Healing",
			source : [["UA:RS", 5]],
			minlevel : 6,
			description : " [1 Sorcery Point]" + desc([
				"When I roll dice for healing with one of my Sorcerer spells, I can reroll them once",
				"By spending 1 Sorcery Point, I can reroll any number of those dice for that spell"
			])
		},
		"subclassfeature14" : {
			name : "Angelic Form",
			source : [["UA:RS", 5]],
			minlevel : 14,
			description : desc([
				'Choose an otherworldly quality using the "Choose Feature" button above.',
				"As a Bonus Action, I can manifest a pair of spectral wings that give me 30 ft Fly Speed.",
				"These wings last until I become Incapacitated or I dismiss them as a Bonus Action.",
			]),
			choices : ["Beautiful", "Youthful", "Kind", "Imposing"],
			"beautiful" : {
				name : "Angelic Form: Beautiful",
				description : desc([
					"My appearance takes on an otherworldly quality of beauty.",
					"As a Bonus Action, I can manifest a pair of spectral wings that give me 30 ft Fly Speed.",
					"These wings last until I become Incapacitated or I dismiss them as a Bonus Action.",
				])
			},
			"youthful" : {
				name : "Angelic Form: Youthful",
				description : desc([
					"My appearance takes on an otherworldly quality of youthfulness.",
					"As a Bonus Action, I can manifest a pair of spectral wings that give me 30 ft Fly Speed.",
					"These wings last until I become Incapacitated or I dismiss them as a Bonus Action.",
				])
			},
			"kind" : {
				name : "Angelic Form: Kind",
				description : desc([
					"My appearance takes on an otherworldly quality of kindness.",
					"As a Bonus Action, I can manifest a pair of spectral wings that give me 30 ft Fly Speed.",
					"These wings last until I become Incapacitated or I dismiss them as a Bonus Action.",
				])
			},
			"imposing" : {
				name : "Angelic Form: Imposing",
				description : desc([
					"My appearance takes on an otherworldly quality of imposingness.",
					"As a Bonus Action, I can manifest a pair of spectral wings that give me 30 ft Fly Speed.",
					"These wings last until I become Incapacitated or I dismiss them as a Bonus Action.",
				])
			},
			action : ["bonus action", " Wings"],
			speed : { fly : { spd : 30, enc : 20 } }
		},
		"subclassfeature18" : {
			name : "Unearthly Recovery",
			source : [["UA:RS", 6]],
			minlevel : 18,
			description : desc([
				"As a Bonus Action when I have less than half of my max HP remaining, I can heal myself",
				"I regain a number of HP equal to half my hit point maximum"
			]),
			action : ["bonus action", ""],
			recovery : "long rest",
			usages : 1
		}
	}
});
AddSubClass("sorcerer_ua23pt7", "giant soul-ua", {
	regExpSearch : /^(?=.*giant)(?=.*soul)(?=.*sorcerer).*$/i,
	subname : "Giant Soul",
	source : [["UA:GSS", 1], ["MJ:HB", 0]],
	fullname : "Giant Soul Sorcerer (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Jotun Resilience",
			source : [["UA:GSS", 1]],
			minlevel : 3,
			description : "\n   " + "My hit point maximum increases by an amount equal to my Sorcerer level",
			calcChanges : {
				hp : function (totalHD) {
					if (classes.known.sorcerer) {
						return [classes.known.sorcerer.level, "Jotun Resilience (sorcerer level)"];
					}
				}
			}
		},
		"subclassfeature3.1" : {
			name : "Mark of Ordning",
			source : [["UA:GSS", 1], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				'Choose a giant heritage using the "Choose Feature" button above',
				"I learn spells based on my giant heritage, which I add to my prepared spells"
			]),
			choices : ["Cloud Giant", "Fire Giant", "Frost Giant", "Hill Giant", "Stone Giant", "Storm Giant"],
			"cloud giant" : {
				name : "Mark of Ordning: Cloud Giant",
				description : desc([
					"I add Minor Illusion, Fog Cloud and Invisibility to my prepared sorcerer spells",
					"These do not count against the number of cantrips/spells I can know/prepare"
				]),
				spellcastingExtra : ["minor illusion", "fog cloud", "invisibility"],
			},
			"fire giant" : {
				name : "Mark of Ordning: Fire Giant",
				description : desc([
					"I add Fire Bolt, Burning Hands, and Flaming Sphere to my prepared sorcerer spells",
					"These do not count against the number of cantrips/spells I can know/prepare"
				]),
				spellcastingExtra : ["fire bolt", "burning hands", "flaming sphere"],
			},
			"frost giant" : {
				name : "Mark of Ordning: Frost Giant",
				description : desc([
					"I add Ray of Frost, Armor of Agathys, and Hold Person to my prepared sorcerer spells",
					"These do not count against the number of cantrips/spells I can know/prepare"
				]),
				spellcastingExtra : ["ray of frost", "armor of agathys", "hold person"],
			},
			"hill giant" : {
				name : "Mark of Ordning: Hill Giant",
				description : desc([
					"I add Shillelagh, Heroism, and Enlarge/Reduce to my prepared sorcerer spells",
					"These do not count against the number of cantrips/spells I can know/prepare"
				]),
				spellcastingExtra : ["shillelagh", "shillelagh ua23bc", "heroism", "enlarge/reduce"],
			},
			"stone giant" : {
				name : "Mark of Ordning: Stone Giant",
				description : desc([
					"I add Resistance, Entangle, and Spike Growth to my prepared sorcerer spells",
					"These do not count against the number of cantrips/spells I can know/prepare"
				]),
				spellcastingExtra : ["resistance", "resistance ua22cs", "entangle", "spike growth"],
			},
			"storm giant" : {
				name : "Mark of Ordning: Storm Giant",
				description : desc([
					"I add Thunderwave, Shocking Grasp, and Gust of Wind to my prepared sorcerer spells",
					"These do not count against the number of cantrips/spells I can know/prepare"
				]),
				spellcastingExtra : ["thunderwave", "shocking grasp", "shocking grasp ua23bc", "gust of wind"],
			},
			choiceDependencies : [{ feature : "subclassfeature6" }]
		},
		"subclassfeature6" : {
			name : "Soul of Lost Ostoria",
			source : [["UA:GSS", 1]],
			minlevel : 6,
			description : "\n   " + 'Use the "Choose Feature" button above to select the giant heritage',
			choices : ["Cloud Giant", "Fire Giant", "Frost Giant", "Hill Giant", "Stone Giant", "Storm Giant"],
			choicesNotInMenu : true,
			"cloud giant" : {
				name : "Soul of Lost Ostoria: Cloud Giant",
				description : desc([
					"As a Bonus Action after casting any of my Mark of Ordning spells, I can teleport",
					"I teleport to an unoccupied space that I can see up to my Con mod + 10 ft away"
				]),
				action : ["bonus action", ""]
			},
			"fire giant" : {
				name : "Soul of Lost Ostoria: Fire Giant",
				description : "\n   " + "I add my Constitution modifier (min 1) to the damage of my Mark of Ordning spells",
				calcChanges : {
					atkCalc : [
						function (fields, v, output) {
							if (v.baseWeaponName == 'fire bolt') output.extraDmg += Math.max(What('Con Mod'), 1);
						},
						"I add my Constitution modifier (min 1) to the damage of my Mark of Ordning spells: Fire Bolt, Burning Hands, and Flaming Sphere"
					],
					spellAdd : [
						function (spellKey, spellObj, spName) {
							if (spName == "sorcerer" && (/^(fire bolt|burning hands|flaming sphere)$/i).test(spellKey)) {
								spellObj.description = spellObj.description.replace(/d(6|10)/, "d$1+" + Math.max(1, What("Con Mod")));
								return true;
							};
						},
						"I add my Constitution modifier (min 1) to the damage of my Mark of Ordning spells: Fire Bolt, Burning Hands, and Flaming Sphere"
					]
				}
			},
			"frost giant" : {
				name : "Soul of Lost Ostoria: Frost Giant",
				description : desc([
					"Immediately after casting any of my Mark of Ordning spells, I gain temporary HP",
					"I gain my Con mod in temporary HP (min 1) and its added to that of the spell (if any)"
				])
			},
			"hill giant" : {
				name : "Soul of Lost Ostoria: Hill Giant",
				source : [["UA:GSS", 2]],
				description : desc([
					"Immediately after casting any of my Mark of Ordning spells, I can magically push others",
					"I can select up to two creatures within 5 ft of me that each have to make a Str save",
					"If failed, it is pushed my Con mod (min 1) + 5 ft away from me; It can choose to fail"
				])
			},
			"stone giant" : {
				name : "Soul of Lost Ostoria: Stone Giant",
				source : [["UA:GSS", 2]],
				description : desc([
					"Immediately after casting any of my Mark of Ordning spells, I gain a bonus to AC",
					"My AC increases with my Constitution modifier (min +1) until the end of my next turn"
				])
			},
			"storm giant" : {
				name : "Soul of Lost Ostoria: Storm Giant",
				source : [["UA:GSS", 2]],
				description : desc([
					"Immediately after casting any of my Mark of Ordning spells, I shoot lightning",
					"Up to 3 targets in 30 ft that I can see take my Con mod (min 1) in Lightning damage"
				])
			}
		},
		"subclassfeature14" : {
			name : "Rage of Fallen Ostoria",
			source : [["UA:GSS", 2]],
			minlevel : 14,
			description : desc([
				"When I start casting a Sorcerer spell using a spell slot on my turn, I can grow in size",
				"It lasts for 1 min or until I die or am Incapacitated; I can activate it only once per turn",
				"While it lasts, I enjoy the following benefits (which are cumulative, except the damage):",
				"\u2022 I increase size by one category (from Medium to Large, for example)",
				"\u2022 My current HP and maximum HP increase by a number equal to my Sorcerer level",
				"\u2022 My reach and Walking Speed both increase by 5 ft",
				"\u2022 I gain Advantage on Strength checks and Strength saving throws",
				"\u2022 I add my Constitution modifier to the damage of my melee weapon attacks (min +1)"
			]),
			additional : levels.map(function(n) {
				return n < 14 ? "" : "+" + n + " HP";
			}),
			usages : levels.map(function(n) {
				return n < 14 ? "" : n < 18 ? 1 : 2;
			}),
			recovery : "short rest"
		},
		"subclassfeature18" : {
			name : "Blessing of the All Father",
			source : [["UA:GSS", 2]],
			minlevel : 18,
			description : "\n   " + "I add +2 to my Constitution and its maximum increases to 22",
			scores : [0, 0, 2, 0, 0, 0],
			scoresMaximum : [0, 0, 22, 0, 0, 0]
		}
	}
});
/*RunFunctionAtEnd(function() { //Note from MasterJedi2014: This has one large piece of custom code that I think I didn't break by altering, but I might be wrong.
	var SorcererSubclassFavoredSoul = AddSubClass("sorcerer_ua23pt7", "favored soul-ua", {
		regExpSearch : /^(?=.*favou?red)(?=.*soul).*$/i,
		subname : "Favored Soul (UA:MC)",
		source : [["UA:MC", 8]],
		fullname : "Favored Soul",
		attacks : [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
		features : {
			"subclassfeature3" : {
				name : "Bonus Proficiencies",
				source : [["UA:MC", 9]],
				minlevel : 3,
				description : "\n   " + "I gain proficiency with Light Armor, Medium Armor, Shields, and Simple Weapons",
				armorProfs : [true, true, false, true],
				weaponProfs : [true, false]
			},
			"subclassfeature3.1" : {
				name : "Chosen of the Gods",
				source : [["UA:MC", 8]],
				minlevel : 3,
				description : "\n   " + 'Choose a Cleric Domain using the "Choose Feature" button above.' + "\n   " + "The chosen domain's spells count as Sorcerer spells, but do not count against the number of spells I can prepare.",
				choices : []
			},
			"subclassfeature14" : {
				name : "Divine Wings",
				source : [["UA:MC", 8]],
				minlevel : 14,
				description : "\n   " + "As a Bonus Action, I sprout feathered or bat wings from my back unless blocked by armor." + "\n   " + "I gain a Fly Speed equal to my current Speed until I dismiss the wings as a Bonus Action.",
				action : ["bonus action", " (start/stop)"],
				speed : { fly : { spd : "walk", enc : "walk" } }
			},
			"subclassfeature18" : {
				name : "Power of the Chosen",
				source : [["UA:MC", 8]],
				minlevel : 18,
				description : "\n   " + "When I cast a spell I gained from the Chosen of the Gods class feature, I heal myself." + "\n   " + "I regain a number of HP equal to my Charisma modifier (minimum 1) + the spell's level."
			},
		},
	});
	// Adding all cleric domain spells to the options of the first level ability "Chosen of the Gods"
	var FSfeat = ClassSubList[SorcererSubclassFavoredSoul].features["subclassfeature1.1"];
	for (var i = 0; i < ClassList.cleric_ua23pt6.subclasses[1].length; i++) {
		var cDomain = ClassSubList[ClassList.cleric_ua23pt6.subclasses[1][i]];
		if (cDomain && cDomain.spellcastingExtra) {
			var eSpells = newObj(cDomain.spellcastingExtra);
			eSpells[100] = "AddToKnown";
			var dSource = cDomain.source ? cDomain.source : cDomain.features["subclassfeature3"] && cDomain.features["subclassfeature3"].source ? cDomain.features["subclassfeature3"].source :[["UA:MC", 8]];
			
			var suffix = 1;
			var entryDoNm = cDomain.subname;
			while (FSfeat.choices.indexOf(entryDoNm) !== -1) {
				suffix += 1;
				entryDoNm = cDomain.subname + " (" + suffix + ")";
			};
			FSfeat.choices.push(entryDoNm);
			FSfeat[entryDoNm.toLowerCase()] = {
				name : "Chosen of the Gods: " + cDomain.subname,
				source : dSource,
				spellcastingExtra : eSpells,
				description : "\n   " + "I add the " + cDomain.subname.toLowerCase() + " spells to my prepared spells." + "\n   " + "These count as sorcerer spells, but do not count against the number of spells I can prepare."
			};
		};
	};
});*/

// Add Warlock subclasses
AddSubClass("warlock_ua23pt7", "the undying", {
	regExpSearch : /^(?!.*light)(?=.*warlock)(?=.*(immortal|undying|neverending|unending)).*$/i,
	subname : "the Undying",
	source : [["S", 139]],
	spellcastingExtra : ["spare the dying", "spare the dying ua23bc", "false life", "ray of sickness", "blindness/deafness", "silence", "feign death", "speak with dead", "aura of life", "death ward", "contagion", "legend lore"],
	features : {
		"subclassfeature3" : {
			name : "Among the Dead",
			source : [["S", 139]],
			minlevel : 3,
			description : "\n   " + "I learn the Spare the Dying cantrip and gain advantage on saving throws vs. diseases" + "\n   " + "If an undead targets me directly with an attack or spell, it must make a Wisdom save" + "\n   " + "On a fail, it must choose a new target or forfeit its attack or harmful spell" + "\n   " + "On a success or if I attack or cast a harmful spell on it, it is immune for 24 hours",
			savetxt : { adv_vs : ["disease"] },
		},
		"subclassfeature6" : {
			name : "Defy Death",
			source : [["S", 140]],
			minlevel : 6,
			description : "\n   " + "I regain 1d8 + my Constitution modifier in HP when I succeed on a Death saving throw" + "\n   " + "I also regain this amount whenever I use Spare the Dying to stabilize a creature",
			recovery : "long rest",
			usages : 1
		},
		"subclassfeature10" : {
			name : "Undying Nature",
			source : [["S", 140]],
			minlevel : 10,
			description : "\n   " + "I can hold my breath indefinitely; I don't require food, water, or sleep (I still need rest)" + "\n   " + "I age more slowly, only 1 year for every 10 years that pass; I can't be magically aged"
		},
		"subclassfeature14" : {
			name : "Indestructible Life",
			source : [["S", 140]],
			minlevel : 14,
			description : "\n   " + "As a Bonus Action, I can regain HP and reattach severed body parts",
			action : ["bonus action", ""],
			recovery : "short rest",
			usages : 1,
			additional : levels.map(function (n) { return n < 14 ? "" : "1d8 + " + n + " HP"; })
		}
	}
});
AddSubClass("warlock_ua23pt7", "the hexblade", { // this code includes contributions by SoilentBrad
	regExpSearch : /^(?=.*hexblade)(?=.*warlock).*$/i,
	subname : "the Hexblade",
	source : [["X", 55]],
	spellcastingExtra : ["shield", "wrathful smite", "wrathful smite ua23pt6", "blur", "branding smite", "blink", "elemental weapon", "phantasmal killer", "staggering smite", "staggering smite ua23pt6", "banishing smite", "banishing smite ua23pt6", "cone of cold"],
	features : {
		"subclassfeature3" : {
			name : "Hexblade's Curse",
			source : [["X", 55]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I can curse a creature I can see within 30 ft of me for 1 minute",
				"\u2022 I add my Proficiency Bonus to damage rolls against the cursed target",
				"\u2022 My attack rolls against the cursed target score a critical hit on a roll of 19 and 20",
				"\u2022 If the target dies while cursed, I regain HP equal to my Warlock level + Cha mod",
				"The curse ends after 1 minute, when the target dies, I die, or I'm Incapacitated"
			]),
			recovery : "short rest",
			usages : 1,
			action : ["bonus action", ""],
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (!v.isDC && (/curse/i).test(v.WeaponTextName) && !v.CritChance) {
							v.CritChance = 19;
							fields.Description += (fields.Description ? '; ' : '') + 'Crit on 19-20';
						}
					},
					"If I include the word 'Curse' in the name of a weapon, the automation will treat the attack as being against a target of the Hexblade's Curse: adding my proficiency bonus to the damage and adding the increased chance of a critical hit to the description.",
					19
				],
				atkCalc : [
					function (fields, v, output) {
						if ((/curse/i).test(v.WeaponTextName)) output.extraDmg += output.prof;
					}, ""]
			}
		},
		"subclassfeature3.1" : {
			name : "Hex Warrior",
			source : [["X", 55]],
			minlevel : 3,
			description : desc([
				"I gain Proficiency with Medium Armor, Shields, and Martial Weapons",
				"When I finish a Long Rest, I can imbue one weapon I touch with my will",
				"Until my next Long Rest, I can use it with Charisma instead of Strength or Dexterity",
				"I have to be Proficient with the weapon and it can't have the Two-Handed property",
				"This benefit also works with every weapon from Pact of the Blade, with no restriction"
			]),
			armorProfs : [false, true, false, true],
			weaponProfs : [false, true],
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (What('Cha Mod') > What(AbilityScores.abbreviations[fields.Mod - 1] + ' Mod') && (v.pactWeapon || v.theWea.pactWeapon || /^(?=.*hexblade)(?!.*((^|[^+-]\b)2|\btwo).?hand(ed)?s?\b).*$/i.test(v.WeaponText))) {
							fields.Mod = 6;
						};
					},
					"If I include the word 'Hexblade' in the name of a weapon that is not two-handed, it gets treated as the weapon I imbued to use Charisma instead of Strength or Dexterity, if my Charisma modifier is higher than the ability it would otherwise use. Alternatively, if I have the Pact of the Blade feature, this will also work for any weapons set to be my Pact Weapon."
				]
			}
		},
		"subclassfeature6" : {
			name : "Accursed Specter",
			source : [["X", 56]],
			minlevel : 6,
			description : desc([
				"When I slay a humanoid, I can curse its soul and have it rise as a specter from its corpse",
				"It has the stats of a specter with Temporary Hit Points equal to half my Warlock level",
				"It rolls Initiative and has its own turns, obeying my verbal commands",
				"It gains a bonus to attack rolls equal to my Charisma modifier (min +0)",
				"The specter remains until the end of my next Long Rest, at which point it vanishes"
			]),
			additional : levels.map( function(n) { return n < 6 ? "" : Math.floor(n/2) + " temp HP"; }),
			usages : 1,
			recovery : "long rest",
			creaturesAdd : [["Accursed Specter", true]],
			creatureOptions : [{
				name : "Accursed Specter",
				nameAlt : ["Accursed Spectre"],
				source : [["X", 56]],
				size : 3,
				type : "Undead",
				alignment : "Chaotic Evil",
				ac : 12,
				hp : 22,
				hd : [5, 8],
				speed : "fly 50 ft (hover)",
				scores : [1, 14, 11, 10, 10, 12],
				damage_resistances : "acid; cold; fire; lightning; thunder; bludgeoning, piercing, and slashing from nonmagical weapons",
				damage_immunities : "necrotic, poison",
				condition_immunities : "charmed, exhaustion, grappled, paralyzed, petrified, poisoned, prone, restrained, unconscious",
				senses : "Darkvision 60 ft; While in sunlight, disadv. on Wis (Perception) checks using sight",
				passivePerception : 10,
				languages : "all languages it knew in life, but can't speak",
				challengeRating : "1",
				proficiencyBonus : 2,
				attacksAction : 1,
				attacks : [{
					name : "Life Drain",
					ability : 2,
					damage : [3, 6, "necrotic"],
					range : "Melee (5 ft)",
					description : "DC 10 Con save or HP max reduced by same as damage taken until a long rest",
					modifiers : ["max(oCha|0)", ""],
					abilitytodamage : false,
					tooltip : "A target of the specter's life drain must succeed on a DC 10 Constitution saving throw or its hit point maximum is reduced by an amount equal to the damage taken. This reduction lasts until the creature finishes a long rest. The target dies if this effect reduces its hit point maximum to 0."
				}],
				traits : [{
					name : "Incorporeal Movement",
					description : "The specter can move through other creatures and objects as if they were difficult terrain. It takes 5 (1d10) force damage if it ends its turn inside an object."
				}, {
					name : "Sunlight Sensitivity",
					description : "While in sunlight, the specter has disadvantage on attack rolls, as well as on Wisdom (Perception) checks that rely on sight."
				}, {
					name : "Life Drain",
					description : "A target of the specter's life drain must succeed on a DC 10 Constitution saving throw or its hit point maximum is reduced by an amount equal to the damage taken. This reduction lasts until the creature finishes a long rest. The target dies if this effect reduces its hit point maximum to 0."
				}],
				features : [{
					name : "Bound Spirit",
					description : "The specter obeys my verbal commands and remains in my service until the end of my next long rest, at which point it vanishes to the afterlife. It acts on its own turn with its own initiative."
				}],
				header : "Bound Spirit",
				eval : function(prefix) {
					AddTooltip(prefix + 'Comp.Use.HP.Temp', "The accursed specter gains half my warlock level as temporary HP when created.");
				},
				removeeval : function(prefix) {
					AddTooltip(prefix + 'Comp.Use.HP.Temp', "");
				},
				changeeval : function (prefix, newLvl) {
					if (!classes.known.warlock) return;
					Value(prefix + 'Comp.Use.HP.Temp', Math.floor(classes.known.warlock.level / 2));
				}
			}]
		},
		"subclassfeature10" : {
			name : "Armor of Hexes",
			source : [["X", 56]],
			minlevel : 10,
			description : desc([
				"As a Reaction when a Hexblade's Curse recipient hits me with an attack, I can roll a d6",
				"On a result of 4 or higher, the attacks misses me instead, regardless of its d20 roll"
			])
		},
		"subclassfeature14" : {
			name : "Master of Hexes",
			source : [["X", 56]],
			minlevel : 14,
			description : desc([
				"When the target of my Hexblade's Curse dies, I can curse another I can see within 30 ft",
				"I can't do this while Incapacitated and I don't regain HP from the death of the previous"
			])
		}
	}
});
AddSubClass("warlock_ua23pt7", "the fathomless", {
	regExpSearch : /^(?=.*warlock)(?=.*fathomless).*$/i,
	subname : "the Fathomless",
	source : [["T", 72]],
	spellcastingExtra : ["create or destroy water", "thunderwave", "gust of wind", "silence", "lightning bolt", "sleet storm", "control water", "summon elemental", "bigby's hand", "cone of cold"],
	features : {
		"subclassfeature3" : {
			name : "Tentacle of the Deeps",
			source : [["T", 72]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I can summon or move a spectral tentacle and make an attack with it",
				"I can summon it to a space within 60 ft that I can see or move an existing one 30 ft",
				"I make melee spell attacks with 10 ft reach with it that deal Cold damage",
				"Creatures hit by the tentacle suffer 10 ft Speed reduction until the start of my next turn",
				"The 10-ft long tentacle lasts for 1 minute or until I summon another"
			]),
			action : [["bonus action", " (summon/move)"]],
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
			additional : levels.map(function (n) {
				return (n < 10 ? 1 : 2) + "d8";
			}),
			weaponsAdd : ['Tentacle of the Deeps'],
			weaponOptions : [{
				regExpSearch : /^(?=.*tentacle)(?=.*\b(deeps?|spectral)\b).*$/i,
				name : "Tentacle of the Deeps",
				source : [["T", 72]],
				ability : 6,
				type : "Spell",
				damage : [1, 8, "Cold"],
				range : "Melee (10 ft)",
				description : "On hit, -10 ft speed until my next turn starts",
				abilitytodamage : false,
				tentacleOfTheDeeps : true
			}],
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.theWea.tentacleOfTheDeeps && classes.known.warlock.level >= 10) {
							fields.Damage_Die = '2d8';
						};
					},
					'',
					1
				]
			}
		},
		"subclassfeature3.1" : {
			name : "Gift of the Sea",
			source : [["T", 72]],
			minlevel : 3,
			description : "\n   I have a Swimming Speed of 40 ft and I can breathe underwater",
			speed : { swim : { spd : 40, enc : 30 } }
		},
		"subclassfeature6" : {
			name : "Oceanic Soul",
			source : [["T", 73]],
			minlevel : 6,
			description : desc([
				"I gain Resistance to Cold damage now that I'm even more at home in the depths",
				"While I'm fully submerged, others who are as well can understand my speech and I theirs"
			]),
			dmgres : ["Cold"],
			spellChanges : {
				"summon elemental" : {
					description : "Summon Water Elemental Spirit; obeys commands; takes turn after mine; vanishes at 0 hp (400gp)",
					changes : "My warlock spell Summon Elemental can only call forth an elemental spirit of water."
				}
			}
		},
		"subclassfeature6.1" : {
			name : "Guardian Coil",
			source : [["T", 73]],
			minlevel : 6,
			description : desc([
				"As a Reaction when I or a creature I see in 10 ft of my tentacle is damaged, it can help",
				"The tentacle interposes itself, reducing the damage of the attack for that creature"
			]),
			action : [["reaction", ""]],
			additional : levels.map(function (n) {
				return (n < 10 ? 1 : 2) + "d8 damage reduced";
			})
		},
		"subclassfeature10" : {
			name : "Grasping Tentacles",
			source : [["T", 73]],
			minlevel : 10,
			description : desc([
				"I learn Evard's Black Tentacles; Once per long rest, I can cast it without using a spell slot",
				"It counts as a Warlock spell for me, but not towards the number of spell I can prepare",
				"Whenever I cast it, I gain temporary hit points equal to my Warlock level",
				"Moreover, damage can't break my concentration on this spell"
			]),
			action : [["action", ""]],
			additional : levels.map(function (n) {
				return n < 10 ? "" : n + " temp HP; 1\xD7 per long rest no SS";
			}),
			spellcastingBonus : {
				name : "Grasping Tentacles",
				spells : ["evard's black tentacles"],
				selection : ["evard's black tentacles"],
				firstCol : "oncelr"
			},
			extraLimitedFeatures : [{
				name : "Evard's Black Tentacles (no spell slot)",
				usages : 1,
				recovery : "long rest"
			}],
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (spellKey === "evard's black tentacles") {
							spellObj.description = "I temp hp; All enter/start in 20-ft rad save or restrained \u0026 3d6 Bludg. dmg/rnd; Str/Dex check escape";
							spellObj.duration = "Conc*, 1 min";
							return true;
						}
					},
					"Whenever I cast Evard's Black Tentacles, I gain temporary hit points equal to my warlock level.\n \u2022 Damage can't break my concentration on this spell."
				]
			}
		},
		"subclassfeature14" : {
			name : "Fathomless Plunge",
			source : [["T", 73]],
			minlevel : 14,
			description : desc([
				"As an Action, I can teleport myself and up to 5 willing creatures I can see within 30 ft",
				"We reappear up to 1 mile away, inside or within 30 ft of a body of water I've seen"
			]),
			action : [["action", ""]],
			recovery : "short rest",
			usages : 1
		}
	}
});
AddSubClass("warlock_ua23pt7", "the genie", {
	regExpSearch : /^(?=.*warlock)(?=.*(genie|dao|djinni|efreeti|marid)).*$/i,
	subname : "the Genie",
	source : [["T", 73], ["UA:SR", 2]],
	features : {
		"subclassfeature3" : {
			name : "Choose Genie Kind",
			source : [["T", 73], ["UA:SR", 3]],
			minlevel : 3,
			description : '\n   Use the "Choose Feature" button above to choose the kind of genie your patron is',
			calcChanges : {
				spellList : [
					function(spList, spName, spType) {
						if (spType.indexOf("bonus") !== -1 && spList.name && /mystic arcanum/i.test(spList.name) && spList.level[0] === 9) {
							spList.extraspells.push("wish");
						} else if (spType.indexOf("bonus") === -1 && spName === "warlock") {
							if (!spList.notspells) spList.notspells = [];
							spList.notspells.push("wish");
						}
					},
					"The Genie patron adds Wish as a spell available for my 9th-level Mystic Arcanum selection."
				]
			},
			choices : ["Dao (earth)", "Djinni (air)", "Efreeti (fire)", "Marid (water)"],
			"dao (earth)" : {
				name : "Dao Genie Patron",
				description : "\n   My genie patron is a Dao, associated with earth",
				spellcastingExtra : ["detect evil and good", "sanctuary", "phantasmal force", "spike growth", "create food and water", "meld into stone", "phantasmal killer", "stone shape", "creation", "wall of stone", "wish"]
			},
			"djinni (air)" : {
				name : "Djinni Genie Patron",
				description : "\n   My genie patron is a Djinni, associated with air",
				spellcastingExtra : ["detect evil and good", "thunderwave", "gust of wind", "phantasmal force", "create food and water", "wind wall", "greater invisibility", "phantasmal killer", "creation", "seeming", "wish"]
			},
			"efreeti (fire)" : {
				name : "Efreeti Genie Patron",
				description : "\n   My genie patron is an Efreeti, associated with fire",
				spellcastingExtra : ["burning hands", "detect evil and good", "phantasmal force", "scorching ray", "create food and water", "fireball", "fire shield", "phantasmal killer", "creation", "flame strike", "wish"]
			},
			"marid (water)" : {
				name : "Marid Genie Patron",
				description : "\n   My genie patron is a Marid, associated with water",
				spellcastingExtra : ["detect evil and good", "fog cloud", "blur", "phantasmal force", "create food and water", "sleet storm", "control water", "phantasmal killer", "cone of cold", "creation", "wish"]
			},
			choiceDependencies : [{
				feature : "subclassfeature3.3"
			}, {
				feature : "subclassfeature6"
			}]
		},
		"subclassfeature3.1" : {
			name : "Genie's Vessel",
			source : [["T", 73], ["UA:SR", 3]],
			minlevel : 3,
			description : desc([
				"My patron gifts me a magical vessel, a Tiny object, granting me a measure of its power",
				"I choose the vessel's appearance; I can use it as my spellcasting focus for Warlock spells",
				"The vessel's AC is my spell save DC and it has my warlock level + Proficiency Bonus in HP",
				"If it is destroyed or lost, I can get a replacement with a 1-hour ceremony during a rest"
			])
		},
		"subclassfeature3.2" : {
			name : "Genie's Vessel: Bottled Respite",
			source : [["T", 74], ["UA:SR", 3]],
			minlevel : 3,
			description : desc([
				"As an Action, I can vanish and enter the extradimensional space inside my genie's vessel",
				"The vessel stays in its location; The space inside is a 20-ft high, 20-ft radius cylinder",
				"As a Bonus Action, I can exit my vessel; I exit it early if I die or the vessel is destroyed",
				"I can remain inside for twice my Proficiency Bonus in hours; Objects can be left inside"
			]),
			limfeaname : "Bottled Respite",
			action : [["action", " (enter)"], ["bonus action", " (eject)"]],
			usages : 1,
			recovery : "long rest"
		},
		"subclassfeature3.3" : {
			name : "Genie's Wrath",
			source : [["T", 73], ["UA:SR", 3]],
			minlevel : 3,
			description : desc([
				"I can deal bonus damage on my attacks, its type depending on my patron's genie kind",
				'Use the "Choose Feature" button above to choose the kind of genie your patron is'
			]),
			choices : ["dao (earth)", "djinni (air)", "efreeti (fire)", "marid (water)"],
			choicesNotInMenu : true,
			"dao (earth)" : {
				name : "Dao's Wrath",
				description : " [once on each of my turns]\n   When I hit an attack, I can have it deal my Prof Bonus in extra Bludgeoning damage",
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (!v.isDC) {
								fields.Description += (fields.Description ? '; ' : '') + 'Once per my turn +' + How('Proficiency Bonus') + ' bludgeoning damage';
							}
						},
						"Once on each of my turns, I can have one of my attacks that hit deal extra Bludgeoning damage equal to my proficiency bonus."
					]
				}
			},
			"djinni (air)" : {
				name : "Djinni's Wrath",
				description : " [once on each of my turns]\n   When I hit an attack, I can have it deal my Proficiency Bonus in extra Thunder damage",
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (!v.isDC) {
								fields.Description += (fields.Description ? '; ' : '') + 'Once per my turn +' + How('Proficiency Bonus') + ' thunder damage';
							}
						},
						"Once on each of my turns, I can have one of my attacks that hit deal extra Thunder damage equal to my proficiency bonus."
					]
				}
			},
			"efreeti (fire)" : {
				name : "Efreeti's Wrath",
				description : " [once on each of my turns]\n   When I hit an attack, I can have it deal my Proficiency Bonus in extra Fire damage",
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (!v.isDC) {
								fields.Description += (fields.Description ? '; ' : '') + 'Once per my turn +' + How('Proficiency Bonus') + ' fire damage';
							}
						},
						"Once on each of my turns, I can have one of my attacks that hit deal extra Fire damage equal to my proficiency bonus."
					]
				}
			},
			"marid (water)" : {
				name : "Marid's Wrath",
				description : " [once on each of my turns]\n   When I hit an attack, I can have it deal my Proficiency Bonus in extra Cold damage",
				calcChanges : {
					atkAdd : [
						function (fields, v) {
							if (!v.isDC) {
								fields.Description += (fields.Description ? '; ' : '') + 'Once per my turn +' + How('Proficiency Bonus') + ' cold damage';
							}
						},
						"Once on each of my turns, I can have one of my attacks that hit deal extra Cold damage equal to my proficiency bonus."
					]
				}
			}
		},
		"subclassfeature6" : {
			name : "Elemental Gift",
			source : [["T", 75], ["UA:SR", 3]],
			minlevel : 6,
			description : desc([
				"I gain Resistance to a damage type depending on my patron's genie kind",
				'Use the "Choose Feature" button above to choose the kind of genie your patron is',
				"As a Bonus Action, I can gain a Flying Speed of 30 ft and I can Hover, for 10 minutes"
			]),
			choices : ["dao (earth)", "djinni (air)", "efreeti (fire)", "marid (water)"],
			choicesNotInMenu : true,
			"dao (earth)" : {
				name : "Dao's Elemental Gift",
				description : desc([
					"I gain Resistance to Bludgeoning damage",
					"As a Bonus Action, I can gain a Flying Speed of 30 ft and I can Hover, for 10 minutes"
				]),
				action : [["bonus action", " (start fly)"]],
				dmgres : ["Bludgeoning"]
			},
			"djinni (air)" : {
				name : "Djinni's Elemental Gift",
				description : desc([
					"I gain Resistance to Thunder damage",
					"As a Bonus Action, I can gain a Flying Speed of 30 ft and I can Hover, for 10 minutes"
				]),
				action : [["bonus action", " (start fly)"]],
				dmgres : ["Thunder"]
			},
			"efreeti (fire)" : {
				name : "Efreeti's Elemental Gift",
				description : desc([
					"I gain Resistance to Fire damage",
					"As a Bonus Action, I can gain a Flying Speed of 30 ft and I can Hover, for 10 minutes"
				]),
				action : [["bonus action", " (start fly)"]],
				dmgres : ["Fire"]
			},
			"marid (water)" : {
				name : "Marid's Elemental Gift",
				description : desc([
					"I gain Resistance to Cold damage",
					"As a Bonus Action, I can gain a Flying Speed of 30 ft and I can Hover, for 10 minutes"
				]),
				action : [["bonus action", " (start fly)"]],
				dmgres : ["Cold"]
			},
			additional : "Fly 10 min",
			usages : "Prof Bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature10" : {
			name : "Sanctuary Vessel",
			source : [["T", 75], ["UA:SR", 3]],
			minlevel : 10,
			description : desc([
				"When I enter my vessel I can have up to 5 willing creatures I can see in 30 ft join me",
				"As a Bonus Action, I can eject any number of creatures from my genie's vessel",
				"Everyone is ejected when I leave it, I die, or if the vessel is destroyed",
				"Anyone who remains in the vessel for at least 10 min gains the benefits of a Short Rest",
				"Also, HD spend as part of this short rest has my Proficiency Bonus added to the roll"
			])
		},
		"subclassfeature14" : {
			name : "Limited Wish",
			source : [["T", 75], ["UA:SR", 3]],
			minlevel : 14,
			description : " [1\xD7 per 1d4 long rests]" + desc([
				"As an Action, I can cast a 6th-level or lower spell with a casting time time of one action",
				"This can be any spell; It doesn't require any costly components, it simply takes effect"
			]),
			action : [["action", ""]],
			extraLimitedFeatures : [{
				name : "Limited Wish",
				usages : 1,
				recovery : "1d4 LR"
			}]
		}
	}
});
AddSubClass("warlock_ua23pt7", "the undead",{
	regExpSearch : /^(?=.*undead)(?=.*warlock).*$/i,
	subname : "the Undead",
	source : [["VRGtR", 30]],
	spellcastingExtra : ["bane", "false life", "blindness/deafness", "phantasmal force", "phantom steed", "speak with dead", "death ward", "greater invisibility", "antilife shell", "cloudkill"],
	features : {
		"subclassfeature3" : {
			name : "Form of Dread",
			source : [["VRGtR", 30]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I can transform for 1 minute and gain the following benefits:",
				" \u2022 I gain Temporary Hit Points equal to 1d10 + my Warlock level",
				" \u2022 I am immune to the Frightened condition",
				" \u2022 Once per turns when I hit an attack, I can force the target to make a Wis save",
				"   If the target fails this save, it is Frightened of me until the end of my next turn"
			]),
			additional : levels.map(function (n) {
				return "1d10+" + n + " temp HP";
			}),
			usages : "Prof Bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest",
			action : [["bonus action", ""]],
			savetxt : { immune : ["frightened (Form of Dread)"] }
		},
		"subclassfeature6" : {
			name : "Grave Touched",
			source : [["VRGtR", 30]],
			minlevel : 6,
			description : desc([
				"I no longer need to eat, drink, or breathe",
				"Once per turn if I damage a creature with an attack, I can change its type to Necrotic",
				"While I'm in my Form of Dread, I can roll one extra damage die for this Necrotic damage"
			])
		},
		"subclassfeature10" : {
			name : "Necrotic Husk",
			source : [["VRGtR", 31]],
			minlevel : 10,
			description : desc([
				"I have Resistance to Necrotic damage, or Immunity while I'm in my Form of Dread",
				"As a Reaction when reduced to 0 HP, I can drop to 1 HP instead and erupt with energy",
				"Each creature of my choice within 30 ft takes 2d10 + my Warlock level Necrotic damage",
				"After this, I gain 1 level of Exhaustion and must complete 1d4 Long Rests to do so again"
			]),
			additional : levels.map(function (n) {
				return n < 10 ? "" : "2d10+" + n + " damage, 1\xD7 per 1d4 long rests"
			}),
			action : [["reaction", ""]],
			dmgres : [["Necrotic"]],
			savetxt : { immune : ["necrotic (Form of Dread)"] },
			extraLimitedFeatures : [{
				name : "Necrotic Husk (revive)",
				usages : 1,
				recovery : "1d4 LR"
			}]
		},
		"subclassfeature14" : {
			name : "Spirit Projection",
			source : [["VRGtR", 31]],
			minlevel : 14,
			description : desc([
				"As an action, I can project my spirit from my body, leaving it suspended and Unconscious",
				"This lasts 1 hour or until my concentration is broken; Damage and effects affect both",
				"When it ends, I can have my spirit return to my body or my body teleport to my spirit",
				"My spirit has my abilities, but no gear; While projecting I gain the following benefits:",
				" \u2022 My spirit and body gain Resistance to Bludgeoning, Piercing, and Slashing damage",
				" \u2022 My Conjuration/Necromancy spells need no Verbal, Somatic, non-costly Material comp.",
				" \u2022 I gain a Flying Speed equal to my Walking Speed and can Hover",
				" \u2022 Move through creatures/objects as Difficult Terrain; 1d10 force damage if end turn in",
				" \u2022 While in my Form of Dread, once per turns when I deal Necrotic damage, I can heal",
				"   I regain hit points equal to half the amount of Necrotic damage dealt"
			]),
			usages : 1,
			recovery : "long rest",
			action : [["action", ""]]
		}
	}
});
AddSubClass("warlock_ua23pt7", "ghost in the machine-ua", { // Still valid 2021-09-21
	regExpSearch : /^(?=.*warlock)(?=.*ghost)(?=.*(machine|computer)).*$/i,
	subname : "the Ghost in the Machine",
	source : [["UA:MM", 2]],
	spellcastingExtra : ["infallible relay-ua", "remote access-ua", "arcane hacking-ua", "digital phantom-ua", "haywire-ua", "invisibility to cameras-ua", "conjure knowbot-ua", "system backdoor-ua", "shutdown-ua", "synchronicity-ua"],
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiency",
			source : [["UA:MM", 2]],
			minlevel : 3,
			description : "\n   " + "I am proficient with hacking tools and know the On/Off cantrip",
			toolProfs : ["Hacking tools"],
			spellcastingBonus : {
				name : "Bonus Cantrip (On/Off)",
				spells : ["on/off-ua"],
				selection : ["on/off-ua"]
			}
		},
		"subclassfeature3.1" : {
			name : "Information Surge",
			source : [["UA:MM", 2]],
			minlevel : 3,
			description : desc([
				"As an action, I can cause a computerized device within 30 ft to make an Int save",
				"If the device is held/used by a creature, that creature makes the saving throw",
				"If the device is not held/used, it makes a save with a +0 modifier and disadvantage",
				"On a failed save, the device stops functioning until the end of my next turn"
			]),
			usages : 1,
			recovery : "short rest",
			action : ["action", ""]
		},
		"subclassfeature6" : {
			name : "Wire Walk",
			source : [["UA:MM", 3]],
			minlevel : 6,
			description : desc([
				"As a bonus action, I can teleport through a hardwired network to a point I can see",
				"Both where I start and end must be a device, cable, or socket connected to the network"
			]),
			usages : 1,
			recovery : "long rest",
			action : ["bonus action", ""]
		},
		"subclassfeature10" : {
			name : "Personal Encryption",
			source : [["UA:MM", 3]],
			minlevel : 10,
			description : desc([
				"I have adv. on saves vs. scrying, thought detection, and magics for learning my location",
				"If the effect doesn't let me a save, the user has disadv. on checks to use it on me, if any"
			])
		},
		"subclassfeature14" : {
			name : "Technovirus",
			source : [["UA:MM", 3]],
			minlevel : 14,
			description : desc([
				"As an action, I make a melee spell attack to infect someone with a techno-organic virus",
				"The target takes 8d10 psychic damage, or half that with a successful Con save",
				"If it failed its save, I can use an action to cast Command on it while it remains infected",
				"It makes its save vs. this Command with disadvantage and I can cast it at any range",
				"It is infected until my next long rest; The virus can be removed with Lesser Restoration"
			]),
			usages : 1,
			recovery : "long rest",
			action : ["action", ""]
		}
	}
});
AddSubClass("warlock_ua23pt7", "the undying light-ua", {
	regExpSearch : /^(?=.*warlock)(?=.*light)(?=.*(immortal|undying|neverending|unending)).*$/i,
	subname : "the Undying Light",
	source : [["UA:LDU", 3]],
	spellcastingExtra : ["burning hands", "flaming sphere", "daylight", "fire shield", "flame strike"],
	features : {
		"subclassfeature3" : {
			name : "Radiant Soul",
			source : [["UA:LDU", 3]],
			minlevel : 3,
			description : "\n   " + "I add my Cha modifier to cantrips/spells I cast that deal fire or radiant damage" + "\n   " + "I have resistance to radiant damage and know the Light and Sacred Flame cantrips",
			spellcastingBonus : [{
				name : "Radiant Soul",
				spells : ["light"],
				selection : ["light"]
			}, {
				name : "Radiant Soul",
				spells : ["sacred flame"],
				selection : ["sacred flame"]
			}],
			dmgres : ["Radiant"],
			calcChanges : {
				atkCalc : [
					function (fields, v, output) {
						if (v.isSpell && (/fire|radiant/i).test(fields.Damage_Type)) output.extraDmg += What('Cha Mod');
					},
					"Cantrips and spells that fire or radiant damage get my Charisma modifier added to their damage."
				],
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (!spellObj.psionic) return genericSpellDmgEdit(spellKey, spellObj, "fire|radiant", "Cha");
					},
					"Cantrips and spells that fire or radiant damage get my Charisma modifier added to their damage."
				]
			}
		},
		"subclassfeature6" : {
			name : "Searing Vengeance",
			source : [["UA:LDU", 3]],
			minlevel : 6,
			description : "\n   " + "When I would make a death saving throw, I can instead spring back to my feet" + "\n   " + "I immediately stand up and recover HP equal to half my current HP maximum" + "\n   " + "Also, all hostiles within 30 ft of me take 10 + Charisma modifier in radiant damage" + "\n   " + "Damaged creatures are blinded until the end of my next turn",
			usages : 1,
			recovery : "long rest"
		},
		"subclassfeature10" : {
			name : "Radiant Resilience",
			source : [["UA:LDU", 4]],
			minlevel : 10,
			description : "\n   " + "When I finish a short or long rest, I and up to five allies gain temporary hit points" + "\n   " + "I get my warlock level + Cha mod, while my allies get half my warlock level + Cha mod"
		},
		"subclassfeature14" : {
			name : "Healing Light",
			source : [["UA:LDU", 4]],
			minlevel : 14,
			description : "\n   " + "As a bonus action, I touch a creature and heal it by expending dice from my pool" + "\n   " + "I subtract the number of d6's used from my pool; I can expend up to 5d6 at a time" + "\n   " + "The target heals HP equal to the roll of the dice; I regain expended uses with a long rest",
			usages : "15d6 per ",
			usagescalc : "event.value = '15d6';",
			recovery : "long rest",
			action : ["bonus action", ""]
		}
	}
});
AddSubClass("warlock_ua23pt7", "the seeker-ua", { // Still valid 2021-09-21
	regExpSearch : /^(?=.*warlock)(?=.*seeker).*$/i,
	subname : "the Seeker",
	source : [["UA:TF", 1]],
	spellcastingExtra : ["feather fall", "jump", "jump ua23pt7", "levitate", "locate object", "clairvoyance", "sending", "arcane eye", "locate creature", "legend lore", "passwall"],
	features : {
		"subclassfeature3" : {
			name : "Shielding Aurora",
			source : [["UA:TF", 1]],
			minlevel : 3,
			description : "\n   " + "As a Bonus Action, I create a whirling aurora of brilliant energy around me" + "\n   " + "It lasts until the end of my next turn and grants me Resistance to all damage" + "\n   " + "Any hostile ending its turn in 10 ft of me get Warlock level + Cha mod Radiant damage",
			usages : 1,
			recovery : "short rest",
			action : ["bonus action", ""]
		},
		"subclassfeature6" : {
			name : "Astral Refuge",
			source : [["UA:TF", 2]],
			minlevel : 6,
			description : "\n   " + "As an action, I can step into an astral refuge, coming back at the end of the turn" + "\n   " + "While in the astral refuge, I can take two actions to cast spells targeting just me",
			action : ["action", ""]
		},
		"subclassfeature10" : {
			name : "Far Wanderer",
			source : [["UA:TF", 2]],
			minlevel : 10,
			description : "\n   " + "I no longer need to breathe, and I gain Resistance to Fire damage and Cold damage",
			dmgres : ["Cold", "Fire"]
		},
		"subclassfeature14" : {
			name : "Astral Sequestration",
			source : [["UA:TF", 2]],
			minlevel : 14,
			description : "\n   " + "With a 5 minutes ritual, I can shift myself and ten willing creatures to the Astral Plane" + "\n   " + "While sequestered on Astral Plane, we gain the full benefits of a Short Rest" + "\n   " + "After this rest, we return to the same space as before, without any time having passed",
			usages : 1,
			recovery : "long rest"
		}
	}
});
AddSubClass("warlock_ua23pt7", "the raven queen-ua", { // Still valid 2021-09-21; this code includes contributions by Ben Y. and Wizzard
	regExpSearch : /^(?=.*\braven)(?=.*queen\b).*$/i,
	subname : "the Raven Queen",
	source : [["UA:WnW", 2]],
	spellcastingExtra : ["false life", "sanctuary", "silence", "spiritual weapon", "spiritual weapon ua22cs", "feign death", "speak with dead", "ice storm", "locate creature", "commune", "cone of cold"],
	features : {
		"subclassfeature3" : {
			name : "Sentinel Raven",
			source : [["UA:WnW", 2]],
			minlevel : 3,
			description : desc([
				"I gain the services of a spirit in the form of a raven (using the stats of a raven)",
				"It always obeys my commands, rolls its own Initiative, and can be slain",
				"While it's within 100 ft, I can telepathically speak with it and see/hear what it does",
				"While it's on my shoulder, I gain Darkvision 30 ft and add my Cha mod to Perception",
				"While it's on my shoulder, it can't be targeted, take damage, or take actions",
				"It vanishes if it is more than 5 miles away from me, it dies, or if I die",
				"If it dies, I gain advantage on all attack rolls against its killer for 24 hours",
				"After a Short Rest, I can recall it to me regardless of its location or if it died"
			]),
			vision : [["Darkvision", 30]],
			addMod : { type : "skill", field : "Perc", mod : "max(Cha|0)", text : "While my sentinel raven is perched on my shoulder, I can add my Charisma modifier to Perception." },
			creaturesAdd : [["Sentinel Raven"]],
			creatureOptions : [{
				name : "Sentinel Raven",
				source : [["UA:WnW", 2]],
				size : 5,
				type : "Beast",
				alignment : "Unaligned",
				ac : 12,
				hp : 1,
				hd : [1, 4],
				speed : "10 ft, fly 50 ft",
				scores : [2, 14, 8, 2, 12, 6],
				skills : {
					"perception" : 3
				},
				senses : "",
				passivePerception : 13,
				challengeRating : "0",
				proficiencyBonus : 2,
				attacksAction : 1,
				attacks : [{
					name : "Beak",
					ability : 2,
					damage : [1, "", "piercing"],
					range : "Melee (5 ft)",
					description : "",
					abilitytodamage : false
				}],
				traits : [{
					name : "Mimicry",
					description : "The raven can mimic simple sounds it has heard, such as a person whispering, a baby crying, or an animal chittering. A creature that hears the sounds can tell they are imitations with a successful DC 10 Wisdom (Insight) check."
				}, {
					name : "Sentinel",
					description : "The raven doesn't require sleep. While it is within 100 feet of me, it can awaken me from sleep as a bonus action."
				}, {
					name : "Shoulder Perch",
					description : "While perched on my shoulder, the raven can't be targeted by any attack or other harmful effect; only I can cast spells on it; it can't take damage; and it is incapacitated. It then also grants me darkvision 30 ft and a bonus to my Wisdom (Perception) equal to my Charisma modifier."
				}],
				features : [{
					name : "Sent by the Raven Queen",
					description : "The raven acts independently of me, but it always obeys my commands. In combat, it rolls its own initiative and acts on its own turn, but I control how it acts. If it is slain by a creature, I gain advantage on all attack rolls against the killer for the next 24 hours. While the raven is within 100 ft of me, I can telepathically command it and see through its eyes and hear what it hears.\n   The raven vanishes when it dies, if I die, or if we are separated by more than 5 miles. At the end of a short or long rest, I can call the raven back to reappear within 5 ft of me, regardless where it is or if it died."
				}]
			}]
		},
		"subclassfeature6" : {
			name : "Soul of the Raven",
			source : [["UA:WnW", 2]],
			minlevel : 6,
			description : desc([
				"As a Bonus Action, when my raven is perched on my shoulder, I can merge our bodies",
				"I become Tiny and replace my Speed with the raven's (10 ft, fly 50 ft)",
				"I can then use my action only to Dash, Disengage, Dodge, Help, Hide, or Search",
				"While merged, I still get all the benefits of my raven being perched on my shoulder",
				"I can end this as an action"
			]),
			action : [["bonus action", " (start)"], ['action', ' (end)']]
		},
		"subclassfeature10" : {
			name : "Raven's Shield",
			source : [["UA:WnW", 3]],
			minlevel : 10,
			description : "\n   " + "I can't be Frightened, have Advantage on death saves, and Resistance to Necrotic damage",
			savetxt : { immune : ["frightened"], adv_vs : ["death"] },
			dmgres : ["Necrotic"]
		},
		"subclassfeature14" : {
			name : "Queen's Right Hand",
			source : [["UA:WnW", 3]],
			minlevel : 14,
			description : "\n   " + "I can cast Finger of Death once per long rest",
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				name : "Queen's Right Hand",
				spells : ["finger of death"],
				selection : ["finger of death"],
				firstCol : "oncelr"
			}
		}
	}
});
AddSubClass("warlock_ua23pt7", "the lurker in the deep-ua", {
	regExpSearch : /^(?=.*warlock)(?=.*lurker)(?=.*(deep|depth)).*$/i,
	subname : "the Lurker in the Deep",
	source : [["UA:SnW", 2]],
	spellcastingExtra : ["create or destroy water", "thunderwave", "gust of wind", "shatter", "lightning bolt", "sleet storm", "control water", "evard's black tentacles", "commune with nature", "cone of cold"],
	features : {
		"subclassfeature3" : {
			name : "Grasp of the Deep",
			source : [["UA:SnW", 3]],
			minlevel : 3,
			description : desc([
				"As a Bonus Action, I can summon or move a spectral tentacle and make an attack with it",
				"I can summon it to a space within 60 ft that I can see or move an existing one 30 ft",
				"I make melee spell attacks with 10 ft reach with it that deal Cold or Lightning damage",
				"Creatures hit by the tentacle suffer 10 ft Speed reduction until the start of my next turn",
				"The 10-ft long tentacle lasts for 1 minute or until I summon another"
			]),
			action : [["bonus action", " (summon/move)"]],
			recovery : "long rest",
			additional : levels.map(function (n) {
				return (n < 10 ? 1 : 2) + "d8";
			}),
			usages : "Cha mod per ",
			usagescalc : "event.value = Math.max(1, What('Cha Mod'));",
			weaponOptions : [{
				regExpSearch : /^((?=.*grasp)(?=.*deep)|(?=.*spectral)(?=.*tentacle)).*$/i,
				name : "Grasp of the Deep",
				source : [["UA:SnW", 3]],
				ability : 6,
				type : "Spell",
				damage : [1, 8, "Cold/Lightning"],
				range : "Melee (10 ft)",
				description : "My choice of Cold or Lightning damage; Target -10 ft speed until my next turn starts",
				abilitytodamage : false,
				litdGraspOfTheDeep : true
			}],
			weaponsAdd : ['Grasp of the Deep'],
			calcChanges : {
				atkAdd : [
					function (fields, v) {
						if (v.theWea.litdGraspOfTheDeep && classes.known.warlock.level >= 10) {
							fields.Damage_Die = '2d8';
						};
					}
				]
			}
		},
		"subclassfeature1.1" : {
			name : "Scion of the Deep",
			source : [["UA:SnW", 3]],
			minlevel : 1,
			description : desc([
				"I can communicate telepathically with any Aberration, Beast, Elemental, or Monstrosity",
				"The creature must be within 120 ft of me and have an innate Swimming Speed"
			])
		},
		"subclassfeature6" : {
			name : "Fathomless Soul",
			source : [["UA:SnW", 3]],
			minlevel : 6,
			description : " [cold resistance]\n   I have a Swimming Speed equal to my Walking Speed; I can breathe both air and water",
			dmgres : ["Cold"],
			speed : { swim : { spd : "walk", enc : "walk" } }
		},
		"subclassfeature6.1" : {
			name : "Guardian Grasp",
			source : [["UA:SnW", 3]],
			minlevel : 6,
			description : desc([
				"As a Reaction when a creature in 10 ft of my tentacle takes damage, I can have it help",
				"One creature takes only half damage and my spectral tentacle vanishes"
			]),
			action : [["reaction", ""]]
		},
		"subclassfeature10" : {
			name : "Devouring Maw",
			source : [["UA:SnW", 3]],
			minlevel : 10,
			description : desc([
				"As an action, I can summon a 10-ft radius translucent maw within 60 ft for 1 minute",
				"Creatures in the maw as it appear must Str save or be Restrained, can repeat save as action",
				"Creatures starting their turn in the maw take 3d6 Cold or Lightning damage (my choice)",
				"If a creature is in the maw at the start of my turn, I gain my Warlock level in Temp HP"
			]),
			action : [["action", ""]],
			additional : levels.map(function (n) {
				return n < 10 ? "" : n + " temp HP";
			}),
			recovery : "short rest",
			usages : 1
		},
		"subclassfeature14" : {
			name : "Unleash the Depths",
			source : [["UA:SnW", 4]],
			minlevel : 14,
			description : desc([
				"As an action, I can choose one of the following effects to occur within 30 ft of me:",
				"\u2022 Teleport myself and up to 5 willing creatures I can see within 30 ft of the chosen point",
				"  The destination must be within 100 miles and visited by me within the last 24 hours",
				"\u2022 5 creatures within 30 ft of the chosen point that I can see are attacked by tentacles",
				"  The targets take 6d10 Cold or Lightning damage (my choice) and are knocked Prone",
				"  Each can make a Dexterity save to halve the damage and avoid being knocked Prone"
			]),
			action : [["action", ""]],
			recovery : "long rest",
			usages : 1
		}
	}
});
AddSubClass("warlock_ua23pt7", "the noble genie-ua", {
	regExpSearch : /^(?=.*warlock)(?=.*noble)(?=.*\b(genie|djinni|dao|efreeti)\b).*$/i,
	subname : "the Noble Genie",
	source : [["UA:SP1", 4]],
	spellcastingExtra : ["fog cloud", "sleep", "enlarge/reduce", "phantasmal force", "create food and water", "protection from energy", "polymorph", "phantasmal killer", "bigby's hand", "creation"],
	features : {
		"subclassfeature3" : {
			name : "Collector's Vessel",
			source : [["UA:SP1", 5]],
			minlevel : 3,
			description : desc([
				"My patron gives me a magical vessel, a Tiny object which I can use as a spellcasting focus",
				"If I lose it, I can perform a 1-hour ceremony during a rest to receive a replacement",
				"As an action while holding it, I can create a tether to a willing target I can see in 100 ft",
				"This lasts for 1 hour, until I do this again, or the tethered target is reduced to 0 HP",
				"It also ends when the tethered target ends its turn further than 100 ft from me",
				"While the tether lasts, I add my Cha mod (min +1) to my Wis (Perception) checks",
				"Also, I can have spells I cast originate from the tethered creature's space"
			]),
			action : [["action", ""]],
			usages : "Charisma modifier per ",
			usagescalc : "event.value = Math.max(1, What('Cha Mod'));",
			recovery : "long rest"
		},
		"subclassfeature6" : {
			name : "Elemental Resistance",
			source : [["UA:SP1", 5]],
			minlevel : 6,
			description : desc([
				"When I finish a Long Rest, I can gain Acid, Cold, Fire, or Lightning Resistance (my choice)",
				"This lasts until I finish my next Long Rest; A creature tethered to my vessel also gains this"
			])
		},
		"subclassfeature10" : {
			name : "Protective Wish",
			source : [["UA:SP1", 5]],
			minlevel : 10,
			description : desc([
				"As a Reaction when I or my tethered creature is hit by an attack, we can swap places",
				"As we both teleport to each others location, the one hit by the attack switches as well"
			]),
			action : [["reaction", ""]]
		},
		"subclassfeature10.1" : {
			name : "Genie's Entertainment",
			source : [["UA:SP1", 6]],
			minlevel : 10,
			description : desc([
				"As an action, I can have a creature I can see within 90 ft make a Charisma save",
				"If failed, it is drawn into my vessel and teleported to my patron's court for 1 minute",
				"In there it is Stunned but unharmed; At the end of each of its turns it can save to return"
			]),
			recovery : "long rest",
			usages : 1
		},
		"subclassfeature14" : {
			name : "Collector's Call",
			source : [["UA:SP1", 6]],
			minlevel : 14,
			description : desc([
				"As an action, I can implore my patron if I make a Persuasion check vs. my spell save DC",
				"If I fail, the use is wasted; If I succeed, I can choose one of the following effects:",
				" \u2022 A creature I can see in 60 ft heals 8d6 HP and 1 Condition affecting it ends",
				"   This condition can be Blinded, Charmed, Deafened, Frightened, Paralyzed, or Poisoned",
				" \u2022 A creature I can see in 60 ft has Disadv. on attacks \u0026 saves until my next turn starts",
				" \u2022 I can cast Legend Lore without using material components",
				"I can regain a use of this by sacrificing 500 gp of nonmagical treasure to my patron"
			]),
			action : [["action", ""]],
			recovery : "long rest",
			usages : 1,
			spellcastingBonus : {
				name : "Collector's Call",
				spells : ["legend lore"],
				selection : ["legend lore"],
				firstCol : 'Sp'
			},
			spellChanges : {
				"legend lore" : {
					components : "V,S",
					compMaterial : "",
					description : "Learn summary of lore of named or described person, place, or object",
					changes : "When I use my Collector's Call feature to cast Legend Lore, it doesn't require any material components."
				}
			}
		}
	}
});

// Add Wizard subclasses
AddSubClass("wizard_ua23pt7", "conjuration", {
	regExpSearch : /(conjuration|conjurer)/i,
	subname : "School of Conjuration",
	fullname : "Conjurer (UA:PT-vii)",
	source : [["P", 116], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Conjuration Savant",
			source : [["P", 116], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can add two Conjuration spells from the Wizard spell list, each 2nd-lvl or lower, to my spellbook",
				"  for free. Additionally, when I gain a new level of spell slots in this class, I can add one",
				"  Conjuration spell from the Wizard spell list to my spellbook for free.",
			]),
			additional : ["", "", "2 Conj. spells", "2 Conj. spells", "3 Conj. spells", "3 Conj. spells", "4 Conj. spells", "4 Conj. spells", "5 Conj. spells", "5 Conj. spells", "6 Conj. spells", "6 Conj. spells", "7 Conj. spells", "7 Conj. spells", "8 Conj. spells", "8 Conj. spells", "9 Conj. spells", "9 Conj. spells", "10 Conj. spells", "10 Conj. spells"],
			spellcastingBonus : {
				name : "From the Conjuration school",
				"class" : ["wizard", "wizard_ua23pt7"],
				school : ["Conj"],
				times : [0, 0, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10],
			},
		},
		"subclassfeature3.1" : {
			name : "Minor Conjuration",
			source : [["P", 116]],
			minlevel : 3,
			description : "\n   " + "As an action, I can conjure an object up to 3 ft on each side and no more than 10 lbs" + "\n   " + "It must be of a form of a nonmagical object I have seen and is created within 10 ft" + "\n   " + "The object disappears after 1 hour, if it takes or deals damage, or when I use this again",
			action : ["action", ""]
		},
		"subclassfeature6" : {
			name : "Benign Transposition",
			source : [["P", 116]],
			minlevel : 6,
			description : "\n   " + "As an action, I can teleport to a place within 30 ft that I can see" + "\n   " + "Instead, I can swap places with a willing Small/Medium creature in 30 ft that I can see" + "\n   " + "I can do this again after a long rest or casting a 1st-level or higher conjuration spell",
			usages : 1,
			recovery : "long rest",
			action : ["action", ""]
		},
		"subclassfeature10" : {
			name : "Focused Conjuration",
			source : [["P", 116]],
			minlevel : 10,
			description : "\n   " + "While I am concentrating on a conjuration spell, it can't be broken by taking damage"
		},
		"subclassfeature14" : {
			name : "Durable Summons",
			source : [["P", 116]],
			minlevel : 14,
			description : "\n   " + "Any creature I summon or create with a conjuration spell has 30 temporary hit points",
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (spellKey.indexOf("conjure") !== -1 && !(/barrage|volley|knowbot/i).test(spellKey)) {
							spellObj.description = spellObj.description.replace(/verbal commands/i, "command").replace(/^summon /i, '') + "; +30 temp hp";
							return true;
						} else if ((/find (greater )?(steed|familiar)/i).test(spellKey)) {
							spellObj.description = spellObj.description.replace(/Gain the services of a ([^;]+)/i, "A $1 (+30 temp hp)");
							return true;
						}
					},
					"Any creature I summon or create with a conjuration spell gains 30 temporary hit points."
				]
			}
		}
	}
});
AddSubClass("wizard_ua23pt7", "enchantment", {
	regExpSearch : /(enchantment|enchanter)/i,
	subname : "School of Enchantment",
	fullname : "Enchanter (UA:PT-vii)",
	source : [["P", 117], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Enchantment Savant",
			source : [["P", 117], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can add two Enchantment spells from the Wizard spell list, each 2nd-lvl or lower, to my spellbook",
				"  for free. Additionally, when I gain a new level of spell slots in this class, I can add one",
				"  Enchantment spell from the Wizard spell list to my spellbook for free.",
			]),
			additional : ["", "", "2 Ench. spells", "2 Ench. spells", "3 Ench. spells", "3 Ench. spells", "4 Ench. spells", "4 Ench. spells", "5 Ench. spells", "5 Ench. spells", "6 Ench. spells", "6 Ench. spells", "7 Ench. spells", "7 Ench. spells", "8 Ench. spells", "8 Ench. spells", "9 Ench. spells", "9 Ench. spells", "10 Ench. spells", "10 Ench. spells"],
			spellcastingBonus : {
				name : "From the Enchantment school",
				"class" : ["wizard", "wizard_ua23pt7"],
				school : ["Ench"],
				times : [0, 0, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10],
			},
		},
		"subclassfeature3.1" : {
			name : "Hypnotic Gaze",
			source : [["P", 117]],
			minlevel : 3,
			description : "\n   " + "As an action, a seen enemy within 5 ft must make a Wis save or be charmed" + "\n   " + "This doesn't work if it can't see/hear me; It's also incapacitated and reduced to 0 speed" + "\n   " + "This lasts until the end of my next turn, but I can use an action to extend the duration" + "\n   " + "It also ends if it takes damage, can't see or hear me, or is more than 5 ft from me" + "\n   " + "On success or once it ends, I can't use this on it again until after a long rest",
			action : ["action", ""],
			usages : 1,
			recovery : "long rest"
		},
		"subclassfeature6" : {
			name : "Instinctive Charm",
			source : [["P", 117]],
			minlevel : 6,
			description : "\n   " + "As a reaction, when someone I can see in 30 ft attacks me, it must make a Wis save" + "\n   " + "If failed, it must instead attack the closest creature within range (not me or self)" + "\n   " + "On a success, the target is immune to this until after my long rest; This is a charm effect",
			action : ["reaction", " (when attacked)"]
		},
		"subclassfeature10" : {
			name : "Split Enchantment",
			source : [["P", 117]],
			minlevel : 10,
			description : "\n   " + "When I cast an enchantment spell with only one target, I can target a second in range" + "\n   " + "This does not apply to cantrips",
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (spellObj.psionic || !spellObj.level || spellObj.school !== "Ench") return;
						var startDescr = spellObj.description;
						switch(spellKey) {
							case "animal messenger" :
								spellObj.description = spellObj.description.replace("Tiny beast delivers", "2 tiny beasts deliver single");
								break;
							case "antipathy/sympathy" :
								spellObj.description = spellObj.description.replace("Creature,", "2 crea, 1");
								break;
							case "heroism" :
							case "command" :
								spellObj.description = spellObj.description.replace(/, halt| as spell lasts/i, "");
							default :
								spellObj.description = spellObj.description.replace("1+1/SL", "2 or 1+1/SL").replace(/1 (crea(ture)?|beast|humanoid)/i, "2 $1s").replace(/creas\b/gi, "crea");
						}
						return startDescr !== spellObj.description;
					},
					"My enchantment, single-target 1st-level or higher spells can affect two targets instead of only one."
				]
			}
		},
		"subclassfeature14" : {
			name : "Alter Memories",
			source : [["P", 117]],
			minlevel : 14,
			description : "\n   " + "When I cast an enchantment spell that charms, I can have one target be unaware of it" + "\n   " + "Also, once before that spell ends, I can have that target forget time while affected" + "\n   " + "It must make an Intelligence save or lose up to 1 + Charisma modifier hours of memory"
		}
	}
});
AddSubClass("wizard_ua23pt7", "necromancy", {
	regExpSearch : /necromancy|necromancer|necromantic/i,
	subname : "School of Necromancy",
	fullname : "Necromancer (UA:PT-vii)",
	source : [["P", 118], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Necromancy Savant",
			source : [["P", 118], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can add two Necromancy spells from the Wizard spell list, each 2nd-lvl or lower, to my spellbook",
				"  for free. Additionally, when I gain a new level of spell slots in this class, I can add one",
				"  Necromancy spell from the Wizard spell list to my spellbook for free.",
			]),
			additional : ["", "", "2 Necro. spells", "2 Necro. spells", "3 Necro. spells", "3 Necro. spells", "4 Necro. spells", "4 Necro. spells", "5 Necro. spells", "5 Necro. spells", "6 Necro. spells", "6 Necro. spells", "7 Necro. spells", "7 Necro. spells", "8 Necro. spells", "8 Necro. spells", "9 Necro. spells", "9 Necro. spells", "10 Necro. spells", "10 Necro. spells"],
			spellcastingBonus : {
				name : "From the Necromancy school",
				"class" : ["wizard", "wizard_ua23pt7"],
				school : ["Necro"],
				times : [0, 0, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10],
			},
		},
		"subclassfeature3.1" : {
			name : "Grim Harvest",
			source : [["P", 118]],
			minlevel : 3,
			description : "\n   " + "Once per turn, when I kill something with a 1st-level or higher spell, I regain hit points" + "\n   " + "The number of hit points regained is 2\xD7 the spell's level (or 3\xD7 with necromancy spells)" + "\n   " + "This doesn't occur for constructs/undead"
		},
		"subclassfeature6" : {
			name : "Undead Thralls",
			source : [["P", 119]],
			minlevel : 6,
			description : "\n   " + "I add Animate Dead to my spellbook and can have an additional target when casting it" + "\n   " + "Undead created by my necromancy spells have the following benefits:" + "\n   " + "They add my proficiency bonus to damage and my wizard level to their HP maximums",
			spellcastingBonus : {
				name : "Undead Thralls",
				spells : ["animate dead"],
				selection : ["animate dead"]
			},
			spellChanges : {
				"animate dead" : {
					description : "Turn corpses into 2+2/SL Skeletons or Zombies; control for 24h; bns a command within 60 ft",
					changes : "My Undead Thralls class feature allows me to animate one more corpse than normal with Animate Dead."
				}
			}
		},
		"subclassfeature10" : {
			name : "Inured to Undead",
			source : [["P", 119]],
			minlevel : 10,
			description : "\n   " + "I have resistance to necrotic damage and my hit point maximum can't be reduced",
			dmgres : ["Necrotic"]
		},
		"subclassfeature14" : {
			name : "Command Undead",
			source : [["P", 11]],
			minlevel : 14,
			description : "\n   " + "As an action, an undead within 60 ft that I can see must make a Charisma save" + "\n   " + "If its Int is > 7, it has adv. on the save; If its Int is > 11, it repeats the save every hour" + "\n   " + "If failed, it becomes friendly to me and obeys my commands until I use this on another" + "\n   " + "On success, it becomes permanently immune to my further attempts",
			action : ["action", ""]
		}
	}
});
AddSubClass("wizard_ua23pt7", "transmutation", {
	regExpSearch : /(transmutation|transmuter)/i,
	subname : "School of Transmutation",
	fullname : "Transmuter (UA:PT-vii)",
	source : [["P", 119], ["MJ:HB", 0]],
	features : {
		"subclassfeature3" : {
			name : "Transmutation Savant",
			source : [["P", 119], ["MJ:HB", 0]],
			minlevel : 3,
			description : desc([
				"I can add two Transmutation spells from the Wizard spell list, each 2nd-lvl or lower, to my spellbook",
				"  for free. Additionally, when I gain a new level of spell slots in this class, I can add one",
				"  Transmutation spell from the Wizard spell list to my spellbook for free.",
			]),
			additional : ["", "", "2 Trans. spells", "2 Trans. spells", "3 Trans. spells", "3 Trans. spells", "4 Trans. spells", "4 Trans. spells", "5 Trans. spells", "5 Trans. spells", "6 Trans. spells", "6 Trans. spells", "7 Trans. spells", "7 Trans. spells", "8 Trans. spells", "8 Trans. spells", "9 Trans. spells", "9 Trans. spells", "10 Trans. spells", "10 Trans. spells"],
			spellcastingBonus : {
				name : "From the Transmutation school",
				"class" : ["wizard", "wizard_ua23pt7"],
				school : ["Trans"],
				times : [0, 0, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10],
			},
		},
		"subclassfeature3.1" : {
			name : "Minor Alchemy",
			source : [["P", 119]],
			minlevel : 3,
			description : "\n   " + "I can transform an object of wood/stone/iron/copper/silver into another of those" + "\n   " + "For each 10 min I spend, I can transform up to 1 cubic foot of the material" + "\n   " + "It reverts back when I lose concentration or after 1 hour"
		},
		"subclassfeature6" : {
			name : "Transmuter's Stone",
			source : [["P", 119]],
			minlevel : 6,
			description : desc([
				"In 8 hours, I can create a transmuter's stone that gives its wielder one of the following:",
				" \u2022 Darkvision 60 ft",
				" \u2022 10 ft increase to speed while unencumbered",
				" \u2022 Proficiency in Constitution saving throws",
				" \u2022 Resistance to either acid, cold, fire, lightning, or thunder damage",
				"The benefit is chosen at creation; I can have only one active stone at a time",
				"I can change the benefit when I cast a 1st-level or higher transmutation spell with it"
			])
		},
		"subclassfeature10" : {
			name : "Shapechanger",
			source : [["P", 119]],
			minlevel : 10,
			description : "\n   " + "I add Polymorph to my spellbook; I can cast it on myself without using a spell slot" + "\n   " + "When I do that, I can only transform into a beast with a challenge rating of 1 or lower",
			recovery : "short rest",
			usages : 1,
			spellcastingBonus : [{
				name : "Add to spellbook",
				spells : ["polymorph"],
				selection : ["polymorph"]
			}, {
				name : "1/SR no spell slot",
				spells : ["polymorph"],
				selection : ["polymorph"],
				firstCol : "oncesr"
			}],
			spellChanges : {
				"polymorph" : {
					name : "Polymorph (special)",
					range : "Self",
					description : "I transformed into a beast of my choice with a CR 1 or lower; see book",
					changes : "Using my Shapechanger class feature, I can cast Polymorph once per short rest without using a spell slot, but when I do so I can only cast it on myself and transform into a beast."
				}
			}
		},
		"subclassfeature14" : {
			name : "Master Transmuter",
			source : [["P", 119]],
			minlevel : 14,
			description : "\n   " + "As an action, I can destroy my transmuter's stone and do one of the four following:" + "\n    " + "1) Major Transformation" + "\n      " + "In 10 minutes, I transmute one nonmagical object up to 5 cubic foot into another" + "\n      " + "This new, nonmagical object must be of similar size and mass and equal or less value" + "\n    " + "2) Panacea" + "\n      " + "One touched has all curses, diseases, and poisons removed and is healed to max HP" + "\n    " + "3) Restore Life" + "\n      " + "I cast Raise Dead without using spell slots or needing to have it in my spellbook" + "\n    " + "4) Restore Youth" + "\n      " + "A touched creature's apparent age is reduced by 3d10 years (to a minimum of 13)",
			action : ["action", ""]
		}
	}
});
AddSubClass("wizard_ua23pt7", "bladesinging", {
	regExpSearch : /(bladesinging|bladesinger)/i,
	subname : "Tradition of Bladesinging",
	fullname : "Bladesinger (UA:PT-vii)",
	attacks : [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
	source : [["S", 142], ["T", 76]],
	features : {
		"subclassfeature3" : {
			name : "Training in War and Song",
			source : [["S", 142], ["T", 76]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with light armor, a one-handed melee weapon, and Performance",
			armorProfs : [true, false, false, false],
			skills : ["Performance"]
		},
		"subclassfeature3.1" : {
			name : "Bladesong",
			source : [["S", 142], ["T", 76]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can start the bladesong for 1 minute; I can dismiss it at any time",
				"It stops when I wear a shield, medium or heavy armor, or attack with two hands",
				"While the bladesong is active I have the following benefits:",
				" \u2022 Intelligence modifier (min 1) to AC",
				" \u2022 Base walking speed increases by 10 foot",
				" \u2022 Advantage on Dexterity (Acrobatics) checks",
				" \u2022 Intelligence modifier (min 1) to concentration saves for maintaining conc. on a spell"
			]),
			action : [["bonus action", " (start)"]],
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature6" : {
			name : "Extra Attack",
			source : [["S", 142], ["T", 77]],
			minlevel : 6,
			description : desc([
				"I can attack twice instead of once when I take the Attack action on my turn",
				"Moreover, I can cast one of my cantrips in place of one of those attacks"
			])
		},
		"subclassfeature10" : {
			name : "Song of Defense",
			source : [["S", 142], ["T", 77]],
			minlevel : 10,
			description : desc([
				"As a reaction while my bladesong is active, I can expend a spell slot to reduce damage",
				"The damage I take is reduced by 5 for every level of the spell slot I expend"
			]),
			action : [["reaction", " (in bladesong)"]]

		},
		"subclassfeature14" : {
			name : "Song of Victory",
			source : [["S", 142], ["T", 77]],
			minlevel : 14,
			description : "\n   " + "While my bladesong is active, I add my Int mod (min 1) to melee weapon attack damage",
			calcChanges : {
				atkCalc : [
					function (fields, v, output) {
						if (v.isMeleeWeapon && (/blade.?song/i).test(v.WeaponTextName)) {
							output.extraDmg += Math.max(1, Number(What('Int Mod')));
						};
					},
					"If I include the word 'Bladesong' in the name or description of a melee weapon, it gets my Intelligence modifier added to its Damage."
				]
			}
		}
	}
});
AddSubClass("wizard_ua23pt7", "war magic", {
	regExpSearch : /^(?=.*war)(?=.*(wizard|magic|mage)).*$/i,
	subname : "War Magic",
	source : [["X", 59]],
	fullname : "War Mage (UA:PT-vii)",
	features : {
		"subclassfeature3" : { //has to be identical to a feature named in the ClassList
			name : "Arcane Deflection",
			source : [["X", 59]],
			minlevel : 3,
			description : desc([
				"As a reaction when I'm hit by an attack, I can gain +2 to my AC against that attack",
				"As a reaction when I fail a save, I can gain +4 bonus to that saving throw",
				"After I do either, I can't cast spells other than cantrips until the end of my next turn"
			]),
			action : ["reaction", ""]
		},
		"subclassfeature3.1" : {
			name : "Tactical Wit",
			source : [["X", 60]],
			minlevel : 3,
			description : "\n   " + "I gain a bonus to my initiative rolls equal to my Intelligence modifier",
			addMod : { type : "skill", field : "Init", mod : "max(Int|0)", text : "I can add my Intelligence modifier to initiative rolls." }
		},
		"subclassfeature6" : {
			name : "Power Surge",
			source : [["X", 60]],
			minlevel : 6,
			description : desc([
				"I have a pool of stored power surges that I can use to empower my damaging spells",
				"I gain a power surge whenever I successfully end a spell with Dispel Magic or Counterspell",
				"This pool can store a number of power surges equal to my Intelligence modifier (min 1)",
				"It resets to 1 power surge after a long rest or when I have 0 surges left after a short rest",
				"When I deal damage with a wizard spell, I can spend a power surge to do extra damage",
				"One target takes half my wizard level in force damage; I can do this only once per turn"
			]),
			usages : "Resets to 1 after ",
			usagescalc : "event.value = !event.value || event.value == 'Resets to 1 after ' ? 1 : event.value;",
			recovery : "long rest",
			additional : levels.map( function(n) { return n < 6 ? "" : "+" + Math.floor(n/2) + " force damage"; })
		},
		"subclassfeature10" : {
			name : "Durable Magic",
			source : [["X", 60]],
			minlevel : 10,
			description : "\n   " + "While I'm maintaining concentration on a spell, I gain +2 to AC and all saving throws"
		},
		"subclassfeature14" : {
			name : "Deflecting Shroud",
			source : [["X", 60]],
			minlevel : 14,
			description : desc([
				"When I use my Arcane Deflection feature, magical energy arcs from me to creatures",
				"Up to 3 targets I can see within 60 ft of me take half my wizard level in force damage"
			]),
			additional : levels.map( function(n) { return n < 14 ? "" : Math.floor(n/2) + " force damage"; })
		}
	}
});
AddSubClass("wizard_ua23pt7", "chronurgy magic", { // contains contributions by bassbogan on GitHub and @Nod_Hero#2046 on Discord
	regExpSearch : /chronurgy|chronomancer|chronurgist/i,
	subname : "Chronurgy Magic",
	source : [["W", 184]],
	fullname : "Chronurgist (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Chronal Shift",
			source : [["W", 184]],
			minlevel : 3,
			description : desc([
				"As a reaction after I or a creature I see rolls a check, save, or attack, I can force a reroll",
				"I can do this after I see if the roll fails or succeeds; The target must use the second roll."
			]),
			action : [["reaction", ""]],
			usages : 2,
			recovery : "long rest",
			eval : function() {
				// Always have access to dunamancy spells enabled
				if (GetFeatureChoice("classes", "wizard_ua23pt7", "spellcasting ua23pt7", true).indexOf("access to dunamancy spells") === -1) {
					ClassFeatureOptions(["wizard_ua23pt7", "spellcasting ua23pt7", "access to dunamancy spells", true]);
				}
			},
			removeeval : function() {
				// Remove access to dunamancy spells when removing subclass
				if (GetFeatureChoice("classes", "wizard_ua23pt7", "spellcasting ua23pt7", true).indexOf("access to dunamancy spells") !== -1) {
					ClassFeatureOptions(["wizard_ua23pt7", "spellcasting ua23pt7", "access to dunamancy spells", true], "remove");
				}
			}
		},
		"subclassfeature3.1" : {
			name : "Temporal Awareness",
			source : [["W", 184]],
			minlevel : 3,
			description : desc([
				"I gain a bonus to my initiative rolls equal to my Intelligence modifier"
			]),
			addMod : { type : "skill", field : "Init", mod : "max(Int|0)", text : "I can add my Intelligence modifier to initiative rolls." }
		},
		"subclassfeature6" : {
			name : "Momentary Stasis",
			source : [["W", 184]],
			minlevel : 6,
			description : desc([
				"As an action, I can have a Large or smaller creature I can see in 60 ft make a Con save",
				"If failed, it is encased in a field of magical energy, incapacitated and has a speed of 0",
				"This lasts until the end of my next turn or until the creature takes any damage"
			]),
			action : [["action", ""]],
			usages : "Intelligence modifier per ",
			usagescalc : "event.value = Math.max(1, What('Int Mod'));",
			recovery : "long rest"
		},
		"subclassfeature10" : {
			name : "Arcane Abeyance",
			source : [["W", 184]],
			minlevel : 10,
			description : desc([
				"When I use a spell slot to cast a 4th-level or lower spell, I can condense it into a mote",
				"The spell is frozen in time at the moment of casting and held within a grey bead",
				"The bead is a Tiny object with 1 HP, AC 15, and immune to poison and psychic damage",
				"After 1 hour or if it is destroyed, it vanishes with a flash of light and the spell is lost",
				"As an action, a creature holding the bead can release the spell within as if they cast it",
				"The spell still uses my spell attack bonus and save DC; The bead vanishes once used"
			]),
			usages : 1,
			recovery : "short rest"
		},
		"subclassfeature14" : {
			name : "Convergent Future",
			source : [["W", 185]],
			minlevel : 14,
			description : desc([
				"As a reaction after I or a creature I see rolls a check, save, or attack, I can choose the roll",
				"I decide the number rolled, if it is the minimum needed to succeed or 1 less than that",
				"When I use this feature, I gain a level of exhaustion which only a long rest can remove"
			]),
			action : [["reaction", ""]]
		}
	}
});
AddSubClass("wizard_ua23pt7", "graviturgy magic", { // contains contributions by bassbogan on GitHub and @Nod_Hero#2046 on Discord
	regExpSearch : /^((?=.*graviturgy)(?=.*(wizard|magic|mage))|gravimancer|graviturgist).*$/i,
	subname : "Graviturgy Magic",
	source : [["W", 185]],
	fullname : "Graviturgist (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Adjust Density",
			source : [["W", 185]],
			minlevel : 3,
			description : desc([
				"As an action, I can magically double or halve the weight of a creature I can see in 30 ft",
				"If doubled, it has -10 ft speed and advantage on Strength checks and Strength saves",
				"If halved, it has +10 ft speed, can jump twice as far, and disadv. on Str checks and saves",
				"This lasts for 1 minute or until my concentration ends (like concentrating on a spell)"
			]),
			action : [["action", ""]],
			additional : levels.map(function (n) {
				return n < 2 ? "" : (n < 10 ? "Large" : "Huge") + " or smaller creatures";
			}),
			eval : function() {
				// Always have access to dunamancy spells enabled
				if (GetFeatureChoice("classes", "wizard_ua23pt7", "spellcasting ua23pt7", true).indexOf("access to dunamancy spells") === -1) {
					ClassFeatureOptions(["wizard_ua23pt7", "spellcasting ua23pt7", "access to dunamancy spells", true]);
				}
			},
			removeeval : function() {
				// Remove access to dunamancy spells when removing subclass
				if (GetFeatureChoice("classes", "wizard_ua23pt7", "spellcasting ua23pt7", true).indexOf("access to dunamancy spells") !== -1) {
					ClassFeatureOptions(["wizard_ua23pt7", "spellcasting ua23pt7", "access to dunamancy spells", true], "remove");
				}
			}
		},
		"subclassfeature6" : {
			name : "Gravity Well",
			source : [["W", 185]],
			minlevel : 6,
			description : desc([
				"Whenever I cast a spell on a creature, I can move it 5 ft to an empty space of my choice",
				"This only works if the target is willing, fails its save vs. the spell, or the spell attack hits it"
			]),
		},
		"subclassfeature10" : {
			name : "Violent Attraction",
			source : [["W", 185]],
			minlevel : 10,
			description : desc([
				"As a reaction when I or a creature I see in 60 ft hits a weapon attack, I can improve it",
				"I increase the weapon's velocity, causing it to deal an extra 1d10 damage",
				"As a reaction if a creature within 60 ft is damaged by a fall, I can increase it by 2d10"
			]),
			action : [["reaction", ""]],
			usages : "Intelligence modifier per ",
			usagescalc : "event.value = Math.max(1, What('Int Mod'));",
			recovery : "long rest"
		},
		"subclassfeature14" : {
			name : "Event Horizon",
			source : [["W", 185]],
			minlevel : 14,
			description : desc([
				"As an action, I can magically emit powerful gravitational magic that pulls on hostiles",
				"Whenever a creature hostile to me starts it turn within 30 ft, it must make Str save",
				"If failed, it takes 2d10 force damage and its speed is 0 until the start of its next turn",
				"If successful, it takes half the damage and every foot it moves this turn costs 2 extra feet",
				"This lasts for 1 minute or until my concentration ends (like concentrating on a spell)",
				"I can do this once per long rest, or by expending a 3rd-level or higher spell slot (SS 3+)"
			]),
			action : [["action", ""]],
			usages : 1,
			recovery : "long rest",
			altResource : "SS 3+",
		}
	}
});
AddSubClass("wizard_ua23pt7", "order of scribes", {
	regExpSearch : /^(?=.*wizard)(?=.*order)(?=.*scribes?).*$|scrivener/i,
	subname : "Order of Scribes",
	source : [["T", 77]],
	features : {
		"subclassfeature3" : {
			name : "Wizardly Quill",
			source : [["T", 77]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can magically create a Tiny quill with the following properties:",
				" \u2022 It doesn't require ink and produces ink in the color of my choice when writing with it",
				" \u2022 I require only 2 minutes per spell level to transcribe spells into my spellbook with it",
				" \u2022 As a bonus action, I can use it to erase a text written with it if within 5 ft of the text",
				"The quill disappear if I create another or if I die"
			]),
			action : [["bonus action", " (create/erase)"]]
		},
		"subclassfeature3.1" : {
			name : "Awakened Spellbook",
			source : [["T", 77]],
			minlevel : 3,
			description : desc([
				"My spellbook gains sentience and grants me the following benefits while I am holding it:",
				" \u2022 I can use the book as a spellcasting focus for my wizard spells",
				" \u2022 When I cast a wizard spell using a spell slot, I can temporarily replace its damage type",
				"   The new type must appear in my spellbook in a spell of the same level as the spell slot",
				" \u2022 Once per long rest, I can ritual cast a wizard spell without 10 min extra casting time",
				"I can replace it over a short rest, transferring its spells and sentience to a blank book"
			]),
			additional : "fast ritual cast",
			usages : 1,
			recovery : "long rest"
		},
		"subclassfeature6" : {
			name : "Manifest Mind",
			source : [["T", 78]],
			minlevel : 6,
			description : desc([
				"As a bonus action, I can have the mind of my awakened spellbook manifest within 60 ft",
				"The spellbook needs to be on my person to do this; The mind is a Tiny spectral object",
				"The mind is intangible, doesn't occupy a space, hovers, and sheds dim light in 10 ft",
				"It can hear, see, has 60 ft darkvision, and telepathically shares with me what it perceives",
				"As a bonus action, I can dismiss it or move it up to 30 ft to an empty space I can see",
				"It can pass through creatures; It stops manifesting if it's over 300 ft from me or I die",
				"It also stop manifesting if Dispel Magic is cast on it or the awakened spellbook is no more",
				"I can do this once per long rest, or by expending a spell slot (SS 1+) to manifest it again"
			]),
			action : [["bonus action", " (conjure/move/dismiss)"]],
			usages : 1,
			recovery : "long rest",
			altResource : "SS 1+"
		},
		"subclassfeature6.1" : {
			name : "Manifest Mind: Cast Spell",
			source : [["T", 78]],
			minlevel : 6,
			description : desc([
				"I can have wizard spells I cast on my turn originate from the mind while its manifested"
			]),
			usages : "Proficiency bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature10" : {
			name : "Master Scrivener",
			source : [["T", 78]],
			minlevel : 10,
			description : desc([
				"When I finish a long rest, I can write a spell in my awakened spellbook on a blank paper",
				"It must be a level 1 or 2 spell with 1 action casting time; My spellbook must be in 5 ft",
				"As an action, I can use this scroll to cast the spell on it at one higher level than normal",
				"Only I can use the scroll; The scroll turns blank again when I use it or finish a long rest",
				"Also, using my Wizardly Quill, the gold and time I need to craft spell scrolls is halved"
			]),
			action : [["action", " (cast scroll)"]],
			usages : 1,
			recovery : "long rest",
			spellcastingBonus : {
				name : "Master Scrivener scoll",
				"class" : "wizard",
				level : [1, 2],
				firstCol : "MS"
			},
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName, isDuplicate) {
						if (!isDuplicate && spName === "wizard" && spellObj.firstCol === "MS" && (spellObj.level === 1 || spellObj.level === 2)) {
							// Calculate upcasting to be exactly 1 level higher
							var rxMatch = /(\d*d?\d+)\+(\d*d?\d+)\/(\d*SL)\b/i;
							while (rxMatch.test(spellObj.description)) {
								var aMatch = spellObj.description.match(rxMatch);
								var strDie1 = !isNaN(aMatch[1]) ? true : /\d+d\d+/i.test(aMatch[1]) ? aMatch[1].replace(/\d+(d\d+)/i, "$1") : false;
								var strDie2 = !isNaN(aMatch[2]) ? true : /\d+d\d+/i.test(aMatch[2]) ? aMatch[2].replace(/\d+(d\d+)/i, "$1") : undefined;
								if (!/^SL$/i.test(aMatch[3])) {
									// only increases if more than 1 level higher spell slot, so nothing we can do with it, just remove all upcasting
									removeSpellUpcasting(spellObj);
								} else if (/^\d/.test(aMatch[1]) && strDie1 === strDie2) {
									// identical type steps (e.g. 1d6+1d6/SL or 3+1/SL), so add the second to the first
									var strNew = (Number(aMatch[1].replace(/^(\d+).*/, "$1")) + Number(aMatch[2].replace(/^(\d+).*/, "$1"))) + aMatch[1].replace(/^\d+(.*)/, "$1");
									spellObj.description = spellObj.description.replace(rxMatch, strNew);
								} else {
									// non-identical steps, so leave the first and second along, but remove the /SL
									spellObj.description = spellObj.description.replace(rxMatch, "$1+$2");
								}
							}
							// Remove costly material components
							spellObj.description = spellObj.description.replace(/ \(\d+ ?gp( cons\.?)?\)/i, '');
							// List only the scroll as a component from the spell
							spellObj.components = "M\u2020";
							spellObj.compMaterial = "Spells cast from spell scrolls don't require any components other than the spell scroll itself.";
							return true;
						}
					},
					"When I finish a long rest, I can create a scroll of a spell in my spellbook using my Master Scrivener class feature. I can then cast this spell from the scroll and the spell is cast as if using a spell slot one level higher than its spell level."
				]
			}
		},
		"subclassfeature14" : {
			name : "One with the Word",
			source : [["T", 78]],
			minlevel : 14,
			description : ' [see 3rd page "Notes" section]',
			action : [["reaction", " (when damaged)"]],
			advantages : [["Arcana", true]],
			"one with the word" : {
				name : "One with the Word",
				extraname : "Order of Scribes 14",
				source : [["T", 78]],
				description : desc([
					"While my awakened spellbook is on my person, I have advantage on Int (Arcana) checks",
					"As a reaction when I take damage while my spellbook's mind is manifested, I can dismiss it",
					"In dismissing the manifested mind like this, I prevent all of the damage taken by me",
					"After doing so, I lose spells with a combined level of 3d6 from my awakened spellbook",
					"If I do not have enough spells left to cover the number rolled, I drop to 0 HP instead",
					"The spells vanish from my spellbook, reappearing only after I finish 1d6 long rests",
					"I can't cast spells that I lost this way, even if found on a scroll or in another spellbook"
				]),
				usages : 1,
				recovery : "long rest"
			},
			autoSelectExtrachoices : [{
				extrachoice : "one with the word"
			}]
		}
	}
});
AddSubClass("wizard_ua23pt7", "artificer-ua", {
	regExpSearch : /^((?=.*(wizard|mage|magus))(?=.*artificer))|(?=.*infuser).*$/i,
	subname : "Tradition of the Artificer",
	source : [["UA:E", 3]],
	fullname : "Wizard (Artificer) (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Infuse Potions",
			source : [["UA:E", 3]],
			minlevel : 3,
			description : "\n   " + "I can produce magic potions if I spend 10 minutes and expend a spell slot" + "\n   " + "I can not regain the spell slot until the potion is consumed or a week has passed",
			additional : ["", "3 potions", "3 potions", "3 potions", "3 potions", "3 potions", "3 potions", "3 potions", "3 potions", "4 potions", "4 potions", "4 potions", "4 potions", "4 potions", "4 potions", "4 potions", "4 potions", "4 potions", "4 potions", "4 potions"]
		},
		"subclassfeature3.1" : {
			name : "Infuse Scrolls",
			source : [["UA:E", 4]],
			minlevel : 3,
			description : "\n   " + "I can produce a scroll after a short rest if I spend 10 minutes and my Arcane Recovery" + "\n   " + "I subtract the spell's level from the levels worth of slots I regain using Arcane Recovery" + "\n   " + "This reduction applies till the scroll is used and I finish a long rest",
			additional : ["", "1 scroll", "1 scroll", "1 scroll", "1 scroll", "1 scroll", "1 scroll", "1 scroll", "1 scroll", "2 scrolls", "2 scrolls", "2 scrolls", "2 scrolls", "2 scrolls", "2 scrolls", "2 scrolls", "2 scrolls", "2 scrolls", "2 scrolls", "2 scrolls"]
		},
		"subclassfeature6" : {
			name : "Infuse Weapons and Armor",
			source : [["UA:E", 4]],
			minlevel : 6,
			description : "\n   " + "I can spend 10 minutes to produce a magic weapon, armor, a shield, or ammunition" + "\n   " + "The item retains its magic for 8 hours and the spell slot I expend is:" + "\n   " + "2nd: +1 ammunition (20 pieces), 3rd: +1 weapon or +1 shield, 4th: +1 armor," + "\n   " + "5th: +2 weapon or +2 ammunition (20 pieces), 6th: +3 armor.",
			additional : ["", "", "", "", "", "1 weapon or armor", "1 weapon or armor", "1 weapon or armor", "1 weapon or armor", "2 weapons or armor", "2 weapons or armor", "2 weapons or armor", "2 weapons or armor", "2 weapons or armor", "2 weapons or armor", "2 weapons or armor", "2 weapons or armor", "2 weapons or armor", "2 weapons or armor", "2 weapons or armor"]
		},
		"subclassfeature10" : {
			name : "Superior Artificer",
			source : [["UA:E", 4]],
			minlevel : 10,
			description : "\n   " + "I can create one additional scroll, potion, weapon, or armor when I use Infuse"
		},
		"subclassfeature14" : {
			name : "Master Artificer",
			source : [["UA:E", 4]],
			minlevel : 14,
			description : "\n   " + "I can produce a variety of magic items from Tables A and B from the DMG" + "\n   " + "It takes 1 week for such an item and I cannot do it again for a month",
			usages : 1,
			recovery : "Month"
		}
	}
});
AddSubClass("wizard_ua23pt7", "technomancy-ua", { // Still valid 2021-09-21
	regExpSearch : /technomancy|technomancer/i,
	subname : "Technomancy",
	source : [["UA:MM", 3]],
	fullname : "Technomancer (UA:PT-vii)",
	features : {
		"subclassfeature3": {
			name : "Bonus Proficiencies",
			source : [["UA:MM", 3]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with sidearms and hacking tools",
			weaponProfs : [false, false, ["Sidearms"]],
			toolProfs : ["Hacking tools"]
		},
		"subclassfeature3.1": {
			name : "Technological Savant",
			source : [["UA:MM", 3]],
			minlevel : 3,
			description : desc([
				"I can use a single tablet computer (or similar) instead of a spellbook",
				"Spells copied into this device cost half the normal amount of gp"
			])
		},
		"subclassfeature6": {
			name : "Program Spell",
			source : [["UA:MM", 4]],
			minlevel : 6,
			description : desc([
				"I can cast a spell into a device of at least smartphone-level of computing power",
				"Variables of the spell are chosen at time of casting; I can have only one active at a time",
				"As an action within the next 48 hours, the spell can be cast from the device",
				"I can't activate a concentration spell in this way if I am concentrating on another spell"
			]),
			recovery : "long rest",
			usages : 1
		},
		"subclassfeature10": {
			name : "Online Casting",
			source : [["UA:MM", 4]],
			minlevel : 10,
			description : desc([
				"I can cast a spell, that is not area-of-effect, through networked electronic devices",
				"If the spell requires sight/hearing, the audio/visual must be transmitted electronically",
				"The spell's range is determined from me to my device plus from the target to its device"
			]),
			usages : "Intelligence modifier per ",
			usagescalc : "event.value = Math.max(1, What('Int Mod'));",
			recovery : "long rest"
		},
		"subclassfeature14": {
			name : "Chained Device",
			source : [["UA:MM", 4]],
			minlevel : 14,
			description : "\n   " + "I can use a held/worn tablet computer to concentrate on a spell I cast instead of me" + "\n   " + "If the device is separated from me, turned off, or broken, the effect is lost",
			recovery : "long rest",
			usages : 1
		}
	}
});
AddSubClass("wizard_ua23pt7", "lore mastery-ua", { // Still valid 2021-09-21; this code includes contributions by /u/magicmanfk
	regExpSearch : /^(?=.*\blore)(?=.*mastery?\b).*$/i,
	subname : "Lore Mastery",
	source : [["UA:WnW", 5]],
	fullname : "Lore Master (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Lore Master",
			source : [["UA:WnW", 6]],
			minlevel : 3,
			description : desc([
				"I can use my Intelligence modifier for initiative instead of my Dexterity modifier",
				"I get expertise with each Arcana, History, Nature, and Religion, if I'm proficient with it"
			]),
			skills : [["Arcana", "only"], ["History", "only"], ["Nature", "only"], ["Religion", "only"]],
			addMod : { type : "skill", field : "Init", mod : "max(Int-Dex|0)", text : "I use my Intelligence modifier for initiative rolls instead of Dexterity." }
		},
		"subclassfeature3.1" : {
			name : "Spell Secrets: Elements",
			source : [["UA:WnW", 6]],
			minlevel : 3,
			description : desc([
				"I can change the damage type of spells I cast using spell slots (so not cantrips)",
				"I can swap out acid, cold, fire, force, lightning, necrotic, radiant, or thunder damage"
			])
		},
		"subclassfeature2.2" : {
			name : "Spell Secrets: Saves",
			source : [["UA:WnW", 6]],
			minlevel : 2,
			description : "\n   " + "I can change the saving throw ability score to another for a spell I cast using a spell slot",
			recovery : "short rest",
			usages : 1
		},
		"subclassfeature6" : {
			name : "Alchemical Casting",
			source : [["UA:WnW", 6]],
			minlevel : 6,
			description : desc([
				"When I cast a spell with a spell slot, I can expend one additional spell slot to augment it",
				" - 1st-level slot: one damage roll of the spell adds +2d10 force damage",
				" - 2nd-level slot: if the range of the spell is at least 30 ft, it becomes 1 mile",
				" - 3rd-level slot: the spell's save DC increases by 2"
			])
		},
		"subclassfeature10" : {
			name : "Prodigious Memory",
			source : [["UA:WnW", 6]],
			minlevel : 10,
			description : "\n   " + "As a bonus action, I can replace one of my prepared spells with another from my book",
			recovery : "short rest",
			usages : 1,
			action : ["bonus action", ""]
		},
		"subclassfeature14" : {
			name : "Master of Magic",
			source : [["UA:WnW", 6]],
			minlevel : 14,
			description : desc([
				"As a bonus action, I can call to mind one spell of my choice from any class' spell list",
				"This spell must be of a level I have spell slots for and that I don't already have prepared",
				"I can then cast it using the normal spellcasting rules, including expending a spell slot",
				"It counts a wizard spell; I can only cast the spell during the same turn I call it to mind"
			]),
			usages : 1,
			recovery : "long rest",
			action : ["bonus action", ""]
		}
	}
});
AddSubClass("wizard_ua23pt7", "school of invention-ua", {
	regExpSearch : /^(?=.*wizard)(?=.*invent(ion|or)).*$/i,
	subname : "School of Invention",
	source : [["UA:TS", 2]],
	fullname : "Wizard (Inventor) (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Tools of the Inventor",
			source : [["UA:TS", 3]],
			minlevel : 3,
			description : "\n   " + "I gain proficiency with light armor and two tools of my choice",
			toolProfs : [["Any one tool", 2]],
			armorProfs : [true, false, false, false]
		},
		"subclassfeature3.1" : {
			name : "Arcanomechanical Armor",
			source : [["UA:TS", 3]],
			minlevel : 3,
			description : desc([
				"After a long rest, I can transform a studded leather armor into arcanomechanical armor",
				"This is a magic light armor that gives AC 12 + Dex mod and force resistance, if attuned",
				"Only I can attune to it; Creating a new one removes the magic from the previous"
			]),
			dmgres : ["Force"],
			armorOptions : [{
				regExpSearch : /arcanomechanical/i,
				name : "Arcanomechanical",
				source : [["UA:TS", 3]],
				type : "light",
				ac : 12,
				weight : 8,
				invName : "Arcanomechanical armor"
			}],
			armorAdd : "Arcanomechanical"
		},
		"subclassfeature3.2" : {
			name : "Reckless Casting",
			source : [["UA:TS", 3]],
			minlevel : 3,
			description : desc([
				"As an action, I can attempt to cast a random spell or cantrip by rolling a d10 on a table",
				"On a roll of 10, I roll again twice on that table and cast both results",
				"However, if I then roll 10 on either dice, the whole casting fails and the action is wasted",
				"If I choose cantrip, I roll on the table once and cast the result",
				"If I choose a spell, I expend a spell slot and roll twice on the table for the slot's level",
				"I can then choose which of the results I use; Use 5th-level table for spell slots over level 5"
			]),
			toNotesPage : [{
				name : "Reckless Casting Tables",
				note : "\nd10\tCantrip\t\td10\tCantrip" + desc([
					" 1\tAcid Splash\t\t    6\tRay of Frost",
					" 2\tChill Touch\t\t    7\tShocking Grasp",
					" 3\tFire Bolt\t\t    8\tSacred Flame",
					" 4\tLight\t\t    9\tThorn Whip",
					" 5\tPoison Spray\t  10\tRoll twice; Another 10, all is wasted"
				]) + "\n\nd10\t1st-Level Spell\td10\t1st-Level Spell" + desc([
					" 1\tBurning Hands\t    6\tFog Cloud",
					" 2\tChromatic Orb\t    7\tJump",
					" 3\tColor Spray\t\t    8\tMagic Missile",
					" 4\tFaerie Fire\t\t    9\tThunderwave",
					" 5\tFalse Life\t\t  10\tRoll twice; Another 10, all is wasted"
				]) + "\n\nd10\t2nd-Level Spell\td10\t2nd-Level Spell" + desc([
					" 1\tBlur\t\t    6\tLevitate",
					" 2\tDarkness\t\t    7\tMelf's Acid Arrow",
					" 3\tEnlarge/Reduce\t    8\tScorching Ray",
					" 4\tGust of Wind\t    9\tShatter",
					" 5\tInvisibility\t\t  10\tRoll twice; Another 10, all is wasted"
				]) + "\n\nd10\t3rd-Level Spell\td10\t3rd-Level Spell" + desc([
					" 1\tBlink\t\t    6\tGaseous Form",
					" 2\tFear\t\t    7\tLightning Bolt",
					" 3\tFeign Death \t    8\tSleet Storm",
					" 4\tFireball\t\t    9\tStinking Cloud",
					" 5\tFly\t\t  10\tRoll twice; Another 10, all is wasted"
				]) + "\n\nd10\t4th-Level Spell\td10\t4th-Level Spell" + desc([
					" 1\tBlight\t\t    6\tIce Storm",
					" 2\tConfusion\t\t    7\tPhantasmal Killer",
					" 3\tEvard's Black Tentacles\t    8\tStoneskin",
					" 4\tFire Shield\t\t    9\tWall of Fire",
					" 5\tGreater Invisibility\t  10\tRoll twice; Another 10, all is wasted"
				]) + "\n\nd10\t5th-Level Spell\td10\t5th-Level Spell" + desc([
					" 1\tCloudkill\t\t    6\tInsect Plague",
					" 2\tCone of Cold\t    7\tMass Cure Wounds",
					" 3\tDestructive Wave\t    8\tWall of Force",
					" 4\tFlame Strike\t    9\tWall of Stone",
					" 5\tHold Monster\t  10\tRoll twice; Another 10, all is wasted"
				])
			}]
		},
		"subclassfeature6" : {
			name : "Alchemical Casting",
			source : [["UA:TS", 4]],
			minlevel : 6,
			description : desc([
				"I can manipulate spells cast while wearing and attuned to my Arcanomechanical Armor",
				"By expending an additional 1st or 2nd-level spell slot, I do the following:",
				"\u2022 1st: I can substitute acid, cold, fire, lightning, or thunder damage for another type",
				"\u2022 2nd: I increase the spells damage, if any, by 2d10 force damage against one target"
			])
		},
		"subclassfeature10" : {
			name : "Prodigious Inspiration",
			source : [["UA:TS", 4]],
			minlevel : 10,
			description : "\n   " + "As a bonus action, I can replace a prepared spell with another from my spellbook",
			usages : 1,
			recovery : "short rest",
			action : ["bonus action", ""]
		},
		"subclassfeature14" : {
			name : "Controlled Chaos",
			source : [["UA:TS", 4]],
			minlevel : 14,
			description : desc([
				"When I expend a spell slot to cast a spell using Reckless Casting, it is more powerful",
				"I can roll on the table that is one level higher than the spell slot expended"
			])
		}
	}
});
AddSubClass("wizard_ua23pt7", "onomancy-ua", {
	regExpSearch : /onomancy|onomancer/i,
	subname : "Onomancy",
	source : [["UA:CDnW", 4]],
	fullname : "Onomancer (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Bonus Proficiencies",
			source : [["UA:CDnW", 4]],
			minlevel : 3,
			description : "\n   I learn a language of my choice and gain proficiency with calligrapher's tools",
			toolProfs : ["Calligrapher's tools"],
			languageProfs : [1]
		},
		"subclassfeature3.1" : {
			name : "Extract Name",
			source : [["UA:CDnW", 4]],
			minlevel : 3,
			description : desc([
				"As a bonus action, I can have a creature I can see within 60 ft make a Wisdom save",
				"If failed, it is charmed by me until my next turn ends and I mentally learn its true name",
				"If successful, I know that my magic failed and can't use this feature again on it"
			]),
			usages : "Intelligence modifier per ",
			usagescalc : "event.value = Math.max(1, What('Int Mod'));",
			recovery : "long rest",
			action : [["bonus action", ""]]
		},
		"subclassfeature3.2" : {
			name : "Fateful Naming",
			source : [["UA:CDnW", 4]],
			minlevel : 3,
			description : desc([
				"I add Bane and Bless to my spellbook and they count as wizard spells for me",
				"These are always prepared, but don't count against the number of spells I can prepare",
				"I can cast either spell without using a spell slot by speaking the true name of a target"
			]),
			spellcastingBonus : {
				name : "Fateful Naming",
				spells : ["bane", "bless"],
				selection : ["bane", "bless"],
				times : 2,
				firstCol : "markedbox"
			},
			additional : "with true name",
			usages : "Int mod per ",
			usagescalc : "event.value = Math.max(1, What('Int Mod'));",
			recovery : "long rest",
		},
		"subclassfeature6" : {
			name : "Resonants",
			source : [["UA:CDnW", 4]],
			minlevel : 6,
			description : desc([
				'Use the "Choose Feature" button above to add Resonants to the third page',
				"Whenever I gain a wizard level, I can replace a Resonant I know with another"
			]),
			additional : levels.map(function (n) {
				return n < 6 ? "" : (n < 10 ? 2 : 4) + " resonants known";
			}),
			extraTimes : levels.map(function (n) {
				return n < 6 ? 0 : n < 10 ? 2 : 4;
			}),
			extraname : "Resonant",
			extrachoices : ["Absorption", "Devastation", "Dissolution", "Nullification", "Puppetry", "Sympathy"],
			"absorption" : {
				name : "Absorption",
				source : [["UA:CDnW", 5]],
				description : "\n   When the spell deals damage to the named target, I gain a number of temporary hit points",
				additional : levels.map(function (n) {
					return (n < 10 ? 3 : n < 14 ? 4 : 5) + "d6 temporary hit points";
				})
			},
			"devastation" : {
				name : "Devastation",
				source : [["UA:CDnW", 5]],
				description : "\n   The named creature has disadvantage on its first saving throw against the spell"
			},
			"dissolution" : {
				name : "Dissolution",
				source : [["UA:CDnW", 5]],
				description : "\n   The first time the named creature takes damage from the spell, it takes extra damage",
				additional : levels.map(function (n) {
					return "+" + (n < 10 ? 2 : n < 14 ? 3 : 4) + "d8 force damage";
				})
			},
			"nullification" : {
				name : "Nullification",
				source : [["UA:CDnW", 5]],
				description : desc([
					"If the named creature is affected by any other spells, I know what those spells are",
					"In addition, I can try to end one of my choice with an Int check (DC 10 + spell level)"
				])
			},
			"puppetry" : {
				name : "Puppetry",
				source : [["UA:CDnW", 5]],
				description : desc([
					"The first time the named creature takes damage from the spell, it is moved as well",
					"I choose to knock it prone or move it up to 10 ft directly towards me or away from me"
				])
			},
			"sympathy" : {
				name : "Sympathy",
				source : [["UA:CDnW", 5]],
				description : "\n   I can target the named creature with the spell even if I can't see it or it is has total cover"
			}
		},
		"subclassfeature6.1" : {
			name : "Resonant Utterance",
			source : [["UA:CDnW", 4]],
			minlevel : 6,
			description : desc([
				"When I use a spell slot to cast a wizard spell, I can use one resonant that I know",
				"The resonant will only work if I speak the true name of a creature targeted by the spell"
			]),
			usages : "half wizard level per ",
			usagescalc : "event.value = classes.known.wizard ? Math.floor(classes.known.wizard.level / 2) : 0;",
			recovery : "long rest"
		},
		"subclassfeature14" : {
			name : "Relentless Naming",
			source : [["UA:CDnW", 5]],
			minlevel : 14,
			description : desc([
				"When I speak the true name of a creature when I cast a damage dealing spell at it,",
				"I can have that spell deal force or psychic damage instead of its normal damage type"
			])
		}
	}
});
AddSubClass("wizard_ua23pt7", "psionics-ua", {
	regExpSearch : /^((?=.*(wizard|mage|magus))(?=.*psionics)|(?=.*(psionicist|mentalist)))(?!.*(wild mage|\bpsion\b|mystic)).*$/i,
	subname : "Psionics",
	source : [["UA:FRnW", 3]],
	fullname : "Psionicist (UA:PT-vii)",
	features : {
		"subclassfeature3" : {
			name : "Psionic Focus",
			source : [["UA:FRnW", 3]],
			minlevel : 3,
			description : desc([
				"I learn to channel psionic energy through an object special to me, my psionic focus",
				"It allows me to reroll a roll of 1 on any psychic or force damage die for my wizard spells",
				"I can use this as my spellcasting focus; If lost, I can recreate it by meditating for 1 hour"
			])
		},
		"subclassfeature3.1" : {
			name : "Psionic Devotion",
			source : [["UA:FRnW", 4]],
			minlevel : 3,
			description : desc([
				'I learn one cantrip: Friends, Mage Hand, or Message; Use "Choose Feature" button above',
				"While my psionic focus is on me, I can cast it as a bonus action without components"
			]),
			choices : ["Friends", "Mage Hand", "Message"],
			"friends" : {
				name : "Psionic Devotion: Friends",
				description : desc([
					"I learn the Friends cantrip and while my psionic focus in on me, I am better at casting it",
					"I can cast it as a bonus action without components and the target doesn't become hostile"
				]),
				spellcastingBonus : {
					name : "Psionic Devotion",
					spells : ["friends"],
					selection : ["friends"],
					firstCol : "atwill"
				},
				spellChanges : {
					"friends" : {
						time : "1 bns",
						components : "",
						compMaterial : "",
						description : "Adv. on Cha checks vs. 1 crea currently not hostile; when spell ends, crea realizes I used magic",
						changes : "While my psionic focus is on my person, I can cast Friends as a bonus action without requiring any components and when the spell ends, the target doesn't become hostile to me."
					}
				}
			},
			"mage hand" : {
				name : "Psionic Devotion: Mage Hand",
				description : desc([
					"I learn Mage Hand and while my psionic focus in on me, I am better at casting it",
					"I can then cast it as a bonus action without components and can make the hand invisible",
					"Also, I can control the hand as a bonus action instead of an action"
				]),
				spellcastingBonus : {
					name : "Psionic Devotion",
					spells : ["mage hand"],
					selection : ["mage hand"],
					firstCol : "atwill"
				},
				spellChanges : {
					"mage hand" : {
						time : "1 bns",
						components : "",
						description : "Create invisible hand for simple tasks or carry up to 10 lb; 1 bns action to control; can't have multiples",
						changes : "While my psionic focus is on my person, I can cast Mage Hand as a bonus action without requiring any components, can make the hand invisible, and controlling the hand is a bonus action for me."
					}
				}
			},
			"message" : {
				name : "Psionic Devotion: Message",
				description : desc([
					"I learn the Message cantrip and while my psionic focus in on me, I'm better at casting it",
					"I can then cast it as a bonus action without components",
					"Also, I don't need to point at the target or whisper the message out loud"
				]),
				spellcastingBonus : {
					name : "Psionic Devotion",
					spells : ["message"],
					selection : ["message"],
					firstCol : "atwill"
				},
				spellChanges : {
					"message" : {
						time : "1 bns",
						components : "",
						compMaterial : "",
						description : "1 crea hears message I think; can reply with a whisper; nobody can overhear; needs no straight line",
						changes : "While my psionic focus is on my person, I can cast Message as a bonus action without requiring any components, don't need to point toward the target, and I don't need to whisper my message out loud."
					}
				}
			}
		},
		"subclassfeature6" : {
			name : "Thought Form",
			source : [["UA:FRnW", 4]],
			minlevel : 6,
			description : desc([
				"As a bonus action, I can use my psionic focus to transform my body into luminous energy",
				"I chose the shape (my size); It sheds 5-ft radius dim light; My equipment melds into it",
				"My psionic focus hovers within the energy; In this form, I have the following benefits:",
				" \u2022 Spells I cast require no verbal, somatic, or material components without a gold cost",
				" \u2022 I have resistance to psychic and nonmagical bludgeoning/piercing/slashing damage",
				"This lasts for 10 minutes or until I'm incapacitated, die, or use a bonus action to end it"
			]),
			action : [["bonus action", ""]],
			usages : "Intelligence modifier per ",
			usagescalc : "event.value = Math.max(1, What('Int Mod'));",
			recovery : "long rest"
		},
		"subclassfeature10" : {
			name : "Mental Discipline",
			source : [["UA:FRnW", 4]],
			minlevel : 10,
			description : desc([
				'I learn one spell: Dominate Person, Scrying, or Telekinesis; Use "Choose Feature" button',
				"I can cast the spell without a spell slot once per long rest (and normally with a spell slot)"
			]),
			usages : 1,
			recovery : "long rest",
			choices : ["Dominate Person", "Scrying", "Telekinesis"],
			"dominate person" : {
				name : "Mental Discipline: Dominate Person",
				description : desc([
					"I add Dominate Person to my spellbook and can cast it without requiring components",
					"Once per long rest, I can cast it without using a spell slot; I can also prepare it as normal"
				]),
				limfeaname : "Dominate Person (without spell slot)",
				spellcastingBonus : {
					name : "Mental Discipline",
					spells : ["dominate person"],
					selection : ["dominate person"]
				},
				spellChanges : {
					"dominate person" : {
						components : "",
						changes : "I can cast Dominate Person without requiring any components. Once per long rest, I can cast it without using a spell slot. I can also cast it by using spell slots as normal."
					}
				}
			},
			"scrying" : {
				name : "Mental Discipline: Scrying",
				description : desc([
					"I add Scrying to my spellbook and can cast it without requiring components",
					"Once per long rest, I can cast it without using a spell slot; I can also prepare it as normal"
				]),
				limfeaname : "Scrying (without spell slot)",
				spellcastingBonus : {
					name : "Mental Discipline",
					spells : ["scrying"],
					selection : ["scrying"]
				},
				spellChanges : {
					"scrying" : {
						components : "",
						compMaterial : "",
						changes : "I can cast Scrying without requiring any components. Once per long rest, I can cast it without using a spell slot. I can also cast it by using spell slots as normal."
					}
				}
			},
			"telekinesis" : {
				name : "Mental Discipline: Telekinesis",
				description : desc([
					"I add Telekinesis to my spellbook and can cast it without requiring components",
					"Once per long rest, I can cast it without using a spell slot; I can also prepare it as normal"
				]),
				limfeaname : "Telekinesis (without spell slot)",
				spellcastingBonus : {
					name : "Mental Discipline",
					spells : ["telekinesis"],
					selection : ["telekinesis"]
				},
				spellChanges : {
					"telekinesis" : {
						components : "",
						changes : "I can cast Telekinesis without requiring any components. Once per long rest, I can cast it without using a spell slot. I can also cast it by using spell slots as normal."
					}
				}
			}
		},
		"subclassfeature10.1" : {
			name : "Empowered Psionics",
			source : [["UA:FRnW", 5]],
			minlevel : 10,
			description : "\n   I add my Int modifier to one target of my wizard spells that do psychic or force damage",
			calcChanges : {
				spellAdd : [
					function (spellKey, spellObj, spName) {
						if (spName.indexOf("wizard") != -1) {
							return genericSpellDmgEdit(spellKey, spellObj, "force|psychic", "Int", true);
						}
					},
					"When I deal psychic or force damage with a wizard spell, I can add my Intelligence modifier to the damage against one of the spell's targets."
				]
			}
		},
		"subclassfeature14" : {
			name : "Thought Travel",
			source : [["UA:FRnW", 5]],
			minlevel : 14,
			description : desc([
				"While in my thought form, I gain a fly speed equal to my walking speed and I can hover",
				"I can then also move through creatures and objects as if they were difficult terrain",
				"I take 1d10 force damage if I end my turn inside an object",
				"If I end my thought form while inside an object, I'm shunted to the nearest empty space",
				"I then take 1d10 force damage for every 5 ft traveled"
			])
		}
	}
});
AddSubClass("wizard_ua23pt7", "runecrafter-ua", {
	regExpSearch : /runecrafting|runecrafter/i,
	subname : "Tradition of Runecrafting",
	fullname : "Runecrafter (UA:PT-vii)",
	source : [["UA:GO", 3]],
	features : {
		"subclassfeature3" : {
			name : "Runes of Understanding",
			source : [["UA:GO", 3]],
			minlevel : 3,
			description : desc([
				"I always have Comprehend Languages prepared and can cast it without using a spell slot",
				"It doesn't count against the number of spells I can prepare"
			]),
			spellcastingBonus : [{
				name : "Runes of Understanding",
				spells : ["comprehend languages"],
				selection : ["comprehend languages"],
				firstCol : "atwill"
			}]
		},
		"subclassfeature3.1" : {
			name : "Runic Empowerment",
			source : [["UA:GO", 3]],
			minlevel : 3,
			description : desc([
				"When I cast a spell using a spell slot, I can invoke one of the following runes:",
				" \u2022 Life Rune: Me or a creature I can see within 30 ft gains 5 temp HP per spell slot level",
				" \u2022 War Rune: A creature I can see within 30 ft is marked until the end of my next turn",
				"   Attack rolls against it gain a bonus equal to half the spell slot level, rounded up",
				" \u2022 Wind Rune: Until my next turn starts, my speed increases by 5 ft per spell slot level",
				"   Additionally, my movement doesn't provoke opportunity attacks"
			]),
			usages : "Prof Bonus per ",
			usagescalc : "event.value = How('Proficiency Bonus');",
			recovery : "long rest"
		},
		"subclassfeature6" : {
			name : "Sigils of Warding",
			source : [["UA:GO", 3]],
			minlevel : 6,
			description : desc([
				"As a reaction when I fail a Strength, Dexterity, or Constitution save, I can call on a rune",
				"I expend a use of my Runic Empowerment feature and succeed on the save instead"
			]),
			action : [["reaction", ""]]
		},
		"subclassfeature10" : {
			name : "Rune Maven",
			source : [["UA:GO", 3]],
			minlevel : 10,
			description : desc([
				"Whenever I use Arcane Recovery, I also regain uses of Runic Empowerment",
				"I regain a number of uses equal to half my Intelligence modifier, rounded up (min 1)"
			])
		},
		"subclassfeature14" : {
			name : "Engraved Enmity",
			source : [["UA:GO", 3]],
			minlevel : 14,
			description : desc([
				"As a bonus action, I can have a creature I can see within 60 ft make a Wisdom save",
				"If failed, it is marked by an enmity rune for 1 min, or until I lose my concentration",
				"A glowing energy mote hovers over the marked and it suffers the following effects:",
				" \u2022 The marked has disadvantage on saving throws against spells I cast",
				" \u2022 The glow makes the marked visible even if invisible, and they can't become invisible",
				" \u2022 When marking and as a bonus action on subsequent turns, I can curse the creature",
				"   The next time an ally hits the cursed with an attack, it also takes 1d8 force damage",
				"I can do this once per long rest, or by expending a 3rd-level or higher spell slot (SS 3+)"
			]),
			recovery : "long rest",
			usages : 1,
			altResource : "SS 3+",
			action : [["bonus action", ""]]
		}
	}
});
/*RunFunctionAtEnd(function() {
	var theTheurgySubclass = AddSubClass("wizard_ua23pt7", "theurgy-ua", { // Still valid 2021-09-21
		regExpSearch : /^((?=.*mystic)(?=.*theurge))|(?=.*(theurgy|theurgist)).*$/i,
		subname : "Theurgy",
		source : [["UA:TF", 1], ["UA:WR", 1]],
		fullname : "Theurgist",
		features : {
			"subclassfeature3" : {
				name : "Arcane Initiate",
				source : [["UA:TF", 2], ["UA:WR", 1]],
				minlevel : 3,
				description : "\n   " + 'Choose a Cleric Domain using the "Choose Feature" button above' + "\n   " + "When I gain a wizard level I can replace one of the spells I would add to my spellbook" + "\n   " + "I can replace it with one of the chosen domain spells, if it is of a level I can cast" + "\n   " + "If my spellbook has all the domain spells, I can select any cleric spell of a level I can cast" + "\n   " + "Other wizards cannot copy cleric spells from my spellbook into their own spellbooks",
				calcChanges : {
					spellList : [
						function(spList, spName, spType) {
							if (spName !== "wizard_ua23pt7" || spType.indexOf("bonus") !== -1 || !CurrentSpells.wizard_ua23pt7.extra || !CurrentSpells.wizard_ua23pt7.selectSp || !spList.level || !spList.level[1]) return;
							var domainSpells = CurrentSpells.wizard.extra;
							// now stop this function if even one of the domain spells is not already in the spellbook
							var knownSpells = [].concat(CurrentSpells.wizard_ua23pt7.selectSp ? CurrentSpells.wizard_ua23pt7.selectSp : []).concat(CurrentSpells.wizard_ua23pt7.selectSpSB ? CurrentSpells.wizard_ua23pt7.selectSpSB : []);
							for (var i = 0; i < domainSpells.length; i++) {
								if (knownSpells.indexOf(domainSpells[i]) == -1) return;
							}
							// get all the cleric spells, level 1-9
							var clericSpells = CreateSpellList({"class" : "cleric", level : [1,9]}, false, false, false);
							spList.extraspells = spList.extraspells.concat(clericSpells);
						},
						"When I gain a wizard level after my spellbook already has all the spells of my chosen domain, I can instead select any cleric spell of a level I can cast as one of the spells I gain from levelling up."
					]
				},
				choices : [],
				choiceDependencies : [{
					feature : "subclassfeature3.3"
				}, {
					feature : "subclassfeature6"
				}, {
					feature : "subclassfeature10"
				}, {
					feature : "subclassfeature14"
				}]
			},
			"subclassfeature3.1" : {
				name : "Channel Arcana",
				source : [["UA:TF", 2], ["UA:WR", 1]],
				minlevel : 3,
				description : "\n   " + "I can channel arcane energy from my deity; the save for this is my wizard spell DC",
				usages : [0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3],
				recovery : "short rest"
			},
			"subclassfeature3.2" : {
				name : "Channel Arcana: Divine Arcana",
				source : [["UA:TF", 2], ["UA:WR", 1]],
				minlevel : 3,
				description : "\n   " + "As a bonus action, I speak a prayer to control the flow of magic around me" + "\n   " + "The next spell I cast gains a +2 bonus to its attack roll or saving throw DC",
				action : ["bonus action", ""]
			},
			"subclassfeature3.3" : {
				name : "Channel Arcana: Domain",
				source : [["UA:TF", 2], ["UA:WR", 1]],
				minlevel : 3,
				description : "\n   " + 'Use the "Choose Feature" button above to select the domain',
				choices : [],
				choicesNotInMenu : true
			},
			"subclassfeature6" : {
				name : "Arcane Acolyte",
				source : [["UA:TF", 3], ["UA:WR", 1]],
				minlevel : 6,
				description : "\n   " + 'Use the "Choose Feature" button above to select the domain',
				choices : [],
				choicesNotInMenu : true
			},
			"subclassfeature10" : {
				name : "Arcane Priest",
				source : [["UA:TF", 3], ["UA:WR", 2]],
				minlevel : 10,
				description : "\n   " + 'Use the "Choose Feature" button above to select the domain',
				choices : [],
				choicesNotInMenu : true
			},
			"subclassfeature14" : {
				name : "Arcane High Priest",
				source : [["UA:TF", 3], ["UA:WR", 2]],
				minlevel : 14,
				description : "\n   " + 'Use the "Choose Feature" button above to select the domain',
				choices : [],
				choicesNotInMenu : true
			}
		}
	});
	var MTfeat = ClassSubList[theTheurgySubclass].features;
	for (var i = 0; i < ClassList.cleric_ua23pt6.subclasses[1].length; i++) {
		var aDomain = ClassSubList[ClassList.cleric_ua23pt6.subclasses[1][i]];
		if (!aDomain) continue;
		var dSource = aDomain.source ? aDomain.source : aDomain.features["subclassfeature3"] && aDomain.features["subclassfeature3"].source ? aDomain.features["subclassfeature3"].source : [["UA:TF", 0], ["UA:WR", 0]];
		
		var suffix = 1;
		var entryDoNm = aDomain.subname;
		while (MTfeat["subclassfeature3"].choices.indexOf(entryDoNm) !== -1) {
			suffix += 1;
			entryDoNm = aDomain.subname + " (" + suffix + ")";
		};
		MTfeat["subclassfeature3"].choices.push(entryDoNm);
		MTfeat["subclassfeature3"][entryDoNm.toLowerCase()] = {
			name : "Arcane Initiate: " + aDomain.subname,
			source : dSource,
			spellcastingExtra : aDomain.spellcastingExtra,
			description : "\n   " + "When I gain a wizard level I can replace one of the spells I would add to my spellbook" + "\n   " + "I can replace it with one of the " + aDomain.subname.toLowerCase() + " spells, if it is of a level I can cast" + "\n   " + "If my spellbook has all the domain spells, I can select any cleric spell of a level I can cast" + "\n   " + "Other wizards cannot copy cleric spells from my spellbook into their own spellbooks"
		};
		var AIdomain = MTfeat["subclassfeature3"][entryDoNm.toLowerCase()];
		for (var aFea in aDomain.features) {
			var dFea = aDomain.features[aFea];
			if (dFea.minlevel === 2 && (/channel divinity/i).test(dFea.name)) {
				MTfeat["subclassfeature3.3"].choices.push(entryDoNm);
				MTfeat["subclassfeature3.3"][entryDoNm.toLowerCase()] = newObj(dFea);
				MTfeat["subclassfeature3.3"][entryDoNm.toLowerCase()].name = MTfeat["subclassfeature3.3"][entryDoNm.toLowerCase()].name.replace(/channel divinity/i, "Channel Arcana");
			};
			if (dFea.minlevel === 1 && !dFea.armor && !dFea.weapons && !dFea.armorProfs && !dFea.weaponProfs) {
				if (MTfeat["subclassfeature6"].choices.indexOf(entryDoNm) === -1) { //if the entry does not exist yet
					MTfeat["subclassfeature6"].choices.push(entryDoNm);
					MTfeat["subclassfeature6"][entryDoNm.toLowerCase()] = newObj(dFea);
				} else { //add to the existing entry
					var theFea = MTfeat["subclassfeature6"][entryDoNm.toLowerCase()];
					theFea.name += " \u0026 " + dFea.name;
					theFea.description += dFea.description;
					for (var subFea in dFea) {
						if (theFea[subFea] === undefined) theFea[subFea] = dFea[subFea];
					};
				};
			};
			if (dFea.minlevel === 6 && !dFea.armor && !dFea.weapons && !dFea.armorProfs && !dFea.weaponProfs) {
				if (MTfeat["subclassfeature10"].choices.indexOf(entryDoNm) === -1) { //if the entry does not exist yet
					MTfeat["subclassfeature10"].choices.push(entryDoNm);
					MTfeat["subclassfeature10"][entryDoNm.toLowerCase()] = newObj(dFea);
				} else { //add to the existing entry
					var theFea = MTfeat["subclassfeature10"][entryDoNm.toLowerCase()];
					theFea.name += " \u0026 " + dFea.name;
					theFea.description += dFea.description;
					for (var subFea in dFea) {
						if (theFea[subFea] === undefined) theFea[subFea] = dFea[subFea];
					};
				};
			};
			if (dFea.minlevel === 17 && !dFea.armor && !dFea.weapons && !dFea.armorProfs && !dFea.weaponProfs) {
				if (MTfeat["subclassfeature14"].choices.indexOf(entryDoNm) === -1) { //if the entry does not exist yet
					MTfeat["subclassfeature14"].choices.push(entryDoNm);
					MTfeat["subclassfeature14"][entryDoNm.toLowerCase()] = newObj(dFea);
				} else { //add to the existing entry
					var theFea = MTfeat["subclassfeature14"][entryDoNm.toLowerCase()];
					theFea.name += " \u0026 " + dFea.name;
					theFea.description += dFea.description;
					for (var subFea in dFea) {
						if (theFea[subFea] === undefined) theFea[subFea] = dFea[subFea];
					};
				};
			};
		};
	};
});*/